"use strict";(self["webpackChunk_radiantearth_stac_browser"]=self["webpackChunk_radiantearth_stac_browser"]||[]).push([[3666],{13666:function(e,t,n){n.r(t),n.d(t,{appendCollectionsQueryParam:function(){return u},getMapTileUrlTemplate:function(){return f},getTileSetInfo:function(){return m},getVectorTileUrlTemplate:function(){return p}});var r=n(54422),i=n(70915),o=n(77076),s=n(38599),c=n(56758);const l={"image/png":!0,"image/jpeg":!0,"image/gif":!0,"image/webp":!0},a={"application/vnd.mapbox-vector-tile":!0,"application/geo+json":!0};function u(e,t){if(!t.length)return e;const n=new URL(e,"file:/");if(n.pathname.split("/").includes("collections"))return(0,r.z3)('The "collections" query parameter cannot be added to collection endpoints'),e;const i=t.map(e=>encodeURIComponent(e)).join(",");n.searchParams.append("collections",i);const o=e.split("?")[0],s=decodeURIComponent(n.searchParams.toString());return`${o}?${s}`}function f(e,t,n){let r,i;for(let o=0;o<e.length;++o){const n=e[o];if("item"===n.rel){if(n.type===t){r=n.href;break}(l[n.type]||!i&&n.type.startsWith("image/"))&&(i=n.href)}}if(!r){if(!i)throw new Error('Could not find "item" link');r=i}return n&&(r=u(r,n)),r}function p(e,t,n,r){let i,o;const s={};for(let c=0;c<e.length;++c){const n=e[c];if(s[n.type]=n.href,"item"===n.rel){if(n.type===t){i=n.href;break}a[n.type]&&(o=n.href)}}if(!i&&n)for(let c=0;c<n.length;++c){const e=n[c];if(s[e]){i=s[e];break}}if(!i){if(!o)throw new Error('Could not find "item" link');i=o}return r&&(i=u(i,r)),i}function d(e,t,n,r){let l=e.projection;if(!l&&("string"===typeof t.crs?l=(0,s.Jt)(t.crs):"uri"in t.crs&&(l=(0,s.Jt)(t.crs.uri)),!l))throw new Error(`Unsupported CRS: ${JSON.stringify(t.crs)}`);const a=t.orderedAxes,u=a?a.slice(0,2).map(e=>e.replace(/E|X|Lon/i,"e").replace(/N|Y|Lat/i,"n")).join(""):l.getAxisOrientation(),f=!u.startsWith("en"),p=t.tileMatrices,d={};for(let i=0;i<p.length;++i){const e=p[i];d[e.id]=e}const h={},m=[];if(r)for(let i=0;i<r.length;++i){const e=r[i],t=e.tileMatrix;m.push(t),h[t]=e}else for(let i=0;i<p.length;++i){const e=p[i].id;m.push(e)}const w=m.length,g=new Array(w),T=new Array(w),x=new Array(w),y=new Array(w),C=[-1/0,-1/0,1/0,1/0];for(let o=0;o<w;++o){const e=m[o],t=d[e],n=t.pointOfOrigin;g[o]=f?[n[1],n[0]]:n,T[o]=t.cellSize,x[o]=[t.matrixWidth,t.matrixHeight],y[o]=[t.tileWidth,t.tileHeight];const r=h[e];if(r){const e=t.cellSize*t.tileWidth,n=g[o][0]+r.minTileCol*e,s=g[o][0]+(r.maxTileCol+1)*e,c=t.cellSize*t.tileHeight,l="bottomLeft"===t.cornerOfOrigin;let a,u;l?(a=g[o][1]+r.minTileRow*c,u=g[o][1]+(r.maxTileRow+1)*c):(a=g[o][1]-(r.maxTileRow+1)*c,u=g[o][1]-r.minTileRow*c),(0,i._N)(C,[n,a,s,u],C)}}const E=new c.A({origins:g,resolutions:T,sizes:x,tileSizes:y,extent:r?C:void 0}),R=e.context,b=e.url;function k(e,t,i){if(!e)return;const s=m[e[0]],c=d[s],l="bottomLeft"===c.cornerOfOrigin,a={tileMatrix:s,tileCol:e[1],tileRow:l?-e[2]-1:e[2]};if(r){const e=h[c.id];if(a.tileCol<e.minTileCol||a.tileCol>e.maxTileCol||a.tileRow<e.minTileRow||a.tileRow>e.maxTileRow)return}Object.assign(a,R);const u=n.replace(/\{(\w+?)\}/g,function(e,t){return a[t]});return(0,o.O2)(b,u)}return{grid:E,projection:l,urlTemplate:n,urlFunction:k}}function h(e,t){const n=t.tileMatrixSetLimits;let r;if("map"===t.dataType)r=f(t.links,e.mediaType,e.collections);else{if("vector"!==t.dataType)throw new Error('Expected tileset data type to be "map" or "vector"');r=p(t.links,e.mediaType,e.supportedMediaTypes,e.collections)}if(t.tileMatrixSet)return d(e,t.tileMatrixSet,r,n);const i=t.links.find(e=>"http://www.opengis.net/def/rel/ogc/1.0/tiling-scheme"===e.rel);if(!i)throw new Error("Expected http://www.opengis.net/def/rel/ogc/1.0/tiling-scheme link or tileMatrixSet");const s=i.href,c=(0,o.O2)(e.url,s);return(0,o.hm)(c).then(function(t){return d(e,t,r,n)})}function m(e){return(0,o.hm)(e.url).then(function(t){return h(e,t)})}},77076:function(e,t,n){n.d(t,{FQ:function(){return i},O2:function(){return l},hm:function(){return c}});var r=n(4087);function i(e,t,n,i){const o=document.createElement("script"),s="olc_"+(0,r.v6)(t);function c(){delete window[s],o.parentNode.removeChild(o)}o.async=!0,o.src=e+(e.includes("?")?"&":"?")+(i||"callback")+"="+s;const l=setTimeout(function(){c(),n&&n()},1e4);window[s]=function(e){clearTimeout(l),c(),t(e)},document.head.appendChild(o)}class o extends Error{constructor(e){const t="Unexpected response status: "+e.status;super(t),this.name="ResponseError",this.response=e}}class s extends Error{constructor(e){super("Failed to issue request"),this.name="ClientError",this.client=e}}function c(e){return new Promise(function(t,n){function r(e){const r=e.target;if(!r.status||r.status>=200&&r.status<300){let e;try{e=JSON.parse(r.responseText)}catch(i){const e="Error parsing response text as JSON: "+i.message;return void n(new Error(e))}return void t(e)}n(new o(r))}function i(e){n(new s(e.target))}const c=new XMLHttpRequest;c.addEventListener("load",r),c.addEventListener("error",i),c.open("GET",e),c.setRequestHeader("Accept","application/json"),c.send()})}function l(e,t){return t.includes("://")?t:new URL(t,e).href}}}]);
//# sourceMappingURL=3666.b5b4f46a.js.map