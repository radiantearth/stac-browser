"use strict";(self["webpackChunk_radiantearth_stac_browser"]=self["webpackChunk_radiantearth_stac_browser"]||[]).push([[4391],{64391:function(t,e,n){n.d(e,{default:function(){return ut}});var r=n(71321);function s(t){return"string"===typeof t&&t.length>0}function i(t,e,n,r=1e-8){if("number"!==typeof t)return null;const s=e-r,i=n+r;return t<s||t>i?null:Math.min(Math.max(t,e),n)}function l(t){return"object"===typeof t&&t===Object(t)&&!Array.isArray(t)}function u(t){switch(t){case"int8":return-128;case"int16":return-32768;case"int32":return-2147483648}return t.startsWith("u")?0:null}function a(t){switch(t){case"int8":return 127;case"uint8":return 255;case"int16":return 32767;case"uint16":return 65535;case"int32":return 2147483647;case"uint32":return 4294967295}return null}function o(t){const e={minimum:null,maximum:null},n=t=>null!==t.minimum&&null!==t.maximum,r=t.getMetadata("statistics");if(l(r)&&("number"===typeof r.minimum&&(e.minimum=r.minimum),"number"===typeof r.maximum&&(e.maximum=r.maximum),n(e)))return e;const s=t.getMetadata("raster:histogram");if(l(s)&&("number"===typeof s.min&&(e.minimum=s.min),"number"===typeof s.max&&(e.maximum=s.max),n(e)))return e;const i=t.getMetadata("classification:classes");if(Array.isArray(i)&&(i.reduce((t,e)=>(t.minimum=Math.min(t.minimum,e.value),t.maximum=Math.max(t.maximum,e.value),t),e),n(e)))return e;const o=t.getMetadata("file:values");if(Array.isArray(o)&&(o.reduce((t,e)=>(t.minimum=Math.min(t.minimum,...e.values),t.maximum=Math.max(t.maximum,...e.values),t),e),n(e)))return e;const h=t.getMetadata("data_type");return h&&(e.minimum=u(h),e.maximum=a(h)),e}function h(t){let e=[];const n=t.getMetadata("nodata");if("undefined"!==typeof n)e.push(n);else{const n=t.getMetadata("file:nodata");if("undefined"!==typeof n)e=n;else{const n=t.getMetadata("classification:classes");Array.isArray(n)&&(e=n.filter(t=>Boolean(t.nodata)).map(t=>t.value))}}return e.map(t=>"nan"===t?NaN:"+inf"===t?1/0:"-inf"===t?-1/0:t)}function c(t){let e=t.length>=6,n=t[0],r=t[e?3:2],s=t[1],i=t[e?4:3],l={west:n,east:r,south:s,north:i};return e&&(l.base=t[2],l.height=t[5]),l}function g(t){let{west:e,east:n,south:r,north:s}=c(t);return[[[e,s],[e,r],[n,r],[n,s],[e,s]]]}function m(t){if(t=p(t,!0),!t)return null;let e=c(t),n=[];if(d(t)){let t=(e.west+360+e.east)/2;t>180&&(t-=360),n.push(t)}else n.push((e.west+e.east)/2);return n.push((e.south+e.north)/2),"undefined"!==typeof e.base&&n.push((e.base+e.height)/2),n}function f(t){const e=p(t);if(e?t=[e]:Array.isArray(t)&&(t=t.map(t=>p(t)).filter(t=>null!==t)),!Array.isArray(t)||0===t.length)return null;let n=t.reduce((t,e)=>{if(d(e)){let{west:n,east:r,south:s,north:i}=c(e);t.push(g([-180,s,r,i])),t.push(g([n,s,180,i]))}else t.push(g(e));return t},[]),r=null;return 1===n.length?r={type:"Polygon",coordinates:n[0]}:n.length>1&&(r={type:"MultiPolygon",coordinates:n}),r?{type:"Feature",geometry:r,properties:{}}:void 0}function p(t,e=!1){if(!Array.isArray(t)||![4,6].includes(t.length))return null;let{west:n,east:r,south:s,north:l,base:u,height:a}=c(t);return n=i(n,-180,180),s=i(s,-90,90),r=i(r,-180,180),l=i(l,-90,90),t=e&&6===t.length?[n,s,u,r,l,a]:[n,s,r,l],t.some(t=>null===t)?null:t}function d(t){if(t=p(t),!t)return!1;let{west:e,east:n}=c(t);return e>n}function y(t){if(!Array.isArray(t)||0===t.length)return null;let e={west:180,south:90,east:-180,north:-90};t.forEach(t=>{if(t=p(t),!t)return;let n=c(t),r=["west","south"];for(let s in n){let t=r.includes(s)?Math.min:Math.max;e[s]=t(e[s],n[s])}});let n=[e.west,e.south,e.east,e.north];return p(n)}class x{constructor(t,e={},n=[]){if(!l(t))throw new Error("Given data is not an object");if(t instanceof x){for(let e of n)this[e]=t[e];t=t.toJSON()}this._keyMap=e,this._privateKeys=["_keyMap","_privateKeys"].concat(n);for(let r in t)"undefined"===typeof this[r]&&(this[r]=r in e?e[r](t[r],this):t[r])}isItem(){return"Feature"===this.type}isCatalog(){return"Catalog"===this.type}isCatalogLike(){return this.isCatalog()||this.isCollection()}isCollection(){return"Collection"===this.type}isItemCollection(){return"FeatureCollection"===this.type}isCollectionCollection(){return!1}isAsset(){return!1}isLink(){return!1}isBand(){return!1}getObjectType(){}getAbsoluteUrl(){return null}getMetadata(t){return this[t]}toGeoJSON(){return null}getBoundingBox(){return null}getCenter(){return m(this.getBoundingBox())}getBoundingBoxes(){return[]}toJSON(){let t={};return Object.keys(this).forEach(e=>{if("function"===typeof this[e]||this._privateKeys.includes(e))return;let n=this[e];if(e in this._keyMap){let t=Array.isArray(n)?[]:{};for(let e in n)t[e]=n[e].toJSON();n=t}t[e]=n}),t}}var A=x,B=n(84193);const b=["http","https"];function _(t,e,n=!0){return k(t,e,!1,n)}function k(t,e=null,n=!1,r=!0){let s=B(t);if(e&&s.is("relative")){let t=B(e),n=t.path();n.endsWith("/")||n.endsWith(".json")||t.path(n+"/"),s=s.absoluteTo(t)}return s.normalize(),n&&(s.query(""),s.fragment("")),r?s.toString():s}const w="application/geo+json",v=["application/json",w,"text/json"],T=["image/gif","image/jpeg","image/apng","image/png","image/webp"],L=["image/tiff; application=geotiff; profile=cloud-optimized","image/vnd.stac.geotiff; cloud-optimized=true"],C=["application/geotiff","image/tiff; application=geotiff","image/vnd.stac.geotiff"].concat(L);T.concat(C);function M(t,e,n=!1){return Array.isArray(e)||(e=[e]),!(!n||"undefined"!==typeof t)||"string"===typeof t&&(e=e.map(t=>t.toLowerCase()),e.includes(t.toLowerCase()))}function O(t,e=!1){return M(t,v,e)}class S extends A{constructor(t,e=null,n={},r=[]){super(t,n,["_context"].concat(r)),this._context||(this._context=e)}getAbsoluteUrl(t=!0){return this._context?_(this.href,this._context.getAbsoluteUrl(),t):this.href.includes("://")?this.href:null}getContext(){return this._context}canBrowserDisplayImage(t=!1){if("string"!==typeof this.href)return!1;if(!t&&"undefined"===typeof this.type)return!1;let e=new B(this.href),n=e.protocol().toLowerCase(),r=e.suffix().toLowerCase();return!(s(n)&&!b.includes(n))&&(!(!s(this.type)||!T.includes(this.type.toLowerCase()))||!("undefined"!==typeof this.type||!s(r)||"jpg"!==r&&!T.includes("image/"+r)))}isType(t){return s(this.type)&&M(this.type,t)}isGeoTIFF(){return this.isType(C)}isCOG(){return this.isType(L)}isHTTP(){let t=this.getAbsoluteUrl(!1),e=t.protocol().toLowerCase();return s(e)&&b.includes(e)}isPreview(){return!1}}var R=S;class j extends R{constructor(t,e=null){super(t,e)}isLink(){return!0}getObjectType(){return"Link"}isPreview(){return"preview"===this.rel}static fromLinks(t,e=null){return Array.isArray(t)?t.map(t=>l(t)?new j(t,e):t):[]}}var W=j;class E extends A{constructor(t,e=null,n={},r=[]){if(super(t,Object.assign({links:W.fromLinks},n),["_url"].concat(r)),!this._url&&(this._url=e,!this._url)){let t=this.getSelfLink();t&&(this._url=t.href)}}getAbsoluteUrl(){return this._url}setAbsoluteUrl(t){this._url=t}getStacLinksWithRel(t,e=!0){return this.getLinksWithRels([t]).filter(t=>O(t.type,e))}getStacLinkWithRel(t,e=!0){const n=this.getStacLinksWithRel(t,e);return n.length>0?n[0]:null}getLinks(){return Array.isArray(this.links)?this.links.filter(t=>l(t)&&s(t.href)):[]}getLinkWithRel(t){return this.getLinks().find(e=>e.rel===t)||null}getLinksWithRels(t){return this.getLinks().filter(e=>t.includes(e.rel))}getLinksWithOtherRels(t){return this.getLinks().filter(e=>!t.includes(e.rel))}getSelfLink(){return this.getStacLinkWithRel("self")}getRootLink(){return this.getStacLinkWithRel("root")}getParentLink(){return this.getStacLinkWithRel("parent")}}var I=E;class D extends I{constructor(t,e=null,n={},r=[]){super(t,e,n,r)}getAll(){return[]}}var N=D;class F extends A{constructor(t,e=null,n=null){super(t,{},["_index","_context"]),"number"!==typeof this._index&&(this._index="string"===typeof e?parseInt(e,10):e),this._context||(this._context=n)}getContext(){return this._context}getObjectType(){return"Band"}isBand(){return!0}getIndex(){return this._index}getMetadata(t){return"undefined"!==typeof this[t]?this[t]:this._context?this._context.getMetadata(t):void 0}getMinMaxValues(){return o(this)}getNoDataValues(){return h(this)}static fromBands(t,e=null){let n=[];if(Array.isArray(t))for(let r in t)n[r]=new F(t[r],r,e);return n}}var G=F;const P=["created","updated","published","expires","unpublished","bands"];class J extends R{constructor(t,e=null,n=null){const r={bands:G.fromBands,alternate:J.fromAssets};super(t,n,r,["_key"]),this._key||(this._key=e)}getObjectType(){return"Asset"}isAsset(){return!0}getAbsoluteUrl(t=!0){return this.isDefinition()?null:super.getAbsoluteUrl(t)}getKey(){return this._key}getMetadata(t){return"undefined"!==typeof this[t]?this[t]:this._context instanceof J||this._context&&!P.includes(t)?this._context.getMetadata(t):void 0}getBands(){return this.bands||[]}findVisualBands(){const t={red:null,green:null,blue:null},e=this.getBands();for(const r in e){const n=parseInt(r,10),i=e[n];l(i)&&s(i["eo:common_name"])&&i["eo:common_name"]in t&&(t[i["eo:common_name"]]=i)}const n=Object.values(t).every(t=>null!==t);return n?t:null}findBand(t,e="name"){Array.isArray(t)||(t=[t]);const n=this.getBands(),r=n.findIndex(n=>l(n)&&t.includes(n[e]));return r>=0?n[r]:null}getBand(t){if(l(t)||null===t)return t;const e=this.getBands();return e[t]||null}getMinMaxValues(){return o(this)}getNoDataValues(){return h(this)}isDefinition(){return!s(this.href)}isHTTP(){return this.isDefinition()?null:super.isHTTP()}isPreview(){const t=["thumbnail","overview"];return!!t.includes(this.getKey())||Array.isArray(this.roles)&&this.roles.some(e=>t.includes(e))}hasRole(t,e=!1){return Array.isArray(t)||(t=[t]),!(!e||!t.includes(this.getKey()))||Array.isArray(this.roles)&&Boolean(this.roles.find(e=>t.includes(e)))}static fromAssets(t,e=null){let n={};if(l(t))for(let r in t)n[r]=new J(t[r],r,e);return n}}var U=J;class K extends I{constructor(t,e=null,n={},r=[]){super(t,e,n,r)}getTemporalExtent(){return null}getTemporalExtents(){return[]}getIcons(t=!0){return this.getLinksWithRels(["icon"]).filter(e=>e.canBrowserDisplayImage(t))}getThumbnails(t=!0,e=null){let n=this.getAssets().filter(t=>t.isPreview());if(0===n.length&&(n=this.getLinks().filter(t=>t.isPreview())),t&&(n=n.filter(t=>t.canBrowserDisplayImage())),e&&n.length>1){let t=t=>Array.isArray(t.roles)&&t.roles.includes(e)||t.getKey()===e;n=n.filter(t).concat(n.filter(e=>!t(e)))}return n}getDefaultGeoTIFF(t=!0,e=!1){let n=this.rankGeoTIFFs(t,e);return n[0]?.asset}rankGeoTIFFs(t=!0,e=!1,n=null,r=null){l(n)||(n={data:1,visual:2,thumbnail:2,overview:3});let s=[],i=this.getAssetsByTypes(C);t&&(i=i.filter(t=>t.isHTTP()&&(!e||t.isCOG())));let u=Object.entries(n);for(let l of i){let t=0;if(u.length>0){let e=u.filter(([t])=>l.hasRole(t,!0)).map(([,t])=>t);e.length>0&&(t+=Math.max(...e))}!e&&l.isCOG()&&(t+=2),l.findVisualBands()&&(t+=1),"function"===typeof r&&(t+=r(l)),s.push({asset:l,score:t})}return s.sort((t,e)=>e.score-t.score),s}findVisualAssets(){let t={red:null,green:null,blue:null},e=Object.keys(t),n=this.getAssets();for(let s of n){let n=s.findBand(e,"eo:common_name");n&&(t[n["eo:common_name"]]=s)}let r=Object.values(t).every(t=>null!==t);return r?t:null}getAsset(t){return l(this.assets)&&this.assets[t]||null}getAssets(){return l(this.assets)?Object.values(this.assets):[]}getAssetsWithRoles(t,e=!1){return this.getAssets().filter(n=>n.hasRole(t,e))}getAssetWithRole(t,e=!1){let n=this.getAssetsWithRoles([t],e);return n[0]||null}getAssetsByTypes(t){return this.getAssets().filter(e=>M(e.type,t))}equals(t){return this===t||t instanceof K&&(this.getObjectType()===t.getObjectType()&&!(!this.id||this.id!==t.id))}supportsExtension(t){if(!Array.isArray(this.stac_extensions))return!1;let e=new RegExp("^"+t.replaceAll("*","[^/]+")+"$");return this.stac_extensions.some(t=>e.test(t))}}var V=K;class H extends V{constructor(t,e=null,n={},r=[]){super(t,e,n,r)}getObjectType(){return this.type}getSearchLink(t=null){let e=this.getStacLinksWithRel("search");return t?e[0]||null:e.find(e=>e.method===t||!t&&!e.method)||null}getApiCollectionsLink(){return this.getStacLinkWithRel("data")}getApiItemsLink(){return this.getStacLinkWithRel("items")}getChildLinks(){return this.getStacLinksWithRel("child")}getItemLinks(){return this.getStacLinksWithRel("item")}}var z=H;class q extends z{constructor(t,e=null){super(t,e)}}var $=q;function Z(t){if(s(t)&&t.length>=10)try{let e=t.match(/^(-?\d{1,})-(\d\d)-(\d\d)[T ](\d\d):(\d\d):(\d\d)(?:\.(\d*))?(?:Z|[+-]00:00)?$/i),n=e.slice(1).map(t=>parseInt(t,10));return new Date(Date.UTC(n[0],n[1]-1,n[2],n[3],n[4],n[5],n[6]||0))}catch{return null}return null}function Q(t,e){return new Date(t.valueOf()+(e-t)/2)}function X(t){if(!Array.isArray(t)||0===t.length)return null;let e,n;const r=(t,e,n)=>"undefined"===typeof t?e:null===t||null===e?null:n(t,e);return t.forEach(([t,s])=>{e=r(e,t,Math.min),n=r(n,s,Math.max)}),[null===e?null:new Date(e),null===n?null:new Date(n)]}class Y extends z{constructor(t,e=null){const n={assets:U.fromAssets,item_assets:U.fromAssets};super(t,e,n)}toGeoJSON(){let t=f(this.getBoundingBoxes());return t&&(t.id=this.id),t}getBoundingBox(){let t=this.getRawBoundingBoxes();return t.length>0?p(t[0]):null}getBoundingBoxes(){let t=this.getRawBoundingBoxes();return 1===t.length?[p(t[0])]:t.length>1?t.slice(1).map(p):null}getRawBoundingBoxes(){let t=this.extent?.spatial?.bbox;return Array.isArray(t)&&t.length>0?t:[]}getTemporalExtent(){return this.getTemporalExtents()[0]||null}getTemporalExtents(){let t=this.extent?.temporal?.interval;return Array.isArray(t)&&t.length>0?t.filter(t=>Array.isArray(t)&&(s(t[0])||s(t[1]))).map(t=>t.map(t=>Z(t))):[]}getSummary(t){return this.summaries[t]}getBands(){let t=this.getMetadata("bands");return Array.isArray(t)||(t=this.getSummary("bands")),Array.isArray(t)?G.fromBands(t,this):[]}}var tt=Y;class et extends N{constructor(t,e=null){const n={collections:t=>t.map(t=>new tt(t))};super(t,e,n)}getObjectType(){return"CollectionCollection"}getAll(){return this.collections}isCollectionCollection(){return!0}toGeoJSON(){let t=this.collections.map(t=>t.toGeoJSON()).filter(t=>null!==t);return{type:"FeatureCollection",features:t}}getBoundingBox(){return y(this.getBoundingBoxes())}getBoundingBoxes(){return this.collections.map(t=>t.getBoundingBox())}getTemporalExtent(){return X(this.getTemporalExtents())}getTemporalExtents(){return this.collections.map(t=>t.getTemporalExtent())}}var nt=et;class rt extends V{constructor(t,e=null){super(t,e,{assets:U.fromAssets})}getObjectType(){return"Item"}toGeoJSON(){return this.toJSON()}getBoundingBox(){return p(this.bbox)}getBoundingBoxes(){const t=this.getBoundingBox();return t?[t]:[]}getDateTime(){let t=Z(this.properties.datetime);if(!t){let t=Z(this.properties.start_datetime),e=Z(this.properties.end_datetime);return t&&e?Q(t,e):t||e}return t}getTemporalExtent(){return this.getTemporalExtents()[0]||null}getTemporalExtents(){let t=[];return s(this.properties.start_datetime)||s(this.properties.end_datetime)?t=[[this.properties.start_datetime||null,this.properties.end_datetime||null]]:s(this.properties.datetime)&&(t=[[this.properties.datetime,this.properties.datetime]]),t.map(t=>t.map(t=>Z(t)))}getMetadata(t){return this.properties[t]}getBands(){const t=this.getMetadata("bands");return Array.isArray(t)?G.fromBands(t,this):[]}getCollectionLink(){return this.getStacLinkWithRel("collection")}}var st=rt;class it extends N{constructor(t,e=null){const n={features:t=>t.map(t=>new st(t))};super(t,e,n)}getObjectType(){return"ItemCollection"}getAll(){return this.features}toGeoJSON(){return this.toJSON()}getBoundingBox(){return y(this.getBoundingBoxes())}getBoundingBoxes(){return this.features.map(t=>t.getBoundingBox())}getTemporalExtent(){return X(this.getTemporalExtents())}getTemporalExtents(){return this.features.map(t=>t.getTemporalExtent())}}var lt=it;function ut(t,e=!0,n=!1){return e&&(t=r.stac(t,n)),"Feature"===t.type?new st(t):"FeatureCollection"===t.type?new lt(t):"Collection"===t.type||!t.type&&"undefined"!==typeof t.extent&&"undefined"!==typeof t.license?new tt(t):!t.type&&Array.isArray(t.collections)?new nt(t):new $(t)}}}]);
//# sourceMappingURL=4391.f28965b2.js.map