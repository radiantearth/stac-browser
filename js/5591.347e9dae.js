"use strict";(self["webpackChunk_radiantearth_stac_browser"]=self["webpackChunk_radiantearth_stac_browser"]||[]).push([[850,5591,6131,6164,8469,8512],{18469:function(e,t,r){r.r(t),t["default"]={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"}},28512:function(e,t,r){r.r(t);var n=r(40190),o=r(11078),i=r(6837),a=r(38599),s=r(97404),l=r(4863),u=r(4087),c=r(46164);class p extends c["default"]{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:f,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:void 0===e.interpolate||e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:null,this.tileClass=void 0!==e.tileClass?e.tileClass:n.A,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!(0,a.tI)(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||(0,a.tI)(t,e)))return this.tileGrid;const r=(0,u.v6)(e);return r in this.tileGridForProjection||(this.tileGridForProjection[r]=(0,l.pr)(e)),this.tileGridForProjection[r]}createTile_(e,t,r,n,a,s){const l=[e,t,r],u=this.getTileCoordForTileUrlFunction(l,a),c=u?this.tileUrlFunction(u,n,a):void 0,p=new this.tileClass(l,void 0!==c?o.A.IDLE:o.A.EMPTY,void 0!==c?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return p.key=s,p.addEventListener(i.A.CHANGE,this.handleTileChange.bind(this)),p}getTile(e,t,r,n,o){const i=this.getProjection();if(!i||!o||(0,a.tI)(i,o))return this.getTileInternal(e,t,r,n,i||o);const l=[e,t,r],u=this.getKey(),c=this.getTileGridForProjection(i),p=this.getTileGridForProjection(o),f=this.getTileCoordForTileUrlFunction(l,o),d=new s.A(i,c,o,p,l,f,this.getTilePixelRatio(n),this.getGutter(),(e,t,r,n)=>this.getTileInternal(e,t,r,n,i),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return d.key=u,d}getTileInternal(e,t,r,n,o){const i=this.getKey();return this.createTile_(e,t,r,n,o,i)}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const r=(0,a.Jt)(e);if(r){const e=(0,u.v6)(r);e in this.tileGridForProjection||(this.tileGridForProjection[e]=t)}}}function f(e,t){e.getImage().src=t}t["default"]=p},46164:function(e,t,r){r.r(t);var n=r(11078),o=r(42654),i=r(14465),a=r(4087),s=r(66017),l=r(18469);class u extends s["default"]{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===u.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,r=(0,a.v6)(t),o=t.getState();let i;o==n.A.LOADING?(this.tileLoadingKeys_[r]=!0,i=l["default"].TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],i=o==n.A.ERROR?l["default"].TILELOADERROR:o==n.A.LOADED?l["default"].TILELOADEND:void 0),void 0!=i&&this.dispatchEvent(new s.TileSourceEvent(i,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,"undefined"!==typeof t?this.setKey(t):this.changed()}setUrl(e){const t=(0,i.Uu)(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction((0,o.Qz)(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,r){}}t["default"]=u},81828:function(e,t,r){r.d(t,{apply:function(){return $s}});var n=8,o={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},i={"*":{type:"source"}},a=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],s={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},l={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},u={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},c={type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},p={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},f={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},d={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},y=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],h={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},m={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},g={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},v={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},b={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},x={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},w={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},k={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},S={type:"array",value:"*"},$={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},z={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},A={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},j={type:"array",value:"*",minimum:1},M={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},E={"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},_={source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},C={type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},q=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],T={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},F={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},P={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},O={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},I={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},N={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},R={"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},L={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},D={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},U={"*":{type:"string"}},G={$version:n,$root:o,sources:i,source:a,source_vector:s,source_raster:l,source_raster_dem:u,source_geojson:c,source_video:p,source_image:f,layer:d,layout:y,layout_background:h,layout_fill:m,layout_circle:g,layout_heatmap:v,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:b,layout_symbol:x,layout_raster:w,layout_hillshade:k,"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:S,filter_operator:$,geometry_type:z,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:A,expression:j,light:M,sky:E,terrain:_,projection:C,paint:q,paint_fill:T,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:F,paint_circle:P,paint_heatmap:O,paint_symbol:I,paint_raster:N,paint_hillshade:R,"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:L,transition:D,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:U};const J=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function V(e,t){const r={};for(const n in e)"ref"!==n&&(r[n]=e[n]);return J.forEach(e=>{e in t&&(r[e]=t[e])}),r}function W(e){e=e.slice();const t=Object.create(null);for(let r=0;r<e.length;r++)t[e[r].id]=e[r];for(let r=0;r<e.length;r++)"ref"in e[r]&&(e[r]=V(e[r],t[e[r].ref]));return e}class K{constructor(e,t,r,n){this.message=(e?`${e}: `:"")+r,n&&(this.identifier=n),null!==t&&void 0!==t&&t.__line__&&(this.line=t.__line__)}}function Z(e,...t){for(const r of t)for(const t in r)e[t]=r[t];return e}class X extends Error{constructor(e,t){super(t),this.message=t,this.key=e}}class B{constructor(e,t=[]){this.parent=e,this.bindings={};for(const[r,n]of t)this.bindings[r]=n}concat(e){return new B(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const H={kind:"null"},Y={kind:"number"},Q={kind:"string"},ee={kind:"boolean"},te={kind:"color"},re={kind:"projectionDefinition"},ne={kind:"object"},oe={kind:"value"},ie={kind:"error"},ae={kind:"collator"},se={kind:"formatted"},le={kind:"padding"},ue={kind:"colorArray"},ce={kind:"numberArray"},pe={kind:"resolvedImage"},fe={kind:"variableAnchorOffsetCollection"};function de(e,t){return{kind:"array",itemType:e,N:t}}function ye(e){if("array"===e.kind){const t=ye(e.itemType);return"number"===typeof e.N?`array<${t}, ${e.N}>`:"value"===e.itemType.kind?"array":`array<${t}>`}return e.kind}const he=[H,Y,Q,ee,te,re,se,ne,de(oe),le,ce,ue,pe,fe];function me(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!me(e.itemType,t.itemType))&&("number"!==typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(const e of he)if(!me(e,t))return null}return`Expected ${ye(e)} but found ${ye(t)} instead.`}function ge(e,t){return t.some(t=>t.kind===e.kind)}function ve(e,t){return t.some(t=>"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"===typeof e:t===typeof e)}function be(e,t){return"array"===e.kind&&"array"===t.kind?e.itemType.kind===t.itemType.kind&&"number"===typeof e.N:e.kind===t.kind}const xe=.96422,we=1,ke=.82521,Se=4/29,$e=6/29,ze=3*$e*$e,Ae=$e*$e*$e,je=Math.PI/180,Me=180/Math.PI;function Ee(e){return e%=360,e<0&&(e+=360),e}function _e([e,t,r,n]){let o,i;e=Ce(e),t=Ce(t),r=Ce(r);const a=qe((.2225045*e+.7168786*t+.0606169*r)/we);e===t&&t===r?o=i=a:(o=qe((.4360747*e+.3850649*t+.1430804*r)/xe),i=qe((.0139322*e+.0971045*t+.7141733*r)/ke));const s=116*a-16;return[s<0?0:s,500*(o-a),200*(a-i),n]}function Ce(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function qe(e){return e>Ae?Math.pow(e,1/3):e/ze+Se}function Te([e,t,r,n]){let o=(e+16)/116,i=isNaN(t)?o:o+t/500,a=isNaN(r)?o:o-r/200;return o=we*Pe(o),i=xe*Pe(i),a=ke*Pe(a),[Fe(3.1338561*i-1.6168667*o-.4906146*a),Fe(-.9787684*i+1.9161415*o+.033454*a),Fe(.0719453*i-.2289914*o+1.4052427*a),n]}function Fe(e){return e=e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055,e<0?0:e>1?1:e}function Pe(e){return e>$e?e*e*e:ze*(e-Se)}function Oe(e){const[t,r,n,o]=_e(e),i=Math.sqrt(r*r+n*n),a=Math.round(1e4*i)?Ee(Math.atan2(n,r)*Me):NaN;return[a,i,t,o]}function Ie([e,t,r,n]){return e=isNaN(e)?0:e*je,Te([r,Math.cos(e)*t,Math.sin(e)*t,n])}function Ne([e,t,r,n]){function o(n){const o=(n+e/30)%12,i=t*Math.min(r,1-r);return r-i*Math.max(-1,Math.min(o-3,9-o,1))}return e=Ee(e),t/=100,r/=100,[o(0),o(8),o(4),n]}const Re=Object.hasOwn||function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};function Le(e,t){return Re(e,t)?e[t]:void 0}function De(e){if(e=e.toLowerCase().trim(),"transparent"===e)return[0,0,0,0];const t=Le(We,e);if(t){const[e,r,n]=t;return[e/255,r/255,n/255,1]}if(e.startsWith("#")){const t=/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/;if(t.test(e)){const t=e.length<6?1:2;let r=1;return[Ue(e.slice(r,r+=t)),Ue(e.slice(r,r+=t)),Ue(e.slice(r,r+=t)),Ue(e.slice(r,r+t)||"ff")]}}if(e.startsWith("rgb")){const t=/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,r=e.match(t);if(r){const[e,t,n,o,i,a,s,l,u,c,p,f]=r,d=[o||" ",s||" ",c].join("");if("  "===d||"  /"===d||",,"===d||",,,"===d){const e=[n,a,u].join(""),r="%%%"===e?100:""===e?255:0;if(r){const e=[Je(+t/r,0,1),Je(+i/r,0,1),Je(+l/r,0,1),p?Ge(+p,f):1];if(Ve(e))return e}}return}}const r=/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,n=e.match(r);if(n){const[e,t,r,o,i,a,s,l,u]=n,c=[r||" ",i||" ",s].join("");if("  "===c||"  /"===c||",,"===c||",,,"===c){const e=[+t,Je(+o,0,100),Je(+a,0,100),l?Ge(+l,u):1];if(Ve(e))return Ne(e)}}}function Ue(e){return parseInt(e.padEnd(2,e),16)/255}function Ge(e,t){return Je(t?e/100:e,0,1)}function Je(e,t,r){return Math.min(Math.max(t,e),r)}function Ve(e){return!e.some(Number.isNaN)}const We={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Ke(e,t,r){return e+r*(t-e)}function Ze(e,t,r){return e.map((e,n)=>Ke(e,t[n],r))}class Xe{constructor(e,t,r,n=1,o=!0){this.r=e,this.g=t,this.b=r,this.a=n,o||(this.r*=n,this.g*=n,this.b*=n,n||this.overwriteGetter("rgb",[e,t,r,n]))}static parse(e){if(e instanceof Xe)return e;if("string"!==typeof e)return;const t=De(e);return t?new Xe(...t,!1):void 0}get rgb(){const{r:e,g:t,b:r,a:n}=this,o=n||1/0;return this.overwriteGetter("rgb",[e/o,t/o,r/o,n])}get hcl(){return this.overwriteGetter("hcl",Oe(this.rgb))}get lab(){return this.overwriteGetter("lab",_e(this.rgb))}overwriteGetter(e,t){return Object.defineProperty(this,e,{value:t}),t}toString(){const[e,t,r,n]=this.rgb;return`rgba(${[e,t,r].map(e=>Math.round(255*e)).join(",")},${n})`}static interpolate(e,t,r,n="rgb"){switch(n){case"rgb":{const[n,o,i,a]=Ze(e.rgb,t.rgb,r);return new Xe(n,o,i,a,!1)}case"hcl":{const[n,o,i,a]=e.hcl,[s,l,u,c]=t.hcl;let p,f;if(isNaN(n)||isNaN(s))isNaN(n)?isNaN(s)?p=NaN:(p=s,1!==i&&0!==i||(f=l)):(p=n,1!==u&&0!==u||(f=o));else{let e=s-n;s>n&&e>180?e-=360:s<n&&n-s>180&&(e+=360),p=n+r*e}const[d,y,h,m]=Ie([p,null!==f&&void 0!==f?f:Ke(o,l,r),Ke(i,u,r),Ke(a,c,r)]);return new Xe(d,y,h,m,!1)}case"lab":{const[n,o,i,a]=Te(Ze(e.lab,t.lab,r));return new Xe(n,o,i,a,!1)}}}}Xe.black=new Xe(0,0,0,1),Xe.white=new Xe(1,1,1,1),Xe.transparent=new Xe(0,0,0,0),Xe.red=new Xe(1,0,0,1);class Be{constructor(e,t,r){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const He=["bottom","center","top"];class Ye{constructor(e,t,r,n,o,i){this.text=e,this.image=t,this.scale=r,this.fontStack=n,this.textColor=o,this.verticalAlign=i}}class Qe{constructor(e){this.sections=e}static fromString(e){return new Qe([new Ye(e,null,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(e=>0!==e.text.length||e.image&&0!==e.image.name.length)}static factory(e){return e instanceof Qe?e:Qe.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map(e=>e.text).join("")}}class et{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof et)return e;if("number"===typeof e)return new et([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const t of e)if("number"!==typeof t)return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]];break}return new et(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r){return new et(Ze(e.values,t.values,r))}}class tt{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof tt)return e;if("number"===typeof e)return new tt([e]);if(Array.isArray(e)){for(const t of e)if("number"!==typeof t)return;return new tt(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r){return new tt(Ze(e.values,t.values,r))}}class rt{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof rt)return e;if("string"===typeof e){const t=Xe.parse(e);if(!t)return;return new rt([t])}if(!Array.isArray(e))return;const t=[];for(const r of e){if("string"!==typeof r)return;const e=Xe.parse(r);if(!e)return;t.push(e)}return new rt(t)}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r,n="rgb"){const o=[];if(e.values.length!=t.values.length)throw new Error(`colorArray: Arrays have mismatched length (${e.values.length} vs. ${t.values.length}), cannot interpolate.`);for(let i=0;i<e.values.length;i++)o.push(Xe.interpolate(e.values[i],t.values[i],r,n));return new rt(o)}}class nt extends Error{constructor(e){super(e),this.name="RuntimeError"}toJSON(){return this.message}}const ot=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class it{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof it)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2===0){for(let t=0;t<e.length;t+=2){const r=e[t],n=e[t+1];if("string"!==typeof r||!ot.has(r))return;if(!Array.isArray(n)||2!==n.length||"number"!==typeof n[0]||"number"!==typeof n[1])return}return new it(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r){const n=e.values,o=t.values;if(n.length!==o.length)throw new nt(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${t.toString()}`);const i=[];for(let a=0;a<n.length;a+=2){if(n[a]!==o[a])throw new nt(`Cannot interpolate values containing mismatched anchors. from[${a}]: ${n[a]}, to[${a}]: ${o[a]}`);i.push(n[a]);const[e,t]=n[a+1],[s,l]=o[a+1];i.push([Ke(e,s,r),Ke(t,l,r)])}return new it(i)}}class at{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new at({name:e,available:!1}):null}}class st{constructor(e,t,r){this.from=e,this.to=t,this.transition=r}static interpolate(e,t,r){return new st(e,t,r)}static parse(e){return e instanceof st?e:Array.isArray(e)&&3===e.length&&"string"===typeof e[0]&&"string"===typeof e[1]&&"number"===typeof e[2]?new st(e[0],e[1],e[2]):"object"===typeof e&&"string"===typeof e.from&&"string"===typeof e.to&&"number"===typeof e.transition?new st(e.from,e.to,e.transition):"string"===typeof e?new st(e,e,1):void 0}}function lt(e,t,r,n){if(!("number"===typeof e&&e>=0&&e<=255&&"number"===typeof t&&t>=0&&t<=255&&"number"===typeof r&&r>=0&&r<=255)){const o="number"===typeof n?[e,t,r,n]:[e,t,r];return`Invalid rgba value [${o.join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}return"undefined"===typeof n||"number"===typeof n&&n>=0&&n<=1?null:`Invalid rgba value [${[e,t,r,n].join(", ")}]: 'a' must be between 0 and 1.`}function ut(e){if(null===e||"string"===typeof e||"boolean"===typeof e||"number"===typeof e||e instanceof st||e instanceof Xe||e instanceof Be||e instanceof Qe||e instanceof et||e instanceof tt||e instanceof rt||e instanceof it||e instanceof at)return!0;if(Array.isArray(e)){for(const t of e)if(!ut(t))return!1;return!0}if("object"===typeof e){for(const t in e)if(!ut(e[t]))return!1;return!0}return!1}function ct(e){if(null===e)return H;if("string"===typeof e)return Q;if("boolean"===typeof e)return ee;if("number"===typeof e)return Y;if(e instanceof Xe)return te;if(e instanceof st)return re;if(e instanceof Be)return ae;if(e instanceof Qe)return se;if(e instanceof et)return le;if(e instanceof tt)return ce;if(e instanceof rt)return ue;if(e instanceof it)return fe;if(e instanceof at)return pe;if(Array.isArray(e)){const t=e.length;let r;for(const n of e){const e=ct(n);if(r){if(r===e)continue;r=oe;break}r=e}return de(r||oe,t)}return ne}function pt(e){const t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof Xe||e instanceof st||e instanceof Qe||e instanceof et||e instanceof tt||e instanceof rt||e instanceof it||e instanceof at?e.toString():JSON.stringify(e)}class ft{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(2!==e.length)return t.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!ut(e[1]))return t.error("invalid value");const r=e[1];let n=ct(r);const o=t.expectedType;return"array"!==n.kind||0!==n.N||!o||"array"!==o.kind||"number"===typeof o.N&&0!==o.N||(n=o),new ft(n,r)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const dt={string:Q,number:Y,boolean:ee,object:ne};class yt{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r,n=1;const o=e[0];if("array"===o){let o,i;if(e.length>2){const r=e[1];if("string"!==typeof r||!(r in dt)||"object"===r)return t.error('The item type argument of "array" must be one of string, number, boolean',1);o=dt[r],n++}else o=oe;if(e.length>3){if(null!==e[2]&&("number"!==typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);i=e[2],n++}r=de(o,i)}else{if(!dt[o])throw new Error(`Types doesn't contain name = ${o}`);r=dt[o]}const i=[];for(;n<e.length;n++){const r=t.parse(e[n],n,oe);if(!r)return null;i.push(r)}return new yt(r,i)}evaluate(e){for(let t=0;t<this.args.length;t++){const r=this.args[t].evaluate(e),n=me(this.type,ct(r));if(!n)return r;if(t===this.args.length-1)throw new nt(`Expected value to be of type ${ye(this.type)}, but found ${ye(ct(r))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const ht={"to-boolean":ee,"to-color":te,"to-number":Y,"to-string":Q};class mt{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const r=e[0];if(!ht[r])throw new Error(`Can't parse ${r} as it is not part of the known types`);if(("to-boolean"===r||"to-string"===r)&&2!==e.length)return t.error("Expected one argument.");const n=ht[r],o=[];for(let i=1;i<e.length;i++){const r=t.parse(e[i],i,oe);if(!r)return null;o.push(r)}return new mt(n,o)}evaluate(e){switch(this.type.kind){case"boolean":return Boolean(this.args[0].evaluate(e));case"color":{let t,r;for(const n of this.args){if(t=n.evaluate(e),r=null,t instanceof Xe)return t;if("string"===typeof t){const r=e.parseColor(t);if(r)return r}else if(Array.isArray(t)&&(r=t.length<3||t.length>4?`Invalid rgba value ${JSON.stringify(t)}: expected an array containing either three or four numeric values.`:lt(t[0],t[1],t[2],t[3]),!r))return new Xe(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new nt(r||`Could not parse color from value '${"string"===typeof t?t:JSON.stringify(t)}'`)}case"padding":{let t;for(const r of this.args){t=r.evaluate(e);const n=et.parse(t);if(n)return n}throw new nt(`Could not parse padding from value '${"string"===typeof t?t:JSON.stringify(t)}'`)}case"numberArray":{let t;for(const r of this.args){t=r.evaluate(e);const n=tt.parse(t);if(n)return n}throw new nt(`Could not parse numberArray from value '${"string"===typeof t?t:JSON.stringify(t)}'`)}case"colorArray":{let t;for(const r of this.args){t=r.evaluate(e);const n=rt.parse(t);if(n)return n}throw new nt(`Could not parse colorArray from value '${"string"===typeof t?t:JSON.stringify(t)}'`)}case"variableAnchorOffsetCollection":{let t;for(const r of this.args){t=r.evaluate(e);const n=it.parse(t);if(n)return n}throw new nt(`Could not parse variableAnchorOffsetCollection from value '${"string"===typeof t?t:JSON.stringify(t)}'`)}case"number":{let t=null;for(const r of this.args){if(t=r.evaluate(e),null===t)return 0;const n=Number(t);if(!isNaN(n))return n}throw new nt(`Could not convert ${JSON.stringify(t)} to number.`)}case"formatted":return Qe.fromString(pt(this.args[0].evaluate(e)));case"resolvedImage":return at.fromString(pt(this.args[0].evaluate(e)));case"projectionDefinition":return this.args[0].evaluate(e);default:return pt(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const gt=["Unknown","Point","LineString","Polygon"];class vt{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"===typeof this.feature.type?gt[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let t=this._parseColorCache.get(e);return t||(t=Xe.parse(e),this._parseColorCache.set(e,t)),t}}class bt{constructor(e,t,r=[],n,o=new B,i=[]){this.registry=e,this.path=r,this.key=r.map(e=>`[${e}]`).join(""),this.scope=o,this.errors=i,this.expectedType=n,this._isConstant=t}parse(e,t,r,n,o={}){return t?this.concat(t,r,n)._parse(e,o):this._parse(e,o)}_parse(e,t){function r(e,t,r){return"assert"===r?new yt(t,[e]):"coerce"===r?new mt(t,[e]):e}if(null!==e&&"string"!==typeof e&&"boolean"!==typeof e&&"number"!==typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const o=e[0];if("string"!==typeof o)return this.error(`Expression name must be a string, but found ${typeof o} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const i=this.registry[o];if(i){let o=i.parse(e,this);if(!o)return null;if(this.expectedType){const e=this.expectedType,n=o.type;if("string"!==e.kind&&"number"!==e.kind&&"boolean"!==e.kind&&"object"!==e.kind&&"array"!==e.kind||"value"!==n.kind){if("projectionDefinition"===e.kind&&["string","array"].includes(n.kind)||["color","formatted","resolvedImage"].includes(e.kind)&&["value","string"].includes(n.kind)||["padding","numberArray"].includes(e.kind)&&["value","number","array"].includes(n.kind)||"colorArray"===e.kind&&["value","string","array"].includes(n.kind)||"variableAnchorOffsetCollection"===e.kind&&["value","array"].includes(n.kind))o=r(o,e,t.typeAnnotation||"coerce");else if(this.checkSubtype(e,n))return null}else o=r(o,e,t.typeAnnotation||"assert")}if(!(o instanceof ft)&&"resolvedImage"!==o.type.kind&&this._isConstant(o)){const e=new vt;try{o=new ft(o.type,o.evaluate(e))}catch(n){return this.error(n.message),null}}return o}return this.error(`Unknown expression "${o}". If you wanted a literal array, use ["literal", [...]].`,0)}return"undefined"===typeof e?this.error("'undefined' value invalid. Use null instead."):"object"===typeof e?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof e} instead.`)}concat(e,t,r){const n="number"===typeof e?this.path.concat(e):this.path,o=r?this.scope.concat(r):this.scope;return new bt(this.registry,this._isConstant,n,t||null,o,this.errors)}error(e,...t){const r=`${this.key}${t.map(e=>`[${e}]`).join("")}`;this.errors.push(new X(r,e))}checkSubtype(e,t){const r=me(e,t);return r&&this.error(r),r}}class xt{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const r=[];for(let o=1;o<e.length-1;o+=2){const n=e[o];if("string"!==typeof n)return t.error(`Expected string, but found ${typeof n} instead.`,o);if(/[^a-zA-Z0-9_]/.test(n))return t.error("Variable names must contain only alphanumeric characters or '_'.",o);const i=t.parse(e[o+1],o+1);if(!i)return null;r.push([n,i])}const n=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return n?new xt(r,n):null}outputDefined(){return this.result.outputDefined()}}class wt{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){if(2!==e.length||"string"!==typeof e[1])return t.error("'var' expression requires exactly one string literal argument.");const r=e[1];return t.scope.has(r)?new wt(r,t.scope.get(r)):t.error(`Unknown variable "${r}". Make sure "${r}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class kt{constructor(e,t,r){this.type=e,this.index=t,this.input=r}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,Y),n=t.parse(e[2],2,de(t.expectedType||oe));if(!r||!n)return null;const o=n.type;return new kt(o.itemType,r,n)}evaluate(e){const t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new nt(`Array index out of bounds: ${t} < 0.`);if(t>=r.length)throw new nt(`Array index out of bounds: ${t} > ${r.length-1}.`);if(t!==Math.floor(t))throw new nt(`Array index must be an integer, but found ${t} instead.`);return r[t]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class St{constructor(e,t){this.type=ee,this.needle=e,this.haystack=t}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,oe),n=t.parse(e[2],2,oe);return r&&n?ge(r.type,[ee,Q,Y,H,oe])?new St(r,n):t.error(`Expected first argument to be of type boolean, string, number or null, but found ${ye(r.type)} instead`):null}evaluate(e){const t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!ve(t,["boolean","string","number","null"]))throw new nt(`Expected first argument to be of type boolean, string, number or null, but found ${ye(ct(t))} instead.`);if(!ve(r,["string","array"]))throw new nt(`Expected second argument to be of type array or string, but found ${ye(ct(r))} instead.`);return r.indexOf(t)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class $t{constructor(e,t,r){this.type=Y,this.needle=e,this.haystack=t,this.fromIndex=r}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,oe),n=t.parse(e[2],2,oe);if(!r||!n)return null;if(!ge(r.type,[ee,Q,Y,H,oe]))return t.error(`Expected first argument to be of type boolean, string, number or null, but found ${ye(r.type)} instead`);if(4===e.length){const o=t.parse(e[3],3,Y);return o?new $t(r,n,o):null}return new $t(r,n)}evaluate(e){const t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!ve(t,["boolean","string","number","null"]))throw new nt(`Expected first argument to be of type boolean, string, number or null, but found ${ye(ct(t))} instead.`);let n;if(this.fromIndex&&(n=this.fromIndex.evaluate(e)),ve(r,["string"])){const e=r.indexOf(t,n);return-1===e?-1:[...r.slice(0,e)].length}if(ve(r,["array"]))return r.indexOf(t,n);throw new nt(`Expected second argument to be of type array or string, but found ${ye(ct(r))} instead.`)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class zt{constructor(e,t,r,n,o,i){this.inputType=e,this.type=t,this.input=r,this.cases=n,this.outputs=o,this.otherwise=i}static parse(e,t){if(e.length<5)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!==1)return t.error("Expected an even number of arguments.");let r,n;t.expectedType&&"value"!==t.expectedType.kind&&(n=t.expectedType);const o={},i=[];for(let l=2;l<e.length-1;l+=2){let a=e[l];const s=e[l+1];Array.isArray(a)||(a=[a]);const u=t.concat(l);if(0===a.length)return u.error("Expected at least one branch label.");for(const e of a){if("number"!==typeof e&&"string"!==typeof e)return u.error("Branch labels must be numbers or strings.");if("number"===typeof e&&Math.abs(e)>Number.MAX_SAFE_INTEGER)return u.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"===typeof e&&Math.floor(e)!==e)return u.error("Numeric branch labels must be integer values.");if(r){if(u.checkSubtype(r,ct(e)))return null}else r=ct(e);if("undefined"!==typeof o[String(e)])return u.error("Branch labels must be unique.");o[String(e)]=i.length}const c=t.parse(s,l,n);if(!c)return null;n=n||c.type,i.push(c)}const a=t.parse(e[1],1,oe);if(!a)return null;const s=t.parse(e[e.length-1],e.length-1,n);return s?"value"!==a.type.kind&&t.concat(1).checkSubtype(r,a.type)?null:new zt(r,n,a,o,i,s):null}evaluate(e){const t=this.input.evaluate(e),r=ct(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise;return r.evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class At{constructor(e,t,r){this.type=e,this.branches=t,this.otherwise=r}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!==0)return t.error("Expected an odd number of arguments.");let r;t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);const n=[];for(let i=1;i<e.length-1;i+=2){const o=t.parse(e[i],i,ee);if(!o)return null;const a=t.parse(e[i+1],i+1,r);if(!a)return null;n.push([o,a]),r=r||a.type}const o=t.parse(e[e.length-1],e.length-1,r);if(!o)return null;if(!r)throw new Error("Can't infer output type");return new At(r,n,o)}evaluate(e){for(const[t,r]of this.branches)if(t.evaluate(e))return r.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[t,r]of this.branches)e(t),e(r);e(this.otherwise)}outputDefined(){return this.branches.every(([e,t])=>t.outputDefined())&&this.otherwise.outputDefined()}}class jt{constructor(e,t,r,n){this.type=e,this.input=t,this.beginIndex=r,this.endIndex=n}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,oe),n=t.parse(e[2],2,Y);if(!r||!n)return null;if(!ge(r.type,[de(oe),Q,oe]))return t.error(`Expected first argument to be of type array or string, but found ${ye(r.type)} instead`);if(4===e.length){const o=t.parse(e[3],3,Y);return o?new jt(r.type,r,n,o):null}return new jt(r.type,r,n)}evaluate(e){const t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);let n;if(this.endIndex&&(n=this.endIndex.evaluate(e)),ve(t,["string"]))return[...t].slice(r,n).join("");if(ve(t,["array"]))return t.slice(r,n);throw new nt(`Expected first argument to be of type array or string, but found ${ye(ct(t))} instead.`)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function Mt(e,t){const r=e.length-1;let n,o,i=0,a=r,s=0;while(i<=a)if(s=Math.floor((i+a)/2),n=e[s],o=e[s+1],n<=t){if(s===r||t<o)return s;i=s+1}else{if(!(n>t))throw new nt("Input is not a number.");a=s-1}return 0}class Et{constructor(e,t,r){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(const[n,o]of r)this.labels.push(n),this.outputs.push(o)}static parse(e,t){if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!==0)return t.error("Expected an even number of arguments.");const r=t.parse(e[1],1,Y);if(!r)return null;const n=[];let o=null;t.expectedType&&"value"!==t.expectedType.kind&&(o=t.expectedType);for(let i=1;i<e.length;i+=2){const r=1===i?-1/0:e[i],a=e[i+1],s=i,l=i+1;if("number"!==typeof r)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',s);if(n.length&&n[n.length-1][0]>=r)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',s);const u=t.parse(a,l,o);if(!u)return null;o=o||u.type,n.push([r,u])}return new Et(o,r,n)}evaluate(e){const t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);const n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);const o=t.length;if(n>=t[o-1])return r[o-1].evaluate(e);const i=Mt(t,n);return r[i].evaluate(e)}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function _t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}var Ct,qt;function Tt(){if(qt)return Ct;function e(e,t,r,n){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=r,this.p2y=n}return qt=1,Ct=e,e.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var r=e,n=0;n<8;n++){var o=this.sampleCurveX(r)-e;if(Math.abs(o)<t)return r;var i=this.sampleCurveDerivativeX(r);if(Math.abs(i)<1e-6)break;r-=o/i}var a=0,s=1;for(r=e,n=0;n<20;n++){if(o=this.sampleCurveX(r),Math.abs(o-e)<t)break;e>o?a=r:s=r,r=.5*(s-a)+a}return r},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}},Ct}var Ft=Tt(),Pt=_t(Ft);class Ot{constructor(e,t,r,n,o){this.type=e,this.operator=t,this.interpolation=r,this.input=n,this.labels=[],this.outputs=[];for(const[i,a]of o)this.labels.push(i),this.outputs.push(a)}static interpolationFactor(e,t,r,n){let o=0;if("exponential"===e.name)o=It(t,e.base,r,n);else if("linear"===e.name)o=It(t,1,r,n);else if("cubic-bezier"===e.name){const i=e.controlPoints,a=new Pt(i[0],i[1],i[2],i[3]);o=a.solve(It(t,1,r,n))}return o}static parse(e,t){let[r,n,o,...i]=e;if(!Array.isArray(n)||0===n.length)return t.error("Expected an interpolation type expression.",1);if("linear"===n[0])n={name:"linear"};else if("exponential"===n[0]){const e=n[1];if("number"!==typeof e)return t.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:e}}else{if("cubic-bezier"!==n[0])return t.error(`Unknown interpolation type ${String(n[0])}`,1,0);{const e=n.slice(1);if(4!==e.length||e.some(e=>"number"!==typeof e||e<0||e>1))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:e}}}if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!==0)return t.error("Expected an even number of arguments.");if(o=t.parse(o,2,Y),!o)return null;const a=[];let s=null;"interpolate-hcl"!==r&&"interpolate-lab"!==r||t.expectedType==ue?t.expectedType&&"value"!==t.expectedType.kind&&(s=t.expectedType):s=te;for(let l=0;l<i.length;l+=2){const e=i[l],r=i[l+1],n=l+3,o=l+4;if("number"!==typeof e)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',n);if(a.length&&a[a.length-1][0]>=e)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',n);const u=t.parse(r,o,s);if(!u)return null;s=s||u.type,a.push([e,u])}return be(s,Y)||be(s,re)||be(s,te)||be(s,le)||be(s,ce)||be(s,ue)||be(s,fe)||be(s,de(Y))?new Ot(s,r,n,o,a):t.error(`Type ${ye(s)} is not interpolatable.`)}evaluate(e){const t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);const n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);const o=t.length;if(n>=t[o-1])return r[o-1].evaluate(e);const i=Mt(t,n),a=t[i],s=t[i+1],l=Ot.interpolationFactor(this.interpolation,n,a,s),u=r[i].evaluate(e),c=r[i+1].evaluate(e);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Ke(u,c,l);case"color":return Xe.interpolate(u,c,l);case"padding":return et.interpolate(u,c,l);case"colorArray":return rt.interpolate(u,c,l);case"numberArray":return tt.interpolate(u,c,l);case"variableAnchorOffsetCollection":return it.interpolate(u,c,l);case"array":return Ze(u,c,l);case"projectionDefinition":return st.interpolate(u,c,l)}case"interpolate-hcl":switch(this.type.kind){case"color":return Xe.interpolate(u,c,l,"hcl");case"colorArray":return rt.interpolate(u,c,l,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Xe.interpolate(u,c,l,"lab");case"colorArray":return rt.interpolate(u,c,l,"lab")}}}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function It(e,t,r,n){const o=n-r,i=e-r;return 0===o?0:1===t?i/o:(Math.pow(t,i)-1)/(Math.pow(t,o)-1)}Xe.interpolate,et.interpolate,tt.interpolate,rt.interpolate,it.interpolate;class Nt{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r=null;const n=t.expectedType;n&&"value"!==n.kind&&(r=n);const o=[];for(const a of e.slice(1)){const e=t.parse(a,1+o.length,r,void 0,{typeAnnotation:"omit"});if(!e)return null;r=r||e.type,o.push(e)}if(!r)throw new Error("No output type");const i=n&&o.some(e=>me(n,e.type));return new Nt(i?oe:r,o)}evaluate(e){let t,r=null,n=0;for(const o of this.args)if(n++,r=o.evaluate(e),r&&r instanceof at&&!r.available&&(t||(t=r.name),r=null,n===this.args.length&&(r=t)),null!==r)break;return r}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}function Rt(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function Lt(e,t,r){return t===r}function Dt(e,t,r){return t!==r}function Ut(e,t,r){return t<r}function Gt(e,t,r){return t>r}function Jt(e,t,r){return t<=r}function Vt(e,t,r){return t>=r}function Wt(e,t,r,n){return 0===n.compare(t,r)}function Kt(e,t,r,n){return!Wt(e,t,r,n)}function Zt(e,t,r,n){return n.compare(t,r)<0}function Xt(e,t,r,n){return n.compare(t,r)>0}function Bt(e,t,r,n){return n.compare(t,r)<=0}function Ht(e,t,r,n){return n.compare(t,r)>=0}function Yt(e,t,r){const n="=="!==e&&"!="!==e;return class o{constructor(e,t,r){this.type=ee,this.lhs=e,this.rhs=t,this.collator=r,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}static parse(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");const r=e[0];let i=t.parse(e[1],1,oe);if(!i)return null;if(!Rt(r,i.type))return t.concat(1).error(`"${r}" comparisons are not supported for type '${ye(i.type)}'.`);let a=t.parse(e[2],2,oe);if(!a)return null;if(!Rt(r,a.type))return t.concat(2).error(`"${r}" comparisons are not supported for type '${ye(a.type)}'.`);if(i.type.kind!==a.type.kind&&"value"!==i.type.kind&&"value"!==a.type.kind)return t.error(`Cannot compare types '${ye(i.type)}' and '${ye(a.type)}'.`);n&&("value"===i.type.kind&&"value"!==a.type.kind?i=new yt(a.type,[i]):"value"!==i.type.kind&&"value"===a.type.kind&&(a=new yt(i.type,[a])));let s=null;if(4===e.length){if("string"!==i.type.kind&&"string"!==a.type.kind&&"value"!==i.type.kind&&"value"!==a.type.kind)return t.error("Cannot use collator to compare non-string types.");if(s=t.parse(e[3],3,ae),!s)return null}return new o(i,a,s)}evaluate(o){const i=this.lhs.evaluate(o),a=this.rhs.evaluate(o);if(n&&this.hasUntypedArgument){const t=ct(i),r=ct(a);if(t.kind!==r.kind||"string"!==t.kind&&"number"!==t.kind)throw new nt(`Expected arguments for "${e}" to be (string, string) or (number, number), but found (${t.kind}, ${r.kind}) instead.`)}if(this.collator&&!n&&this.hasUntypedArgument){const e=ct(i),r=ct(a);if("string"!==e.kind||"string"!==r.kind)return t(o,i,a)}return this.collator?r(o,i,a,this.collator.evaluate(o)):t(o,i,a)}eachChild(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)}outputDefined(){return!0}}}const Qt=Yt("==",Lt,Wt),er=Yt("!=",Dt,Kt),tr=Yt("<",Ut,Zt),rr=Yt(">",Gt,Xt),nr=Yt("<=",Jt,Bt),or=Yt(">=",Vt,Ht);class ir{constructor(e,t,r){this.type=ae,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(2!==e.length)return t.error("Expected one argument.");const r=e[1];if("object"!==typeof r||Array.isArray(r))return t.error("Collator options argument must be an object.");const n=t.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,ee);if(!n)return null;const o=t.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,ee);if(!o)return null;let i=null;return r["locale"]&&(i=t.parse(r["locale"],1,Q),!i)?null:new ir(n,o,i)}evaluate(e){return new Be(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}class ar{constructor(e,t,r,n,o){this.type=Q,this.number=e,this.locale=t,this.currency=r,this.minFractionDigits=n,this.maxFractionDigits=o}static parse(e,t){if(3!==e.length)return t.error("Expected two arguments.");const r=t.parse(e[1],1,Y);if(!r)return null;const n=e[2];if("object"!==typeof n||Array.isArray(n))return t.error("NumberFormat options argument must be an object.");let o=null;if(n["locale"]&&(o=t.parse(n["locale"],1,Q),!o))return null;let i=null;if(n["currency"]&&(i=t.parse(n["currency"],1,Q),!i))return null;let a=null;if(n["min-fraction-digits"]&&(a=t.parse(n["min-fraction-digits"],1,Y),!a))return null;let s=null;return n["max-fraction-digits"]&&(s=t.parse(n["max-fraction-digits"],1,Y),!s)?null:new ar(r,o,i,a,s)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class sr{constructor(e){this.type=se,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const r=e[1];if(!Array.isArray(r)&&"object"===typeof r)return t.error("First argument must be an image or text section.");const n=[];let o=!1;for(let i=1;i<=e.length-1;++i){const r=e[i];if(o&&"object"===typeof r&&!Array.isArray(r)){o=!1;let e=null;if(r["font-scale"]&&(e=t.parse(r["font-scale"],1,Y),!e))return null;let i=null;if(r["text-font"]&&(i=t.parse(r["text-font"],1,de(Q)),!i))return null;let a=null;if(r["text-color"]&&(a=t.parse(r["text-color"],1,te),!a))return null;let s=null;if(r["vertical-align"]){if("string"===typeof r["vertical-align"]&&!He.includes(r["vertical-align"]))return t.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${r["vertical-align"]}' instead.`);if(s=t.parse(r["vertical-align"],1,Q),!s)return null}const l=n[n.length-1];l.scale=e,l.font=i,l.textColor=a,l.verticalAlign=s}else{const r=t.parse(e[i],1,oe);if(!r)return null;const a=r.type.kind;if("string"!==a&&"value"!==a&&"null"!==a&&"resolvedImage"!==a)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");o=!0,n.push({content:r,scale:null,font:null,textColor:null,verticalAlign:null})}}return new sr(n)}evaluate(e){const t=t=>{const r=t.content.evaluate(e);return ct(r)===pe?new Ye("",r,null,null,null,t.verticalAlign?t.verticalAlign.evaluate(e):null):new Ye(pt(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null,t.verticalAlign?t.verticalAlign.evaluate(e):null)};return new Qe(this.sections.map(t))}eachChild(e){for(const t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor),t.verticalAlign&&e(t.verticalAlign)}outputDefined(){return!1}}class lr{constructor(e){this.type=pe,this.input=e}static parse(e,t){if(2!==e.length)return t.error("Expected two arguments.");const r=t.parse(e[1],1,Q);return r?new lr(r):t.error("No image name provided.")}evaluate(e){const t=this.input.evaluate(e),r=at.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r}eachChild(e){e(this.input)}outputDefined(){return!1}}class ur{constructor(e){this.type=Y,this.input=e}static parse(e,t){if(2!==e.length)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);const r=t.parse(e[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?t.error(`Expected argument of type string or array, but found ${ye(r.type)} instead.`):new ur(r):null}evaluate(e){const t=this.input.evaluate(e);if("string"===typeof t)return[...t].length;if(Array.isArray(t))return t.length;throw new nt(`Expected value to be of type string or array, but found ${ye(ct(t))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const cr=8192;function pr(e,t){const r=dr(e[0]),n=hr(e[1]),o=Math.pow(2,t.z);return[Math.round(r*o*cr),Math.round(n*o*cr)]}function fr(e,t){const r=Math.pow(2,t.z),n=(e[0]/cr+t.x)/r,o=(e[1]/cr+t.y)/r;return[yr(n),mr(o)]}function dr(e){return(180+e)/360}function yr(e){return 360*e-180}function hr(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function mr(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}function gr(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function vr(e,t){return!(e[0]<=t[0])&&(!(e[2]>=t[2])&&(!(e[1]<=t[1])&&!(e[3]>=t[3])))}function br(e,t,r){return t[1]>e[1]!==r[1]>e[1]&&e[0]<(r[0]-t[0])*(e[1]-t[1])/(r[1]-t[1])+t[0]}function xr(e,t,r){const n=e[0]-t[0],o=e[1]-t[1],i=e[0]-r[0],a=e[1]-r[1];return n*a-i*o===0&&n*i<=0&&o*a<=0}function wr(e,t,r,n){const o=[t[0]-e[0],t[1]-e[1]],i=[n[0]-r[0],n[1]-r[1]];return 0!==jr(i,o)&&!(!Mr(e,t,r,n)||!Mr(r,n,e,t))}function kr(e,t,r){for(const n of r)for(let r=0;r<n.length-1;++r)if(wr(e,t,n[r],n[r+1]))return!0;return!1}function Sr(e,t,r=!1){let n=!1;for(const o of t)for(let t=0;t<o.length-1;t++){if(xr(e,o[t],o[t+1]))return r;br(e,o[t],o[t+1])&&(n=!n)}return n}function $r(e,t){for(const r of t)if(Sr(e,r))return!0;return!1}function zr(e,t){for(const r of e)if(!Sr(r,t))return!1;for(let r=0;r<e.length-1;++r)if(kr(e[r],e[r+1],t))return!1;return!0}function Ar(e,t){for(const r of t)if(zr(e,r))return!0;return!1}function jr(e,t){return e[0]*t[1]-e[1]*t[0]}function Mr(e,t,r,n){const o=e[0]-r[0],i=e[1]-r[1],a=t[0]-r[0],s=t[1]-r[1],l=n[0]-r[0],u=n[1]-r[1],c=o*u-l*i,p=a*u-l*s;return c>0&&p<0||c<0&&p>0}function Er(e,t,r){const n=[];for(let o=0;o<e.length;o++){const i=[];for(let n=0;n<e[o].length;n++){const a=pr(e[o][n],r);gr(t,a),i.push(a)}n.push(i)}return n}function _r(e,t,r){const n=[];for(let o=0;o<e.length;o++){const i=Er(e[o],t,r);n.push(i)}return n}function Cr(e,t,r,n){if(e[0]<r[0]||e[0]>r[2]){const t=.5*n;let o=e[0]-r[0]>t?-n:r[0]-e[0]>t?n:0;0===o&&(o=e[0]-r[2]>t?-n:r[2]-e[0]>t?n:0),e[0]+=o}gr(t,e)}function qr(e){e[0]=e[1]=1/0,e[2]=e[3]=-1/0}function Tr(e,t,r,n){const o=Math.pow(2,n.z)*cr,i=[n.x*cr,n.y*cr],a=[];for(const s of e)for(const e of s){const n=[e.x+i[0],e.y+i[1]];Cr(n,t,r,o),a.push(n)}return a}function Fr(e,t,r,n){const o=Math.pow(2,n.z)*cr,i=[n.x*cr,n.y*cr],a=[];for(const s of e){const e=[];for(const r of s){const n=[r.x+i[0],r.y+i[1]];gr(t,n),e.push(n)}a.push(e)}if(t[2]-t[0]<=o/2){qr(t);for(const e of a)for(const n of e)Cr(n,t,r,o)}return a}function Pr(e,t){const r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],o=e.canonicalID();if("Polygon"===t.type){const i=Er(t.coordinates,n,o),a=Tr(e.geometry(),r,n,o);if(!vr(r,n))return!1;for(const e of a)if(!Sr(e,i))return!1}if("MultiPolygon"===t.type){const i=_r(t.coordinates,n,o),a=Tr(e.geometry(),r,n,o);if(!vr(r,n))return!1;for(const e of a)if(!$r(e,i))return!1}return!0}function Or(e,t){const r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],o=e.canonicalID();if("Polygon"===t.type){const i=Er(t.coordinates,n,o),a=Fr(e.geometry(),r,n,o);if(!vr(r,n))return!1;for(const e of a)if(!zr(e,i))return!1}if("MultiPolygon"===t.type){const i=_r(t.coordinates,n,o),a=Fr(e.geometry(),r,n,o);if(!vr(r,n))return!1;for(const e of a)if(!Ar(e,i))return!1}return!0}class Ir{constructor(e,t){this.type=ee,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(ut(e[1])){const t=e[1];if("FeatureCollection"===t.type){const e=[];for(const r of t.features){const{type:t,coordinates:n}=r.geometry;"Polygon"===t&&e.push(n),"MultiPolygon"===t&&e.push(...n)}if(e.length){const r={type:"MultiPolygon",coordinates:e};return new Ir(t,r)}}else if("Feature"===t.type){const e=t.geometry.type;if("Polygon"===e||"MultiPolygon"===e)return new Ir(t,t.geometry)}else if("Polygon"===t.type||"MultiPolygon"===t.type)return new Ir(t,t)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return Pr(e,this.geometries);if("LineString"===e.geometryType())return Or(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class Nr{constructor(e=[],t=(e,t)=>e<t?-1:e>t?1:0){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(0===this.length)return;const e=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:r}=this,n=t[e];while(e>0){const o=e-1>>1,i=t[o];if(r(n,i)>=0)break;t[e]=i,e=o}t[e]=n}_down(e){const{data:t,compare:r}=this,n=this.length>>1,o=t[e];while(e<n){let n=1+(e<<1);const i=n+1;if(i<this.length&&r(t[i],t[n])<0&&(n=i),r(t[n],o)>=0)break;t[e]=t[n],e=n}t[e]=o}}function Rr(e,t,r=0,n=e.length-1,o=Dr){while(n>r){if(n-r>600){const i=n-r+1,a=t-r+1,s=Math.log(i),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(i-l)/i)*(a-i/2<0?-1:1),c=Math.max(r,Math.floor(t-a*l/i+u)),p=Math.min(n,Math.floor(t+(i-a)*l/i+u));Rr(e,t,c,p,o)}const i=e[t];let a=r,s=n;Lr(e,r,t),o(e[n],i)>0&&Lr(e,r,n);while(a<s){Lr(e,a,s),a++,s--;while(o(e[a],i)<0)a++;while(o(e[s],i)>0)s--}0===o(e[r],i)?Lr(e,r,s):(s++,Lr(e,s,n)),s<=t&&(r=s+1),t<=s&&(n=s-1)}}function Lr(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function Dr(e,t){return e<t?-1:e>t?1:0}function Ur(e,t){const r=e.length;if(r<=1)return[e];const n=[];let o,i;for(const a of e){const e=Jr(a);0!==e&&(a.area=Math.abs(e),void 0===i&&(i=e<0),i===e<0?(o&&n.push(o),o=[a]):o.push(a))}if(o&&n.push(o),t>1)for(let a=0;a<n.length;a++)n[a].length<=t||(Rr(n[a],t,1,n[a].length-1,Gr),n[a]=n[a].slice(0,t));return n}function Gr(e,t){return t.area-e.area}function Jr(e){let t=0;for(let r,n,o=0,i=e.length,a=i-1;o<i;a=o++)r=e[o],n=e[a],t+=(n.x-r.x)*(r.y+n.y);return t}const Vr=6378.137,Wr=1/298.257223563,Kr=Wr*(2-Wr),Zr=Math.PI/180;class Xr{constructor(e){const t=Zr*Vr*1e3,r=Math.cos(e*Zr),n=1/(1-Kr*(1-r*r)),o=Math.sqrt(n);this.kx=t*o*r,this.ky=t*o*n*(1-Kr)}distance(e,t){const r=this.wrap(e[0]-t[0])*this.kx,n=(e[1]-t[1])*this.ky;return Math.sqrt(r*r+n*n)}pointOnLine(e,t){let r,n,o,i,a=1/0;for(let s=0;s<e.length-1;s++){let l=e[s][0],u=e[s][1],c=this.wrap(e[s+1][0]-l)*this.kx,p=(e[s+1][1]-u)*this.ky,f=0;0===c&&0===p||(f=(this.wrap(t[0]-l)*this.kx*c+(t[1]-u)*this.ky*p)/(c*c+p*p),f>1?(l=e[s+1][0],u=e[s+1][1]):f>0&&(l+=c/this.kx*f,u+=p/this.ky*f)),c=this.wrap(t[0]-l)*this.kx,p=(t[1]-u)*this.ky;const d=c*c+p*p;d<a&&(a=d,r=l,n=u,o=s,i=f)}return{point:[r,n],index:o,t:Math.max(0,Math.min(1,i))}}wrap(e){while(e<-180)e+=360;while(e>180)e-=360;return e}}const Br=100,Hr=50;function Yr(e,t){return t[0]-e[0]}function Qr(e){return e[1]-e[0]+1}function en(e,t){return e[1]>=e[0]&&e[1]<t}function tn(e,t){if(e[0]>e[1])return[null,null];const r=Qr(e);if(t){if(2===r)return[e,null];const t=Math.floor(r/2);return[[e[0],e[0]+t],[e[0]+t,e[1]]]}if(1===r)return[e,null];const n=Math.floor(r/2)-1;return[[e[0],e[0]+n],[e[0]+n+1,e[1]]]}function rn(e,t){if(!en(t,e.length))return[1/0,1/0,-1/0,-1/0];const r=[1/0,1/0,-1/0,-1/0];for(let n=t[0];n<=t[1];++n)gr(r,e[n]);return r}function nn(e){const t=[1/0,1/0,-1/0,-1/0];for(const r of e)for(const e of r)gr(t,e);return t}function on(e){return e[0]!==-1/0&&e[1]!==-1/0&&e[2]!==1/0&&e[3]!==1/0}function an(e,t,r){if(!on(e)||!on(t))return NaN;let n=0,o=0;return e[2]<t[0]&&(n=t[0]-e[2]),e[0]>t[2]&&(n=e[0]-t[2]),e[1]>t[3]&&(o=e[1]-t[3]),e[3]<t[1]&&(o=t[1]-e[3]),r.distance([0,0],[n,o])}function sn(e,t,r){const n=r.pointOnLine(t,e);return r.distance(e,n.point)}function ln(e,t,r,n,o){const i=Math.min(sn(e,[r,n],o),sn(t,[r,n],o)),a=Math.min(sn(r,[e,t],o),sn(n,[e,t],o));return Math.min(i,a)}function un(e,t,r,n,o){const i=en(t,e.length)&&en(n,r.length);if(!i)return 1/0;let a=1/0;for(let s=t[0];s<t[1];++s){const t=e[s],i=e[s+1];for(let e=n[0];e<n[1];++e){const n=r[e],s=r[e+1];if(wr(t,i,n,s))return 0;a=Math.min(a,ln(t,i,n,s,o))}}return a}function cn(e,t,r,n,o){const i=en(t,e.length)&&en(n,r.length);if(!i)return NaN;let a=1/0;for(let s=t[0];s<=t[1];++s)for(let t=n[0];t<=n[1];++t)if(a=Math.min(a,o.distance(e[s],r[t])),0===a)return a;return a}function pn(e,t,r){if(Sr(e,t,!0))return 0;let n=1/0;for(const o of t){const t=o[0],i=o[o.length-1];if(t!==i&&(n=Math.min(n,sn(e,[i,t],r)),0===n))return n;const a=r.pointOnLine(o,e);if(n=Math.min(n,r.distance(e,a.point)),0===n)return n}return n}function fn(e,t,r,n){if(!en(t,e.length))return NaN;for(let i=t[0];i<=t[1];++i)if(Sr(e[i],r,!0))return 0;let o=1/0;for(let i=t[0];i<t[1];++i){const t=e[i],a=e[i+1];for(const e of r)for(let r=0,i=e.length,s=i-1;r<i;s=r++){const i=e[s],l=e[r];if(wr(t,a,i,l))return 0;o=Math.min(o,ln(t,a,i,l,n))}}return o}function dn(e,t){for(const r of e)for(const e of r)if(Sr(e,t,!0))return!0;return!1}function yn(e,t,r,n=1/0){const o=nn(e),i=nn(t);if(n!==1/0&&an(o,i,r)>=n)return n;if(vr(o,i)){if(dn(e,t))return 0}else if(dn(t,e))return 0;let a=1/0;for(const s of e)for(let e=0,n=s.length,o=n-1;e<n;o=e++){const n=s[o],i=s[e];for(const e of t)for(let t=0,o=e.length,s=o-1;t<o;s=t++){const o=e[s],l=e[t];if(wr(n,i,o,l))return 0;a=Math.min(a,ln(n,i,o,l,r))}}return a}function hn(e,t,r,n,o,i){if(!i)return;const a=an(rn(n,i),o,r);a<t&&e.push([a,i,[0,0]])}function mn(e,t,r,n,o,i,a){if(!i||!a)return;const s=an(rn(n,i),rn(o,a),r);s<t&&e.push([s,i,a])}function gn(e,t,r,n,o=1/0){let i=Math.min(n.distance(e[0],r[0][0]),o);if(0===i)return i;const a=new Nr([[0,[0,e.length-1],[0,0]]],Yr),s=nn(r);while(a.length>0){const o=a.pop();if(o[0]>=i)continue;const l=o[1],u=t?Hr:Br;if(Qr(l)<=u){if(!en(l,e.length))return NaN;if(t){const t=fn(e,l,r,n);if(isNaN(t)||0===t)return t;i=Math.min(i,t)}else for(let t=l[0];t<=l[1];++t){const o=pn(e[t],r,n);if(i=Math.min(i,o),0===i)return 0}}else{const r=tn(l,t);hn(a,i,n,e,s,r[0]),hn(a,i,n,e,s,r[1])}}return i}function vn(e,t,r,n,o,i=1/0){let a=Math.min(i,o.distance(e[0],r[0]));if(0===a)return a;const s=new Nr([[0,[0,e.length-1],[0,r.length-1]]],Yr);while(s.length>0){const i=s.pop();if(i[0]>=a)continue;const l=i[1],u=i[2],c=t?Hr:Br,p=n?Hr:Br;if(Qr(l)<=c&&Qr(u)<=p){if(!en(l,e.length)&&en(u,r.length))return NaN;let i;if(t&&n)i=un(e,l,r,u,o),a=Math.min(a,i);else if(t&&!n){const t=e.slice(l[0],l[1]+1);for(let e=u[0];e<=u[1];++e)if(i=sn(r[e],t,o),a=Math.min(a,i),0===a)return a}else if(!t&&n){const t=r.slice(u[0],u[1]+1);for(let r=l[0];r<=l[1];++r)if(i=sn(e[r],t,o),a=Math.min(a,i),0===a)return a}else i=cn(e,l,r,u,o),a=Math.min(a,i)}else{const i=tn(l,t),c=tn(u,n);mn(s,a,o,e,r,i[0],c[0]),mn(s,a,o,e,r,i[0],c[1]),mn(s,a,o,e,r,i[1],c[0]),mn(s,a,o,e,r,i[1],c[1])}}return a}function bn(e,t){const r=e.geometry(),n=r.flat().map(t=>fr([t.x,t.y],e.canonical));if(0===r.length)return NaN;const o=new Xr(n[0][1]);let i=1/0;for(const a of t){switch(a.type){case"Point":i=Math.min(i,vn(n,!1,[a.coordinates],!1,o,i));break;case"LineString":i=Math.min(i,vn(n,!1,a.coordinates,!0,o,i));break;case"Polygon":i=Math.min(i,gn(n,!1,a.coordinates,o,i));break}if(0===i)return i}return i}function xn(e,t){const r=e.geometry(),n=r.flat().map(t=>fr([t.x,t.y],e.canonical));if(0===r.length)return NaN;const o=new Xr(n[0][1]);let i=1/0;for(const a of t){switch(a.type){case"Point":i=Math.min(i,vn(n,!0,[a.coordinates],!1,o,i));break;case"LineString":i=Math.min(i,vn(n,!0,a.coordinates,!0,o,i));break;case"Polygon":i=Math.min(i,gn(n,!0,a.coordinates,o,i));break}if(0===i)return i}return i}function wn(e,t){const r=e.geometry();if(0===r.length||0===r[0].length)return NaN;const n=Ur(r,0).map(t=>t.map(t=>t.map(t=>fr([t.x,t.y],e.canonical)))),o=new Xr(n[0][0][0][1]);let i=1/0;for(const a of t)for(const e of n){switch(a.type){case"Point":i=Math.min(i,gn([a.coordinates],!1,e,o,i));break;case"LineString":i=Math.min(i,gn(a.coordinates,!0,e,o,i));break;case"Polygon":i=Math.min(i,yn(e,a.coordinates,o,i));break}if(0===i)return i}return i}function kn(e){return"MultiPolygon"===e.type?e.coordinates.map(e=>({type:"Polygon",coordinates:e})):"MultiLineString"===e.type?e.coordinates.map(e=>({type:"LineString",coordinates:e})):"MultiPoint"===e.type?e.coordinates.map(e=>({type:"Point",coordinates:e})):[e]}class Sn{constructor(e,t){this.type=Y,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(ut(e[1])){const t=e[1];if("FeatureCollection"===t.type)return new Sn(t,t.features.map(e=>kn(e.geometry)).flat());if("Feature"===t.type)return new Sn(t,kn(t.geometry));if("type"in t&&"coordinates"in t)return new Sn(t,kn(t))}return t.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return bn(e,this.geometries);if("LineString"===e.geometryType())return xn(e,this.geometries);if("Polygon"===e.geometryType())return wn(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class $n{constructor(e){this.type=oe,this.key=e}static parse(e,t){if(2!==e.length)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);const r=e[1];return void 0===r||null===r?t.error("Global state property must be defined."):"string"!==typeof r?t.error(`Global state property must be string, but found ${typeof e[1]} instead.`):new $n(r)}evaluate(e){var t;const r=null===(t=e.globals)||void 0===t?void 0:t.globalState;return r&&0!==Object.keys(r).length?Le(r,this.key):null}eachChild(){}outputDefined(){return!1}}const zn={"==":Qt,"!=":er,">":rr,"<":tr,">=":or,"<=":nr,array:yt,at:kt,boolean:yt,case:At,coalesce:Nt,collator:ir,format:sr,image:lr,in:St,"index-of":$t,interpolate:Ot,"interpolate-hcl":Ot,"interpolate-lab":Ot,length:ur,let:xt,literal:ft,match:zt,number:yt,"number-format":ar,object:yt,slice:jt,step:Et,string:yt,"to-boolean":mt,"to-color":mt,"to-number":mt,"to-string":mt,var:wt,within:Ir,distance:Sn,"global-state":$n};class An{constructor(e,t,r,n){this.name=e,this.type=t,this._evaluate=r,this.args=n}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,t){const r=e[0],n=An.definitions[r];if(!n)return t.error(`Unknown expression "${r}". If you wanted a literal array, use ["literal", [...]].`,0);const o=Array.isArray(n)?n[0]:n.type,i=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,a=i.filter(([t])=>!Array.isArray(t)||t.length===e.length-1);let s=null;for(const[l,u]of a){s=new bt(t.registry,Tn,t.path,null,t.scope);const n=[];let i=!1;for(let t=1;t<e.length;t++){const r=e[t],o=Array.isArray(l)?l[t-1]:l.type,a=s.parse(r,1+n.length,o);if(!a){i=!0;break}n.push(a)}if(!i)if(Array.isArray(l)&&l.length!==n.length)s.error(`Expected ${l.length} arguments, but found ${n.length} instead.`);else{for(let e=0;e<n.length;e++){const t=Array.isArray(l)?l[e]:l.type,r=n[e];s.concat(e+1).checkSubtype(t,r.type)}if(0===s.errors.length)return new An(r,o,u,n)}}if(1===a.length)t.errors.push(...s.errors);else{const r=a.length?a:i,n=r.map(([e])=>qn(e)).join(" | "),o=[];for(let i=1;i<e.length;i++){const r=t.parse(e[i],1+o.length);if(!r)return null;o.push(ye(r.type))}t.error(`Expected arguments of type ${n}, but found (${o.join(", ")}) instead.`)}return null}static register(e,t){An.definitions=t;for(const r in t)e[r]=An}}function jn(e,[t,r,n,o]){t=t.evaluate(e),r=r.evaluate(e),n=n.evaluate(e);const i=o?o.evaluate(e):1,a=lt(t,r,n,i);if(a)throw new nt(a);return new Xe(t/255,r/255,n/255,i,!1)}function Mn(e,t){return e in t}function En(e,t){const r=t[e];return"undefined"===typeof r?null:r}function _n(e,t,r,n){while(r<=n){const o=r+n>>1;if(t[o]===e)return!0;t[o]>e?n=o-1:r=o+1}return!1}function Cn(e){return{type:e}}function qn(e){return Array.isArray(e)?`(${e.map(ye).join(", ")})`:`(${ye(e.type)}...)`}function Tn(e){if(e instanceof wt)return Tn(e.boundExpression);if(e instanceof An&&"error"===e.name)return!1;if(e instanceof ir)return!1;if(e instanceof Ir)return!1;if(e instanceof Sn)return!1;if(e instanceof $n)return!1;const t=e instanceof mt||e instanceof yt;let r=!0;return e.eachChild(e=>{r=t?r&&Tn(e):r&&e instanceof ft}),!!r&&(Fn(e)&&On(e,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"]))}function Fn(e){if(e instanceof An){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof Ir)return!1;if(e instanceof Sn)return!1;let t=!0;return e.eachChild(e=>{t&&!Fn(e)&&(t=!1)}),t}function Pn(e){if(e instanceof An&&"feature-state"===e.name)return!1;let t=!0;return e.eachChild(e=>{t&&!Pn(e)&&(t=!1)}),t}function On(e,t){if(e instanceof An&&t.indexOf(e.name)>=0)return!1;let r=!0;return e.eachChild(e=>{r&&!On(e,t)&&(r=!1)}),r}function In(e){return{result:"success",value:e}}function Nn(e){return{result:"error",value:e}}function Rn(e){return"data-driven"===e["property-type"]||"cross-faded-data-driven"===e["property-type"]}function Ln(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Dn(e){return!!e.expression&&e.expression.interpolated}function Un(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function Gn(e){return"object"===typeof e&&null!==e&&!Array.isArray(e)&&ct(e)===ne}An.register(zn,{error:[ie,[Q],(e,[t])=>{throw new nt(t.evaluate(e))}],typeof:[Q,[oe],(e,[t])=>ye(ct(t.evaluate(e)))],"to-rgba":[de(Y,4),[te],(e,[t])=>{const[r,n,o,i]=t.evaluate(e).rgb;return[255*r,255*n,255*o,i]}],rgb:[te,[Y,Y,Y],jn],rgba:[te,[Y,Y,Y,Y],jn],has:{type:ee,overloads:[[[Q],(e,[t])=>Mn(t.evaluate(e),e.properties())],[[Q,ne],(e,[t,r])=>Mn(t.evaluate(e),r.evaluate(e))]]},get:{type:oe,overloads:[[[Q],(e,[t])=>En(t.evaluate(e),e.properties())],[[Q,ne],(e,[t,r])=>En(t.evaluate(e),r.evaluate(e))]]},"feature-state":[oe,[Q],(e,[t])=>En(t.evaluate(e),e.featureState||{})],properties:[ne,[],e=>e.properties()],"geometry-type":[Q,[],e=>e.geometryType()],id:[oe,[],e=>e.id()],zoom:[Y,[],e=>e.globals.zoom],"heatmap-density":[Y,[],e=>e.globals.heatmapDensity||0],elevation:[Y,[],e=>e.globals.elevation||0],"line-progress":[Y,[],e=>e.globals.lineProgress||0],accumulated:[oe,[],e=>void 0===e.globals.accumulated?null:e.globals.accumulated],"+":[Y,Cn(Y),(e,t)=>{let r=0;for(const n of t)r+=n.evaluate(e);return r}],"*":[Y,Cn(Y),(e,t)=>{let r=1;for(const n of t)r*=n.evaluate(e);return r}],"-":{type:Y,overloads:[[[Y,Y],(e,[t,r])=>t.evaluate(e)-r.evaluate(e)],[[Y],(e,[t])=>-t.evaluate(e)]]},"/":[Y,[Y,Y],(e,[t,r])=>t.evaluate(e)/r.evaluate(e)],"%":[Y,[Y,Y],(e,[t,r])=>t.evaluate(e)%r.evaluate(e)],ln2:[Y,[],()=>Math.LN2],pi:[Y,[],()=>Math.PI],e:[Y,[],()=>Math.E],"^":[Y,[Y,Y],(e,[t,r])=>Math.pow(t.evaluate(e),r.evaluate(e))],sqrt:[Y,[Y],(e,[t])=>Math.sqrt(t.evaluate(e))],log10:[Y,[Y],(e,[t])=>Math.log(t.evaluate(e))/Math.LN10],ln:[Y,[Y],(e,[t])=>Math.log(t.evaluate(e))],log2:[Y,[Y],(e,[t])=>Math.log(t.evaluate(e))/Math.LN2],sin:[Y,[Y],(e,[t])=>Math.sin(t.evaluate(e))],cos:[Y,[Y],(e,[t])=>Math.cos(t.evaluate(e))],tan:[Y,[Y],(e,[t])=>Math.tan(t.evaluate(e))],asin:[Y,[Y],(e,[t])=>Math.asin(t.evaluate(e))],acos:[Y,[Y],(e,[t])=>Math.acos(t.evaluate(e))],atan:[Y,[Y],(e,[t])=>Math.atan(t.evaluate(e))],min:[Y,Cn(Y),(e,t)=>Math.min(...t.map(t=>t.evaluate(e)))],max:[Y,Cn(Y),(e,t)=>Math.max(...t.map(t=>t.evaluate(e)))],abs:[Y,[Y],(e,[t])=>Math.abs(t.evaluate(e))],round:[Y,[Y],(e,[t])=>{const r=t.evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[Y,[Y],(e,[t])=>Math.floor(t.evaluate(e))],ceil:[Y,[Y],(e,[t])=>Math.ceil(t.evaluate(e))],"filter-==":[ee,[Q,oe],(e,[t,r])=>e.properties()[t.value]===r.value],"filter-id-==":[ee,[oe],(e,[t])=>e.id()===t.value],"filter-type-==":[ee,[Q],(e,[t])=>e.geometryType()===t.value],"filter-<":[ee,[Q,oe],(e,[t,r])=>{const n=e.properties()[t.value],o=r.value;return typeof n===typeof o&&n<o}],"filter-id-<":[ee,[oe],(e,[t])=>{const r=e.id(),n=t.value;return typeof r===typeof n&&r<n}],"filter->":[ee,[Q,oe],(e,[t,r])=>{const n=e.properties()[t.value],o=r.value;return typeof n===typeof o&&n>o}],"filter-id->":[ee,[oe],(e,[t])=>{const r=e.id(),n=t.value;return typeof r===typeof n&&r>n}],"filter-<=":[ee,[Q,oe],(e,[t,r])=>{const n=e.properties()[t.value],o=r.value;return typeof n===typeof o&&n<=o}],"filter-id-<=":[ee,[oe],(e,[t])=>{const r=e.id(),n=t.value;return typeof r===typeof n&&r<=n}],"filter->=":[ee,[Q,oe],(e,[t,r])=>{const n=e.properties()[t.value],o=r.value;return typeof n===typeof o&&n>=o}],"filter-id->=":[ee,[oe],(e,[t])=>{const r=e.id(),n=t.value;return typeof r===typeof n&&r>=n}],"filter-has":[ee,[oe],(e,[t])=>t.value in e.properties()],"filter-has-id":[ee,[],e=>null!==e.id()&&void 0!==e.id()],"filter-type-in":[ee,[de(Q)],(e,[t])=>t.value.indexOf(e.geometryType())>=0],"filter-id-in":[ee,[de(oe)],(e,[t])=>t.value.indexOf(e.id())>=0],"filter-in-small":[ee,[Q,de(oe)],(e,[t,r])=>r.value.indexOf(e.properties()[t.value])>=0],"filter-in-large":[ee,[Q,de(oe)],(e,[t,r])=>_n(e.properties()[t.value],r.value,0,r.value.length-1)],all:{type:ee,overloads:[[[ee,ee],(e,[t,r])=>t.evaluate(e)&&r.evaluate(e)],[Cn(ee),(e,t)=>{for(const r of t)if(!r.evaluate(e))return!1;return!0}]]},any:{type:ee,overloads:[[[ee,ee],(e,[t,r])=>t.evaluate(e)||r.evaluate(e)],[Cn(ee),(e,t)=>{for(const r of t)if(r.evaluate(e))return!0;return!1}]]},"!":[ee,[ee],(e,[t])=>!t.evaluate(e)],"is-supported-script":[ee,[Q],(e,[t])=>{const r=e.globals&&e.globals.isSupportedScript;return!r||r(t.evaluate(e))}],upcase:[Q,[Q],(e,[t])=>t.evaluate(e).toUpperCase()],downcase:[Q,[Q],(e,[t])=>t.evaluate(e).toLowerCase()],concat:[Q,Cn(oe),(e,t)=>t.map(t=>pt(t.evaluate(e))).join("")],"resolved-locale":[Q,[ae],(e,[t])=>t.evaluate(e).resolvedLocale()]});class Jn{constructor(e,t){this.expression=e,this._warningHistory={},this._evaluator=new vt,this._defaultValue=t?Qn(t):null,this._enumValues=t&&"enum"===t.type?t.values:null}evaluateWithoutErrorHandling(e,t,r,n,o,i){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=n,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=i,this.expression.evaluate(this._evaluator)}evaluate(e,t,r,n,o,i){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=n,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=i||null;try{const e=this.expression.evaluate(this._evaluator);if(null===e||void 0===e||"number"===typeof e&&e!==e)return this._defaultValue;if(this._enumValues&&!(e in this._enumValues))throw new nt(`Expected value to be one of ${Object.keys(this._enumValues).map(e=>JSON.stringify(e)).join(", ")}, but found ${JSON.stringify(e)} instead.`);return e}catch(a){return this._warningHistory[a.message]||(this._warningHistory[a.message]=!0,"undefined"!==typeof console&&console.warn(a.message)),this._defaultValue}}}function Vn(e){return Array.isArray(e)&&e.length>0&&"string"===typeof e[0]&&e[0]in zn}function Wn(e,t){const r=new bt(zn,Tn,[],t?Yn(t):void 0),n=r.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return n?In(new Jn(n,t)):Nn(r.errors)}class Kn{constructor(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent="constant"!==e&&!Pn(t.expression),this.globalStateRefs=Hn(t.expression)}evaluateWithoutErrorHandling(e,t,r,n,o,i){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,o,i)}evaluate(e,t,r,n,o,i){return this._styleExpression.evaluate(e,t,r,n,o,i)}}class Zn{constructor(e,t,r,n){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent="camera"!==e&&!Pn(t.expression),this.globalStateRefs=Hn(t.expression),this.interpolationType=n}evaluateWithoutErrorHandling(e,t,r,n,o,i){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,o,i)}evaluate(e,t,r,n,o,i){return this._styleExpression.evaluate(e,t,r,n,o,i)}interpolationFactor(e,t,r){return this.interpolationType?Ot.interpolationFactor(this.interpolationType,e,t,r):0}}function Xn(e,t){const r=Wn(e,t);if("error"===r.result)return r;const n=r.value.expression,o=Fn(n);if(!o&&!Rn(t))return Nn([new X("","data expressions not supported")]);const i=On(n,["zoom"]);if(!i&&!Ln(t))return Nn([new X("","zoom expressions not supported")]);const a=Bn(n);if(!a&&!i)return Nn([new X("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(a instanceof X)return Nn([a]);if(a instanceof Ot&&!Dn(t))return Nn([new X("",'"interpolate" expressions cannot be used with this property')]);if(!a)return In(new Kn(o?"constant":"source",r.value));const s=a instanceof Ot?a.interpolation:void 0;return In(new Zn(o?"camera":"composite",r.value,a.labels,s))}function Bn(e){let t=null;if(e instanceof xt)t=Bn(e.result);else if(e instanceof Nt){for(const r of e.args)if(t=Bn(r),t)break}else(e instanceof Et||e instanceof Ot)&&e.input instanceof An&&"zoom"===e.input.name&&(t=e);return t instanceof X||e.eachChild(e=>{const r=Bn(e);r instanceof X?t=r:!t&&r?t=new X("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&r&&t!==r&&(t=new X("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function Hn(e,t=new Set){return e instanceof $n&&t.add(e.key),e.eachChild(e=>{Hn(e,t)}),t}function Yn(e){const t={color:te,string:Q,number:Y,enum:Q,boolean:ee,formatted:se,padding:le,numberArray:ce,colorArray:ue,projectionDefinition:re,resolvedImage:pe,variableAnchorOffsetCollection:fe};return"array"===e.type?de(t[e.value]||oe,e.length):t[e.type]}function Qn(e){if("color"===e.type&&Gn(e.default))return new Xe(0,0,0,0);switch(e.type){case"color":return Xe.parse(e.default)||null;case"padding":return et.parse(e.default)||null;case"numberArray":return tt.parse(e.default)||null;case"colorArray":return rt.parse(e.default)||null;case"variableAnchorOffsetCollection":return it.parse(e.default)||null;case"projectionDefinition":return st.parse(e.default)||null;default:return void 0===e.default?null:e.default}}function eo(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!==typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(const t of e.slice(1))if(!eo(t)&&"boolean"!==typeof t)return!1;return!0;default:return!0}}const to={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ro(e){if(null===e||void 0===e)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};eo(e)||(e=io(e));const t=Wn(e,to);if("error"===t.result)throw new Error(t.value.map(e=>`${e.key}: ${e.message}`).join(", "));{const r=oo(e);return{filter:(e,r,n)=>t.value.evaluate(e,r,{},n),needGeometry:r,getGlobalStateRefs:()=>Hn(t.value.expression)}}}function no(e,t){return e<t?-1:e>t?1:0}function oo(e){if(!Array.isArray(e))return!1;if("within"===e[0]||"distance"===e[0])return!0;for(let t=1;t<e.length;t++)if(oo(e[t]))return!0;return!1}function io(e){if(!e)return!0;const t=e[0];if(e.length<=1)return"any"!==t;const r="=="===t?ao(e[1],e[2],"=="):"!="===t?co(ao(e[1],e[2],"==")):"<"===t||">"===t||"<="===t||">="===t?ao(e[1],e[2],t):"any"===t?so(e.slice(1)):"all"===t?["all"].concat(e.slice(1).map(io)):"none"===t?["all"].concat(e.slice(1).map(io).map(co)):"in"===t?lo(e[1],e.slice(2)):"!in"===t?co(lo(e[1],e.slice(2))):"has"===t?uo(e[1]):"!has"!==t||co(uo(e[1]));return r}function ao(e,t,r){switch(e){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,e,t]}}function so(e){return["any"].concat(e.map(io))}function lo(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(e=>typeof e!==typeof t[0])?["filter-in-large",e,["literal",t.sort(no)]]:["filter-in-small",e,["literal",t]]}}function uo(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function co(e){return["!",e]}function po(e){return"object"===typeof e?["literal",e]:e}function fo(e,t){let r=e.stops;if(!r)return yo(e,t);const n=r&&"object"===typeof r[0][0],o=n||void 0!==e.property,i=n||!o;return r=r.map(e=>!o&&t.tokens&&"string"===typeof e[1]?[e[0],$o(e[1])]:[e[0],po(e[1])]),n?mo(e,t,r):i?xo(e,t,r):bo(e,t,r)}function yo(e,t){const r=["get",e.property];if(void 0===e.default)return"string"===t.type?["string",r]:r;if("enum"===t.type)return["match",r,Object.keys(t.values),r,e.default];{const n=["color"===t.type?"to-color":t.type,r,po(e.default)];return"array"===t.type&&n.splice(1,0,t.value,t.length||null),n}}function ho(e){switch(e.colorSpace){case"hcl":return"interpolate-hcl";case"lab":return"interpolate-lab";default:return"interpolate"}}function mo(e,t,r){const n={},o={},i=[];for(let s=0;s<r.length;s++){const t=r[s],a=t[0].zoom;void 0===n[a]&&(n[a]={zoom:a,type:e.type,property:e.property,default:e.default},o[a]=[],i.push(a)),o[a].push([t[0].value,t[1]])}const a=So({},t);if("exponential"===a){const r=[ho(e),["linear"],["zoom"]];for(const e of i){const i=bo(n[e],t,o[e]);ko(r,e,i,!1)}return r}{const e=["step",["zoom"]];for(const r of i){const i=bo(n[r],t,o[r]);ko(e,r,i,!0)}return wo(e),e}}function go(e,t){return void 0!==e?e:void 0!==t?t:void 0}function vo(e,t){const r=po(go(e.default,t.default));return void 0===r&&"resolvedImage"===t.type?"":r}function bo(e,t,r){const n=So(e,t),o=["get",e.property];if("categorical"===n&&"boolean"===typeof r[0][0]){const n=["case"];for(const e of r)n.push(["==",o,e[0]],e[1]);return n.push(vo(e,t)),n}if("categorical"===n){const n=["match",o];for(const e of r)ko(n,e[0],e[1],!1);return n.push(vo(e,t)),n}if("interval"===n){const t=["step",["number",o]];for(const e of r)ko(t,e[0],e[1],!0);return wo(t),void 0===e.default?t:["case",["==",["typeof",o],"number"],t,po(e.default)]}if("exponential"===n){const t=void 0!==e.base?e.base:1,n=[ho(e),1===t?["linear"]:["exponential",t],["number",o]];for(const e of r)ko(n,e[0],e[1],!1);return void 0===e.default?n:["case",["==",["typeof",o],"number"],n,po(e.default)]}throw new Error(`Unknown property function type ${n}`)}function xo(e,t,r,n=["zoom"]){const o=So(e,t);let i,a=!1;if("interval"===o)i=["step",n],a=!0;else{if("exponential"!==o)throw new Error(`Unknown zoom function type "${o}"`);{const t=void 0!==e.base?e.base:1;i=[ho(e),1===t?["linear"]:["exponential",t],n]}}for(const s of r)ko(i,s[0],s[1],a);return wo(i),i}function wo(e){"step"===e[0]&&3===e.length&&(e.push(0),e.push(e[3]))}function ko(e,t,r,n){e.length>3&&t===e[e.length-2]||(n&&2===e.length||e.push(t),e.push(r))}function So(e,t){return e.type?e.type:t.expression.interpolated?"exponential":"interval"}function $o(e){const t=["concat"],r=/{([^{}]+)}/g;let n=0;for(let o=r.exec(e);null!==o;o=r.exec(e)){const i=e.slice(n,r.lastIndex-o[0].length);n=r.lastIndex,i.length>0&&t.push(i),t.push(["get",o[1]])}if(1===t.length)return e;if(n<e.length)t.push(e.slice(n));else if(2===t.length)return["to-string",t[1]];return t}function zo(e){const t=e.key,r=e.value;return r?[new K(t,r,"constants have been deprecated as of v8")]:[]}function Ao(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function jo(e){if(Array.isArray(e))return e.map(jo);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){const t={};for(const r in e)t[r]=jo(e[r]);return t}return Ao(e)}function Mo(e){const t=e.key,r=e.value,n=e.valueSpec||{},o=e.objectElementValidators||{},i=e.style,a=e.styleSpec,s=e.validateSpec;let l=[];const u=Un(r);if("object"!==u)return[new K(t,r,`object expected, ${u} found`)];for(const c in r){const e=c.split(".")[0],u=Le(n,e)||n["*"];let p;if(Le(o,e))p=o[e];else if(Le(n,e))p=s;else if(o["*"])p=o["*"];else{if(!n["*"]){l.push(new K(t,r[c],`unknown property "${c}"`));continue}p=s}l=l.concat(p({key:(t?`${t}.`:t)+c,value:r[c],valueSpec:u,style:i,styleSpec:a,object:r,objectKey:c,validateSpec:s},r))}for(const c in n)o[c]||n[c].required&&void 0===n[c]["default"]&&void 0===r[c]&&l.push(new K(t,r,`missing required property "${c}"`));return l}function Eo(e){const t=e.value,r=e.valueSpec,n=e.validateSpec,o=e.style,i=e.styleSpec,a=e.key,s=e.arrayElementValidator||n;if("array"!==Un(t))return[new K(a,t,`array expected, ${Un(t)} found`)];if(r.length&&t.length!==r.length)return[new K(a,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new K(a,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let l={type:r.value,values:r.values};i.$version<7&&(l["function"]=r.function),"object"===Un(r.value)&&(l=r.value);let u=[];for(let c=0;c<t.length;c++)u=u.concat(s({array:t,arrayIndex:c,value:t[c],valueSpec:l,validateSpec:e.validateSpec,style:o,styleSpec:i,key:`${a}[${c}]`}));return u}function _o(e){const t=e.key,r=e.value,n=e.valueSpec;let o=Un(r);return"number"===o&&r!==r&&(o="NaN"),"number"!==o?[new K(t,r,`number expected, ${o} found`)]:"minimum"in n&&r<n.minimum?[new K(t,r,`${r} is less than the minimum value ${n.minimum}`)]:"maximum"in n&&r>n.maximum?[new K(t,r,`${r} is greater than the maximum value ${n.maximum}`)]:[]}function Co(e){const t=e.valueSpec,r=Ao(e.value.type);let n,o,i,a={};const s="categorical"!==r&&void 0===e.value.property,l=!s,u="array"===Un(e.value.stops)&&"array"===Un(e.value.stops[0])&&"object"===Un(e.value.stops[0][0]),c=Mo({key:e.key,value:e.value,valueSpec:e.styleSpec.function,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:p,default:y}});return"identity"===r&&s&&c.push(new K(e.key,e.value,'missing required property "property"')),"identity"===r||e.value.stops||c.push(new K(e.key,e.value,'missing required property "stops"')),"exponential"===r&&e.valueSpec.expression&&!Dn(e.valueSpec)&&c.push(new K(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(l&&!Rn(e.valueSpec)?c.push(new K(e.key,e.value,"property functions not supported")):s&&!Ln(e.valueSpec)&&c.push(new K(e.key,e.value,"zoom functions not supported"))),"categorical"!==r&&!u||void 0!==e.value.property||c.push(new K(e.key,e.value,'"property" property is required')),c;function p(e){if("identity"===r)return[new K(e.key,e.value,'identity function may not have a "stops" property')];let t=[];const n=e.value;return t=t.concat(Eo({key:e.key,value:n,valueSpec:e.valueSpec,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:f})),"array"===Un(n)&&0===n.length&&t.push(new K(e.key,n,"array must have at least one stop")),t}function f(e){let r=[];const n=e.value,s=e.key;if("array"!==Un(n))return[new K(s,n,`array expected, ${Un(n)} found`)];if(2!==n.length)return[new K(s,n,`array length 2 expected, length ${n.length} found`)];if(u){if("object"!==Un(n[0]))return[new K(s,n,`object expected, ${Un(n[0])} found`)];if(void 0===n[0].zoom)return[new K(s,n,"object stop key must have zoom")];if(void 0===n[0].value)return[new K(s,n,"object stop key must have value")];if(i&&i>Ao(n[0].zoom))return[new K(s,n[0].zoom,"stop zoom values must appear in ascending order")];Ao(n[0].zoom)!==i&&(i=Ao(n[0].zoom),o=void 0,a={}),r=r.concat(Mo({key:`${s}[0]`,value:n[0],valueSpec:{zoom:{}},validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:_o,value:d}}))}else r=r.concat(d({key:`${s}[0]`,value:n[0],validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec},n));return Vn(jo(n[1]))?r.concat([new K(`${s}[1]`,n[1],"expressions are not allowed in function stops.")]):r.concat(e.validateSpec({key:`${s}[1]`,value:n[1],valueSpec:t,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec}))}function d(e,i){const s=Un(e.value),l=Ao(e.value),u=null!==e.value?e.value:i;if(n){if(s!==n)return[new K(e.key,u,`${s} stop domain type must match previous stop domain type ${n}`)]}else n=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new K(e.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==r){let n=`number expected, ${s} found`;return Rn(t)&&void 0===r&&(n+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new K(e.key,u,n)]}return"categorical"!==r||"number"!==s||isFinite(l)&&Math.floor(l)===l?"categorical"!==r&&"number"===s&&void 0!==o&&l<o?[new K(e.key,u,"stop domain values must appear in ascending order")]:(o=l,"categorical"===r&&l in a?[new K(e.key,u,"stop domain values must be unique")]:(a[l]=!0,[])):[new K(e.key,u,`integer expected, found ${l}`)]}function y(e){return e.validateSpec({key:e.key,value:e.value,valueSpec:t,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec})}}function qo(e){const t=("property"===e.expressionContext?Xn:Wn)(jo(e.value),e.valueSpec);if("error"===t.result)return t.value.map(t=>new K(`${e.key}${t.key}`,e.value,t.message));const r=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!r.outputDefined())return[new K(e.key,e.value,`Invalid data expression for "${e.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===e.expressionContext&&"layout"===e.propertyType&&!Pn(r))return[new K(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext&&!Pn(r))return[new K(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!On(r,["zoom","feature-state"]))return[new K(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!Fn(r))return[new K(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function To(e){const t=e.value,r=e.key,n=Un(t);return"boolean"!==n?[new K(r,t,`boolean expected, ${n} found`)]:[]}function Fo(e){const t=e.key,r=e.value,n=Un(r);return"string"!==n?[new K(t,r,`color expected, ${n} found`)]:Xe.parse(String(r))?[]:[new K(t,r,`color expected, "${r}" found`)]}function Po(e){const t=e.key,r=e.value,n=e.valueSpec,o=[];return Array.isArray(n.values)?-1===n.values.indexOf(Ao(r))&&o.push(new K(t,r,`expected one of [${n.values.join(", ")}], ${JSON.stringify(r)} found`)):-1===Object.keys(n.values).indexOf(Ao(r))&&o.push(new K(t,r,`expected one of [${Object.keys(n.values).join(", ")}], ${JSON.stringify(r)} found`)),o}function Oo(e){return eo(jo(e.value))?qo(Z({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Io(e)}function Io(e){const t=e.value,r=e.key;if("array"!==Un(t))return[new K(r,t,`array expected, ${Un(t)} found`)];const n=e.styleSpec;let o,i=[];if(t.length<1)return[new K(r,t,"filter array must have at least 1 element")];switch(i=i.concat(Po({key:`${r}[0]`,value:t[0],valueSpec:n.filter_operator,style:e.style,styleSpec:e.styleSpec})),Ao(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&"$type"===Ao(t[1])&&i.push(new K(r,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":3!==t.length&&i.push(new K(r,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(o=Un(t[1]),"string"!==o&&i.push(new K(`${r}[1]`,t[1],`string expected, ${o} found`)));for(let a=2;a<t.length;a++)o=Un(t[a]),"$type"===Ao(t[1])?i=i.concat(Po({key:`${r}[${a}]`,value:t[a],valueSpec:n.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==o&&"number"!==o&&"boolean"!==o&&i.push(new K(`${r}[${a}]`,t[a],`string, number, or boolean expected, ${o} found`));break;case"any":case"all":case"none":for(let n=1;n<t.length;n++)i=i.concat(Io({key:`${r}[${n}]`,value:t[n],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":o=Un(t[1]),2!==t.length?i.push(new K(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):"string"!==o&&i.push(new K(`${r}[1]`,t[1],`string expected, ${o} found`));break}return i}function No(e,t){const r=e.key,n=e.validateSpec,o=e.style,i=e.styleSpec,a=e.value,s=e.objectKey,l=i[`${t}_${e.layerType}`];if(!l)return[];const u=s.match(/^(.*)-transition$/);if("paint"===t&&u&&l[u[1]]&&l[u[1]].transition)return n({key:r,value:a,valueSpec:i.transition,style:o,styleSpec:i});const c=e.valueSpec||l[s];if(!c)return[new K(r,a,`unknown property "${s}"`)];let p;if("string"===Un(a)&&Rn(c)&&!c.tokens&&(p=/^{([^}]+)}$/.exec(a)))return[new K(r,a,`"${s}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(p[1])} }\`.`)];const f=[];return"symbol"===e.layerType&&("text-field"===s&&o&&!o.glyphs&&f.push(new K(r,a,'use of "text-field" requires a style "glyphs" property')),"text-font"===s&&Gn(jo(a))&&"identity"===Ao(a.type)&&f.push(new K(r,a,'"text-font" does not support identity functions'))),f.concat(n({key:e.key,value:a,valueSpec:c,style:o,styleSpec:i,expressionContext:"property",propertyType:t,propertyKey:s}))}function Ro(e){return No(e,"paint")}function Lo(e){return No(e,"layout")}function Do(e){let t=[];const r=e.value,n=e.key,o=e.style,i=e.styleSpec;if("object"!==Un(r))return[new K(n,r,`object expected, ${Un(r)} found`)];r.type||r.ref||t.push(new K(n,r,'either "type" or "ref" is required'));let a=Ao(r.type);const s=Ao(r.ref);if(r.id){const i=Ao(r.id);for(let a=0;a<e.arrayIndex;a++){const e=o.layers[a];Ao(e.id)===i&&t.push(new K(n,r.id,`duplicate layer id "${r.id}", previously used at line ${e.id.__line__}`))}}if("ref"in r){let e;["type","source","source-layer","filter","layout"].forEach(e=>{e in r&&t.push(new K(n,r[e],`"${e}" is prohibited for ref layers`))}),o.layers.forEach(t=>{Ao(t.id)===s&&(e=t)}),e?e.ref?t.push(new K(n,r.ref,"ref cannot reference another ref layer")):a=Ao(e.type):t.push(new K(n,r.ref,`ref layer "${s}" not found`))}else if("background"!==a)if(r.source){const e=o.sources&&o.sources[r.source],i=e&&Ao(e.type);e?"vector"===i&&"raster"===a?t.push(new K(n,r.source,`layer "${r.id}" requires a raster source`)):"raster-dem"!==i&&"hillshade"===a||"raster-dem"!==i&&"color-relief"===a?t.push(new K(n,r.source,`layer "${r.id}" requires a raster-dem source`)):"raster"===i&&"raster"!==a?t.push(new K(n,r.source,`layer "${r.id}" requires a vector source`)):"vector"!==i||r["source-layer"]?"raster-dem"===i&&"hillshade"!==a&&"color-relief"!==a?t.push(new K(n,r.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):"line"!==a||!r.paint||!r.paint["line-gradient"]||"geojson"===i&&e.lineMetrics||t.push(new K(n,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new K(n,r,`layer "${r.id}" must specify a "source-layer"`)):t.push(new K(n,r.source,`source "${r.source}" not found`))}else t.push(new K(n,r,'missing required property "source"'));return t=t.concat(Mo({key:n,value:r,valueSpec:i.layer,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*"(){return[]},type(){return e.validateSpec({key:`${n}.type`,value:r.type,valueSpec:i.layer.type,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,object:r,objectKey:"type"})},filter:Oo,layout(e){return Mo({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*"(e){return Lo(Z({layerType:a},e))}}})},paint(e){return Mo({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*"(e){return Ro(Z({layerType:a},e))}}})}}})),t}function Uo(e){const t=e.value,r=e.key,n=Un(t);return"string"!==n?[new K(r,t,`string expected, ${n} found`)]:[]}function Go(e){var t;const r=null!==(t=e.sourceName)&&void 0!==t?t:"",n=e.value,o=e.styleSpec,i=o.source_raster_dem,a=e.style;let s=[];const l=Un(n);if(void 0===n)return s;if("object"!==l)return s.push(new K("source_raster_dem",n,`object expected, ${l} found`)),s;const u=Ao(n.encoding),c="custom"===u,p=["redFactor","greenFactor","blueFactor","baseShift"],f=e.value.encoding?`"${e.value.encoding}"`:"Default";for(const d in n)!c&&p.includes(d)?s.push(new K(d,n[d],`In "${r}": "${d}" is only valid when "encoding" is set to "custom". ${f} encoding found`)):i[d]?s=s.concat(e.validateSpec({key:d,value:n[d],valueSpec:i[d],validateSpec:e.validateSpec,style:a,styleSpec:o})):s.push(new K(d,n[d],`unknown property "${d}"`));return s}const Jo={promoteId:Wo};function Vo(e){const t=e.value,r=e.key,n=e.styleSpec,o=e.style,i=e.validateSpec;if(!t.type)return[new K(r,t,'"type" is required')];const a=Ao(t.type);let s;switch(a){case"vector":case"raster":return s=Mo({key:r,value:t,valueSpec:n[`source_${a.replace("-","_")}`],style:e.style,styleSpec:n,objectElementValidators:Jo,validateSpec:i}),s;case"raster-dem":return s=Go({sourceName:r,value:t,style:e.style,styleSpec:n,validateSpec:i}),s;case"geojson":if(s=Mo({key:r,value:t,valueSpec:n.source_geojson,style:o,styleSpec:n,validateSpec:i,objectElementValidators:Jo}),t.cluster)for(const e in t.clusterProperties){const[n,o]=t.clusterProperties[e],i="string"===typeof n?[n,["accumulated"],["get",e]]:n;s.push(...qo({key:`${r}.${e}.map`,value:o,expressionContext:"cluster-map"})),s.push(...qo({key:`${r}.${e}.reduce`,value:i,expressionContext:"cluster-reduce"}))}return s;case"video":return Mo({key:r,value:t,valueSpec:n.source_video,style:o,validateSpec:i,styleSpec:n});case"image":return Mo({key:r,value:t,valueSpec:n.source_image,style:o,validateSpec:i,styleSpec:n});case"canvas":return[new K(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Po({key:`${r}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Wo({key:e,value:t}){if("string"===Un(t))return Uo({key:e,value:t});{const r=[];for(const n in t)r.push(...Uo({key:`${e}.${n}`,value:t[n]}));return r}}function Ko(e){const t=e.value,r=e.styleSpec,n=r.light,o=e.style;let i=[];const a=Un(t);if(void 0===t)return i;if("object"!==a)return i=i.concat([new K("light",t,`object expected, ${a} found`)]),i;for(const s in t){const a=s.match(/^(.*)-transition$/);i=a&&n[a[1]]&&n[a[1]].transition?i.concat(e.validateSpec({key:s,value:t[s],valueSpec:r.transition,validateSpec:e.validateSpec,style:o,styleSpec:r})):n[s]?i.concat(e.validateSpec({key:s,value:t[s],valueSpec:n[s],validateSpec:e.validateSpec,style:o,styleSpec:r})):i.concat([new K(s,t[s],`unknown property "${s}"`)])}return i}function Zo(e){const t=e.value,r=e.styleSpec,n=r.sky,o=e.style,i=Un(t);if(void 0===t)return[];if("object"!==i)return[new K("sky",t,`object expected, ${i} found`)];let a=[];for(const s in t)a=n[s]?a.concat(e.validateSpec({key:s,value:t[s],valueSpec:n[s],style:o,styleSpec:r})):a.concat([new K(s,t[s],`unknown property "${s}"`)]);return a}function Xo(e){const t=e.value,r=e.styleSpec,n=r.terrain,o=e.style;let i=[];const a=Un(t);if(void 0===t)return i;if("object"!==a)return i=i.concat([new K("terrain",t,`object expected, ${a} found`)]),i;for(const s in t)i=n[s]?i.concat(e.validateSpec({key:s,value:t[s],valueSpec:n[s],validateSpec:e.validateSpec,style:o,styleSpec:r})):i.concat([new K(s,t[s],`unknown property "${s}"`)]);return i}function Bo(e){return 0===Uo(e).length?[]:qo(e)}function Ho(e){return 0===Uo(e).length?[]:qo(e)}function Yo(e){const t=e.key,r=e.value,n=Un(r);if("array"===n){if(r.length<1||r.length>4)return[new K(t,r,`padding requires 1 to 4 values; ${r.length} values found`)];const n={type:"number"};let o=[];for(let i=0;i<r.length;i++)o=o.concat(e.validateSpec({key:`${t}[${i}]`,value:r[i],validateSpec:e.validateSpec,valueSpec:n}));return o}return _o({key:t,value:r,valueSpec:{}})}function Qo(e){const t=e.key,r=e.value,n=Un(r);if("array"===n){const n={type:"number"};if(r.length<1)return[new K(t,r,"array length at least 1 expected, length 0 found")];let o=[];for(let i=0;i<r.length;i++)o=o.concat(e.validateSpec({key:`${t}[${i}]`,value:r[i],validateSpec:e.validateSpec,valueSpec:n}));return o}return _o({key:t,value:r,valueSpec:{}})}function ei(e){const t=e.key,r=e.value,n=Un(r);if("array"===n){if(r.length<1)return[new K(t,r,"array length at least 1 expected, length 0 found")];let e=[];for(let n=0;n<r.length;n++)e=e.concat(Fo({key:`${t}[${n}]`,value:r[n]}));return e}return Fo({key:t,value:r})}function ti(e){const t=e.key,r=e.value,n=Un(r),o=e.styleSpec;if("array"!==n||r.length<1||r.length%2!==0)return[new K(t,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let i=[];for(let a=0;a<r.length;a+=2)i=i.concat(Po({key:`${t}[${a}]`,value:r[a],valueSpec:o["layout_symbol"]["text-anchor"]})),i=i.concat(Eo({key:`${t}[${a+1}]`,value:r[a+1],valueSpec:{length:2,value:"number"},validateSpec:e.validateSpec,style:e.style,styleSpec:o}));return i}function ri(e){let t=[];const r=e.value,n=e.key;if(Array.isArray(r)){const o=[],i=[];for(const a in r){r[a].id&&o.includes(r[a].id)&&t.push(new K(n,r,`all the sprites' ids must be unique, but ${r[a].id} is duplicated`)),o.push(r[a].id),r[a].url&&i.includes(r[a].url)&&t.push(new K(n,r,`all the sprites' URLs must be unique, but ${r[a].url} is duplicated`)),i.push(r[a].url);const s={id:{type:"string",required:!0},url:{type:"string",required:!0}};t=t.concat(Mo({key:`${n}[${a}]`,value:r[a],valueSpec:s,validateSpec:e.validateSpec}))}return t}return Uo({key:n,value:r})}function ni(e){const t=e.value,r=e.styleSpec,n=r.projection,o=e.style,i=Un(t);if(void 0===t)return[];if("object"!==i)return[new K("projection",t,`object expected, ${i} found`)];let a=[];for(const s in t)a=n[s]?a.concat(e.validateSpec({key:s,value:t[s],valueSpec:n[s],style:o,styleSpec:r})):a.concat([new K(s,t[s],`unknown property "${s}"`)]);return a}function oi(e){const t=e.key;let r=e.value;r=r instanceof String?r.valueOf():r;const n=Un(r);return"array"!==n||ai(r)||ii(r)?["array","string"].includes(n)?[]:[new K(t,r,`projection expected, invalid type "${n}" found`)]:[new K(t,r,`projection expected, invalid array ${JSON.stringify(r)} found`)]}function ii(e){return!!["interpolate","step","literal"].includes(e[0])}function ai(e){return Array.isArray(e)&&3===e.length&&"string"===typeof e[0]&&"string"===typeof e[1]&&"number"===typeof e[2]}function si(e){return Boolean(e)&&e.constructor===Object}function li(e){return si(e.value)?[]:[new K(e.key,e.value,`object expected, ${Un(e.value)} found`)]}const ui={"*"(){return[]},array:Eo,boolean:To,number:_o,color:Fo,constants:zo,enum:Po,filter:Oo,function:Co,layer:Do,object:Mo,source:Vo,light:Ko,sky:Zo,terrain:Xo,projection:ni,projectionDefinition:oi,string:Uo,formatted:Bo,resolvedImage:Ho,padding:Yo,numberArray:Qo,colorArray:ei,variableAnchorOffsetCollection:ti,sprite:ri,state:li};function ci(e){const t=e.value,r=e.valueSpec,n=e.styleSpec;if(e.validateSpec=ci,r.expression&&Gn(Ao(t)))return Co(e);if(r.expression&&Vn(jo(t)))return qo(e);if(r.type&&ui[r.type])return ui[r.type](e);{const t=Mo(Z({},e,{valueSpec:r.type?n[r.type]:r}));return t}}function pi(e){const t=e.value,r=e.key,n=Uo(e);return n.length||(-1===t.indexOf("{fontstack}")&&n.push(new K(r,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&n.push(new K(r,t,'"glyphs" url must include a "{range}" token'))),n}function fi(e,t=G){let r=[];return r=r.concat(ci({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,validateSpec:ci,objectElementValidators:{glyphs:pi,"*"(){return[]}}})),e["constants"]&&(r=r.concat(zo({key:"constants",value:e["constants"]}))),yi(r)}function di(e){return function(t){return e({...t,validateSpec:ci})}}function yi(e){return[].concat(e).sort((e,t)=>e.line-t.line)}function hi(e){return function(...t){return yi(e.apply(this,t))}}fi.source=hi(di(Vo)),fi.sprite=hi(di(ri)),fi.glyphs=hi(di(pi)),fi.light=hi(di(Ko)),fi.sky=hi(di(Zo)),fi.terrain=hi(di(Xo)),fi.state=hi(di(li)),fi.layer=hi(di(Do)),fi.filter=hi(di(Oo)),fi.paintProperty=hi(di(Ro)),fi.layoutProperty=hi(di(Lo));const mi=G;var gi={thin:100,hairline:100,"ultra-light":200,"extra-light":200,light:300,book:300,regular:400,normal:400,plain:400,roman:400,standard:400,medium:500,"semi-bold":600,"demi-bold":600,bold:700,"extra-bold":800,"ultra-bold":800,heavy:900,black:900,"heavy-black":900,fat:900,poster:900,"ultra-black":950,"extra-black":950},vi=" ",bi=/(italic|oblique)$/i,xi={};function wi(e,t,r){var n=xi[e];if(!n){Array.isArray(e)||(e=[e]);for(var o,i,a=400,s="normal",l=[],u=0,c=e.length;u<c;++u){var p=e[u],f=p.split(" "),d=f[f.length-1].toLowerCase();for(var y in"normal"==d||"italic"==d||"oblique"==d?(s=i?s:d,i=!0,f.pop(),d=f[f.length-1].toLowerCase()):bi.test(d)&&(d=d.replace(bi,""),s=i?s:f[f.length-1].replace(d,""),i=!0),gi){var h=f.length>1?f[f.length-2].toLowerCase():"";if(d==y||d==y.replace("-","")||h+"-"+d==y){a=o?a:gi[y],f.pop(),h&&y.startsWith(h)&&f.pop();break}}o||"number"!=typeof d||(a=d,o=!0);var m=f.join(vi).replace("Klokantech Noto Sans","Noto Sans").replace("DIN Pro","Barlow").replace("Arial Unicode MS","Arial");-1!==m.indexOf(vi)&&(m='"'+m+'"'),l.push(m)}n=xi[e]=[s,a,l]}return n[0]+vi+n[1]+vi+t+"px"+(r?"/"+r:"")+vi+n[2]}var ki=r(23597),Si=r(6933),$i=r(70915),zi=r(74238),Ai=r(24778),ji=r(27733),Mi=r(13628),Ei=r(49700),_i=r(953),Ci=r(29276),qi=r(81426),Ti=r(38774),Fi=r(88756),Pi=r(11078),Oi=r(4087);const Ii="https://api.mapbox.com";function Ni(e){const t="mapbox://";return 0!==e.indexOf(t)?"":e.slice(t.length)}function Ri(e,t,r){if("string"===typeof e)return[{id:"default",url:Li(e,t,r)}];for(const n of e)n.url=Li(n.url,t,r);return e}function Li(e,t,r){const n=Ni(e);if(!n)return decodeURI(new URL(e,r).href);const o="sprites/";if(0!==n.indexOf(o))throw new Error(`unexpected sprites url: ${e}`);const i=n.slice(o.length);return`${Ii}/styles/v1/${i}/sprite?access_token=${t}`}function Di(e,t){const r=Ni(e);if(!r)return decodeURI(new URL(e,location.href).href);const n="styles/";if(0!==r.indexOf(n))throw new Error(`unexpected style url: ${e}`);const o=r.slice(n.length);return`${Ii}/styles/v1/${o}?&access_token=${t}`}const Ui=["a","b","c","d"];function Gi(e,t,r,n){const o=new URL(e,n||location.href),i=Ni(e);if(!i)return t?(o.searchParams.has(r)||o.searchParams.set(r,t),[decodeURI(o.href)]):[decodeURI(o.href)];if("mapbox.satellite"===i){const e=window.devicePixelRatio>=1.5?"@2x":"";return[`https://api.mapbox.com/v4/${i}/{z}/{x}/{y}${e}.webp?access_token=${t}`]}return Ui.map(e=>`https://${e}.tiles.mapbox.com/v4/${i}/{z}/{x}/{y}.vector.pbf?access_token=${t}`)}const Ji=Object.freeze({}),Vi={},Wi={};let Ki=0;function Zi(e){return e.id||(e.id=Ki++),e.id}function Xi(e,t){return Zi(e)+"."+(0,Oi.v6)(t)}function Bi(e){let t=Vi[e.id];return t||(t={},Vi[Zi(e)]=t),t}function Hi(e){let t=Wi[e.id];return t||(t={},Wi[Zi(e)]=t),t}function Yi(e){return e*Math.PI/180}const Qi=function(){const e=[];for(let t=78271.51696402048;e.length<=24;t/=2)e.push(t);return e}();function ea(e,t){if("undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"undefined"!==typeof OffscreenCanvas)return new OffscreenCanvas(e,t);const r=document.createElement("canvas");return r.width=e,r.height=t,r}function ta(e,t){let r=0;const n=t.length;for(;r<n;++r){const o=t[r];if(o<e&&r+1<n){const n=t[r]/t[r+1];return r+Math.log(t[r]/e)/Math.log(n)}}return n-1}function ra(e,t){const r=Math.floor(e),n=Math.pow(2,e-r);return t[r]/n}const na={};function oa(e,t,r={},n){if(t in na)return n&&(n.url=na[t][0].url),na[t][1];const o=r.transformRequest&&r.transformRequest(t,e)||t,i=function(e){return delete na[t],Promise.reject(new Error("Error fetching source "+t))},a=function(e){return delete na[t],e.ok?e.json():Promise.reject(new Error("Error fetching source "+t))},s=(0,zi.hq)(()=>o).then(e=>e instanceof Response?(n&&(n.url=e.url),a(e)):(e instanceof Request||(e=new Request(e)),e.headers.get("Accept")||e.headers.set("Accept","application/json"),n&&(n.url=e.url),fetch(e).then(a).catch(i))).catch(i);return na[t]=[o,s],s}function ia(e,t){if("string"!==typeof e)return Promise.resolve(e);if(!e.trim().startsWith("{"))return e=Di(e,t.accessToken),oa("Style",e,t);try{const t=JSON.parse(e);return Promise.resolve(t)}catch(Nn){return Promise.reject(Nn)}}const aa={};function sa(e,t,r={}){const n=[t,JSON.stringify(e)].toString();let o=aa[n];if(!o||r.transformRequest){let i;r.transformRequest&&(i=(e,t)=>{const n=r.transformRequest&&r.transformRequest(t,"Tiles")||t;if(e instanceof Fi.A)e.setLoader((t,r,o)=>{const i=function(r){r.arrayBuffer().then(r=>{const n=e.getFormat(),i=n.readFeatures(r,{extent:t,featureProjection:o});e.setFeatures(i)})};(0,zi.hq)(()=>n).then(t=>{if(t instanceof Response)return i(t);fetch(t).then(i).catch(t=>e.setState(Pi.A.ERROR))}).catch(t=>e.setState(Pi.A.ERROR))});else{const t=e.getImage();(0,zi.hq)(()=>n).then(r=>{if("string"===typeof r)return void(t.src=r);const n=e=>e.blob().then(e=>{const r=URL.createObjectURL(e);t.addEventListener("load",()=>URL.revokeObjectURL(r)),t.addEventListener("error",()=>URL.revokeObjectURL(r)),t.src=r});if(r instanceof Response)return n(r);fetch(r).then(n).catch(t=>e.setState(Pi.A.ERROR))}).catch(t=>e.setState(Pi.A.ERROR))}});const a=e.url;if(a&&!e.tiles){const n=Gi(a,r.accessToken,r.accessTokenParam||"access_token",t||location.href);if(a.startsWith("mapbox://"))o=Promise.resolve({tileJson:Object.assign({},e,{url:void 0,tiles:n}),tileLoadFunction:i});else{const e={};o=oa("Source",n[0],r,e).then(function(t){return t.tiles=t.tiles.map(function(n){return"tms"===t.scheme&&(n=n.replace("{y}","{-y}")),Gi(n,r.accessToken,r.accessTokenParam||"access_token",e.url)[0]}),Promise.resolve({tileJson:t,tileLoadFunction:i})})}}else e.tiles?(e=Object.assign({},e,{tiles:e.tiles.map(function(n){return"tms"===e.scheme&&(n=n.replace("{y}","{-y}")),Gi(n,r.accessToken,r.accessTokenParam||"access_token",t||location.href)[0]})}),o=Promise.resolve({tileJson:Object.assign({},e),tileLoadFunction:i})):o=Promise.reject(new Error("source has no `tiles` nor `url`"));aa[n]=o}return o}function la(e,t,r,n){const o=[2*r*t.pixelRatio+t.width,2*r*t.pixelRatio+t.height],i=ea(o[0],o[1]),a=i.getContext("2d");a.drawImage(e,t.x,t.y,t.width,t.height,r*t.pixelRatio,r*t.pixelRatio,t.width,t.height);const s=a.getImageData(0,0,o[0],o[1]);a.globalCompositeOperation="destination-over",a.fillStyle=`rgba(${255*n.r},${255*n.g},${255*n.b},${n.a})`;const l=s.data;for(let u=0,c=s.width;u<c;++u)for(let e=0,n=s.height;e<n;++e){const n=4*(e*c+u),o=l[n+3];o>0&&a.arc(u,e,r*t.pixelRatio,0,2*Math.PI)}return a.fill(),i}function ua(e,t,r){const n=Math.max(0,Math.min(1,(r-e)/(t-e)));return n*n*(3-2*n)}function ca(e,t,r){const n=ea(t.width,t.height),o=n.getContext("2d");o.drawImage(e,t.x,t.y,t.width,t.height,0,0,t.width,t.height);const i=o.getImageData(0,0,t.width,t.height),a=i.data;for(let s=0,l=i.width;s<l;++s)for(let e=0,t=i.height;e<t;++e){const t=4*(e*l+s),n=a[t+3]/255,o=.75,i=.1,u=ua(o-i,o+i,n);u>0?(a[t+0]=Math.round(255*r.r*u),a[t+1]=Math.round(255*r.g*u),a[t+2]=Math.round(255*r.b*u),a[t+3]=Math.round(255*u)):a[t+3]=0}return o.putImageData(i,0,0),n}const pa=Array(256).join("");function fa(e,t){if(t>=.05){let r="";const n=e.split("\n"),o=pa.slice(0,Math.round(t/.1));for(let e=0,t=n.length;e<t;++e)e>0&&(r+="\n"),r+=n[e].split("").join(o);return r}return e}let da;function ya(){return da||(da=ea(1,1).getContext("2d")),da}function ha(e,t){return ya().measureText(e).width+(e.length-1)*t}const ma={};function ga(e,t,r,n){if(-1!==e.indexOf("\n")){const o=e.split("\n"),i=[];for(let e=0,a=o.length;e<a;++e)i.push(ga(o[e],t,r,n));return i.join("\n")}const o=r+","+t+","+e+","+n;let i=ma[o];if(!i){const a=e.split(" ");if(a.length>1){const e=ya();e.font=t;const o=e.measureText("M").width,s=o*r;let l="";const u=[];for(let t=0,r=a.length;t<r;++t){const e=a[t],r=l+(l?" ":"")+e;ha(r,n)<=s?l=r:(l&&u.push(l),l=e)}l&&u.push(l);for(let t=0,r=u.length;t<r&&r>1;++t){const e=u[t];if(ha(e,n)<.35*s){const o=t>0?ha(u[t-1],n):1/0,i=t<r-1?ha(u[t+1],n):1/0;u.splice(t,1),r-=1,o<i?(u[t-1]+=" "+e,t-=1):u[t]=e+" "+u[t]}}for(let t=0,r=u.length-1;t<r;++t){const e=u[t],o=u[t+1];if(ha(e,n)>.7*s&&ha(o,n)<.6*s){const i=e.split(" "),a=i.pop();ha(a,n)<.2*s&&(u[t]=i.join(" "),u[t+1]=a+" "+o),r-=1}}i=u.join("\n")}else i=e;i=fa(i,n),ma[o]=i}return i}Ti.yY.on("propertychange",()=>{for(const e in ma)delete ma[e]});const va=["Arial","Courier New","Times New Roman","Verdana","sans-serif","serif","monospace","cursive","fantasy"],ba={};function xa(e,t="https://cdn.jsdelivr.net/npm/@fontsource/{font-family}/{fontweight}{-fontstyle}.css"){let r;for(let n=0,o=e.length;n<o;++n){const t=e[n];if(t in ba)continue;ba[t]=!0;const o=wi(t,16),i=o.split(" ");r||(r=[]),r.push([i.slice(3).join(" ").replace(/"/g,""),i[1],i[0]])}return r?((async()=>{await document.fonts.ready;for(let e=0,n=r.length;e<n;++e){const n=r[e],o=n[0];if(va.includes(o))continue;const i=n[1],a=n[2],s=await document.fonts.load(`${a} ${i} 16px "${o}"`);if(!s.some(e=>e.family.replace(/^['"]|['"]$/g,"").toLowerCase()===o.toLowerCase()&&e.weight==i&&e.style===a)){const e=t.replace("{font-family}",o.replace(/ /g,"-").toLowerCase()).replace("{Font+Family}",o.replace(/ /g,"+")).replace("{fontweight}",i).replace("{-fontstyle}",a.replace("normal","").replace(/(.+)/,"-$1")).replace("{fontstyle}",a);if(!document.querySelector('link[href="'+e+'"]')){const t=document.createElement("link");t.href=e,t.rel="stylesheet",document.head.appendChild(t)}}}})(),e):e}const wa={Point:1,MultiPoint:1,LineString:2,MultiLineString:2,Polygon:3,MultiPolygon:3},ka={center:[.5,.5],left:[0,.5],right:[1,.5],top:[.5,0],bottom:[.5,1],"top-left":[0,0],"top-right":[1,0],"bottom-left":[0,1],"bottom-right":[1,1]},Sa=function(e,t){const r=Xn(e,t);if("error"===r.result)throw new Error(r.value.map(e=>`${e.key}: ${e.message}`).join(", "));return r.value},$a={zoom:0,distanceFromCenter:0};let za,Aa;function ja(e,t,r,n,o,i){const a=e.id;o||(o={},console.warn("No functionCache provided to getValue()")),o[a]||(o[a]={});const s=o[a];if(!s[r]){let n=(e[t]||Ji)[r];const o=mi[`${t}_${e.type}`][r];void 0===n&&(n=o.default);let i=Vn(n);if(!i&&Gn(n)&&(n=fo(n,o),i=!0),i){const e=Sa(n,o);s[r]=e.evaluate.bind(e)}else"color"==o.type&&(n=Xe.parse(n)),s[r]=function(){return n}}return s[r]($a,n,i)}function Ma(e,t,r,n){const o=ja(e,"layout",`${r}-allow-overlap`,t,n);if(!o)return"declutter";const i=ja(e,"layout",`${r}-ignore-placement`,t,n);return i?"none":"obstacle"}function Ea(e,t,r,n){if(n||console.warn("No filterCache provided to evaluateFilter()"),!(e in n))try{n[e]=ro(t).filter}catch(o){console.warn("Filter will evaluate to false: "+o.message),n[e]=function(){return!1}}return n[e]($a,r)}An.register(zn,{...An.definitions,pitch:[{kind:"number"},[],e=>$a.pitch||90],"distance-from-center":[{kind:"number"},[],e=>$a.distanceFromCenter||0]});let _a=!1;function Ca(e,t){if(e){if(!_a&&(0===e.a||0===t))return;const r=e.a;return t=void 0===t?1:t,0===r?"transparent":"rgba("+Math.round(255*e.r/r)+","+Math.round(255*e.g/r)+","+Math.round(255*e.b/r)+","+r*t+")"}return e}const qa=/\{[^{}}]*\}/g;function Ta(e,t){return e.replace(qa,function(e){return t[e.slice(1,-1)]||""})}function Fa(e,t){let r=e.split(":")[0];return r===e&&(r="default"),t[r]}let Pa=!1;const Oa={};function Ia(e,t,r,n=Qi,o=void 0,i=void 0,a=void 0,s=void 0){if("string"==typeof t&&(t=JSON.parse(t)),8!=t.version)throw new Error("glStyle version 8 required.");Oa[Xi(t,e)]=Array.from(arguments);const l={};("string"===typeof i||i instanceof Request||i instanceof Response||i instanceof Promise)&&(i={default:i});for(const w in i){const t=i[w];(0,zi.hq)(()=>t).then(async t=>{let r;if("undefined"!==typeof Image){const n=new Image;if("string"===typeof t)n.crossOrigin="anonymous",n.src=t;else{let e;t instanceof Request?e=await fetch(t):t instanceof Response&&(e=t);const o=await e.blob();r=URL.createObjectURL(o),n.src=r}n.addEventListener("load",function t(){n.removeEventListener("load",t),l[w]={image:n,size:[n.width,n.height]},e.changed(),r&&URL.revokeObjectURL(r)}),n.addEventListener("error",function e(){URL.revokeObjectURL(r),n.removeEventListener("error",e)})}else if("undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope){const e=self;e.postMessage({action:"loadImage",src:t}),e.addEventListener("message",function(e){"imageLoaded"===e.data.action&&e.data.src===t&&(l[w]={image:e.data.image,size:[e.data.image.width,e.data.image.height]})})}})}const u=W(t.layers),c={},p=[],f={},d={},y=Bi(t),h=Hi(t);let m;for(let w=0,k=u.length;w<k;++w){const e=u[w],n=e.id;if("string"==typeof r&&e.source==r||Array.isArray(r)&&-1!==r.indexOf(n)){const r=e["source-layer"];if(m){if(e.source!==m)throw new Error(`Layer "${n}" does not use source "${m}`)}else{m=e.source;const r=t.sources[m];if(!r)throw new Error(`Source "${m}" is not defined`);const n=r.type;if("vector"!==n&&"geojson"!==n)throw new Error(`Source "${m}" is not of type "vector" or "geojson", but "${n}"`)}let o=c[r];o||(o=[],c[r]=o),o.push({layer:e,index:w}),p.push(n)}}const g=new _i.A,v=new Mi.A,b=[],x=function(r,i,u){const p=r.getProperties(),m=c[p["mvt:layer"]];if(!m)return;let x=n.indexOf(i);-1==x&&(x=ta(i,n)),$a.zoom=x,$a.distanceFromCenter=0;const w=r.getGeometry(),k=wa[w.getType()],S=e.get("map");if(S&&S instanceof ki.A&&1===k){const e=S.getSize();if(e){const t=S.getView().getCenter(),r=(0,$i.q1)(w.getExtent());$a.distanceFromCenter=(0,Si.Io)(t,r)/i/e[1]}}const $={id:r.getId(),properties:p,type:k},z=e.get("mapbox-featurestate")[r.getId()];let A,j=-1;for(let n=0,c=m.length;n<c;++n){const c=m[n],w=c.layer,S=w.id;if(void 0!==u&&u!==S)continue;const M=w.layout||Ji,E=w.paint||Ji;if("none"===M.visibility||"minzoom"in w&&x<w.minzoom||"maxzoom"in w&&x>=w.maxzoom)continue;const _=w.filter;if(!_||Ea(S,_,$,h)){let n,u,h,m,x,S;A=w;const _=c.index;if(3==k&&("fill"==w.type||"fill-extrusion"==w.type))if(u=ja(w,"paint",w.type+"-opacity",$,y,z),w.type+"-pattern"in E){const e=ja(w,"paint",w.type+"-pattern",$,y,z);if(e){const t="string"===typeof e?Ta(e,p):e.toString(),r=Fa(t,l);if(o&&o[t]&&r){++j,S=b[j],S&&S.getFill()&&!S.getStroke()&&!S.getText()||(S=new Ci.Ay({fill:new Mi.A}),b[j]=S),h=S.getFill(),S.setZIndex(_);const e=t+"."+u;let n=d[e];if(!n){const i=o[t],a=ea(i.width,i.height),s=a.getContext("2d");s.globalAlpha=u,s.drawImage(r.image,i.x,i.y,i.width,i.height,0,0,i.width,i.height),n=s.createPattern(a,"repeat"),d[e]=n}h.setColor(n)}}}else n=Ca(ja(w,"paint",w.type+"-color",$,y,z),u),w.type+"-outline-color"in E&&(x=Ca(ja(w,"paint",w.type+"-outline-color",$,y,z),u)),x||(x=n),(n||x)&&(++j,S=b[j],(!S||n&&!S.getFill()||!n&&S.getFill()||x&&!S.getStroke()||!x&&S.getStroke()||S.getText())&&(S=new Ci.Ay({fill:n?new Mi.A:void 0,stroke:x?new _i.A:void 0}),b[j]=S),n&&(h=S.getFill(),h.setColor(n)),x&&(m=S.getStroke(),m.setColor(x),m.setWidth(.5)),S.setZIndex(_));if(1!=k&&"line"==w.type){n="line-pattern"in E?void 0:Ca(ja(w,"paint","line-color",$,y,z),ja(w,"paint","line-opacity",$,y,z));const e=ja(w,"paint","line-width",$,y,z);n&&e>0&&(++j,S=b[j],S&&S.getStroke()&&!S.getFill()&&!S.getText()||(S=new Ci.Ay({stroke:new _i.A}),b[j]=S),m=S.getStroke(),m.setLineCap(ja(w,"layout","line-cap",$,y,z)),m.setLineJoin(ja(w,"layout","line-join",$,y,z)),m.setMiterLimit(ja(w,"layout","line-miter-limit",$,y,z)),m.setColor(n),m.setWidth(e),m.setLineDash(E["line-dasharray"]?ja(w,"paint","line-dasharray",$,y,z).map(function(t){return t*e}):null),S.setZIndex(_))}let C,q,T,F,P,O,I,N,R,L=!1,D=null,U=0;if((1==k||2==k)&&"icon-image"in M){const t=ja(w,"layout","icon-image",$,y,z);if(t){let n;C="string"===typeof t?Ta(t,p):t.toString();const a=s?s(e,C):void 0,u=Fa(C,l);if(o&&o[C]&&u||a){const e=ja(w,"layout","icon-rotation-alignment",$,y,z);if(2==k){const t=r.getGeometry();if(t.getFlatMidpoint||t.getFlatMidpoints){const r=t.getExtent(),o=Math.sqrt(Math.max(Math.pow((r[2]-r[0])/i,2),Math.pow((r[3]-r[1])/i,2)));if(o>150){const r="MultiLineString"===t.getType()?t.getFlatMidpoints():t.getFlatMidpoint();Aa||(za=[NaN,NaN],Aa=new Ai.Ay("Point",za,[],2,{},void 0)),n=Aa,za[0]=r[0],za[1]=r[1];const o=ja(w,"layout","symbol-placement",$,y,z);if("line"===o&&"map"===e){const e=t.getStride(),n=t.getFlatCoordinates();for(let t=0,o=n.length-e;t<o;t+=e){const o=n[t],i=n[t+1],a=n[t+e],s=n[t+e+1],l=Math.min(o,a),u=Math.max(o,a),c=r[0],p=r[1],f=(s-i)*(c-o)-(a-o)*(p-i);if(Math.abs(f)<.001&&c<=u&&c>=l){U=Math.atan2(i-s,a-o);break}}}}}}if(2!==k||n){const t=ja(w,"layout","icon-size",$,y,z),r=void 0!==E["icon-color"]?ja(w,"paint","icon-color",$,y,z):null;if(!r||0!==r.a){const n=ja(w,"paint","icon-halo-color",$,y,z),i=ja(w,"paint","icon-halo-width",$,y,z);let s=`${C}.${t}.${i}.${n}`;if(null!==r&&(s+=`.${r}`),q=f[s],!q){const l=Ma(w,$,"icon",y);let c;"icon-offset"in M&&(c=ja(w,"layout","icon-offset",$,y,z).slice(0),c[0]*=t,c[1]*=-t);let p=r?[255*r.r,255*r.g,255*r.b,r.a]:void 0;if(a){const r={color:p,rotateWithView:"map"===e,displacement:c,declutterMode:l,scale:t};"string"===typeof a?r.src=a:(r.img=a,r.imgSize=[a.width,a.height]),q=new Ei.A(r)}else{const a=o[C];let s,f,d;if(i)a.sdf?(s=la(ca(u.image,a,r||[0,0,0,1]),{x:0,y:0,width:a.width,height:a.height,pixelRatio:a.pixelRatio},i,n),p=void 0):s=la(u.image,a,i,n);else{if(a.sdf&&!u.unSDFed){const e=ca(u.image,{x:0,y:0,width:u.size[0],height:u.size[1]},{r:1,g:1,b:1,a:1});u.image=e,u.unSDFed=!0}s=u.image,f=[a.width,a.height],d=[a.x,a.y]}q=new Ei.A({color:p,img:s,imgSize:u.size,size:f,offset:d,rotateWithView:"map"===e,scale:t/a.pixelRatio,displacement:c,declutterMode:l})}f[s]=q}}q&&(++j,S=b[j],S&&S.getImage()&&!S.getFill()&&!S.getStroke()||(S=new Ci.Ay,b[j]=S),S.setGeometry(n),q.setRotation(U+Yi(ja(w,"layout","icon-rotate",$,y,z))),q.setOpacity(ja(w,"paint","icon-opacity",$,y,z)),q.setAnchor(ka[ja(w,"layout","icon-anchor",$,y,z)]),S.setImage(q),D=S.getText(),S.setText(void 0),S.setZIndex(_),L=!0,T=!1)}else T=!0}}}if(1==k&&"circle"===w.type){++j,S=b[j],S&&S.getImage()&&!S.getFill()&&!S.getStroke()||(S=new Ci.Ay,b[j]=S);const e="circle-radius"in E?ja(w,"paint","circle-radius",$,y,z):5,t=Ca(ja(w,"paint","circle-stroke-color",$,y,z),ja(w,"paint","circle-stroke-opacity",$,y,z)),r=ja(w,"paint","circle-translate",$,y,z),n=Ca(ja(w,"paint","circle-color",$,y,z),ja(w,"paint","circle-opacity",$,y,z)),o=ja(w,"paint","circle-stroke-width",$,y,z),i=e+"."+t+"."+n+"."+o+"."+r[0]+"."+r[1];q=f[i],q||(q=new ji.A({radius:e,displacement:[r[0],-r[1]],stroke:t&&o>0?new _i.A({width:o,color:t}):void 0,fill:n?new Mi.A({color:n}):void 0,declutterMode:"none"}),f[i]=q),S.setImage(q),D=S.getText(),S.setText(void 0),S.setGeometry(void 0),S.setZIndex(_),L=!0}if("text-field"in M){I=Math.round(ja(w,"layout","text-size",$,y,z));const e=ja(w,"layout","text-font",$,y,z);O=ja(w,"layout","text-line-height",$,y,z),P=wi(a?a(e,t.metadata?t.metadata["ol:webfonts"]:void 0):e,I,O),P.includes("sans-serif")||(P+=",sans-serif"),N=ja(w,"layout","text-letter-spacing",$,y,z),R=ja(w,"layout","text-max-width",$,y,z);const r=ja(w,"layout","text-field",$,y,z);F="object"===typeof r&&r.sections?1===r.sections.length?r.toString():r.sections.reduce((t,r,n)=>{const o=r.fontStack?r.fontStack.split(","):e,i=wi(a?a(o):o,I*(r.scale||1),O);let s=r.text;if("\n"===s)return t.push("\n",""),t;if(2==k)return t.push(fa(s,N),i),t;s=ga(s,i,R,N).split("\n");for(let e=0,a=s.length;e<a;++e)e>0&&t.push("\n",""),t.push(s[e],i);return t},[]):Ta(r,p).trim(),u=ja(w,"paint","text-opacity",$,y,z)}if(F&&u&&!T){L||(++j,S=b[j],S&&S.getText()&&!S.getFill()&&!S.getStroke()||(S=new Ci.Ay,b[j]=S),S.setImage(void 0),S.setGeometry(void 0));const e=Ma(w,$,"text",y);S.getText()||S.setText(D),D=S.getText(),(!D||"getDeclutterMode"in D&&D.getDeclutterMode()!==e)&&(D=new qi.A({padding:[2,2,2,2],declutterMode:e}),S.setText(D));const t=ja(w,"layout","text-transform",$,y,z);"uppercase"==t?F=Array.isArray(F)?F.map((e,t)=>t%2?e:e.toUpperCase()):F.toUpperCase():"lowercase"==t&&(F=Array.isArray(F)?F.map((e,t)=>t%2?e:e.toLowerCase()):F.toLowerCase());const r=Array.isArray(F)?F:2==k?fa(F,N):ga(F,P,R,N);if(D.setText(r),D.setFont(P),D.setRotation(Yi(ja(w,"layout","text-rotate",$,y,z))),"function"===typeof D.setKeepUpright){const e=ja(w,"layout","text-keep-upright",$,y,z);D.setKeepUpright(e)}const n=ja(w,"layout","text-anchor",$,y,z),o=L||1==k?"point":ja(w,"layout","symbol-placement",$,y,z);let i;if("line-center"===o?(D.setPlacement("line"),i="center"):D.setPlacement(o),"line"===o&&"function"===typeof D.setRepeat){const e=ja(w,"layout","symbol-spacing",$,y,z);D.setRepeat(2*e)}D.setOverflow("point"===o);let a=ja(w,"paint","text-halo-width",$,y,z);const s=ja(w,"layout","text-offset",$,y,z),l=ja(w,"paint","text-translate",$,y,z);let c=0,p=0;if("point"==o){i="center",-1!==n.indexOf("left")?(i="left",p=a):-1!==n.indexOf("right")&&(i="right",p=-a);const e=ja(w,"layout","text-rotation-alignment",$,y,z);D.setRotateWithView("map"==e)}else D.setMaxAngle(Yi(ja(w,"layout","text-max-angle",$,y,z))*F.length/r.length),D.setRotateWithView(!1);D.setTextAlign(i);let f="middle";0==n.indexOf("bottom")?(f="bottom",c=-a-.5*(O-1)*I):0==n.indexOf("top")&&(f="top",c=a+.5*(O-1)*I),D.setTextBaseline(f);const d=ja(w,"layout","text-justify",$,y,z);D.setJustify("auto"===d?void 0:d),D.setOffsetX(s[0]*I+p+l[0]),D.setOffsetY(s[1]*I+c+l[1]),v.setColor(Ca(ja(w,"paint","text-color",$,y,z),u)),D.setFill(v);const h=Ca(ja(w,"paint","text-halo-color",$,y,z),u);if(h&&a>0){g.setColor(h),a*=2;const e=.5*I;g.setWidth(a<=e?a:e),D.setStroke(g)}else D.setStroke(void 0);const m=ja(w,"layout","text-padding",$,y,z),x=D.getPadding();m!==x[0]&&(x[0]=m,x[1]=m,x[2]=m,x[3]=m),S.setZIndex(_)}}}return j>-1?(b.length=j+1,Pa&&("set"in r?r.set("mapbox-layer",A):r.getProperties()["mapbox-layer"]=A),b):void 0};return e.setStyle(x),e.set("mapbox-layers",p),e.set("mapbox-source",m),e.set("mapbox-featurestate",e.get("mapbox-featurestate")||{}),x}var Na=r(58694),Ra=r(73354),La=r(60032),Da=(r(35598),r(53820)),Ua=r(60764),Ga=r(30945),Ja=r(82986),Va=r(65544),Wa=r(60942),Ka=r(8100),Za=r(38599),Xa=r(90024),Ba=r(16444),Ha=r(19551),Ya=r(42457),Qa=r(75522),es=r(56758),ts=r(4863);function rs(e,t){const r=e[0],n=r.width,o=r.height,i=r.data,a=new Uint8ClampedArray(i.length),s=2*t.resolution,l=n-1,u=o-1,c=[0,0,0,0],p=2*Math.PI,f=Math.PI/2,d=Math.PI*t.sunEl/180,y=Math.PI*t.sunAz/180,h=Math.cos(d),m=Math.sin(d),g=t.highlightColor,v=t.shadowColor,b=t.accentColor,x=t.encoding;let w,k,S,$,z,A,j,M,E,_,C,q,T,F,P,O,I,N,R,L,D,U;function G(e,t="mapbox"){return"mapbox"===t?.1*(256*e[0]*256+256*e[1]+e[2])-1e4:"terrarium"===t?256*e[0]+e[1]+e[2]/256-32768:void 0}for(k=0;k<=u;++k)for(z=0===k?0:k-1,A=k===u?u:k+1,w=0;w<=l;++w)S=0===w?0:w-1,$=w===l?l:w+1,j=4*(k*n+S),c[0]=i[j],c[1]=i[j+1],c[2]=i[j+2],c[3]=i[j+3],M=t.vert*G(c,x),j=4*(k*n+$),c[0]=i[j],c[1]=i[j+1],c[2]=i[j+2],c[3]=i[j+3],E=t.vert*G(c,x),_=(E-M)/s,j=4*(z*n+w),c[0]=i[j],c[1]=i[j+1],c[2]=i[j+2],c[3]=i[j+3],M=t.vert*G(c,x),j=4*(A*n+w),c[0]=i[j],c[1]=i[j+1],c[2]=i[j+2],c[3]=i[j+3],E=t.vert*G(c,x),C=(E-M)/s,T=Math.atan2(C,-_),T=T<0?f-T:T>f?p-T+f:f-T,q=Math.atan(Math.sqrt(_*_+C*C)),U=m*Math.cos(q)+h*Math.sin(q)*Math.cos(y-T),F=Math.cos(q),P=255*U,R=Math.min(Math.max(2*t.sunEl,0),1),L=1.875-1.75*t.opacity,D=.5!==t.opacity?f*((Math.pow(L,q)-1)/(Math.pow(L,f)-1)):q,I={r:(1-F)*b.r*R*255,g:(1-F)*b.g*R*255,b:(1-F)*b.b*R*255,a:(1-F)*b.a*R*255},O=Math.abs(((T+y)/Math.PI+.5)%2-1),N={r:(g.r*(1-O)+v.r*O)*P,g:(g.g*(1-O)+v.g*O)*P,b:(g.b*(1-O)+v.b*O)*P,a:(g.a*(1-O)+v.a*O)*P},j=4*(k*n+w),a[j]=I.r*(1-O)+N.r,a[j+1]=I.g*(1-O)+N.g,a[j+2]=I.b*(1-O)+N.b,a[j+3]=i[j+3]*t.opacity*R*Math.sin(D);return new ImageData(a,n,o)}function ns(e,t=512){return e.getExtent()?(0,ts.EN)({extent:e.getExtent(),tileSize:t,maxZoom:22}).getResolutions():Qi}function os(e,t){if(!t.accessToken){t=Object.assign({},t);const r=new URL(e).searchParams;r.forEach((e,r)=>{t.accessToken=e,t.accessTokenParam=r})}return t}function is(e,t,r="",n={},o=void 0){let i,a,s,l,u=!0;return"string"===typeof r||Array.isArray(r)?l=r:(s=r,l=s.source||s.layers,n=s),"string"===typeof n?(i=n,s={}):(i=n.styleUrl,s=n),!1===s.updateSource&&(u=!1),o||(o=s.resolutions),i||"string"!==typeof t||t.trim().startsWith("{")||(i=t),i&&(i=i.startsWith("data:")?location.href:Di(i,s.accessToken),s=os(i,s)),new Promise(function(r,n){ia(t,s).then(function(t){if(8!=t.version)return n(new Error("glStyle version 8 required."));if(!(e instanceof Ja["default"]||e instanceof Va["default"]))return n(new Error("Can only apply to VectorLayer or VectorTileLayer"));const c=e instanceof Va["default"]?"vector":"geojson";if(l?a=Array.isArray(l)?t.layers.find(function(e){return e.id===l[0]}).source:l:(a=t.layers.find(function(e){return e.source&&t.sources[e.source].type===c}).source,l=a),!a)return n(new Error(`No ${c} source found in the glStyle.`));function p(){if(!u)return Promise.resolve();if(e instanceof Va["default"])return ps(t.sources[a],i,s).then(function(t){const r=e.getSource();r?t!==r&&(r.setTileUrlFunction(t.getTileUrlFunction()),"function"===typeof r.setUrls&&"function"===typeof t.getUrls&&r.setUrls(t.getUrls()),r.format_||(r.format_=t.format_),r.getAttributions()||r.setAttributions(t.getAttributions()),r.getTileLoadFunction()===Qa.defaultLoadFunction&&r.setTileLoadFunction(t.getTileLoadFunction()),(0,Za.tI)(r.getProjection(),t.getProjection())&&(r.tileGrid=t.getTileGrid())):e.setSource(t);const n=e.getSource().getTileGrid();!isFinite(e.getMaxResolution())&&!isFinite(e.getMinZoom())&&n.getMinZoom()>0&&e.setMaxResolution(ra(Math.max(0,n.getMinZoom()-1e-12),n.getResolutions()))});const r=t.sources[a];let n=e.getSource();n&&n.get("mapbox-source")===r||(n=gs(r,i,s));const o=e.getSource();return o?n!==o&&(o.getAttributions()||o.setAttributions(n.getAttributions()),o.format_||(o.format_=n.getFormat()),o.url_=n.getUrl()):e.setSource(n),Promise.resolve()}let f,d;const y={},h={};function m(){if(d||t.sprite&&!y)d?(e.setStyle(d),p().then(r).catch(n)):n(new Error("Something went wrong trying to apply style."));else{if(s.projection&&!o){const e=(0,Za.Jt)(s.projection),t=e.getUnits();"m"!==t&&(o=Qi.map(e=>e/Ka.I[t]))}d=Ia(e,t,l,o,y,h,(e,t=s.webfonts)=>xa(e,t),s.getImage),e.getStyle()?p().then(r).catch(n):n(new Error(`Nothing to show for source [${a}]`))}}if(t.sprite){const e=Ri(t.sprite,s.accessToken,i||location.href);f=window.devicePixelRatio>=1.5?.5:1;const r=.5==f?"@2x":"";Promise.all(e.map(function(e){const t=new URL(e.url);let o=t.origin+t.pathname+r+".json"+t.search;return new Promise(function(e,r){oa("Sprite",o,s).then(e).catch(function(n){o=t.origin+t.pathname+".json"+t.search,oa("Sprite",o,s).then(e).catch(r)})}).then(function(o){let i;if(void 0===o&&n(new Error("No sprites found.")),i=t.origin+t.pathname+r+".png"+t.search,s.transformRequest){const e=s.transformRequest(i,"SpriteImage")||i;(e instanceof Request||e instanceof Promise)&&(i=e)}h[e.id]=i;for(const t in o){const r="default"==e.id?t:`${e.id}:${t}`;y[r]=o[t]}}).catch(function(e){n(new Error(`Sprites cannot be loaded: ${o}: ${e.message}`))})})).then(m).catch(n)}else m()}).catch(n)})}function as(e,t){let r;return e.some(function(e){if(e.id==t)return r=e.source,!0}),r}function ss(e,t){const r=e.bounds;if(r){const e=(0,Za.Rb)([r[0],r[1]],t),n=(0,Za.Rb)([r[2],r[3]],t);return[e[0],e[1],n[0],n[1]]}return(0,Za.Jt)(t).getExtent()}function ls(e,t,r){const n=new Ha["default"]({tileJSON:t,tileSize:e.tileSize||t.tileSize||512}),o=n.getTileJSON(),i=n.getTileGrid(),a=(0,Za.Jt)(r.projection||"EPSG:3857"),s=ss(o,a),l=a.getExtent(),u=o.minzoom||0,c=o.maxzoom||22,p={attributions:n.getAttributions(),projection:a,tileGrid:new es.A({origin:l?(0,$i.Py)(l):i.getOrigin(0),extent:s||i.getExtent(),minZoom:u,resolutions:ns(a,t.tileSize).slice(0,c+1),tileSize:i.getTileSize(0)})};return Array.isArray(o.tiles)?p.urls=o.tiles:p.url=o.tiles,p}function us(e,t,r,n){const o={id:e.id,type:e.type},i=e.layout||{},a=e.paint||{};let s;o["paint"]=a,$a.zoom=ta(t,r.resolutions||Qi),$a.distanceFromCenter=0;const l=ja(o,"paint","background-color",Ji,n);return void 0!==a["background-opacity"]&&(s=ja(o,"paint","background-opacity",Ji,n)),"none"==i.visibility?void 0:Ca(l,s)}function cs(e,t,r){const n=document.createElement("div");return n.className="ol-mapbox-style-background",n.style.position="absolute",n.style.width="100%",n.style.height="100%",new Ua["default"]({source:new Ba["default"]({}),render(o){const i=us(e,o.viewState.resolution,t,r);return n.style.backgroundColor=i,n}})}function ps(e,t,r){return new Promise(function(n,o){sa(e,t,r).then(function({tileJson:t,tileLoadFunction:o}){const i=ls(e,t,r);i.tileLoadFunction=o,i.format=new La.A({layerName:"mvt:layer"});const a=new Qa["default"](i);a.set("mapbox-source",e),n(a)}).catch(o)})}function fs(e,t,r){const n=new Va["default"]({declutter:!0,visible:!1});return ps(e,t,r).then(function(e){n.setSource(e)}).catch(function(e){n.setSource(void 0)}),n}function ds(e){const t=e?e.getCode():"EPSG:3857";return`{bbox-${t.toLowerCase().replace(/[^a-z0-9]/g,"-")}}`}function ys(e,t,r){return new Promise(function(n,o){sa(e,t,r).then(function({tileJson:t,tileLoadFunction:o}){const i=new Ha["default"]({interpolate:void 0===r.interpolate||r.interpolate,transition:0,crossOrigin:"anonymous",tileJSON:t});i.tileGrid=ls(e,t,r).tileGrid,r.projection&&(i.projection=(0,Za.Jt)(r.projection));const a=i.getTileUrlFunction();o&&i.setTileLoadFunction(o),i.setTileUrlFunction(function(e,t,r){const n=ds(r);let o=a(e,t,r);if(-1!=o.indexOf(n)){const t=i.getTileGrid().getTileCoordExtent(e);o=o.replace(n,t.toString())}return o}),i.set("mapbox-source",e),n(i)}).catch(function(e){o(e)})})}function hs(e,t,r){const n=new Ga["default"];return ys(e,t,r).then(function(e){n.setSource(e)}).catch(function(){n.setSource(void 0)}),n}function ms(e,t,r){const n=hs(e,t,r),o=new Da["default"]({source:new Xa["default"]({operationType:"image",operation:rs,sources:[n]})});return o}function gs(e,t,r){const n=r.projection?new Ra.A({dataProjection:r.projection}):new Ra.A,o=e.data,i={};if("string"==typeof o){const[i]=Gi(o,r.accessToken,r.accessTokenParam||"access_token",t||location.href);if(/\{bbox-[0-9a-z-]+\}/.test(i)){const t=(e,t,r)=>{const n=ds(r);return i.replace(n,`${e.join(",")}`)},o=new Ya["default"]({attributions:e.attribution,format:n,loader:(e,n,i,a,s)=>{const l="function"===typeof t?t(e,n,i):t;oa("GeoJSON",l,r).then(e=>{const t=o.getFormat().readFeatures(e,{featureProjection:i});o.addFeatures(t),a(t)}).catch(t=>{o.removeLoadedExtent(e),s()})},strategy:Wa.Qk});return o.set("mapbox-source",e),o}const a=new Ya["default"]({attributions:e.attribution,format:n,url:i,loader:(e,t,n,o,s)=>{oa("GeoJSON",i,r).then(e=>{const t=a.getFormat().readFeatures(e,{featureProjection:n});a.addFeatures(t),o(t)}).catch(t=>{a.removeLoadedExtent(e),s()})}});return a}i.features=n.readFeatures(o,{featureProjection:(0,Za.Tf)()||"EPSG:3857"});const a=new Ya["default"](Object.assign({attributions:e.attribution,format:n},i));return a.set("mapbox-source",e),a}function vs(e,t,r){return new Ja["default"]({declutter:!0,source:gs(e,t,r),visible:!1})}function bs(e,t,r){let n=null;return function(o){e.paint&&"raster-opacity"in e.paint&&o.frameState.viewState.zoom!==n&&(n=o.frameState.viewState.zoom,delete r[e.id],xs(e,t,n,r))}}function xs(e,t,r,n){$a.zoom=r,$a.distanceFromCenter=0;const o=ja(e,"paint","raster-opacity",Ji,n);t.setOpacity(o)}function ws(e,t){function r(){const r=t.get("mapbox-style");if(!r)return;const n=W(r.layers),o=e.get("mapbox-layers"),i=n.filter(function(e){return o.includes(e.id)}).some(function(e){return!e.layout||!e.layout.visibility||"visible"===e.layout.visibility});e.get("visible")!==i&&e.setVisible(i)}e.on("change",r),r()}function ks(e,t,r,n){const o=Bi(e),i=e.layers,a=r.type,s=r.source||as(i,r.ref),l=e.sources[s];let u;if("background"==a)u=cs(r,n,o);else if("vector"==l.type)u=fs(l,t,n);else if("raster"==l.type)u=hs(l,t,n),u.setVisible(!r.layout||"none"!==r.layout.visibility),u.on("prerender",bs(r,u,o));else if("geojson"==l.type)u=vs(l,t,n);else if("raster-dem"==l.type&&"hillshade"==r.type){const e=ms(l,t,n);u=e,e.getSource().on("beforeoperations",function(e){const t=e.data;t.resolution=(0,Za.hO)(n.projection||"EPSG:3857",e.resolution,(0,$i.q1)(e.extent),"m"),$a.zoom=ta(e.resolution,n.resolutions||Qi),$a.distanceFromCenter=0,t.encoding=l.encoding,t.vert=5*ja(r,"paint","hillshade-exaggeration",Ji,o),t.sunAz=ja(r,"paint","hillshade-illumination-direction",Ji,o),t.sunEl=35,t.opacity=.3,t.highlightColor=ja(r,"paint","hillshade-highlight-color",Ji,o),t.shadowColor=ja(r,"paint","hillshade-shadow-color",Ji,o),t.accentColor=ja(r,"paint","hillshade-accent-color",Ji,o)}),u.setVisible(!r.layout||"none"!==r.layout.visibility)}const c=s;return u&&u.set("mapbox-source",c),u}function Ss(e,t,r,n){const o=[];let i=null;if(t instanceof ki.A){if(i=t.getView(),!i.isDef()&&!i.getRotation()&&!i.getResolutions()){const e=n.projection?(0,Za.Jt)(n.projection):i.getProjection();i=new Na.Ay(Object.assign(i.getProperties(),{maxResolution:Qi[0]/Ka.I[e.getUnits()],projection:n.projection||i.getProjection()})),t.setView(i)}"center"in e&&!i.getCenter()&&i.setCenter((0,Za.Rb)(e.center,i.getProjection())),"zoom"in e&&void 0===i.getZoom()&&i.setResolution(Qi[0]/Ka.I[i.getProjection().getUnits()]/Math.pow(2,e.zoom)),i.getCenter()&&void 0!==i.getZoom()||i.fit(i.getProjection().getExtent(),{nearest:!0,size:t.getSize()})}t.set("mapbox-style",e),t.set("mapbox-metadata",{styleUrl:r,options:n});const a=e.layers;let s,l,u,c=[];for(let p=0,f=a.length;p<f;++p){const i=a[p],f=i.type;"heatmap"!=f?(u=i.source||as(a,i.ref),u&&u==l||(c.length&&(o.push(zs(s,c,e,r,t,n)),c=[]),s=ks(e,r,i,n),s instanceof Ja["default"]||s instanceof Va["default"]||(c=[]),l=s.get("mapbox-source")),c.push(i.id)):console.debug(`layers[${p}].type "${f}" not supported`)}return o.push(zs(s,c,e,r,t,n)),Promise.all(o)}function $s(e,t,r={}){let n,o;if(o="string"===typeof e||e instanceof HTMLElement?new ki.A({target:e}):e,"string"===typeof t){const e=t.startsWith("data:")?location.href:Di(t,r.accessToken);r=os(e,r),n=new Promise(function(n,i){ia(t,r).then(function(t){Ss(t,o,e,r).then(function(){n(o)}).catch(i)}).catch(function(e){i(new Error(`Could not load ${t}: ${e.message}`))})})}else n=new Promise(function(e,n){Ss(t,o,!r.styleUrl||r.styleUrl.startsWith("data:")?location.href:Di(r.styleUrl,r.accessToken),r).then(function(){e(o)}).catch(n)});return n}function zs(e,t,r,n,o,i={}){let a=24,s=0;const l=r.layers;for(let u=0,c=l.length;u<c;++u){const e=l[u];-1!==t.indexOf(e.id)&&(a=Math.min("minzoom"in e?e.minzoom:0,a),s=Math.max("maxzoom"in e?e.maxzoom:24,s))}return new Promise(function(l,u){const c=function(){const c=e.getSource();if(c&&"error"!==c.getState()){if("getTileGrid"in c){const t=c.getTileGrid();if(t){const r=t.getMinZoom();(a>0||r>0)&&e.setMaxResolution(Math.min(ra(Math.max(0,a-1e-12),Qi),ra(Math.max(0,r-1e-12),t.getResolutions()))),s<24&&e.setMinResolution(ra(s,Qi))}}else a>0&&e.setMaxResolution(ra(Math.max(0,a-1e-12),Qi));c instanceof Ya["default"]||c instanceof Qa["default"]?is(e,r,t,Object.assign({styleUrl:n},i)).then(function(){ws(e,o),l()}).catch(u):l()}else u(new Error("Error accessing data for source "+e.get("mapbox-source")))};e.set("mapbox-layers",t);const p=o.getLayers();-1===p.getArray().indexOf(e)&&p.push(e),e.getSource()?c():e.once("change:source",c)})}var As=r(1685);r(6837);As.Ay;Va["default"]}}]);
//# sourceMappingURL=5591.347e9dae.js.map