"use strict";(self["webpackChunk_radiantearth_stac_browser"]=self["webpackChunk_radiantearth_stac_browser"]||[]).push([[9124],{59124:function(t,e,i){i.r(e),i.d(e,{default:function(){return T}});var s=i(50071),a=i(86717),n=i(6933),l=i(70915),o=i(11217),r=i(44294),h=i(61597),_=i(38599);function m(t,e,i){const s=[];let a=t(0),n=t(1),l=e(a),o=e(n);const r=[n,a],_=[o,l],m=[1,0],L={};let d,c,b,f,u,g,x=1e5;while(--x>0&&m.length>0)b=m.pop(),a=r.pop(),l=_.pop(),g=b.toString(),g in L||(s.push(l[0],l[1]),L[g]=!0),f=m.pop(),n=r.pop(),o=_.pop(),u=(b+f)/2,d=t(u),c=e(d),(0,h.Q1)(c[0],c[1],l[0],l[1],o[0],o[1])<i?(s.push(o[0],o[1]),g=f.toString(),L[g]=!0):(m.push(f,u,u,b),_.push(o,c,c,l),r.push(n,d,d,a));return s}function L(t,e,i,s,a){const n=(0,_.Jt)("EPSG:4326");return m(function(s){return[t,e+(i-e)*s]},(0,_.RG)(n,s),a)}function d(t,e,i,s,a){const n=(0,_.Jt)("EPSG:4326");return m(function(s){return[e+(i-e)*s,t]},(0,_.RG)(n,s),a)}var c=i(83984),b=i(2236),f=i(73608),u=i(9703);function g(t){if(!(t.context instanceof CanvasRenderingContext2D))throw new Error("Only works for render events from Canvas 2D layers");const e=t.inversePixelTransform[0],i=t.inversePixelTransform[1],s=Math.sqrt(e*e+i*i),a=t.frameState,n=(0,u.lw)(t.inversePixelTransform.slice(),a.coordinateToPixelTransform),l=(0,f.j)(a.viewState.resolution,s);let o;const r=(0,_.Tf)();return r&&(o=(0,_.FO)(r,a.viewState.projection)),new b.A(t.context,s,a.extent,n,a.viewState.rotation,l,o)}var x=i(42457),p=i(13628),S=i(953),w=i(29276),E=i(81426),P=i(82986);const v=new S.A({color:"rgba(0,0,0,0.2)"}),y=[90,45,30,20,10,5,2,1,.5,20/60,10/60,5/60,2/60,1/60,30/3600,20/3600,10/3600,5/3600,2/3600,1/3600];class M extends P["default"]{constructor(t){t=t||{};const e=Object.assign({updateWhileAnimating:!0,updateWhileInteracting:!0,renderBuffer:0},t);delete e.maxLines,delete e.strokeStyle,delete e.targetSize,delete e.showLabels,delete e.lonLabelFormatter,delete e.latLabelFormatter,delete e.lonLabelPosition,delete e.latLabelPosition,delete e.lonLabelStyle,delete e.latLabelStyle,delete e.intervals,super(e),this.projection_=null,this.maxLat_=1/0,this.maxLon_=1/0,this.minLat_=-1/0,this.minLon_=-1/0,this.maxX_=1/0,this.maxY_=1/0,this.minX_=-1/0,this.minY_=-1/0,this.targetSize_=void 0!==t.targetSize?t.targetSize:100,this.maxLines_=void 0!==t.maxLines?t.maxLines:100,this.meridians_=[],this.parallels_=[],this.strokeStyle_=void 0!==t.strokeStyle?t.strokeStyle:v,this.fromLonLatTransform_=void 0,this.toLonLatTransform_=void 0,this.projectionCenterLonLat_=null,this.bottomLeft_=null,this.bottomRight_=null,this.topLeft_=null,this.topRight_=null,this.meridiansLabels_=null,this.parallelsLabels_=null,t.showLabels&&(this.lonLabelFormatter_=void 0==t.lonLabelFormatter?n.aP.bind(this,"EW"):t.lonLabelFormatter,this.latLabelFormatter_=void 0==t.latLabelFormatter?n.aP.bind(this,"NS"):t.latLabelFormatter,this.lonLabelPosition_=void 0==t.lonLabelPosition?0:t.lonLabelPosition,this.latLabelPosition_=void 0==t.latLabelPosition?1:t.latLabelPosition,this.lonLabelStyleBase_=new w.Ay({text:void 0!==t.lonLabelStyle?t.lonLabelStyle.clone():new E.A({font:"12px Calibri,sans-serif",textBaseline:"bottom",fill:new p.A({color:"rgba(0,0,0,1)"}),stroke:new S.A({color:"rgba(255,255,255,1)",width:3})})}),this.lonLabelStyle_=t=>{const e=t.get("graticule_label");return this.lonLabelStyleBase_.getText().setText(e),this.lonLabelStyleBase_},this.latLabelStyleBase_=new w.Ay({text:void 0!==t.latLabelStyle?t.latLabelStyle.clone():new E.A({font:"12px Calibri,sans-serif",textAlign:"right",fill:new p.A({color:"rgba(0,0,0,1)"}),stroke:new S.A({color:"rgba(255,255,255,1)",width:3})})}),this.latLabelStyle_=t=>{const e=t.get("graticule_label");return this.latLabelStyleBase_.getText().setText(e),this.latLabelStyleBase_},this.meridiansLabels_=[],this.parallelsLabels_=[],this.addEventListener(c.A.POSTRENDER,this.drawLabels_.bind(this))),this.intervals_=void 0!==t.intervals?t.intervals:y,this.setSource(new x["default"]({loader:this.loaderFunction.bind(this),strategy:this.strategyFunction.bind(this),features:new s.A,overlaps:!1,useSpatialIndex:!1,wrapX:t.wrapX})),this.featurePool_=[],this.lineStyle_=new w.Ay({stroke:this.strokeStyle_}),this.loadedExtent_=null,this.renderedExtent_=null,this.renderedResolution_=null,this.setRenderOrder(null)}strategyFunction(t,e){let i=t.slice();return this.projection_&&this.getSource().getWrapX()&&(0,l.Li)(i,this.projection_),this.loadedExtent_&&((0,l.bE)(this.loadedExtent_,i,e)?i=this.loadedExtent_.slice():this.getSource().removeLoadedExtent(this.loadedExtent_)),[i]}loaderFunction(t,e,i){this.loadedExtent_=t;const s=this.getSource(),n=this.getExtent()||[-1/0,-1/0,1/0,1/0],o=(0,l._N)(n,t);if(this.renderedExtent_&&(0,l.aI)(this.renderedExtent_,o)&&this.renderedResolution_===e)return;if(this.renderedExtent_=o,this.renderedResolution_=e,(0,l.Im)(o))return;const r=(0,l.q1)(o),h=e*e/4,m=!this.projection_||!(0,_.tI)(this.projection_,i);m&&this.updateProjectionInfo_(i),this.createGraticule_(o,r,e,h);let L,d=this.meridians_.length+this.parallels_.length;this.meridiansLabels_&&(d+=this.meridians_.length),this.parallelsLabels_&&(d+=this.parallels_.length);while(d>this.featurePool_.length)L=new a.A,this.featurePool_.push(L);const c=s.getFeaturesCollection();c.clear();let b,f,u=0;for(b=0,f=this.meridians_.length;b<f;++b)L=this.featurePool_[u++],L.setGeometry(this.meridians_[b]),L.setStyle(this.lineStyle_),c.push(L);for(b=0,f=this.parallels_.length;b<f;++b)L=this.featurePool_[u++],L.setGeometry(this.parallels_[b]),L.setStyle(this.lineStyle_),c.push(L)}addMeridian_(t,e,i,s,a,n){const o=this.getMeridian_(t,e,i,s,n);if((0,l.HY)(o.getExtent(),a)){if(this.meridiansLabels_){const e=this.lonLabelFormatter_(t);n in this.meridiansLabels_?this.meridiansLabels_[n].text=e:this.meridiansLabels_[n]={geom:new r.A([]),text:e}}this.meridians_[n++]=o}return n}addParallel_(t,e,i,s,a,n){const o=this.getParallel_(t,e,i,s,n);if((0,l.HY)(o.getExtent(),a)){if(this.parallelsLabels_){const e=this.latLabelFormatter_(t);n in this.parallelsLabels_?this.parallelsLabels_[n].text=e:this.parallelsLabels_[n]={geom:new r.A([]),text:e}}this.parallels_[n++]=o}return n}drawLabels_(t){const e=t.frameState.viewState.rotation,i=t.frameState.viewState.resolution,s=t.frameState.size,a=t.frameState.extent,n=(0,l.q1)(a);let o=a;if(e){const t=s[0]*i,e=s[1]*i;o=[n[0]-t/2,n[1]-e/2,n[0]+t/2,n[1]+e/2]}let r=0,h=0,_=this.latLabelPosition_<.5;const m=this.projection_.getExtent(),L=(0,l.RG)(m);if(this.getSource().getWrapX()&&this.projection_.canWrapX()&&!(0,l.ms)(m,a)){r=Math.floor((a[0]-m[0])/L),h=Math.ceil((a[2]-m[2])/L);const t=Math.abs(e)>Math.PI/2;_=_!==t}const d=g(t);for(let l=r;l<=h;++l){let t,i,s,m,c=this.meridians_.length+this.parallels_.length;if(this.meridiansLabels_)for(i=0,s=this.meridiansLabels_.length;i<s;++i){const s=this.meridians_[i];if(e||0!==l){const t=s.clone();t.translate(l*L,0),t.rotate(-e,n),m=this.getMeridianPoint_(t,o,i),m.rotate(e,n)}else m=this.getMeridianPoint_(s,a,i);t=this.featurePool_[c++],t.setGeometry(m),t.set("graticule_label",this.meridiansLabels_[i].text),d.drawFeature(t,this.lonLabelStyle_(t))}if(this.parallelsLabels_&&(l===r&&_||l===h&&!_))for(i=0,s=this.parallels_.length;i<s;++i){const s=this.parallels_[i];if(e||0!==l){const t=s.clone();t.translate(l*L,0),t.rotate(-e,n),m=this.getParallelPoint_(t,o,i),m.rotate(e,n)}else m=this.getParallelPoint_(s,a,i);t=this.featurePool_[c++],t.setGeometry(m),t.set("graticule_label",this.parallelsLabels_[i].text),d.drawFeature(t,this.latLabelStyle_(t))}}}createGraticule_(t,e,i,s){const a=this.getInterval_(i);if(-1==a)return this.meridians_.length=0,this.parallels_.length=0,this.meridiansLabels_&&(this.meridiansLabels_.length=0),void(this.parallelsLabels_&&(this.parallelsLabels_.length=0));let n=!1;const o=this.projection_.getExtent(),r=(0,l.RG)(o);this.getSource().getWrapX()&&this.projection_.canWrapX()&&!(0,l.ms)(o,t)&&((0,l.RG)(t)>=r?(t[0]=o[0],t[2]=o[2]):n=!0);const _=[(0,h.qE)(e[0],this.minX_,this.maxX_),(0,h.qE)(e[1],this.minY_,this.maxY_)],m=this.toLonLatTransform_(_);isNaN(m[1])&&(m[1]=Math.abs(this.maxLat_)>=Math.abs(this.minLat_)?this.maxLat_:this.minLat_);let L=(0,h.qE)(m[0],this.minLon_,this.maxLon_),d=(0,h.qE)(m[1],this.minLat_,this.maxLat_);const c=this.maxLines_;let b,f,u,g,x=t;n||(x=[(0,h.qE)(t[0],this.minX_,this.maxX_),(0,h.qE)(t[1],this.minY_,this.maxY_),(0,h.qE)(t[2],this.minX_,this.maxX_),(0,h.qE)(t[3],this.minY_,this.maxY_)]);const p=(0,l.NW)(x,this.toLonLatTransform_,void 0,8);let S=p[3],w=p[2],E=p[1],P=p[0];if(n||((0,l.Ym)(x,this.bottomLeft_)&&(P=this.minLon_,E=this.minLat_),(0,l.Ym)(x,this.bottomRight_)&&(w=this.maxLon_,E=this.minLat_),(0,l.Ym)(x,this.topLeft_)&&(P=this.minLon_,S=this.maxLat_),(0,l.Ym)(x,this.topRight_)&&(w=this.maxLon_,S=this.maxLat_),S=(0,h.qE)(S,d,this.maxLat_),w=(0,h.qE)(w,L,this.maxLon_),E=(0,h.qE)(E,this.minLat_,d),P=(0,h.qE)(P,this.minLon_,L)),L=Math.floor(L/a)*a,g=(0,h.qE)(L,this.minLon_,this.maxLon_),f=this.addMeridian_(g,E,S,s,t,0),b=0,n)while((g-=a)>=P&&b++<c)f=this.addMeridian_(g,E,S,s,t,f);else while(g!=this.minLon_&&b++<c)g=Math.max(g-a,this.minLon_),f=this.addMeridian_(g,E,S,s,t,f);if(g=(0,h.qE)(L,this.minLon_,this.maxLon_),b=0,n)while((g+=a)<=w&&b++<c)f=this.addMeridian_(g,E,S,s,t,f);else while(g!=this.maxLon_&&b++<c)g=Math.min(g+a,this.maxLon_),f=this.addMeridian_(g,E,S,s,t,f);this.meridians_.length=f,this.meridiansLabels_&&(this.meridiansLabels_.length=f),d=Math.floor(d/a)*a,u=(0,h.qE)(d,this.minLat_,this.maxLat_),f=this.addParallel_(u,P,w,s,t,0),b=0;while(u!=this.minLat_&&b++<c)u=Math.max(u-a,this.minLat_),f=this.addParallel_(u,P,w,s,t,f);u=(0,h.qE)(d,this.minLat_,this.maxLat_),b=0;while(u!=this.maxLat_&&b++<c)u=Math.min(u+a,this.maxLat_),f=this.addParallel_(u,P,w,s,t,f);this.parallels_.length=f,this.parallelsLabels_&&(this.parallelsLabels_.length=f)}getInterval_(t){const e=this.projectionCenterLonLat_[0],i=this.projectionCenterLonLat_[1];let s=-1;const a=Math.pow(this.targetSize_*t,2),n=[],l=[];for(let o=0,r=this.intervals_.length;o<r;++o){const t=(0,h.qE)(this.intervals_[o]/2,0,90),r=(0,h.qE)(i,-90+t,90-t);n[0]=e-t,n[1]=r-t,l[0]=e+t,l[1]=r+t,this.fromLonLatTransform_(n,n),this.fromLonLatTransform_(l,l);const _=Math.pow(l[0]-n[0],2)+Math.pow(l[1]-n[1],2);if(_<=a)break;s=this.intervals_[o]}return s}getMeridian_(t,e,i,s,a){const n=L(t,e,i,this.projection_,s);let l=this.meridians_[a];return l?(l.setFlatCoordinates("XY",n),l.changed()):(l=new o.A(n,"XY"),this.meridians_[a]=l),l}getMeridianPoint_(t,e,i){const s=t.getFlatCoordinates();let a=1,n=s.length-1;s[a]>s[n]&&(a=n,n=1);const l=Math.max(e[1],s[a]),o=Math.min(e[3],s[n]),r=(0,h.qE)(e[1]+Math.abs(e[1]-e[3])*this.lonLabelPosition_,l,o),_=s[a-1]+(s[n-1]-s[a-1])*(r-s[a])/(s[n]-s[a]),m=[_,r],L=this.meridiansLabels_[i].geom;return L.setCoordinates(m),L}getMeridians(){return this.meridians_}getParallel_(t,e,i,s,a){const n=d(t,e,i,this.projection_,s);let l=this.parallels_[a];return l?(l.setFlatCoordinates("XY",n),l.changed()):l=new o.A(n,"XY"),l}getParallelPoint_(t,e,i){const s=t.getFlatCoordinates();let a=0,n=s.length-2;s[a]>s[n]&&(a=n,n=0);const l=Math.max(e[0],s[a]),o=Math.min(e[2],s[n]),r=(0,h.qE)(e[0]+Math.abs(e[0]-e[2])*this.latLabelPosition_,l,o),_=s[a+1]+(s[n+1]-s[a+1])*(r-s[a])/(s[n]-s[a]),m=[r,_],L=this.parallelsLabels_[i].geom;return L.setCoordinates(m),L}getParallels(){return this.parallels_}updateProjectionInfo_(t){const e=(0,_.Jt)("EPSG:4326"),i=t.getWorldExtent();this.maxLat_=i[3],this.maxLon_=i[2],this.minLat_=i[1],this.minLon_=i[0];const s=(0,_.RG)(t,e);if(this.minLon_<this.maxLon_)this.toLonLatTransform_=s;else{const t=this.minLon_+this.maxLon_/2;this.maxLon_+=360,this.toLonLatTransform_=function(e,i,a){a=a||2;const n=s(e,i,a);for(let s=0,l=n.length;s<l;s+=a)n[s]<t&&(n[s]+=360);return n}}this.fromLonLatTransform_=(0,_.RG)(e,t);const a=(0,l.NW)([this.minLon_,this.minLat_,this.maxLon_,this.maxLat_],this.fromLonLatTransform_,void 0,8);this.minX_=a[0],this.maxX_=a[2],this.minY_=a[1],this.maxY_=a[3],this.bottomLeft_=this.fromLonLatTransform_([this.minLon_,this.minLat_]),this.bottomRight_=this.fromLonLatTransform_([this.maxLon_,this.minLat_]),this.topLeft_=this.fromLonLatTransform_([this.minLon_,this.maxLat_]),this.topRight_=this.fromLonLatTransform_([this.maxLon_,this.maxLat_]),this.projectionCenterLonLat_=this.toLonLatTransform_((0,l.q1)(t.getExtent())),isNaN(this.projectionCenterLonLat_[1])&&(this.projectionCenterLonLat_[1]=Math.abs(this.maxLat_)>=Math.abs(this.minLat_)?this.maxLat_:this.minLat_),this.projection_=t}}var T=M}}]);
//# sourceMappingURL=9124.e5d04974.js.map