"use strict";(self["webpackChunk_radiantearth_stac_browser"]=self["webpackChunk_radiantearth_stac_browser"]||[]).push([[3735,6017,6116,6165],{4863:function(t,e,i){i.d(e,{EN:function(){return h},Li:function(){return c},kZ:function(){return f},pr:function(){return l}});var n=i(70915),r=i(38599),s=i(6782),o=i(56758),a=i(57115);function l(t){let e=t.getDefaultTileGrid();return e||(e=p(t),t.setDefaultTileGrid(e)),e}function c(t,e,i){const r=e[0],s=t.getTileCoordCenter(e),o=f(i);if(!(0,n.Ym)(o,s)){const e=(0,n.RG)(o),i=Math.ceil((o[0]-s[0])/e);return s[0]+=e*i,t.getTileCoordForCoordAndZ(s,r)}return e}function u(t,e,i,r){r=void 0!==r?r:"top-left";const s=d(t,e,i);return new o.A({extent:t,origin:(0,n.qF)(t,r),resolutions:s,tileSize:i})}function h(t){const e=t||{},i=e.extent||(0,r.Jt)("EPSG:3857").getExtent(),n={extent:i,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:d(i,e.maxZoom,e.tileSize,e.maxResolution)};return new o.A(n)}function d(t,e,i,r){e=void 0!==e?e:a.L,i=(0,s.xq)(void 0!==i?i:a.R);const o=(0,n.Oq)(t),l=(0,n.RG)(t);r=r>0?r:Math.max(l/i[0],o/i[1]);const c=e+1,u=new Array(c);for(let n=0;n<c;++n)u[n]=r/Math.pow(2,n);return u}function p(t,e,i,n){const r=f(t);return u(r,e,i,n)}function f(t){t=(0,r.Jt)(t);let e=t.getExtent();if(!e){const i=180*r.Ig.degrees/t.getMetersPerUnit();e=(0,n.N)(-i,-i,i,i)}return e}},8143:function(t,e,i){var n=i(11078),r=i(93474),s=i(6837),o=i(79332),a=i(4087);class l extends o.A{constructor(t,e,i){super(),i=i||{},this.tileCoord=t,this.state=e,this.key="",this.transition_=void 0===i.transition?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(s.A.CHANGE)}release(){this.setState(n.A.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(this.state!==n.A.EMPTY){if(this.state!==n.A.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}}load(){(0,a.b0)()}getAlpha(t,e){if(!this.transition_)return 1;let i=this.transitionStarts_[t];if(i){if(-1===i)return 1}else i=e,this.transitionStarts_[t]=i;const n=e-i+1e3/60;return n>=this.transition_?1:(0,r.a6)(n/this.transition_)}inTransition(t){return!!this.transition_&&-1!==this.transitionStarts_[t]}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}e.A=l},27607:function(t,e,i){i.d(e,{$r:function(){return u},bL:function(){return a},xo:function(){return o}});var n=i(8143),r=i(11078),s=i(68711);function o(t){return t instanceof Image||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageBitmap?t:null}function a(t){return t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Float32Array||t instanceof DataView?t:null}const l=new Error("disposed");let c=null;function u(t){c||(c=(0,s.Y)(t.width,t.height,void 0,{willReadFrequently:!0}));const e=c.canvas,i=t.width;e.width!==i&&(e.width=i);const n=t.height;return e.height!==n&&(e.height=n),c.clearRect(0,0,i,n),c.drawImage(t,0,0),c.getImageData(0,0,i,n).data}const h=[256,256];class d extends n.A{constructor(t){const e=r.A.IDLE;super(t.tileCoord,e,{transition:t.transition,interpolate:t.interpolate}),this.loader_=t.loader,this.data_=null,this.error_=null,this.size_=t.size||null,this.controller_=t.controller||null}getSize(){if(this.size_)return this.size_;const t=o(this.data_);return t?[t.width,t.height]:h}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==r.A.IDLE&&this.state!==r.A.ERROR)return;this.state=r.A.LOADING,this.changed();const t=this;this.loader_().then(function(e){t.data_=e,t.state=r.A.LOADED,t.changed()}).catch(function(e){t.error_=e,t.state=r.A.ERROR,t.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(l),this.controller_=null),super.disposeInternal()}}e.Ay=d},66017:function(t,e,i){i.r(e),i.d(e,{TileSourceEvent:function(){return u}});var n=i(1685),r=i(6782),s=i(40186),o=i(4863),a=i(4087),l=i(16444);class c extends l["default"]{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=void 0!==t.tilePixelRatio?t.tilePixelRatio:1,this.tileGrid=void 0!==t.tileGrid?t.tileGrid:null;const e=[256,256];this.tileGrid&&(0,r.xq)(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),e),this.tmpSize=[0,0],this.key_=t.key||(0,a.v6)(this),this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,i,n,r){return(0,a.b0)()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:(0,o.pr)(t)}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,i){const n=this.getTileGridForProjection(i),s=this.getTilePixelRatio(e),o=(0,r.xq)(n.getTileSize(t),this.tmpSize);return 1==s?o:(0,r.hs)(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(t,e){const i=void 0!==e?e:this.getProjection(),n=void 0!==e?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(t=(0,o.Li)(n,t,i)),(0,s.N5)(t,n)?t:null}clear(){}refresh(){this.clear(),super.refresh()}}class u extends n.Ay{constructor(t,e){super(t),this.tile=e}}e["default"]=c},83954:function(t,e,i){function n(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function r(t,e){return t[0]=e[0],t[1]=e[1],t[4]=e[2],t[5]=e[3],t[12]=e[4],t[13]=e[5],t}function s(t,e,i,r,s,o,a){a=a??n();const l=1/(t-e),c=1/(i-r),u=1/(s-o);return a[0]=-2*l,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*c,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*u,a[11]=0,a[12]=(t+e)*l,a[13]=(r+i)*c,a[14]=(o+s)*u,a[15]=1,a}function o(t,e,i,r,s){return s=s??n(),s[0]=t[0]*e,s[1]=t[1]*e,s[2]=t[2]*e,s[3]=t[3]*e,s[4]=t[4]*i,s[5]=t[5]*i,s[6]=t[6]*i,s[7]=t[7]*i,s[8]=t[8]*r,s[9]=t[9]*r,s[10]=t[10]*r,s[11]=t[11]*r,s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15],s}function a(t,e,i,r,s){let o,a,l,c,u,h,d,p,f,g,_,w;return s=s??n(),t===s?(s[12]=t[0]*e+t[4]*i+t[8]*r+t[12],s[13]=t[1]*e+t[5]*i+t[9]*r+t[13],s[14]=t[2]*e+t[6]*i+t[10]*r+t[14],s[15]=t[3]*e+t[7]*i+t[11]*r+t[15]):(o=t[0],a=t[1],l=t[2],c=t[3],u=t[4],h=t[5],d=t[6],p=t[7],f=t[8],g=t[9],_=t[10],w=t[11],s[0]=o,s[1]=a,s[2]=l,s[3]=c,s[4]=u,s[5]=h,s[6]=d,s[7]=p,s[8]=f,s[9]=g,s[10]=_,s[11]=w,s[12]=o*e+u*i+f*r+t[12],s[13]=a*e+h*i+g*r+t[13],s[14]=l*e+d*i+_*r+t[14],s[15]=c*e+p*i+w*r+t[15]),s}function l(t,e,i,r){return r=r??n(),r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=t,r[13]=e,r[14]=i,r[15]=1,r}i.d(e,{Tl:function(){return a},Z1:function(){return r},hs:function(){return o},j0:function(){return s},vt:function(){return n},wT:function(){return l}})},98742:function(t,e,i){i.r(e),i.d(e,{getProjectionIdentifier:function(){return _},parseTokenClaims:function(){return g},serializeFunction:function(){return w}});var n=i(38599),r=i(22615);const s="https://services.sentinel-hub.com/api/v1/process",o="https://services.sentinel-hub.com/auth/realms/main/protocol/openid-connect/token",a="3",l=[512,512],c=10,u=500;function h(t){const e=t.version||a;return`//VERSION=${e}\n    ${w("setup",t.setup)}\n    ${w("evaluatePixel",t.evaluatePixel)}\n    ${w("updateOutput",t.updateOutput)}\n  `}async function d(t){const e=await t.blob();return new Promise((t,i)=>{const n=new Image,r=URL.createObjectURL(e);n.onload=()=>{URL.revokeObjectURL(r),t(n)},n.onerror=()=>{URL.revokeObjectURL(r),i(new Error("Failed to load image"))},n.src=r})}function p(t){return new Promise(e=>setTimeout(e,t))}async function f(t){const e=t.tokenUrl||o,i=new URLSearchParams;i.append("grant_type","client_credentials"),i.append("client_id",t.clientId),i.append("client_secret",t.clientSecret);const n={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i},r=await fetch(e,n);if(!r.ok){if(401===r.status)throw new Error("Bad client id or secret");throw new Error("Failed to get token")}const s=await r.json();return s.access_token}function g(t){const e=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),i=atob(e).split(""),n=i.length,r=new Array(n);for(let s=0;s<n;++s){const t=i[s];r[s]="%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}return JSON.parse(decodeURIComponent(r.join("")))}function _(t){const e="http://www.opengis.net/def/crs/",i=t.getCode();return i.startsWith(e)?i:i.startsWith("EPSG:")?`${e}EPSG/0/${i.slice(5)}`:(0,n.tI)(t,(0,n.Jt)("EPSG:4326"))?`${e}EPSG/0/4326`:i}function w(t,e){if(!e)return"";let i=e.toString();return e.name&&"function"!==e.name&&i.match(new RegExp("^"+e.name.replace("$","\\$")+"\\b"))&&(i="function "+i),`var ${t} = ${i};`}class T extends r["default"]{constructor(t){const e=t||{};super({state:"loading",projection:e.projection,attributionsCollapsible:e.attributionsCollapsible,interpolate:e.interpolate,tileSize:e.tileSize||l,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition}),this.setLoader((t,e,i)=>this.loadTile_(t,e,i,1)),this.error_=null,this.evalscript_="",this.inputData_=null,this.processUrl_=e.url||s,this.token_="",this.tokenRenewalId_,e.auth&&this.setAuth(e.auth),e.data&&this.setData(e.data),e.evalscript&&this.setEvalscript(e.evalscript)}async setAuth(t){if(clearTimeout(this.tokenRenewalId_),"string"===typeof t)return this.token_=t,void this.fireWhenReady_();let e,i;try{e=await f(t),i=g(e)}catch(s){return this.error_=s,void this.setState("error")}this.token_=e;const n=1e3*i.exp,r=Math.max(n-Date.now()-6e4,1);this.tokenRenewalId_=setTimeout(()=>this.setAuth(t),r),this.fireWhenReady_()}setData(t){this.inputData_=t,this.fireWhenReady_()}setEvalscript(t){let e;if("string"===typeof t)e=t;else try{e=h(t)}catch(i){return this.error_=i,void this.setState("error")}this.evalscript_=e,this.fireWhenReady_()}fireWhenReady_(){if(!this.token_||!this.evalscript_||!this.inputData_)return;const t=this.getState();"ready"!==t?this.setState("ready"):this.changed()}async loadTile_(t,e,i,n){const r=this.getTileGrid(),s=r.getTileCoordExtent([t,e,i]),o=this.getTileSize(t),a=this.getProjection(),l={input:{bounds:{bbox:s,properties:{crs:_(a)}},data:this.inputData_},output:{width:o[0],height:o[1]},evalscript:this.evalscript_},h={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.token_}`,"Access-Control-Request-Headers":"Retry-After"},body:JSON.stringify(l),credentials:"include"},f=await fetch(this.processUrl_,h);if(!f.ok){if(429===f.status&&n<c-1){const r=u*2**n;return await p(r),this.loadTile_(e,i,t,n+1)}throw new Error(`Failed to get tile: ${f.statusText}`)}return d(f)}getError(){return this.error_}disposeInternal(){clearTimeout(this.tokenRenewalId_),super.disposeInternal()}}e["default"]=T}}]);
//# sourceMappingURL=6165.c6e6bd27.js.map