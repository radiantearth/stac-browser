"use strict";(self["webpackChunk_radiantearth_stac_browser"]=self["webpackChunk_radiantearth_stac_browser"]||[]).push([[8056],{18056:function(e,t,r){r.r(t);var n=r(49825),s=r(27557),o=r(75332),a=r(34799),i=r(55151),l=r(22808);function u(e,t){const r=`\n    attribute vec2 ${a.eS.TEXTURE_COORD};\n    uniform mat4 ${a.gF.TILE_TRANSFORM};\n    uniform float ${a.gF.TEXTURE_PIXEL_WIDTH};\n    uniform float ${a.gF.TEXTURE_PIXEL_HEIGHT};\n    uniform float ${a.gF.TEXTURE_RESOLUTION};\n    uniform float ${a.gF.TEXTURE_ORIGIN_X};\n    uniform float ${a.gF.TEXTURE_ORIGIN_Y};\n    uniform float ${a.gF.DEPTH};\n\n    varying vec2 v_textureCoord;\n    varying vec2 v_mapCoord;\n\n    void main() {\n      v_textureCoord = ${a.eS.TEXTURE_COORD};\n      v_mapCoord = vec2(\n        ${a.gF.TEXTURE_ORIGIN_X} + ${a.gF.TEXTURE_RESOLUTION} * ${a.gF.TEXTURE_PIXEL_WIDTH} * v_textureCoord[0],\n        ${a.gF.TEXTURE_ORIGIN_Y} - ${a.gF.TEXTURE_RESOLUTION} * ${a.gF.TEXTURE_PIXEL_HEIGHT} * v_textureCoord[1]\n      );\n      gl_Position = ${a.gF.TILE_TRANSFORM} * vec4(${a.eS.TEXTURE_COORD}, ${a.gF.DEPTH}, 1.0);\n    }\n  `,o={...(0,s.z0)(),inFragmentShader:!0,bandCount:t},l=[];if(void 0!==e.color){const t=(0,i.s2)(o,e.color,n.mE);l.push(`color = ${t};`)}if(void 0!==e.contrast){const t=(0,i.s2)(o,e.contrast,n.wl);l.push(`color.rgb = clamp((${t} + 1.0) * color.rgb - (${t} / 2.0), vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));`)}if(void 0!==e.exposure){const t=(0,i.s2)(o,e.exposure,n.wl);l.push(`color.rgb = clamp((${t} + 1.0) * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));`)}if(void 0!==e.saturation){const t=(0,i.s2)(o,e.saturation,n.wl);l.push(`\n      float saturation = ${t} + 1.0;\n      float sr = (1.0 - saturation) * 0.2126;\n      float sg = (1.0 - saturation) * 0.7152;\n      float sb = (1.0 - saturation) * 0.0722;\n      mat3 saturationMatrix = mat3(\n        sr + saturation, sr, sr,\n        sg, sg + saturation, sg,\n        sb, sb, sb + saturation\n      );\n      color.rgb = clamp(saturationMatrix * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));\n    `)}if(void 0!==e.gamma){const t=(0,i.s2)(o,e.gamma,n.wl);l.push(`color.rgb = pow(color.rgb, vec3(1.0 / ${t}));`)}if(void 0!==e.brightness){const t=(0,i.s2)(o,e.brightness,n.wl);l.push(`color.rgb = clamp(color.rgb + ${t}, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));`)}const u={},c=Object.keys(o.variables).length;if(c>1&&!e.variables)throw new Error(`Missing variables in style (expected ${o.variables})`);for(let n=0;n<c;++n){const t=o.variables[Object.keys(o.variables)[n]];if(!(t.name in e.variables))throw new Error(`Missing '${t.name}' in style variables`);const r=(0,s.Sl)(t.name);u[r]=function(){let r=e.variables[t.name];return"string"===typeof r&&(r=(0,s.Lm)(r)),void 0!==r?r:-9999999}}const d=Object.keys(u).map(function(e){return`uniform float ${e};`}),g=Math.ceil(t/4);d.push(`uniform sampler2D ${a.gF.TILE_TEXTURE_ARRAY}[${g}];`),o.paletteTextures&&d.push(`uniform sampler2D ${s.uZ}[${o.paletteTextures.length}];`);const h=Object.keys(o.functions).map(function(e){return o.functions[e]}),_=`\n    #ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n    #else\n    precision mediump float;\n    #endif\n\n    varying vec2 v_textureCoord;\n    varying vec2 v_mapCoord;\n    uniform vec4 ${a.gF.RENDER_EXTENT};\n    uniform float ${a.gF.TRANSITION_ALPHA};\n    uniform float ${a.gF.TEXTURE_PIXEL_WIDTH};\n    uniform float ${a.gF.TEXTURE_PIXEL_HEIGHT};\n    uniform float ${a.gF.RESOLUTION};\n    uniform float ${a.gF.ZOOM};\n\n    ${d.join("\n")}\n\n    ${h.join("\n")}\n\n    void main() {\n      if (\n        v_mapCoord[0] < ${a.gF.RENDER_EXTENT}[0] ||\n        v_mapCoord[1] < ${a.gF.RENDER_EXTENT}[1] ||\n        v_mapCoord[0] > ${a.gF.RENDER_EXTENT}[2] ||\n        v_mapCoord[1] > ${a.gF.RENDER_EXTENT}[3]\n      ) {\n        discard;\n      }\n\n      vec4 color = texture2D(${a.gF.TILE_TEXTURE_ARRAY}[0],  v_textureCoord);\n\n      ${l.join("\n")}\n\n      gl_FragColor = color;\n      gl_FragColor.rgb *= gl_FragColor.a;\n      gl_FragColor *= ${a.gF.TRANSITION_ALPHA};\n    }`;return{vertexShader:r,fragmentShader:_,uniforms:u,paletteTextures:o.paletteTextures}}class c extends l["default"]{constructor(e){e=e?Object.assign({},e):{};const t=e.style||{};delete e.style,super(e),this.sources_=e.sources,this.renderedSource_=null,this.renderedResolution_=NaN,this.style_=t,this.styleVariables_=this.style_.variables||{},this.handleSourceUpdate_(),this.addChangeListener(o["default"].SOURCE,this.handleSourceUpdate_)}getSources(e,t){const r=this.getSource();return this.sources_?"function"===typeof this.sources_?this.sources_(e,t):this.sources_:r?[r]:[]}getRenderSource(){return this.renderedSource_||this.getSource()}getSourceState(){const e=this.getRenderSource();return e?e.getState():"undefined"}handleSourceUpdate_(){this.hasRenderer()&&this.getRenderer().clearCache();const e=this.getSource();if(e)if("loading"===e.getState()){const t=()=>{"ready"===e.getState()&&(e.removeEventListener("change",t),this.setStyle(this.style_))};e.addEventListener("change",t)}else this.setStyle(this.style_)}getSourceBandCount_(){const e=Number.MAX_SAFE_INTEGER,t=this.getSources([-e,-e,e,e],e);return t&&t.length&&"bandCount"in t[0]?t[0].bandCount:4}createRenderer(){const e=u(this.style_,this.getSourceBandCount_());return new a.Ay(this,{vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,cacheSize:this.getCacheSize(),paletteTextures:e.paletteTextures})}renderSources(e,t){const r=this.getRenderer();let n;for(let s=0,o=t.length;s<o;++s)this.renderedSource_=t[s],r.prepareFrame(e)&&(n=r.renderFrame(e));return n}render(e,t){this.rendered=!0;const r=e.viewState,n=this.getSources(e.extent,r.resolution);let s=!0;for(let a=0,i=n.length;a<i;++a){const e=n[a],t=e.getState();if("loading"==t){const t=()=>{"ready"==e.getState()&&(e.removeEventListener("change",t),this.changed())};e.addEventListener("change",t)}s=s&&"ready"==t}const o=this.renderSources(e,n);if(this.getRenderer().renderComplete&&s)return this.renderedResolution_=r.resolution,o;if(this.renderedResolution_>.5*r.resolution){const t=this.getSources(e.extent,this.renderedResolution_).filter(e=>!n.includes(e));if(t.length>0)return this.renderSources(e,t)}return o}setStyle(e){if(this.styleVariables_=e.variables||{},this.style_=e,this.hasRenderer()){const e=u(this.style_,this.getSourceBandCount_()),t=this.getRenderer();t.reset({vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,paletteTextures:e.paletteTextures}),this.changed()}}updateStyleVariables(e){Object.assign(this.styleVariables_,e),this.changed()}}c.prototype.dispose,t["default"]=c},22808:function(e,t,r){r.r(t);var n=r(60764),s=r(45360);class o extends n["default"]{constructor(e){e=e||{};const t=Object.assign({},e),r=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=r,this.setPreload(void 0!==e.preload?e.preload:0),this.setUseInterimTilesOnError(void 0===e.useInterimTilesOnError||e.useInterimTilesOnError)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(s["default"].PRELOAD)}setPreload(e){this.set(s["default"].PRELOAD,e)}getUseInterimTilesOnError(){return this.get(s["default"].USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(s["default"].USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}t["default"]=o}}]);
//# sourceMappingURL=8056.6663b01a.js.map