"use strict";(self["webpackChunk_radiantearth_stac_browser"]=self["webpackChunk_radiantearth_stac_browser"]||[]).push([[180],{40180:function(e,t,i){i.r(t),i.d(t,{default:function(){return m},defaultLoadFunction:function(){return v}});var s=i(11078),o=i(8143),r=i(68711),l=i(4087);const n=[];class a extends o.A{constructor(e,t,i,s,o){super(e,t,{transition:0}),this.context_=null,this.executorGroups={},this.loadingSourceTiles=0,this.hitDetectionImageData={},this.replayState_={},this.sourceTiles=[],this.errorTileKeys={},this.wantedResolution,this.getSourceTiles=s.bind(void 0,this),this.removeSourceTiles_=o,this.wrappedTileCoord=i}getContext(){return this.context_||(this.context_=(0,r.Y)(1,1,n)),this.context_}hasContext(){return!!this.context_}getImage(){return this.hasContext()?this.getContext().canvas:null}getReplayState(e){const t=(0,l.v6)(e);return t in this.replayState_||(this.replayState_[t]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedTileZ:-1}),this.replayState_[t]}load(){this.getSourceTiles()}release(){this.context_&&((0,r.Yg)(this.context_),n.push(this.context_.canvas),this.context_=null),this.removeSourceTiles_(this),this.sourceTiles.length=0,super.release()}}var u=a;class c extends o.A{constructor(e,t,i,s,o,r){super(e,t,r),this.extent=null,this.format_=s,this.features_=null,this.loader_,this.projection=null,this.resolution,this.tileLoadFunction_=o,this.url_=i,this.key=i}getTileUrl(){return this.url_}getFormat(){return this.format_}getFeatures(){return this.features_}load(){this.state==s.A.IDLE&&(this.setState(s.A.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_&&this.loader_(this.extent,this.resolution,this.projection))}onLoad(e,t){this.setFeatures(e)}onError(){this.setState(s.A.ERROR)}setFeatures(e){this.features_=e,this.setState(s.A.LOADED)}setLoader(e){this.loader_=e}}var h=c,d=i(90588),g=i(6837),T=i(70915),_=i(21142),p=i(43530),S=i(38599),x=i(6782),A=i(56758),y=i(57115),E=i(4863),R=i(46164);class f extends R["default"]{constructor(e){const t=e.projection||"EPSG:3857",i=e.extent||(0,E.kZ)(t),s=e.tileGrid||(0,E.EN)({extent:i,maxResolution:e.maxResolution,maxZoom:void 0!==e.maxZoom?e.maxZoom:22,minZoom:e.minZoom,tileSize:e.tileSize||512});super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,interpolate:!0,projection:t,state:e.state,tileGrid:s,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:v,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,zDirection:void 0===e.zDirection?1:e.zDirection}),this.format_=e.format?e.format:null,this.tileKeysBySourceTileUrl_={},this.sourceTiles_={},this.overlaps_=void 0==e.overlaps||e.overlaps,this.tileClass=e.tileClass?e.tileClass:h,this.tileGrids_={}}getOverlaps(){return this.overlaps_}getSourceTiles(e,t,i){if(i.getState()===s.A.IDLE){i.setState(s.A.LOADING);const o=i.wrappedTileCoord,r=this.getTileGridForProjection(t),l=r.getTileCoordExtent(o),n=o[0],a=r.getResolution(n);(0,T.r)(l,-a,l);const u=this.tileGrid,c=u.getExtent();c&&(0,T._N)(l,c,l);const h=u.getZForResolution(a,this.zDirection);u.forEachTileCoord(l,h,o=>{const r=this.tileUrlFunction(o,e,t);this.sourceTiles_[r]||(this.sourceTiles_[r]=new this.tileClass(o,r?s.A.IDLE:s.A.EMPTY,r,this.format_,this.tileLoadFunction));const l=this.sourceTiles_[r];i.sourceTiles.push(l),this.tileKeysBySourceTileUrl_[r]||(this.tileKeysBySourceTileUrl_[r]=[]),this.tileKeysBySourceTileUrl_[r].push(i.getKey());const n=l.getState();if(n<s.A.LOADED){const e=t=>{this.handleTileChange(t);const o=l.getState();if(o===s.A.LOADED||o===s.A.ERROR){const t=l.getKey();t in i.errorTileKeys?l.getState()===s.A.LOADED&&delete i.errorTileKeys[t]:i.loadingSourceTiles--,o===s.A.ERROR?i.errorTileKeys[t]=!0:l.removeEventListener(g.A.CHANGE,e),0===i.loadingSourceTiles&&i.setState((0,p.p)(i.errorTileKeys)?s.A.LOADED:s.A.ERROR)}};l.addEventListener(g.A.CHANGE,e),i.loadingSourceTiles++}n===s.A.IDLE&&(l.extent=u.getTileCoordExtent(o),l.projection=t,l.resolution=u.getResolution(o[0]),l.load())}),i.loadingSourceTiles||i.setState(i.sourceTiles.some(e=>e.getState()===s.A.ERROR)?s.A.ERROR:s.A.LOADED)}return i.sourceTiles}removeSourceTiles(e){const t=e.getKey(),i=e.sourceTiles;for(let s=0,o=i.length;s<o;++s){const e=i[s].getTileUrl();if(!this.tileKeysBySourceTileUrl_[e])return;const o=this.tileKeysBySourceTileUrl_[e].indexOf(t);-1!==o&&(this.tileKeysBySourceTileUrl_[e].splice(o,1),0===this.tileKeysBySourceTileUrl_[e].length&&(delete this.tileKeysBySourceTileUrl_[e],delete this.sourceTiles_[e]))}}getTile(e,t,i,o,r){const l=[e,t,i];let n=this.getTileCoordForTileUrlFunction(l,r);const a=this.getTileGrid().getExtent(),c=this.getTileGridForProjection(r);if(n&&a){const t=c.getTileCoordExtent(n);(0,T.r)(t,-c.getResolution(e),t),(0,T.HY)(a,t)||(n=null)}let h=!0;if(null!==n){const t=this.tileGrid,i=c.getResolution(e),s=t.getZForResolution(i,1),l=c.getTileCoordExtent(n);(0,T.r)(l,-i,l),t.forEachTileCoord(l,s,e=>{h=h&&!this.tileUrlFunction(e,o,r)})}const d=new u(l,h?s.A.EMPTY:s.A.IDLE,n,this.getSourceTiles.bind(this,o,r),this.removeSourceTiles.bind(this));return d.key=this.getKey(),d}getTileGridForProjection(e){const t=e.getCode();let i=this.tileGrids_[t];if(!i){const s=this.getProjection();(0,d.v)(null===s||(0,S.tI)(s,e),"A VectorTile source can only be rendered if it has a projection compatible with the view projection.");const o=this.tileGrid,r=o.getResolutions().slice(),l=r.map(function(e,t){return o.getOrigin(t)}),n=r.map(function(e,t){return o.getTileSize(t)}),a=y.L+1;for(let e=r.length;e<a;++e)r.push(r[e-1]/2),l.push(l[e-1]),n.push(n[e-1]);i=new A.A({extent:o.getExtent(),origins:l,resolutions:r,tileSizes:n}),this.tileGrids_[t]=i}return i}getTilePixelRatio(e){return e}getTilePixelSize(e,t,i){const s=this.getTileGridForProjection(i),o=(0,x.xq)(s.getTileSize(e),this.tmpSize);return[Math.round(o[0]*t),Math.round(o[1]*t)]}setOverlaps(e){this.overlaps_=e,this.changed()}}var m=f;function v(e,t){e.setLoader(function(i,s,o){(0,_.m8)(t,e.getFormat(),i,s,o,e.onLoad.bind(e),e.onError.bind(e))})}}}]);
//# sourceMappingURL=180.7d2b8693.js.map