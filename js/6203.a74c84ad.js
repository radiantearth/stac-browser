"use strict";(self["webpackChunk_radiantearth_stac_browser"]=self["webpackChunk_radiantearth_stac_browser"]||[]).push([[6203],{76203:function(t,e,s){s.r(e);var i=s(86717),n=s(90588),r=s(6933),o=s(6837),a=s(70915),h=s(44294),u=s(4087),c=s(42457);class l extends c["default"]{constructor(t){t=t||{},super({attributions:t.attributions,wrapX:t.wrapX}),this.resolution=void 0,this.distance=void 0!==t.distance?t.distance:20,this.minDistance=t.minDistance||0,this.interpolationRatio=0,this.features=[],this.geometryFunction=t.geometryFunction||function(t){const e=t.getGeometry();return(0,n.v)(!e||"Point"===e.getType(),"The default `geometryFunction` can only handle `Point` or null geometries"),e},this.createCustomCluster_=t.createCluster,this.source=null,this.boundRefresh_=this.refresh.bind(this),this.updateDistance(this.distance,this.minDistance),this.setSource(t.source||null)}clear(t){this.features.length=0,super.clear(t)}getDistance(){return this.distance}getSource(){return this.source}loadFeatures(t,e,s){this.source?.loadFeatures(t,e,s),e!==this.resolution&&(this.resolution=e,this.refresh())}setDistance(t){this.updateDistance(t,this.minDistance)}setMinDistance(t){this.updateDistance(this.distance,t)}getMinDistance(){return this.minDistance}setSource(t){this.source&&this.source.removeEventListener(o.A.CHANGE,this.boundRefresh_),this.source=t,t&&t.addEventListener(o.A.CHANGE,this.boundRefresh_),this.refresh()}refresh(){this.clear(),this.cluster(),this.addFeatures(this.features)}updateDistance(t,e){const s=0===t?0:Math.min(e,t)/t,i=t!==this.distance||this.interpolationRatio!==s;this.distance=t,this.minDistance=e,this.interpolationRatio=s,i&&this.refresh()}cluster(){if(void 0===this.resolution||!this.source)return;const t=(0,a.S5)(),e=this.distance*this.resolution,s=this.source.getFeatures(),i={};for(let n=0,r=s.length;n<r;n++){const r=s[n];if(!((0,u.v6)(r)in i)){const s=this.geometryFunction(r);if(s){const n=s.getCoordinates();(0,a.dP)(n,t),(0,a.r)(t,e,t);const r=this.source.getFeaturesInExtent(t).filter(function(t){const e=(0,u.v6)(t);return!(e in i)&&(i[e]=!0,!0)});this.features.push(this.createCluster(r,t))}}}}createCluster(t,e){const s=[0,0];for(let i=t.length-1;i>=0;--i){const e=this.geometryFunction(t[i]);e?(0,r.WQ)(s,e.getCoordinates()):t.splice(i,1)}(0,r.hs)(s,1/t.length);const n=(0,a.q1)(e),o=this.interpolationRatio,u=new h.A([s[0]*(1-o)+n[0]*o,s[1]*(1-o)+n[1]*o]);return this.createCustomCluster_?this.createCustomCluster_(u,t):new i.A({geometry:u,features:t})}}e["default"]=l}}]);
//# sourceMappingURL=6203.a74c84ad.js.map