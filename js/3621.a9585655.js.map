{"version":3,"file":"js/3621.a9585655.js","mappings":"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","sources":["webpack://@radiantearth/stac-browser/./node_modules/jwt-decode/build/esm/index.js","webpack://@radiantearth/stac-browser/./node_modules/oidc-client-ts/dist/esm/oidc-client-ts.js","webpack://@radiantearth/stac-browser/./src/auth/oidc.js"],"sourcesContent":["export class InvalidTokenError extends Error {\n}\nInvalidTokenError.prototype.name = \"InvalidTokenError\";\nfunction b64DecodeUnicode(str) {\n    return decodeURIComponent(atob(str).replace(/(.)/g, (m, p) => {\n        let code = p.charCodeAt(0).toString(16).toUpperCase();\n        if (code.length < 2) {\n            code = \"0\" + code;\n        }\n        return \"%\" + code;\n    }));\n}\nfunction base64UrlDecode(str) {\n    let output = str.replace(/-/g, \"+\").replace(/_/g, \"/\");\n    switch (output.length % 4) {\n        case 0:\n            break;\n        case 2:\n            output += \"==\";\n            break;\n        case 3:\n            output += \"=\";\n            break;\n        default:\n            throw new Error(\"base64 string is not of the correct length\");\n    }\n    try {\n        return b64DecodeUnicode(output);\n    }\n    catch (err) {\n        return atob(output);\n    }\n}\nexport function jwtDecode(token, options) {\n    if (typeof token !== \"string\") {\n        throw new InvalidTokenError(\"Invalid token specified: must be a string\");\n    }\n    options || (options = {});\n    const pos = options.header === true ? 0 : 1;\n    const part = token.split(\".\")[pos];\n    if (typeof part !== \"string\") {\n        throw new InvalidTokenError(`Invalid token specified: missing part #${pos + 1}`);\n    }\n    let decoded;\n    try {\n        decoded = base64UrlDecode(part);\n    }\n    catch (e) {\n        throw new InvalidTokenError(`Invalid token specified: invalid base64 for part #${pos + 1} (${e.message})`);\n    }\n    try {\n        return JSON.parse(decoded);\n    }\n    catch (e) {\n        throw new InvalidTokenError(`Invalid token specified: invalid json for part #${pos + 1} (${e.message})`);\n    }\n}\n","// src/utils/Logger.ts\nvar nopLogger = {\n  debug: () => void 0,\n  info: () => void 0,\n  warn: () => void 0,\n  error: () => void 0\n};\nvar level;\nvar logger;\nvar Log = /* @__PURE__ */ ((Log2) => {\n  Log2[Log2[\"NONE\"] = 0] = \"NONE\";\n  Log2[Log2[\"ERROR\"] = 1] = \"ERROR\";\n  Log2[Log2[\"WARN\"] = 2] = \"WARN\";\n  Log2[Log2[\"INFO\"] = 3] = \"INFO\";\n  Log2[Log2[\"DEBUG\"] = 4] = \"DEBUG\";\n  return Log2;\n})(Log || {});\n((Log2) => {\n  function reset() {\n    level = 3 /* INFO */;\n    logger = nopLogger;\n  }\n  Log2.reset = reset;\n  function setLevel(value) {\n    if (!(0 /* NONE */ <= value && value <= 4 /* DEBUG */)) {\n      throw new Error(\"Invalid log level\");\n    }\n    level = value;\n  }\n  Log2.setLevel = setLevel;\n  function setLogger(value) {\n    logger = value;\n  }\n  Log2.setLogger = setLogger;\n})(Log || (Log = {}));\nvar Logger = class _Logger {\n  constructor(_name) {\n    this._name = _name;\n  }\n  /* eslint-disable @typescript-eslint/no-unsafe-enum-comparison */\n  debug(...args) {\n    if (level >= 4 /* DEBUG */) {\n      logger.debug(_Logger._format(this._name, this._method), ...args);\n    }\n  }\n  info(...args) {\n    if (level >= 3 /* INFO */) {\n      logger.info(_Logger._format(this._name, this._method), ...args);\n    }\n  }\n  warn(...args) {\n    if (level >= 2 /* WARN */) {\n      logger.warn(_Logger._format(this._name, this._method), ...args);\n    }\n  }\n  error(...args) {\n    if (level >= 1 /* ERROR */) {\n      logger.error(_Logger._format(this._name, this._method), ...args);\n    }\n  }\n  /* eslint-enable @typescript-eslint/no-unsafe-enum-comparison */\n  throw(err) {\n    this.error(err);\n    throw err;\n  }\n  create(method) {\n    const methodLogger = Object.create(this);\n    methodLogger._method = method;\n    methodLogger.debug(\"begin\");\n    return methodLogger;\n  }\n  static createStatic(name, staticMethod) {\n    const staticLogger = new _Logger(`${name}.${staticMethod}`);\n    staticLogger.debug(\"begin\");\n    return staticLogger;\n  }\n  static _format(name, method) {\n    const prefix = `[${name}]`;\n    return method ? `${prefix} ${method}:` : prefix;\n  }\n  /* eslint-disable @typescript-eslint/no-unsafe-enum-comparison */\n  // helpers for static class methods\n  static debug(name, ...args) {\n    if (level >= 4 /* DEBUG */) {\n      logger.debug(_Logger._format(name), ...args);\n    }\n  }\n  static info(name, ...args) {\n    if (level >= 3 /* INFO */) {\n      logger.info(_Logger._format(name), ...args);\n    }\n  }\n  static warn(name, ...args) {\n    if (level >= 2 /* WARN */) {\n      logger.warn(_Logger._format(name), ...args);\n    }\n  }\n  static error(name, ...args) {\n    if (level >= 1 /* ERROR */) {\n      logger.error(_Logger._format(name), ...args);\n    }\n  }\n  /* eslint-enable @typescript-eslint/no-unsafe-enum-comparison */\n};\nLog.reset();\n\n// src/utils/JwtUtils.ts\nimport { jwtDecode } from \"jwt-decode\";\nvar JwtUtils = class {\n  // IMPORTANT: doesn't validate the token\n  static decode(token) {\n    try {\n      return jwtDecode(token);\n    } catch (err) {\n      Logger.error(\"JwtUtils.decode\", err);\n      throw err;\n    }\n  }\n  static async generateSignedJwt(header, payload, privateKey) {\n    const encodedHeader = CryptoUtils.encodeBase64Url(new TextEncoder().encode(JSON.stringify(header)));\n    const encodedPayload = CryptoUtils.encodeBase64Url(new TextEncoder().encode(JSON.stringify(payload)));\n    const encodedToken = `${encodedHeader}.${encodedPayload}`;\n    const signature = await window.crypto.subtle.sign(\n      {\n        name: \"ECDSA\",\n        hash: { name: \"SHA-256\" }\n      },\n      privateKey,\n      new TextEncoder().encode(encodedToken)\n    );\n    const encodedSignature = CryptoUtils.encodeBase64Url(new Uint8Array(signature));\n    return `${encodedToken}.${encodedSignature}`;\n  }\n  static async generateSignedJwtWithHmac(header, payload, secretKey) {\n    const encodedHeader = CryptoUtils.encodeBase64Url(new TextEncoder().encode(JSON.stringify(header)));\n    const encodedPayload = CryptoUtils.encodeBase64Url(new TextEncoder().encode(JSON.stringify(payload)));\n    const encodedToken = `${encodedHeader}.${encodedPayload}`;\n    const signature = await window.crypto.subtle.sign(\n      \"HMAC\",\n      secretKey,\n      new TextEncoder().encode(encodedToken)\n    );\n    const encodedSignature = CryptoUtils.encodeBase64Url(new Uint8Array(signature));\n    return `${encodedToken}.${encodedSignature}`;\n  }\n};\n\n// src/utils/CryptoUtils.ts\nvar UUID_V4_TEMPLATE = \"10000000-1000-4000-8000-100000000000\";\nvar toBase64 = (val) => btoa([...new Uint8Array(val)].map((chr) => String.fromCharCode(chr)).join(\"\"));\nvar _CryptoUtils = class _CryptoUtils {\n  static _randomWord() {\n    const arr = new Uint32Array(1);\n    crypto.getRandomValues(arr);\n    return arr[0];\n  }\n  /**\n   * Generates RFC4122 version 4 guid\n   */\n  static generateUUIDv4() {\n    const uuid = UUID_V4_TEMPLATE.replace(\n      /[018]/g,\n      (c) => (+c ^ _CryptoUtils._randomWord() & 15 >> +c / 4).toString(16)\n    );\n    return uuid.replace(/-/g, \"\");\n  }\n  /**\n   * PKCE: Generate a code verifier\n   */\n  static generateCodeVerifier() {\n    return _CryptoUtils.generateUUIDv4() + _CryptoUtils.generateUUIDv4() + _CryptoUtils.generateUUIDv4();\n  }\n  /**\n   * PKCE: Generate a code challenge\n   */\n  static async generateCodeChallenge(code_verifier) {\n    if (!crypto.subtle) {\n      throw new Error(\"Crypto.subtle is available only in secure contexts (HTTPS).\");\n    }\n    try {\n      const encoder = new TextEncoder();\n      const data = encoder.encode(code_verifier);\n      const hashed = await crypto.subtle.digest(\"SHA-256\", data);\n      return toBase64(hashed).replace(/\\+/g, \"-\").replace(/\\//g, \"_\").replace(/=+$/, \"\");\n    } catch (err) {\n      Logger.error(\"CryptoUtils.generateCodeChallenge\", err);\n      throw err;\n    }\n  }\n  /**\n   * Generates a base64-encoded string for a basic auth header\n   */\n  static generateBasicAuth(client_id, client_secret) {\n    const encoder = new TextEncoder();\n    const data = encoder.encode([client_id, client_secret].join(\":\"));\n    return toBase64(data);\n  }\n  /**\n   * Generates a hash of a string using a given algorithm\n   * @param alg\n   * @param message\n   */\n  static async hash(alg, message) {\n    const msgUint8 = new TextEncoder().encode(message);\n    const hashBuffer = await crypto.subtle.digest(alg, msgUint8);\n    return new Uint8Array(hashBuffer);\n  }\n  /**\n   * Generates a rfc7638 compliant jwk thumbprint\n   * @param jwk\n   */\n  static async customCalculateJwkThumbprint(jwk) {\n    let jsonObject;\n    switch (jwk.kty) {\n      case \"RSA\":\n        jsonObject = {\n          \"e\": jwk.e,\n          \"kty\": jwk.kty,\n          \"n\": jwk.n\n        };\n        break;\n      case \"EC\":\n        jsonObject = {\n          \"crv\": jwk.crv,\n          \"kty\": jwk.kty,\n          \"x\": jwk.x,\n          \"y\": jwk.y\n        };\n        break;\n      case \"OKP\":\n        jsonObject = {\n          \"crv\": jwk.crv,\n          \"kty\": jwk.kty,\n          \"x\": jwk.x\n        };\n        break;\n      case \"oct\":\n        jsonObject = {\n          \"crv\": jwk.k,\n          \"kty\": jwk.kty\n        };\n        break;\n      default:\n        throw new Error(\"Unknown jwk type\");\n    }\n    const utf8encodedAndHashed = await _CryptoUtils.hash(\"SHA-256\", JSON.stringify(jsonObject));\n    return _CryptoUtils.encodeBase64Url(utf8encodedAndHashed);\n  }\n  static async generateDPoPProof({\n    url,\n    accessToken,\n    httpMethod,\n    keyPair,\n    nonce\n  }) {\n    let hashedToken;\n    let encodedHash;\n    const payload = {\n      \"jti\": window.crypto.randomUUID(),\n      \"htm\": httpMethod != null ? httpMethod : \"GET\",\n      \"htu\": url,\n      \"iat\": Math.floor(Date.now() / 1e3)\n    };\n    if (accessToken) {\n      hashedToken = await _CryptoUtils.hash(\"SHA-256\", accessToken);\n      encodedHash = _CryptoUtils.encodeBase64Url(hashedToken);\n      payload.ath = encodedHash;\n    }\n    if (nonce) {\n      payload.nonce = nonce;\n    }\n    try {\n      const publicJwk = await crypto.subtle.exportKey(\"jwk\", keyPair.publicKey);\n      const header = {\n        \"alg\": \"ES256\",\n        \"typ\": \"dpop+jwt\",\n        \"jwk\": {\n          \"crv\": publicJwk.crv,\n          \"kty\": publicJwk.kty,\n          \"x\": publicJwk.x,\n          \"y\": publicJwk.y\n        }\n      };\n      return await JwtUtils.generateSignedJwt(header, payload, keyPair.privateKey);\n    } catch (err) {\n      if (err instanceof TypeError) {\n        throw new Error(`Error exporting dpop public key: ${err.message}`);\n      } else {\n        throw err;\n      }\n    }\n  }\n  static async generateDPoPJkt(keyPair) {\n    try {\n      const publicJwk = await crypto.subtle.exportKey(\"jwk\", keyPair.publicKey);\n      return await _CryptoUtils.customCalculateJwkThumbprint(publicJwk);\n    } catch (err) {\n      if (err instanceof TypeError) {\n        throw new Error(`Could not retrieve dpop keys from storage: ${err.message}`);\n      } else {\n        throw err;\n      }\n    }\n  }\n  static async generateDPoPKeys() {\n    return await window.crypto.subtle.generateKey(\n      {\n        name: \"ECDSA\",\n        namedCurve: \"P-256\"\n      },\n      false,\n      [\"sign\", \"verify\"]\n    );\n  }\n  /**\n   * Generates a client assertion JWT for client_secret_jwt authentication\n   * @param client_id The client identifier\n   * @param client_secret The client secret\n   * @param audience The token endpoint URL (audience)\n   * @param algorithm The HMAC algorithm to use (HS256, HS384, HS512). Defaults to HS256\n   */\n  static async generateClientAssertionJwt(client_id, client_secret, audience, algorithm = \"HS256\") {\n    const now = Math.floor(Date.now() / 1e3);\n    const header = {\n      \"alg\": algorithm,\n      \"typ\": \"JWT\"\n    };\n    const payload = {\n      \"iss\": client_id,\n      \"sub\": client_id,\n      \"aud\": audience,\n      \"jti\": _CryptoUtils.generateUUIDv4(),\n      \"exp\": now + 300,\n      // 5 minutes\n      \"iat\": now\n    };\n    const hashMap = {\n      \"HS256\": \"SHA-256\",\n      \"HS384\": \"SHA-384\",\n      \"HS512\": \"SHA-512\"\n    };\n    const hashFunction = hashMap[algorithm];\n    if (!hashFunction) {\n      throw new Error(`Unsupported algorithm: ${algorithm}. Supported algorithms are: HS256, HS384, HS512`);\n    }\n    const encoder = new TextEncoder();\n    const secretKey = await crypto.subtle.importKey(\n      \"raw\",\n      encoder.encode(client_secret),\n      { name: \"HMAC\", hash: hashFunction },\n      false,\n      [\"sign\"]\n    );\n    return await JwtUtils.generateSignedJwtWithHmac(header, payload, secretKey);\n  }\n};\n/**\n * Generates a base64url encoded string\n */\n_CryptoUtils.encodeBase64Url = (input) => {\n  return toBase64(input).replace(/=/g, \"\").replace(/\\+/g, \"-\").replace(/\\//g, \"_\");\n};\nvar CryptoUtils = _CryptoUtils;\n\n// src/utils/Event.ts\nvar Event = class {\n  constructor(_name) {\n    this._name = _name;\n    this._callbacks = [];\n    this._logger = new Logger(`Event('${this._name}')`);\n  }\n  addHandler(cb) {\n    this._callbacks.push(cb);\n    return () => this.removeHandler(cb);\n  }\n  removeHandler(cb) {\n    const idx = this._callbacks.lastIndexOf(cb);\n    if (idx >= 0) {\n      this._callbacks.splice(idx, 1);\n    }\n  }\n  async raise(...ev) {\n    this._logger.debug(\"raise:\", ...ev);\n    for (const cb of this._callbacks) {\n      await cb(...ev);\n    }\n  }\n};\n\n// src/utils/PopupUtils.ts\nvar PopupUtils = class {\n  /**\n   * Populates a map of window features with a placement centered in front of\n   * the current window. If no explicit width is given, a default value is\n   * binned into [800, 720, 600, 480, 360] based on the current window's width.\n   */\n  static center({ ...features }) {\n    var _a, _b, _c;\n    if (features.width == null)\n      features.width = (_a = [800, 720, 600, 480].find((width) => width <= window.outerWidth / 1.618)) != null ? _a : 360;\n    (_b = features.left) != null ? _b : features.left = Math.max(0, Math.round(window.screenX + (window.outerWidth - features.width) / 2));\n    if (features.height != null)\n      (_c = features.top) != null ? _c : features.top = Math.max(0, Math.round(window.screenY + (window.outerHeight - features.height) / 2));\n    return features;\n  }\n  static serialize(features) {\n    return Object.entries(features).filter(([, value]) => value != null).map(([key, value]) => `${key}=${typeof value !== \"boolean\" ? value : value ? \"yes\" : \"no\"}`).join(\",\");\n  }\n};\n\n// src/utils/Timer.ts\nvar Timer = class _Timer extends Event {\n  constructor() {\n    super(...arguments);\n    this._logger = new Logger(`Timer('${this._name}')`);\n    this._timerHandle = null;\n    this._expiration = 0;\n    this._callback = () => {\n      const diff = this._expiration - _Timer.getEpochTime();\n      this._logger.debug(\"timer completes in\", diff);\n      if (this._expiration <= _Timer.getEpochTime()) {\n        this.cancel();\n        void super.raise();\n      }\n    };\n  }\n  // get the time\n  static getEpochTime() {\n    return Math.floor(Date.now() / 1e3);\n  }\n  init(durationInSeconds) {\n    const logger2 = this._logger.create(\"init\");\n    durationInSeconds = Math.max(Math.floor(durationInSeconds), 1);\n    const expiration = _Timer.getEpochTime() + durationInSeconds;\n    if (this.expiration === expiration && this._timerHandle) {\n      logger2.debug(\"skipping since already initialized for expiration at\", this.expiration);\n      return;\n    }\n    this.cancel();\n    logger2.debug(\"using duration\", durationInSeconds);\n    this._expiration = expiration;\n    const timerDurationInSeconds = Math.min(durationInSeconds, 5);\n    this._timerHandle = setInterval(this._callback, timerDurationInSeconds * 1e3);\n  }\n  get expiration() {\n    return this._expiration;\n  }\n  cancel() {\n    this._logger.create(\"cancel\");\n    if (this._timerHandle) {\n      clearInterval(this._timerHandle);\n      this._timerHandle = null;\n    }\n  }\n};\n\n// src/utils/UrlUtils.ts\nvar UrlUtils = class {\n  static readParams(url, responseMode = \"query\") {\n    if (!url) throw new TypeError(\"Invalid URL\");\n    const parsedUrl = new URL(url, \"http://127.0.0.1\");\n    const params = parsedUrl[responseMode === \"fragment\" ? \"hash\" : \"search\"];\n    return new URLSearchParams(params.slice(1));\n  }\n};\nvar URL_STATE_DELIMITER = \";\";\n\n// src/errors/ErrorResponse.ts\nvar ErrorResponse = class extends Error {\n  constructor(args, form) {\n    var _a, _b, _c;\n    super(args.error_description || args.error || \"\");\n    this.form = form;\n    /** Marker to detect class: \"ErrorResponse\" */\n    this.name = \"ErrorResponse\";\n    if (!args.error) {\n      Logger.error(\"ErrorResponse\", \"No error passed\");\n      throw new Error(\"No error passed\");\n    }\n    this.error = args.error;\n    this.error_description = (_a = args.error_description) != null ? _a : null;\n    this.error_uri = (_b = args.error_uri) != null ? _b : null;\n    this.state = args.userState;\n    this.session_state = (_c = args.session_state) != null ? _c : null;\n    this.url_state = args.url_state;\n  }\n};\n\n// src/errors/ErrorTimeout.ts\nvar ErrorTimeout = class extends Error {\n  constructor(message) {\n    super(message);\n    /** Marker to detect class: \"ErrorTimeout\" */\n    this.name = \"ErrorTimeout\";\n  }\n};\n\n// src/AccessTokenEvents.ts\nvar AccessTokenEvents = class {\n  constructor(args) {\n    this._logger = new Logger(\"AccessTokenEvents\");\n    this._expiringTimer = new Timer(\"Access token expiring\");\n    this._expiredTimer = new Timer(\"Access token expired\");\n    this._expiringNotificationTimeInSeconds = args.expiringNotificationTimeInSeconds;\n  }\n  async load(container) {\n    const logger2 = this._logger.create(\"load\");\n    if (container.access_token && container.expires_in !== void 0) {\n      const duration = container.expires_in;\n      logger2.debug(\"access token present, remaining duration:\", duration);\n      if (duration > 0) {\n        let expiring = duration - this._expiringNotificationTimeInSeconds;\n        if (expiring <= 0) {\n          expiring = 1;\n        }\n        logger2.debug(\"registering expiring timer, raising in\", expiring, \"seconds\");\n        this._expiringTimer.init(expiring);\n      } else {\n        logger2.debug(\"canceling existing expiring timer because we're past expiration.\");\n        this._expiringTimer.cancel();\n      }\n      const expired = duration + 1;\n      logger2.debug(\"registering expired timer, raising in\", expired, \"seconds\");\n      this._expiredTimer.init(expired);\n    } else {\n      this._expiringTimer.cancel();\n      this._expiredTimer.cancel();\n    }\n  }\n  async unload() {\n    this._logger.debug(\"unload: canceling existing access token timers\");\n    this._expiringTimer.cancel();\n    this._expiredTimer.cancel();\n  }\n  /**\n   * Add callback: Raised prior to the access token expiring.\n   */\n  addAccessTokenExpiring(cb) {\n    return this._expiringTimer.addHandler(cb);\n  }\n  /**\n   * Remove callback: Raised prior to the access token expiring.\n   */\n  removeAccessTokenExpiring(cb) {\n    this._expiringTimer.removeHandler(cb);\n  }\n  /**\n   * Add callback: Raised after the access token has expired.\n   */\n  addAccessTokenExpired(cb) {\n    return this._expiredTimer.addHandler(cb);\n  }\n  /**\n   * Remove callback: Raised after the access token has expired.\n   */\n  removeAccessTokenExpired(cb) {\n    this._expiredTimer.removeHandler(cb);\n  }\n};\n\n// src/CheckSessionIFrame.ts\nvar CheckSessionIFrame = class {\n  constructor(_callback, _client_id, url, _intervalInSeconds, _stopOnError) {\n    this._callback = _callback;\n    this._client_id = _client_id;\n    this._intervalInSeconds = _intervalInSeconds;\n    this._stopOnError = _stopOnError;\n    this._logger = new Logger(\"CheckSessionIFrame\");\n    this._timer = null;\n    this._session_state = null;\n    this._message = (e) => {\n      if (e.origin === this._frame_origin && e.source === this._frame.contentWindow) {\n        if (e.data === \"error\") {\n          this._logger.error(\"error message from check session op iframe\");\n          if (this._stopOnError) {\n            this.stop();\n          }\n        } else if (e.data === \"changed\") {\n          this._logger.debug(\"changed message from check session op iframe\");\n          this.stop();\n          void this._callback();\n        } else {\n          this._logger.debug(e.data + \" message from check session op iframe\");\n        }\n      }\n    };\n    const parsedUrl = new URL(url);\n    this._frame_origin = parsedUrl.origin;\n    this._frame = window.document.createElement(\"iframe\");\n    this._frame.style.visibility = \"hidden\";\n    this._frame.style.position = \"fixed\";\n    this._frame.style.left = \"-1000px\";\n    this._frame.style.top = \"0\";\n    this._frame.width = \"0\";\n    this._frame.height = \"0\";\n    this._frame.src = parsedUrl.href;\n  }\n  load() {\n    return new Promise((resolve) => {\n      this._frame.onload = () => {\n        resolve();\n      };\n      window.document.body.appendChild(this._frame);\n      window.addEventListener(\"message\", this._message, false);\n    });\n  }\n  start(session_state) {\n    if (this._session_state === session_state) {\n      return;\n    }\n    this._logger.create(\"start\");\n    this.stop();\n    this._session_state = session_state;\n    const send = () => {\n      if (!this._frame.contentWindow || !this._session_state) {\n        return;\n      }\n      this._frame.contentWindow.postMessage(this._client_id + \" \" + this._session_state, this._frame_origin);\n    };\n    send();\n    this._timer = setInterval(send, this._intervalInSeconds * 1e3);\n  }\n  stop() {\n    this._logger.create(\"stop\");\n    this._session_state = null;\n    if (this._timer) {\n      clearInterval(this._timer);\n      this._timer = null;\n    }\n  }\n};\n\n// src/InMemoryWebStorage.ts\nvar InMemoryWebStorage = class {\n  constructor() {\n    this._logger = new Logger(\"InMemoryWebStorage\");\n    this._data = {};\n  }\n  clear() {\n    this._logger.create(\"clear\");\n    this._data = {};\n  }\n  getItem(key) {\n    this._logger.create(`getItem('${key}')`);\n    return this._data[key];\n  }\n  setItem(key, value) {\n    this._logger.create(`setItem('${key}')`);\n    this._data[key] = value;\n  }\n  removeItem(key) {\n    this._logger.create(`removeItem('${key}')`);\n    delete this._data[key];\n  }\n  get length() {\n    return Object.getOwnPropertyNames(this._data).length;\n  }\n  key(index) {\n    return Object.getOwnPropertyNames(this._data)[index];\n  }\n};\n\n// src/errors/ErrorDPoPNonce.ts\nvar ErrorDPoPNonce = class extends Error {\n  constructor(nonce, message) {\n    super(message);\n    /** Marker to detect class: \"ErrorDPoPNonce\" */\n    this.name = \"ErrorDPoPNonce\";\n    this.nonce = nonce;\n  }\n};\n\n// src/JsonService.ts\nvar JsonService = class {\n  constructor(additionalContentTypes = [], _jwtHandler = null, _extraHeaders = {}) {\n    this._jwtHandler = _jwtHandler;\n    this._extraHeaders = _extraHeaders;\n    this._logger = new Logger(\"JsonService\");\n    this._contentTypes = [];\n    this._contentTypes.push(...additionalContentTypes, \"application/json\");\n    if (_jwtHandler) {\n      this._contentTypes.push(\"application/jwt\");\n    }\n  }\n  async fetchWithTimeout(input, init = {}) {\n    const { timeoutInSeconds, ...initFetch } = init;\n    if (!timeoutInSeconds) {\n      return await fetch(input, initFetch);\n    }\n    const controller = new AbortController();\n    const timeoutId = setTimeout(() => controller.abort(), timeoutInSeconds * 1e3);\n    try {\n      const response = await fetch(input, {\n        ...init,\n        signal: controller.signal\n      });\n      return response;\n    } catch (err) {\n      if (err instanceof DOMException && err.name === \"AbortError\") {\n        throw new ErrorTimeout(\"Network timed out\");\n      }\n      throw err;\n    } finally {\n      clearTimeout(timeoutId);\n    }\n  }\n  async getJson(url, {\n    token,\n    credentials,\n    timeoutInSeconds\n  } = {}) {\n    const logger2 = this._logger.create(\"getJson\");\n    const headers = {\n      \"Accept\": this._contentTypes.join(\", \")\n    };\n    if (token) {\n      logger2.debug(\"token passed, setting Authorization header\");\n      headers[\"Authorization\"] = \"Bearer \" + token;\n    }\n    this._appendExtraHeaders(headers);\n    let response;\n    try {\n      logger2.debug(\"url:\", url);\n      response = await this.fetchWithTimeout(url, { method: \"GET\", headers, timeoutInSeconds, credentials });\n    } catch (err) {\n      logger2.error(\"Network Error\");\n      throw err;\n    }\n    logger2.debug(\"HTTP response received, status\", response.status);\n    const contentType = response.headers.get(\"Content-Type\");\n    if (contentType && !this._contentTypes.find((item) => contentType.startsWith(item))) {\n      logger2.throw(new Error(`Invalid response Content-Type: ${contentType != null ? contentType : \"undefined\"}, from URL: ${url}`));\n    }\n    if (response.ok && this._jwtHandler && (contentType == null ? void 0 : contentType.startsWith(\"application/jwt\"))) {\n      return await this._jwtHandler(await response.text());\n    }\n    let json;\n    try {\n      json = await response.json();\n    } catch (err) {\n      logger2.error(\"Error parsing JSON response\", err);\n      if (response.ok) throw err;\n      throw new Error(`${response.statusText} (${response.status})`);\n    }\n    if (!response.ok) {\n      logger2.error(\"Error from server:\", json);\n      if (json.error) {\n        throw new ErrorResponse(json);\n      }\n      throw new Error(`${response.statusText} (${response.status}): ${JSON.stringify(json)}`);\n    }\n    return json;\n  }\n  async postForm(url, {\n    body,\n    basicAuth,\n    timeoutInSeconds,\n    initCredentials,\n    extraHeaders\n  }) {\n    const logger2 = this._logger.create(\"postForm\");\n    const headers = {\n      \"Accept\": this._contentTypes.join(\", \"),\n      \"Content-Type\": \"application/x-www-form-urlencoded\",\n      ...extraHeaders\n    };\n    if (basicAuth !== void 0) {\n      headers[\"Authorization\"] = \"Basic \" + basicAuth;\n    }\n    this._appendExtraHeaders(headers);\n    let response;\n    try {\n      logger2.debug(\"url:\", url);\n      response = await this.fetchWithTimeout(url, { method: \"POST\", headers, body, timeoutInSeconds, credentials: initCredentials });\n    } catch (err) {\n      logger2.error(\"Network error\");\n      throw err;\n    }\n    logger2.debug(\"HTTP response received, status\", response.status);\n    const contentType = response.headers.get(\"Content-Type\");\n    if (contentType && !this._contentTypes.find((item) => contentType.startsWith(item))) {\n      throw new Error(`Invalid response Content-Type: ${contentType != null ? contentType : \"undefined\"}, from URL: ${url}`);\n    }\n    const responseText = await response.text();\n    let json = {};\n    if (responseText) {\n      try {\n        json = JSON.parse(responseText);\n      } catch (err) {\n        logger2.error(\"Error parsing JSON response\", err);\n        if (response.ok) throw err;\n        throw new Error(`${response.statusText} (${response.status})`);\n      }\n    }\n    if (!response.ok) {\n      logger2.error(\"Error from server:\", json);\n      if (response.headers.has(\"dpop-nonce\")) {\n        const nonce = response.headers.get(\"dpop-nonce\");\n        throw new ErrorDPoPNonce(nonce, `${JSON.stringify(json)}`);\n      }\n      if (json.error) {\n        throw new ErrorResponse(json, body);\n      }\n      throw new Error(`${response.statusText} (${response.status}): ${JSON.stringify(json)}`);\n    }\n    return json;\n  }\n  _appendExtraHeaders(headers) {\n    const logger2 = this._logger.create(\"appendExtraHeaders\");\n    const customKeys = Object.keys(this._extraHeaders);\n    const protectedHeaders = [\n      \"accept\",\n      \"content-type\"\n    ];\n    const preventOverride = [\n      \"authorization\"\n    ];\n    if (customKeys.length === 0) {\n      return;\n    }\n    customKeys.forEach((headerName) => {\n      if (protectedHeaders.includes(headerName.toLocaleLowerCase())) {\n        logger2.warn(\"Protected header could not be set\", headerName, protectedHeaders);\n        return;\n      }\n      if (preventOverride.includes(headerName.toLocaleLowerCase()) && Object.keys(headers).includes(headerName)) {\n        logger2.warn(\"Header could not be overridden\", headerName, preventOverride);\n        return;\n      }\n      const content = typeof this._extraHeaders[headerName] === \"function\" ? this._extraHeaders[headerName]() : this._extraHeaders[headerName];\n      if (content && content !== \"\") {\n        headers[headerName] = content;\n      }\n    });\n  }\n};\n\n// src/MetadataService.ts\nvar MetadataService = class {\n  constructor(_settings) {\n    this._settings = _settings;\n    this._logger = new Logger(\"MetadataService\");\n    this._signingKeys = null;\n    this._metadata = null;\n    this._metadataUrl = this._settings.metadataUrl;\n    this._jsonService = new JsonService(\n      [\"application/jwk-set+json\"],\n      null,\n      this._settings.extraHeaders\n    );\n    if (this._settings.signingKeys) {\n      this._logger.debug(\"using signingKeys from settings\");\n      this._signingKeys = this._settings.signingKeys;\n    }\n    if (this._settings.metadata) {\n      this._logger.debug(\"using metadata from settings\");\n      this._metadata = this._settings.metadata;\n    }\n    if (this._settings.fetchRequestCredentials) {\n      this._logger.debug(\"using fetchRequestCredentials from settings\");\n      this._fetchRequestCredentials = this._settings.fetchRequestCredentials;\n    }\n  }\n  resetSigningKeys() {\n    this._signingKeys = null;\n  }\n  async getMetadata() {\n    const logger2 = this._logger.create(\"getMetadata\");\n    if (this._metadata) {\n      logger2.debug(\"using cached values\");\n      return this._metadata;\n    }\n    if (!this._metadataUrl) {\n      logger2.throw(new Error(\"No authority or metadataUrl configured on settings\"));\n      throw null;\n    }\n    logger2.debug(\"getting metadata from\", this._metadataUrl);\n    const metadata = await this._jsonService.getJson(this._metadataUrl, { credentials: this._fetchRequestCredentials, timeoutInSeconds: this._settings.requestTimeoutInSeconds });\n    logger2.debug(\"merging remote JSON with seed metadata\");\n    this._metadata = Object.assign({}, metadata, this._settings.metadataSeed);\n    return this._metadata;\n  }\n  getIssuer() {\n    return this._getMetadataProperty(\"issuer\");\n  }\n  getAuthorizationEndpoint() {\n    return this._getMetadataProperty(\"authorization_endpoint\");\n  }\n  getUserInfoEndpoint() {\n    return this._getMetadataProperty(\"userinfo_endpoint\");\n  }\n  getTokenEndpoint(optional = true) {\n    return this._getMetadataProperty(\"token_endpoint\", optional);\n  }\n  getCheckSessionIframe() {\n    return this._getMetadataProperty(\"check_session_iframe\", true);\n  }\n  getEndSessionEndpoint() {\n    return this._getMetadataProperty(\"end_session_endpoint\", true);\n  }\n  getRevocationEndpoint(optional = true) {\n    return this._getMetadataProperty(\"revocation_endpoint\", optional);\n  }\n  getKeysEndpoint(optional = true) {\n    return this._getMetadataProperty(\"jwks_uri\", optional);\n  }\n  async _getMetadataProperty(name, optional = false) {\n    const logger2 = this._logger.create(`_getMetadataProperty('${name}')`);\n    const metadata = await this.getMetadata();\n    logger2.debug(\"resolved\");\n    if (metadata[name] === void 0) {\n      if (optional === true) {\n        logger2.warn(\"Metadata does not contain optional property\");\n        return void 0;\n      }\n      logger2.throw(new Error(\"Metadata does not contain property \" + name));\n    }\n    return metadata[name];\n  }\n  async getSigningKeys() {\n    const logger2 = this._logger.create(\"getSigningKeys\");\n    if (this._signingKeys) {\n      logger2.debug(\"returning signingKeys from cache\");\n      return this._signingKeys;\n    }\n    const jwks_uri = await this.getKeysEndpoint(false);\n    logger2.debug(\"got jwks_uri\", jwks_uri);\n    const keySet = await this._jsonService.getJson(jwks_uri, { timeoutInSeconds: this._settings.requestTimeoutInSeconds });\n    logger2.debug(\"got key set\", keySet);\n    if (!Array.isArray(keySet.keys)) {\n      logger2.throw(new Error(\"Missing keys on keyset\"));\n      throw null;\n    }\n    this._signingKeys = keySet.keys;\n    return this._signingKeys;\n  }\n};\n\n// src/WebStorageStateStore.ts\nvar WebStorageStateStore = class {\n  constructor({\n    prefix = \"oidc.\",\n    store = localStorage\n  } = {}) {\n    this._logger = new Logger(\"WebStorageStateStore\");\n    this._store = store;\n    this._prefix = prefix;\n  }\n  async set(key, value) {\n    this._logger.create(`set('${key}')`);\n    key = this._prefix + key;\n    await this._store.setItem(key, value);\n  }\n  async get(key) {\n    this._logger.create(`get('${key}')`);\n    key = this._prefix + key;\n    const item = await this._store.getItem(key);\n    return item;\n  }\n  async remove(key) {\n    this._logger.create(`remove('${key}')`);\n    key = this._prefix + key;\n    const item = await this._store.getItem(key);\n    await this._store.removeItem(key);\n    return item;\n  }\n  async getAllKeys() {\n    this._logger.create(\"getAllKeys\");\n    const len = await this._store.length;\n    const keys = [];\n    for (let index = 0; index < len; index++) {\n      const key = await this._store.key(index);\n      if (key && key.indexOf(this._prefix) === 0) {\n        keys.push(key.substr(this._prefix.length));\n      }\n    }\n    return keys;\n  }\n};\n\n// src/OidcClientSettings.ts\nvar DefaultResponseType = \"code\";\nvar DefaultScope = \"openid\";\nvar DefaultClientAuthentication = \"client_secret_post\";\nvar DefaultStaleStateAgeInSeconds = 60 * 15;\nvar OidcClientSettingsStore = class {\n  constructor({\n    // metadata related\n    authority,\n    metadataUrl,\n    metadata,\n    signingKeys,\n    metadataSeed,\n    // client related\n    client_id,\n    client_secret,\n    response_type = DefaultResponseType,\n    scope = DefaultScope,\n    redirect_uri,\n    post_logout_redirect_uri,\n    client_authentication = DefaultClientAuthentication,\n    token_endpoint_auth_signing_alg = \"HS256\",\n    // optional protocol\n    prompt,\n    display,\n    max_age,\n    ui_locales,\n    acr_values,\n    resource,\n    response_mode,\n    // behavior flags\n    filterProtocolClaims = true,\n    loadUserInfo = false,\n    requestTimeoutInSeconds,\n    staleStateAgeInSeconds = DefaultStaleStateAgeInSeconds,\n    mergeClaimsStrategy = { array: \"replace\" },\n    disablePKCE = false,\n    // other behavior\n    stateStore,\n    revokeTokenAdditionalContentTypes,\n    fetchRequestCredentials,\n    refreshTokenAllowedScope,\n    // extra\n    extraQueryParams = {},\n    extraTokenParams = {},\n    extraHeaders = {},\n    dpop,\n    omitScopeWhenRequesting = false\n  }) {\n    var _a;\n    this.authority = authority;\n    if (metadataUrl) {\n      this.metadataUrl = metadataUrl;\n    } else {\n      this.metadataUrl = authority;\n      if (authority) {\n        if (!this.metadataUrl.endsWith(\"/\")) {\n          this.metadataUrl += \"/\";\n        }\n        this.metadataUrl += \".well-known/openid-configuration\";\n      }\n    }\n    this.metadata = metadata;\n    this.metadataSeed = metadataSeed;\n    this.signingKeys = signingKeys;\n    this.client_id = client_id;\n    this.client_secret = client_secret;\n    this.response_type = response_type;\n    this.scope = scope;\n    this.redirect_uri = redirect_uri;\n    this.post_logout_redirect_uri = post_logout_redirect_uri;\n    this.client_authentication = client_authentication;\n    this.token_endpoint_auth_signing_alg = token_endpoint_auth_signing_alg;\n    this.prompt = prompt;\n    this.display = display;\n    this.max_age = max_age;\n    this.ui_locales = ui_locales;\n    this.acr_values = acr_values;\n    this.resource = resource;\n    this.response_mode = response_mode;\n    this.filterProtocolClaims = filterProtocolClaims != null ? filterProtocolClaims : true;\n    this.loadUserInfo = !!loadUserInfo;\n    this.staleStateAgeInSeconds = staleStateAgeInSeconds;\n    this.mergeClaimsStrategy = mergeClaimsStrategy;\n    this.omitScopeWhenRequesting = omitScopeWhenRequesting;\n    this.disablePKCE = !!disablePKCE;\n    this.revokeTokenAdditionalContentTypes = revokeTokenAdditionalContentTypes;\n    this.fetchRequestCredentials = fetchRequestCredentials ? fetchRequestCredentials : \"same-origin\";\n    this.requestTimeoutInSeconds = requestTimeoutInSeconds;\n    if (stateStore) {\n      this.stateStore = stateStore;\n    } else {\n      const store = typeof window !== \"undefined\" ? window.localStorage : new InMemoryWebStorage();\n      this.stateStore = new WebStorageStateStore({ store });\n    }\n    this.refreshTokenAllowedScope = refreshTokenAllowedScope;\n    this.extraQueryParams = extraQueryParams;\n    this.extraTokenParams = extraTokenParams;\n    this.extraHeaders = extraHeaders;\n    this.dpop = dpop;\n    if (this.dpop && !((_a = this.dpop) == null ? void 0 : _a.store)) {\n      throw new Error(\"A DPoPStore is required when dpop is enabled\");\n    }\n  }\n};\n\n// src/UserInfoService.ts\nvar UserInfoService = class {\n  constructor(_settings, _metadataService) {\n    this._settings = _settings;\n    this._metadataService = _metadataService;\n    this._logger = new Logger(\"UserInfoService\");\n    this._getClaimsFromJwt = async (responseText) => {\n      const logger2 = this._logger.create(\"_getClaimsFromJwt\");\n      try {\n        const payload = JwtUtils.decode(responseText);\n        logger2.debug(\"JWT decoding successful\");\n        return payload;\n      } catch (err) {\n        logger2.error(\"Error parsing JWT response\");\n        throw err;\n      }\n    };\n    this._jsonService = new JsonService(\n      void 0,\n      this._getClaimsFromJwt,\n      this._settings.extraHeaders\n    );\n  }\n  async getClaims(token) {\n    const logger2 = this._logger.create(\"getClaims\");\n    if (!token) {\n      this._logger.throw(new Error(\"No token passed\"));\n    }\n    const url = await this._metadataService.getUserInfoEndpoint();\n    logger2.debug(\"got userinfo url\", url);\n    const claims = await this._jsonService.getJson(url, {\n      token,\n      credentials: this._settings.fetchRequestCredentials,\n      timeoutInSeconds: this._settings.requestTimeoutInSeconds\n    });\n    logger2.debug(\"got claims\", claims);\n    return claims;\n  }\n};\n\n// src/TokenClient.ts\nvar TokenClient = class {\n  constructor(_settings, _metadataService) {\n    this._settings = _settings;\n    this._metadataService = _metadataService;\n    this._logger = new Logger(\"TokenClient\");\n    this._jsonService = new JsonService(\n      this._settings.revokeTokenAdditionalContentTypes,\n      null,\n      this._settings.extraHeaders\n    );\n  }\n  /**\n   * Exchange code.\n   *\n   * @see https://www.rfc-editor.org/rfc/rfc6749#section-4.1.3\n   */\n  async exchangeCode({\n    grant_type = \"authorization_code\",\n    redirect_uri = this._settings.redirect_uri,\n    client_id = this._settings.client_id,\n    client_secret = this._settings.client_secret,\n    extraHeaders,\n    ...args\n  }) {\n    const logger2 = this._logger.create(\"exchangeCode\");\n    if (!client_id) {\n      logger2.throw(new Error(\"A client_id is required\"));\n    }\n    if (!redirect_uri) {\n      logger2.throw(new Error(\"A redirect_uri is required\"));\n    }\n    if (!args.code) {\n      logger2.throw(new Error(\"A code is required\"));\n    }\n    const params = new URLSearchParams({ grant_type, redirect_uri });\n    for (const [key, value] of Object.entries(args)) {\n      if (value != null) {\n        params.set(key, value);\n      }\n    }\n    if ((this._settings.client_authentication === \"client_secret_basic\" || this._settings.client_authentication === \"client_secret_jwt\") && (client_secret === void 0 || client_secret === null)) {\n      logger2.throw(new Error(\"A client_secret is required\"));\n      throw null;\n    }\n    let basicAuth;\n    const url = await this._metadataService.getTokenEndpoint(false);\n    switch (this._settings.client_authentication) {\n      case \"client_secret_basic\":\n        basicAuth = CryptoUtils.generateBasicAuth(client_id, client_secret);\n        break;\n      case \"client_secret_post\":\n        params.append(\"client_id\", client_id);\n        if (client_secret) {\n          params.append(\"client_secret\", client_secret);\n        }\n        break;\n      case \"client_secret_jwt\": {\n        const clientAssertion = await CryptoUtils.generateClientAssertionJwt(client_id, client_secret, url, this._settings.token_endpoint_auth_signing_alg);\n        params.append(\"client_id\", client_id);\n        params.append(\"client_assertion_type\", \"urn:ietf:params:oauth:client-assertion-type:jwt-bearer\");\n        params.append(\"client_assertion\", clientAssertion);\n        break;\n      }\n    }\n    logger2.debug(\"got token endpoint\");\n    const response = await this._jsonService.postForm(url, {\n      body: params,\n      basicAuth,\n      timeoutInSeconds: this._settings.requestTimeoutInSeconds,\n      initCredentials: this._settings.fetchRequestCredentials,\n      extraHeaders\n    });\n    logger2.debug(\"got response\");\n    return response;\n  }\n  /**\n   * Exchange credentials.\n   *\n   * @see https://www.rfc-editor.org/rfc/rfc6749#section-4.3.2\n   */\n  async exchangeCredentials({\n    grant_type = \"password\",\n    client_id = this._settings.client_id,\n    client_secret = this._settings.client_secret,\n    scope = this._settings.scope,\n    ...args\n  }) {\n    const logger2 = this._logger.create(\"exchangeCredentials\");\n    if (!client_id) {\n      logger2.throw(new Error(\"A client_id is required\"));\n    }\n    const params = new URLSearchParams({ grant_type });\n    if (!this._settings.omitScopeWhenRequesting) {\n      params.set(\"scope\", scope);\n    }\n    for (const [key, value] of Object.entries(args)) {\n      if (value != null) {\n        params.set(key, value);\n      }\n    }\n    if ((this._settings.client_authentication === \"client_secret_basic\" || this._settings.client_authentication === \"client_secret_jwt\") && (client_secret === void 0 || client_secret === null)) {\n      logger2.throw(new Error(\"A client_secret is required\"));\n      throw null;\n    }\n    let basicAuth;\n    const url = await this._metadataService.getTokenEndpoint(false);\n    switch (this._settings.client_authentication) {\n      case \"client_secret_basic\":\n        basicAuth = CryptoUtils.generateBasicAuth(client_id, client_secret);\n        break;\n      case \"client_secret_post\":\n        params.append(\"client_id\", client_id);\n        if (client_secret) {\n          params.append(\"client_secret\", client_secret);\n        }\n        break;\n      case \"client_secret_jwt\": {\n        const clientAssertion = await CryptoUtils.generateClientAssertionJwt(client_id, client_secret, url, this._settings.token_endpoint_auth_signing_alg);\n        params.append(\"client_id\", client_id);\n        params.append(\"client_assertion_type\", \"urn:ietf:params:oauth:client-assertion-type:jwt-bearer\");\n        params.append(\"client_assertion\", clientAssertion);\n        break;\n      }\n    }\n    logger2.debug(\"got token endpoint\");\n    const response = await this._jsonService.postForm(url, { body: params, basicAuth, timeoutInSeconds: this._settings.requestTimeoutInSeconds, initCredentials: this._settings.fetchRequestCredentials });\n    logger2.debug(\"got response\");\n    return response;\n  }\n  /**\n   * Exchange a refresh token.\n   *\n   * @see https://www.rfc-editor.org/rfc/rfc6749#section-6\n   */\n  async exchangeRefreshToken({\n    grant_type = \"refresh_token\",\n    client_id = this._settings.client_id,\n    client_secret = this._settings.client_secret,\n    timeoutInSeconds,\n    extraHeaders,\n    ...args\n  }) {\n    const logger2 = this._logger.create(\"exchangeRefreshToken\");\n    if (!client_id) {\n      logger2.throw(new Error(\"A client_id is required\"));\n    }\n    if (!args.refresh_token) {\n      logger2.throw(new Error(\"A refresh_token is required\"));\n    }\n    const params = new URLSearchParams({ grant_type });\n    for (const [key, value] of Object.entries(args)) {\n      if (Array.isArray(value)) {\n        value.forEach((param) => params.append(key, param));\n      } else if (value != null) {\n        params.set(key, value);\n      }\n    }\n    if ((this._settings.client_authentication === \"client_secret_basic\" || this._settings.client_authentication === \"client_secret_jwt\") && (client_secret === void 0 || client_secret === null)) {\n      logger2.throw(new Error(\"A client_secret is required\"));\n      throw null;\n    }\n    let basicAuth;\n    const url = await this._metadataService.getTokenEndpoint(false);\n    switch (this._settings.client_authentication) {\n      case \"client_secret_basic\":\n        basicAuth = CryptoUtils.generateBasicAuth(client_id, client_secret);\n        break;\n      case \"client_secret_post\":\n        params.append(\"client_id\", client_id);\n        if (client_secret) {\n          params.append(\"client_secret\", client_secret);\n        }\n        break;\n      case \"client_secret_jwt\": {\n        const clientAssertion = await CryptoUtils.generateClientAssertionJwt(client_id, client_secret, url, this._settings.token_endpoint_auth_signing_alg);\n        params.append(\"client_id\", client_id);\n        params.append(\"client_assertion_type\", \"urn:ietf:params:oauth:client-assertion-type:jwt-bearer\");\n        params.append(\"client_assertion\", clientAssertion);\n        break;\n      }\n    }\n    logger2.debug(\"got token endpoint\");\n    const response = await this._jsonService.postForm(url, { body: params, basicAuth, timeoutInSeconds, initCredentials: this._settings.fetchRequestCredentials, extraHeaders });\n    logger2.debug(\"got response\");\n    return response;\n  }\n  /**\n   * Revoke an access or refresh token.\n   *\n   * @see https://datatracker.ietf.org/doc/html/rfc7009#section-2.1\n   */\n  async revoke(args) {\n    var _a;\n    const logger2 = this._logger.create(\"revoke\");\n    if (!args.token) {\n      logger2.throw(new Error(\"A token is required\"));\n    }\n    const url = await this._metadataService.getRevocationEndpoint(false);\n    logger2.debug(`got revocation endpoint, revoking ${(_a = args.token_type_hint) != null ? _a : \"default token type\"}`);\n    const params = new URLSearchParams();\n    for (const [key, value] of Object.entries(args)) {\n      if (value != null) {\n        params.set(key, value);\n      }\n    }\n    params.set(\"client_id\", this._settings.client_id);\n    if (this._settings.client_secret) {\n      params.set(\"client_secret\", this._settings.client_secret);\n    }\n    await this._jsonService.postForm(url, { body: params, timeoutInSeconds: this._settings.requestTimeoutInSeconds });\n    logger2.debug(\"got response\");\n  }\n};\n\n// src/ResponseValidator.ts\nvar ResponseValidator = class {\n  constructor(_settings, _metadataService, _claimsService) {\n    this._settings = _settings;\n    this._metadataService = _metadataService;\n    this._claimsService = _claimsService;\n    this._logger = new Logger(\"ResponseValidator\");\n    this._userInfoService = new UserInfoService(this._settings, this._metadataService);\n    this._tokenClient = new TokenClient(this._settings, this._metadataService);\n  }\n  async validateSigninResponse(response, state, extraHeaders) {\n    const logger2 = this._logger.create(\"validateSigninResponse\");\n    this._processSigninState(response, state);\n    logger2.debug(\"state processed\");\n    await this._processCode(response, state, extraHeaders);\n    logger2.debug(\"code processed\");\n    if (response.isOpenId) {\n      this._validateIdTokenAttributes(response);\n    }\n    logger2.debug(\"tokens validated\");\n    await this._processClaims(response, state == null ? void 0 : state.skipUserInfo, response.isOpenId);\n    logger2.debug(\"claims processed\");\n  }\n  async validateCredentialsResponse(response, skipUserInfo) {\n    const logger2 = this._logger.create(\"validateCredentialsResponse\");\n    const shouldValidateSubClaim = response.isOpenId && !!response.id_token;\n    if (shouldValidateSubClaim) {\n      this._validateIdTokenAttributes(response);\n    }\n    logger2.debug(\"tokens validated\");\n    await this._processClaims(response, skipUserInfo, shouldValidateSubClaim);\n    logger2.debug(\"claims processed\");\n  }\n  async validateRefreshResponse(response, state) {\n    var _a, _b;\n    const logger2 = this._logger.create(\"validateRefreshResponse\");\n    response.userState = state.data;\n    (_a = response.session_state) != null ? _a : response.session_state = state.session_state;\n    (_b = response.scope) != null ? _b : response.scope = state.scope;\n    if (response.isOpenId && !!response.id_token) {\n      this._validateIdTokenAttributes(response, state.id_token);\n      logger2.debug(\"ID Token validated\");\n    }\n    if (!response.id_token) {\n      response.id_token = state.id_token;\n      response.profile = state.profile;\n    }\n    const hasIdToken = response.isOpenId && !!response.id_token;\n    await this._processClaims(response, false, hasIdToken);\n    logger2.debug(\"claims processed\");\n  }\n  validateSignoutResponse(response, state) {\n    const logger2 = this._logger.create(\"validateSignoutResponse\");\n    if (state.id !== response.state) {\n      logger2.throw(new Error(\"State does not match\"));\n    }\n    logger2.debug(\"state validated\");\n    response.userState = state.data;\n    if (response.error) {\n      logger2.warn(\"Response was error\", response.error);\n      throw new ErrorResponse(response);\n    }\n  }\n  _processSigninState(response, state) {\n    var _a;\n    const logger2 = this._logger.create(\"_processSigninState\");\n    if (state.id !== response.state) {\n      logger2.throw(new Error(\"State does not match\"));\n    }\n    if (!state.client_id) {\n      logger2.throw(new Error(\"No client_id on state\"));\n    }\n    if (!state.authority) {\n      logger2.throw(new Error(\"No authority on state\"));\n    }\n    if (this._settings.authority !== state.authority) {\n      logger2.throw(new Error(\"authority mismatch on settings vs. signin state\"));\n    }\n    if (this._settings.client_id && this._settings.client_id !== state.client_id) {\n      logger2.throw(new Error(\"client_id mismatch on settings vs. signin state\"));\n    }\n    logger2.debug(\"state validated\");\n    response.userState = state.data;\n    response.url_state = state.url_state;\n    (_a = response.scope) != null ? _a : response.scope = state.scope;\n    if (response.error) {\n      logger2.warn(\"Response was error\", response.error);\n      throw new ErrorResponse(response);\n    }\n    if (state.code_verifier && !response.code) {\n      logger2.throw(new Error(\"Expected code in response\"));\n    }\n  }\n  async _processClaims(response, skipUserInfo = false, validateSub = true) {\n    const logger2 = this._logger.create(\"_processClaims\");\n    response.profile = this._claimsService.filterProtocolClaims(response.profile);\n    if (skipUserInfo || !this._settings.loadUserInfo || !response.access_token) {\n      logger2.debug(\"not loading user info\");\n      return;\n    }\n    logger2.debug(\"loading user info\");\n    const claims = await this._userInfoService.getClaims(response.access_token);\n    logger2.debug(\"user info claims received from user info endpoint\");\n    if (validateSub && claims.sub !== response.profile.sub) {\n      logger2.throw(new Error(\"subject from UserInfo response does not match subject in ID Token\"));\n    }\n    response.profile = this._claimsService.mergeClaims(response.profile, this._claimsService.filterProtocolClaims(claims));\n    logger2.debug(\"user info claims received, updated profile:\", response.profile);\n  }\n  async _processCode(response, state, extraHeaders) {\n    const logger2 = this._logger.create(\"_processCode\");\n    if (response.code) {\n      logger2.debug(\"Validating code\");\n      const tokenResponse = await this._tokenClient.exchangeCode({\n        client_id: state.client_id,\n        client_secret: state.client_secret,\n        code: response.code,\n        redirect_uri: state.redirect_uri,\n        code_verifier: state.code_verifier,\n        extraHeaders,\n        ...state.extraTokenParams\n      });\n      Object.assign(response, tokenResponse);\n    } else {\n      logger2.debug(\"No code to process\");\n    }\n  }\n  _validateIdTokenAttributes(response, existingToken) {\n    var _a;\n    const logger2 = this._logger.create(\"_validateIdTokenAttributes\");\n    logger2.debug(\"decoding ID Token JWT\");\n    const incoming = JwtUtils.decode((_a = response.id_token) != null ? _a : \"\");\n    if (!incoming.sub) {\n      logger2.throw(new Error(\"ID Token is missing a subject claim\"));\n    }\n    if (existingToken) {\n      const existing = JwtUtils.decode(existingToken);\n      if (incoming.sub !== existing.sub) {\n        logger2.throw(new Error(\"sub in id_token does not match current sub\"));\n      }\n      if (incoming.auth_time && incoming.auth_time !== existing.auth_time) {\n        logger2.throw(new Error(\"auth_time in id_token does not match original auth_time\"));\n      }\n      if (incoming.azp && incoming.azp !== existing.azp) {\n        logger2.throw(new Error(\"azp in id_token does not match original azp\"));\n      }\n      if (!incoming.azp && existing.azp) {\n        logger2.throw(new Error(\"azp not in id_token, but present in original id_token\"));\n      }\n    }\n    response.profile = incoming;\n  }\n};\n\n// src/State.ts\nvar State = class _State {\n  constructor(args) {\n    this.id = args.id || CryptoUtils.generateUUIDv4();\n    this.data = args.data;\n    if (args.created && args.created > 0) {\n      this.created = args.created;\n    } else {\n      this.created = Timer.getEpochTime();\n    }\n    this.request_type = args.request_type;\n    this.url_state = args.url_state;\n  }\n  toStorageString() {\n    new Logger(\"State\").create(\"toStorageString\");\n    return JSON.stringify({\n      id: this.id,\n      data: this.data,\n      created: this.created,\n      request_type: this.request_type,\n      url_state: this.url_state\n    });\n  }\n  static fromStorageString(storageString) {\n    Logger.createStatic(\"State\", \"fromStorageString\");\n    return Promise.resolve(new _State(JSON.parse(storageString)));\n  }\n  static async clearStaleState(storage, age) {\n    const logger2 = Logger.createStatic(\"State\", \"clearStaleState\");\n    const cutoff = Timer.getEpochTime() - age;\n    const keys = await storage.getAllKeys();\n    logger2.debug(\"got keys\", keys);\n    for (let i = 0; i < keys.length; i++) {\n      const key = keys[i];\n      const item = await storage.get(key);\n      let remove = false;\n      if (item) {\n        try {\n          const state = await _State.fromStorageString(item);\n          logger2.debug(\"got item from key:\", key, state.created);\n          if (state.created <= cutoff) {\n            remove = true;\n          }\n        } catch (err) {\n          logger2.error(\"Error parsing state for key:\", key, err);\n          remove = true;\n        }\n      } else {\n        logger2.debug(\"no item in storage for key:\", key);\n        remove = true;\n      }\n      if (remove) {\n        logger2.debug(\"removed item for key:\", key);\n        void storage.remove(key);\n      }\n    }\n  }\n};\n\n// src/SigninState.ts\nvar SigninState = class _SigninState extends State {\n  constructor(args) {\n    super(args);\n    this.code_verifier = args.code_verifier;\n    this.code_challenge = args.code_challenge;\n    this.authority = args.authority;\n    this.client_id = args.client_id;\n    this.redirect_uri = args.redirect_uri;\n    this.scope = args.scope;\n    this.client_secret = args.client_secret;\n    this.extraTokenParams = args.extraTokenParams;\n    this.response_mode = args.response_mode;\n    this.skipUserInfo = args.skipUserInfo;\n  }\n  static async create(args) {\n    const code_verifier = args.code_verifier === true ? CryptoUtils.generateCodeVerifier() : args.code_verifier || void 0;\n    const code_challenge = code_verifier ? await CryptoUtils.generateCodeChallenge(code_verifier) : void 0;\n    return new _SigninState({\n      ...args,\n      code_verifier,\n      code_challenge\n    });\n  }\n  toStorageString() {\n    new Logger(\"SigninState\").create(\"toStorageString\");\n    return JSON.stringify({\n      id: this.id,\n      data: this.data,\n      created: this.created,\n      request_type: this.request_type,\n      url_state: this.url_state,\n      code_verifier: this.code_verifier,\n      authority: this.authority,\n      client_id: this.client_id,\n      redirect_uri: this.redirect_uri,\n      scope: this.scope,\n      client_secret: this.client_secret,\n      extraTokenParams: this.extraTokenParams,\n      response_mode: this.response_mode,\n      skipUserInfo: this.skipUserInfo\n    });\n  }\n  static fromStorageString(storageString) {\n    Logger.createStatic(\"SigninState\", \"fromStorageString\");\n    const data = JSON.parse(storageString);\n    return _SigninState.create(data);\n  }\n};\n\n// src/SigninRequest.ts\nvar _SigninRequest = class _SigninRequest {\n  constructor(args) {\n    this.url = args.url;\n    this.state = args.state;\n  }\n  static async create({\n    // mandatory\n    url,\n    authority,\n    client_id,\n    redirect_uri,\n    response_type,\n    scope,\n    // optional\n    state_data,\n    response_mode,\n    request_type,\n    client_secret,\n    nonce,\n    url_state,\n    resource,\n    skipUserInfo,\n    extraQueryParams,\n    extraTokenParams,\n    disablePKCE,\n    dpopJkt,\n    omitScopeWhenRequesting,\n    ...optionalParams\n  }) {\n    if (!url) {\n      this._logger.error(\"create: No url passed\");\n      throw new Error(\"url\");\n    }\n    if (!client_id) {\n      this._logger.error(\"create: No client_id passed\");\n      throw new Error(\"client_id\");\n    }\n    if (!redirect_uri) {\n      this._logger.error(\"create: No redirect_uri passed\");\n      throw new Error(\"redirect_uri\");\n    }\n    if (!response_type) {\n      this._logger.error(\"create: No response_type passed\");\n      throw new Error(\"response_type\");\n    }\n    if (!scope) {\n      this._logger.error(\"create: No scope passed\");\n      throw new Error(\"scope\");\n    }\n    if (!authority) {\n      this._logger.error(\"create: No authority passed\");\n      throw new Error(\"authority\");\n    }\n    const state = await SigninState.create({\n      data: state_data,\n      request_type,\n      url_state,\n      code_verifier: !disablePKCE,\n      client_id,\n      authority,\n      redirect_uri,\n      response_mode,\n      client_secret,\n      scope,\n      extraTokenParams,\n      skipUserInfo\n    });\n    const parsedUrl = new URL(url);\n    parsedUrl.searchParams.append(\"client_id\", client_id);\n    parsedUrl.searchParams.append(\"redirect_uri\", redirect_uri);\n    parsedUrl.searchParams.append(\"response_type\", response_type);\n    if (!omitScopeWhenRequesting) {\n      parsedUrl.searchParams.append(\"scope\", scope);\n    }\n    if (nonce) {\n      parsedUrl.searchParams.append(\"nonce\", nonce);\n    }\n    if (dpopJkt) {\n      parsedUrl.searchParams.append(\"dpop_jkt\", dpopJkt);\n    }\n    let stateParam = state.id;\n    if (url_state) {\n      stateParam = `${stateParam}${URL_STATE_DELIMITER}${url_state}`;\n    }\n    parsedUrl.searchParams.append(\"state\", stateParam);\n    if (state.code_challenge) {\n      parsedUrl.searchParams.append(\"code_challenge\", state.code_challenge);\n      parsedUrl.searchParams.append(\"code_challenge_method\", \"S256\");\n    }\n    if (resource) {\n      const resources = Array.isArray(resource) ? resource : [resource];\n      resources.forEach((r) => parsedUrl.searchParams.append(\"resource\", r));\n    }\n    for (const [key, value] of Object.entries({ response_mode, ...optionalParams, ...extraQueryParams })) {\n      if (value != null) {\n        parsedUrl.searchParams.append(key, value.toString());\n      }\n    }\n    return new _SigninRequest({\n      url: parsedUrl.href,\n      state\n    });\n  }\n};\n_SigninRequest._logger = new Logger(\"SigninRequest\");\nvar SigninRequest = _SigninRequest;\n\n// src/SigninResponse.ts\nvar OidcScope = \"openid\";\nvar SigninResponse = class {\n  constructor(params) {\n    /** @see {@link User.access_token} */\n    this.access_token = \"\";\n    /** @see {@link User.token_type} */\n    this.token_type = \"\";\n    /** @see {@link User.profile} */\n    this.profile = {};\n    this.state = params.get(\"state\");\n    this.session_state = params.get(\"session_state\");\n    if (this.state) {\n      const splitState = decodeURIComponent(this.state).split(URL_STATE_DELIMITER);\n      this.state = splitState[0];\n      if (splitState.length > 1) {\n        this.url_state = splitState.slice(1).join(URL_STATE_DELIMITER);\n      }\n    }\n    this.error = params.get(\"error\");\n    this.error_description = params.get(\"error_description\");\n    this.error_uri = params.get(\"error_uri\");\n    this.code = params.get(\"code\");\n  }\n  get expires_in() {\n    if (this.expires_at === void 0) {\n      return void 0;\n    }\n    return this.expires_at - Timer.getEpochTime();\n  }\n  set expires_in(value) {\n    if (typeof value === \"string\") value = Number(value);\n    if (value !== void 0 && value >= 0) {\n      this.expires_at = Math.floor(value) + Timer.getEpochTime();\n    }\n  }\n  get isOpenId() {\n    var _a;\n    return ((_a = this.scope) == null ? void 0 : _a.split(\" \").includes(OidcScope)) || !!this.id_token;\n  }\n};\n\n// src/SignoutRequest.ts\nvar SignoutRequest = class {\n  constructor({\n    url,\n    state_data,\n    id_token_hint,\n    post_logout_redirect_uri,\n    extraQueryParams,\n    request_type,\n    client_id,\n    url_state\n  }) {\n    this._logger = new Logger(\"SignoutRequest\");\n    if (!url) {\n      this._logger.error(\"ctor: No url passed\");\n      throw new Error(\"url\");\n    }\n    const parsedUrl = new URL(url);\n    if (id_token_hint) {\n      parsedUrl.searchParams.append(\"id_token_hint\", id_token_hint);\n    }\n    if (client_id) {\n      parsedUrl.searchParams.append(\"client_id\", client_id);\n    }\n    if (post_logout_redirect_uri) {\n      parsedUrl.searchParams.append(\"post_logout_redirect_uri\", post_logout_redirect_uri);\n      if (state_data || url_state) {\n        this.state = new State({ data: state_data, request_type, url_state });\n        let stateParam = this.state.id;\n        if (url_state) {\n          stateParam = `${stateParam}${URL_STATE_DELIMITER}${url_state}`;\n        }\n        parsedUrl.searchParams.append(\"state\", stateParam);\n      }\n    }\n    for (const [key, value] of Object.entries({ ...extraQueryParams })) {\n      if (value != null) {\n        parsedUrl.searchParams.append(key, value.toString());\n      }\n    }\n    this.url = parsedUrl.href;\n  }\n};\n\n// src/SignoutResponse.ts\nvar SignoutResponse = class {\n  constructor(params) {\n    this.state = params.get(\"state\");\n    if (this.state) {\n      const splitState = decodeURIComponent(this.state).split(URL_STATE_DELIMITER);\n      this.state = splitState[0];\n      if (splitState.length > 1) {\n        this.url_state = splitState.slice(1).join(URL_STATE_DELIMITER);\n      }\n    }\n    this.error = params.get(\"error\");\n    this.error_description = params.get(\"error_description\");\n    this.error_uri = params.get(\"error_uri\");\n  }\n};\n\n// src/ClaimsService.ts\nvar DefaultProtocolClaims = [\n  \"nbf\",\n  \"jti\",\n  \"auth_time\",\n  \"nonce\",\n  \"acr\",\n  \"amr\",\n  \"azp\",\n  \"at_hash\"\n  // https://openid.net/specs/openid-connect-core-1_0.html#CodeIDToken\n];\nvar InternalRequiredProtocolClaims = [\"sub\", \"iss\", \"aud\", \"exp\", \"iat\"];\nvar ClaimsService = class {\n  constructor(_settings) {\n    this._settings = _settings;\n    this._logger = new Logger(\"ClaimsService\");\n  }\n  filterProtocolClaims(claims) {\n    const result = { ...claims };\n    if (this._settings.filterProtocolClaims) {\n      let protocolClaims;\n      if (Array.isArray(this._settings.filterProtocolClaims)) {\n        protocolClaims = this._settings.filterProtocolClaims;\n      } else {\n        protocolClaims = DefaultProtocolClaims;\n      }\n      for (const claim of protocolClaims) {\n        if (!InternalRequiredProtocolClaims.includes(claim)) {\n          delete result[claim];\n        }\n      }\n    }\n    return result;\n  }\n  mergeClaims(claims1, claims2) {\n    const result = { ...claims1 };\n    for (const [claim, values] of Object.entries(claims2)) {\n      if (result[claim] !== values) {\n        if (Array.isArray(result[claim]) || Array.isArray(values)) {\n          if (this._settings.mergeClaimsStrategy.array == \"replace\") {\n            result[claim] = values;\n          } else {\n            const mergedValues = Array.isArray(result[claim]) ? result[claim] : [result[claim]];\n            for (const value of Array.isArray(values) ? values : [values]) {\n              if (!mergedValues.includes(value)) {\n                mergedValues.push(value);\n              }\n            }\n            result[claim] = mergedValues;\n          }\n        } else if (typeof result[claim] === \"object\" && typeof values === \"object\") {\n          result[claim] = this.mergeClaims(result[claim], values);\n        } else {\n          result[claim] = values;\n        }\n      }\n    }\n    return result;\n  }\n};\n\n// src/DPoPStore.ts\nvar DPoPState = class {\n  constructor(keys, nonce) {\n    this.keys = keys;\n    this.nonce = nonce;\n  }\n};\n\n// src/OidcClient.ts\nvar OidcClient = class {\n  constructor(settings, metadataService) {\n    this._logger = new Logger(\"OidcClient\");\n    this.settings = settings instanceof OidcClientSettingsStore ? settings : new OidcClientSettingsStore(settings);\n    this.metadataService = metadataService != null ? metadataService : new MetadataService(this.settings);\n    this._claimsService = new ClaimsService(this.settings);\n    this._validator = new ResponseValidator(this.settings, this.metadataService, this._claimsService);\n    this._tokenClient = new TokenClient(this.settings, this.metadataService);\n  }\n  async createSigninRequest({\n    state,\n    request,\n    request_uri,\n    request_type,\n    id_token_hint,\n    login_hint,\n    skipUserInfo,\n    nonce,\n    url_state,\n    response_type = this.settings.response_type,\n    scope = this.settings.scope,\n    redirect_uri = this.settings.redirect_uri,\n    prompt = this.settings.prompt,\n    display = this.settings.display,\n    max_age = this.settings.max_age,\n    ui_locales = this.settings.ui_locales,\n    acr_values = this.settings.acr_values,\n    resource = this.settings.resource,\n    response_mode = this.settings.response_mode,\n    extraQueryParams = this.settings.extraQueryParams,\n    extraTokenParams = this.settings.extraTokenParams,\n    dpopJkt,\n    omitScopeWhenRequesting = this.settings.omitScopeWhenRequesting\n  }) {\n    const logger2 = this._logger.create(\"createSigninRequest\");\n    if (response_type !== \"code\") {\n      throw new Error(\"Only the Authorization Code flow (with PKCE) is supported\");\n    }\n    const url = await this.metadataService.getAuthorizationEndpoint();\n    logger2.debug(\"Received authorization endpoint\", url);\n    const signinRequest = await SigninRequest.create({\n      url,\n      authority: this.settings.authority,\n      client_id: this.settings.client_id,\n      redirect_uri,\n      response_type,\n      scope,\n      state_data: state,\n      url_state,\n      prompt,\n      display,\n      max_age,\n      ui_locales,\n      id_token_hint,\n      login_hint,\n      acr_values,\n      dpopJkt,\n      resource,\n      request,\n      request_uri,\n      extraQueryParams,\n      extraTokenParams,\n      request_type,\n      response_mode,\n      client_secret: this.settings.client_secret,\n      skipUserInfo,\n      nonce,\n      disablePKCE: this.settings.disablePKCE,\n      omitScopeWhenRequesting\n    });\n    await this.clearStaleState();\n    const signinState = signinRequest.state;\n    await this.settings.stateStore.set(signinState.id, signinState.toStorageString());\n    return signinRequest;\n  }\n  async readSigninResponseState(url, removeState = false) {\n    const logger2 = this._logger.create(\"readSigninResponseState\");\n    const response = new SigninResponse(UrlUtils.readParams(url, this.settings.response_mode));\n    if (!response.state) {\n      logger2.throw(new Error(\"No state in response\"));\n      throw null;\n    }\n    const storedStateString = await this.settings.stateStore[removeState ? \"remove\" : \"get\"](response.state);\n    if (!storedStateString) {\n      logger2.throw(new Error(\"No matching state found in storage\"));\n      throw null;\n    }\n    const state = await SigninState.fromStorageString(storedStateString);\n    return { state, response };\n  }\n  async processSigninResponse(url, extraHeaders, removeState = true) {\n    const logger2 = this._logger.create(\"processSigninResponse\");\n    const { state, response } = await this.readSigninResponseState(url, removeState);\n    logger2.debug(\"received state from storage; validating response\");\n    if (this.settings.dpop && this.settings.dpop.store) {\n      const dpopProof = await this.getDpopProof(this.settings.dpop.store);\n      extraHeaders = { ...extraHeaders, \"DPoP\": dpopProof };\n    }\n    try {\n      await this._validator.validateSigninResponse(response, state, extraHeaders);\n    } catch (err) {\n      if (err instanceof ErrorDPoPNonce && this.settings.dpop) {\n        const dpopProof = await this.getDpopProof(this.settings.dpop.store, err.nonce);\n        extraHeaders[\"DPoP\"] = dpopProof;\n        await this._validator.validateSigninResponse(response, state, extraHeaders);\n      } else {\n        throw err;\n      }\n    }\n    return response;\n  }\n  async getDpopProof(dpopStore, nonce) {\n    let keyPair;\n    let dpopState;\n    if (!(await dpopStore.getAllKeys()).includes(this.settings.client_id)) {\n      keyPair = await CryptoUtils.generateDPoPKeys();\n      dpopState = new DPoPState(keyPair, nonce);\n      await dpopStore.set(this.settings.client_id, dpopState);\n    } else {\n      dpopState = await dpopStore.get(this.settings.client_id);\n      if (dpopState.nonce !== nonce && nonce) {\n        dpopState.nonce = nonce;\n        await dpopStore.set(this.settings.client_id, dpopState);\n      }\n    }\n    return await CryptoUtils.generateDPoPProof({\n      url: await this.metadataService.getTokenEndpoint(false),\n      httpMethod: \"POST\",\n      keyPair: dpopState.keys,\n      nonce: dpopState.nonce\n    });\n  }\n  async processResourceOwnerPasswordCredentials({\n    username,\n    password,\n    skipUserInfo = false,\n    extraTokenParams = {}\n  }) {\n    const tokenResponse = await this._tokenClient.exchangeCredentials({ username, password, ...extraTokenParams });\n    const signinResponse = new SigninResponse(new URLSearchParams());\n    Object.assign(signinResponse, tokenResponse);\n    await this._validator.validateCredentialsResponse(signinResponse, skipUserInfo);\n    return signinResponse;\n  }\n  async useRefreshToken({\n    state,\n    redirect_uri,\n    resource,\n    timeoutInSeconds,\n    extraHeaders,\n    extraTokenParams\n  }) {\n    var _a;\n    const logger2 = this._logger.create(\"useRefreshToken\");\n    let scope;\n    if (this.settings.refreshTokenAllowedScope === void 0) {\n      scope = state.scope;\n    } else {\n      const allowableScopes = this.settings.refreshTokenAllowedScope.split(\" \");\n      const providedScopes = ((_a = state.scope) == null ? void 0 : _a.split(\" \")) || [];\n      scope = providedScopes.filter((s) => allowableScopes.includes(s)).join(\" \");\n    }\n    if (this.settings.dpop && this.settings.dpop.store) {\n      const dpopProof = await this.getDpopProof(this.settings.dpop.store);\n      extraHeaders = { ...extraHeaders, \"DPoP\": dpopProof };\n    }\n    let result;\n    try {\n      result = await this._tokenClient.exchangeRefreshToken({\n        refresh_token: state.refresh_token,\n        // provide the (possible filtered) scope list\n        scope,\n        redirect_uri,\n        resource,\n        timeoutInSeconds,\n        extraHeaders,\n        ...extraTokenParams\n      });\n    } catch (err) {\n      if (err instanceof ErrorDPoPNonce && this.settings.dpop) {\n        extraHeaders[\"DPoP\"] = await this.getDpopProof(this.settings.dpop.store, err.nonce);\n        result = await this._tokenClient.exchangeRefreshToken({\n          refresh_token: state.refresh_token,\n          // provide the (possible filtered) scope list\n          scope,\n          redirect_uri,\n          resource,\n          timeoutInSeconds,\n          extraHeaders,\n          ...extraTokenParams\n        });\n      } else {\n        throw err;\n      }\n    }\n    const response = new SigninResponse(new URLSearchParams());\n    Object.assign(response, result);\n    logger2.debug(\"validating response\", response);\n    await this._validator.validateRefreshResponse(response, {\n      ...state,\n      // override the scope in the state handed over to the validator\n      // so it can set the granted scope to the requested scope in case none is included in the response\n      scope\n    });\n    return response;\n  }\n  async createSignoutRequest({\n    state,\n    id_token_hint,\n    client_id,\n    request_type,\n    url_state,\n    post_logout_redirect_uri = this.settings.post_logout_redirect_uri,\n    extraQueryParams = this.settings.extraQueryParams\n  } = {}) {\n    const logger2 = this._logger.create(\"createSignoutRequest\");\n    const url = await this.metadataService.getEndSessionEndpoint();\n    if (!url) {\n      logger2.throw(new Error(\"No end session endpoint\"));\n      throw null;\n    }\n    logger2.debug(\"Received end session endpoint\", url);\n    if (!client_id && post_logout_redirect_uri && !id_token_hint) {\n      client_id = this.settings.client_id;\n    }\n    const request = new SignoutRequest({\n      url,\n      id_token_hint,\n      client_id,\n      post_logout_redirect_uri,\n      state_data: state,\n      extraQueryParams,\n      request_type,\n      url_state\n    });\n    await this.clearStaleState();\n    const signoutState = request.state;\n    if (signoutState) {\n      logger2.debug(\"Signout request has state to persist\");\n      await this.settings.stateStore.set(signoutState.id, signoutState.toStorageString());\n    }\n    return request;\n  }\n  async readSignoutResponseState(url, removeState = false) {\n    const logger2 = this._logger.create(\"readSignoutResponseState\");\n    const response = new SignoutResponse(UrlUtils.readParams(url, this.settings.response_mode));\n    if (!response.state) {\n      logger2.debug(\"No state in response\");\n      if (response.error) {\n        logger2.warn(\"Response was error:\", response.error);\n        throw new ErrorResponse(response);\n      }\n      return { state: void 0, response };\n    }\n    const storedStateString = await this.settings.stateStore[removeState ? \"remove\" : \"get\"](response.state);\n    if (!storedStateString) {\n      logger2.throw(new Error(\"No matching state found in storage\"));\n      throw null;\n    }\n    const state = await State.fromStorageString(storedStateString);\n    return { state, response };\n  }\n  async processSignoutResponse(url) {\n    const logger2 = this._logger.create(\"processSignoutResponse\");\n    const { state, response } = await this.readSignoutResponseState(url, true);\n    if (state) {\n      logger2.debug(\"Received state from storage; validating response\");\n      this._validator.validateSignoutResponse(response, state);\n    } else {\n      logger2.debug(\"No state from storage; skipping response validation\");\n    }\n    return response;\n  }\n  clearStaleState() {\n    this._logger.create(\"clearStaleState\");\n    return State.clearStaleState(this.settings.stateStore, this.settings.staleStateAgeInSeconds);\n  }\n  async revokeToken(token, type) {\n    this._logger.create(\"revokeToken\");\n    return await this._tokenClient.revoke({\n      token,\n      token_type_hint: type\n    });\n  }\n};\n\n// src/SessionMonitor.ts\nvar SessionMonitor = class {\n  constructor(_userManager) {\n    this._userManager = _userManager;\n    this._logger = new Logger(\"SessionMonitor\");\n    this._start = async (user) => {\n      const session_state = user.session_state;\n      if (!session_state) {\n        return;\n      }\n      const logger2 = this._logger.create(\"_start\");\n      if (user.profile) {\n        this._sub = user.profile.sub;\n        logger2.debug(\"session_state\", session_state, \", sub\", this._sub);\n      } else {\n        this._sub = void 0;\n        logger2.debug(\"session_state\", session_state, \", anonymous user\");\n      }\n      if (this._checkSessionIFrame) {\n        this._checkSessionIFrame.start(session_state);\n        return;\n      }\n      try {\n        const url = await this._userManager.metadataService.getCheckSessionIframe();\n        if (url) {\n          logger2.debug(\"initializing check session iframe\");\n          const client_id = this._userManager.settings.client_id;\n          const intervalInSeconds = this._userManager.settings.checkSessionIntervalInSeconds;\n          const stopOnError = this._userManager.settings.stopCheckSessionOnError;\n          const checkSessionIFrame = new CheckSessionIFrame(this._callback, client_id, url, intervalInSeconds, stopOnError);\n          await checkSessionIFrame.load();\n          this._checkSessionIFrame = checkSessionIFrame;\n          checkSessionIFrame.start(session_state);\n        } else {\n          logger2.warn(\"no check session iframe found in the metadata\");\n        }\n      } catch (err) {\n        logger2.error(\"Error from getCheckSessionIframe:\", err instanceof Error ? err.message : err);\n      }\n    };\n    this._stop = () => {\n      const logger2 = this._logger.create(\"_stop\");\n      this._sub = void 0;\n      if (this._checkSessionIFrame) {\n        this._checkSessionIFrame.stop();\n      }\n      if (this._userManager.settings.monitorAnonymousSession) {\n        const timerHandle = setInterval(async () => {\n          clearInterval(timerHandle);\n          try {\n            const session = await this._userManager.querySessionStatus();\n            if (session) {\n              const tmpUser = {\n                session_state: session.session_state,\n                profile: session.sub ? {\n                  sub: session.sub\n                } : null\n              };\n              void this._start(tmpUser);\n            }\n          } catch (err) {\n            logger2.error(\"error from querySessionStatus\", err instanceof Error ? err.message : err);\n          }\n        }, 1e3);\n      }\n    };\n    this._callback = async () => {\n      const logger2 = this._logger.create(\"_callback\");\n      try {\n        const session = await this._userManager.querySessionStatus();\n        let raiseEvent = true;\n        if (session && this._checkSessionIFrame) {\n          if (session.sub === this._sub) {\n            raiseEvent = false;\n            this._checkSessionIFrame.start(session.session_state);\n            logger2.debug(\"same sub still logged in at OP, session state has changed, restarting check session iframe; session_state\", session.session_state);\n            await this._userManager.events._raiseUserSessionChanged();\n          } else {\n            logger2.debug(\"different subject signed into OP\", session.sub);\n          }\n        } else {\n          logger2.debug(\"subject no longer signed into OP\");\n        }\n        if (raiseEvent) {\n          if (this._sub) {\n            await this._userManager.events._raiseUserSignedOut();\n          } else {\n            await this._userManager.events._raiseUserSignedIn();\n          }\n        } else {\n          logger2.debug(\"no change in session detected, no event to raise\");\n        }\n      } catch (err) {\n        if (this._sub) {\n          logger2.debug(\"Error calling queryCurrentSigninSession; raising signed out event\", err);\n          await this._userManager.events._raiseUserSignedOut();\n        }\n      }\n    };\n    if (!_userManager) {\n      this._logger.throw(new Error(\"No user manager passed\"));\n    }\n    this._userManager.events.addUserLoaded(this._start);\n    this._userManager.events.addUserUnloaded(this._stop);\n    this._init().catch((err) => {\n      this._logger.error(err);\n    });\n  }\n  async _init() {\n    this._logger.create(\"_init\");\n    const user = await this._userManager.getUser();\n    if (user) {\n      void this._start(user);\n    } else if (this._userManager.settings.monitorAnonymousSession) {\n      const session = await this._userManager.querySessionStatus();\n      if (session) {\n        const tmpUser = {\n          session_state: session.session_state,\n          profile: session.sub ? {\n            sub: session.sub\n          } : null\n        };\n        void this._start(tmpUser);\n      }\n    }\n  }\n};\n\n// src/User.ts\nvar User = class _User {\n  constructor(args) {\n    var _a;\n    this.id_token = args.id_token;\n    this.session_state = (_a = args.session_state) != null ? _a : null;\n    this.access_token = args.access_token;\n    this.refresh_token = args.refresh_token;\n    this.token_type = args.token_type;\n    this.scope = args.scope;\n    this.profile = args.profile;\n    this.expires_at = args.expires_at;\n    this.state = args.userState;\n    this.url_state = args.url_state;\n  }\n  /** Computed number of seconds the access token has remaining. */\n  get expires_in() {\n    if (this.expires_at === void 0) {\n      return void 0;\n    }\n    return this.expires_at - Timer.getEpochTime();\n  }\n  set expires_in(value) {\n    if (value !== void 0) {\n      this.expires_at = Math.floor(value) + Timer.getEpochTime();\n    }\n  }\n  /** Computed value indicating if the access token is expired. */\n  get expired() {\n    const expires_in = this.expires_in;\n    if (expires_in === void 0) {\n      return void 0;\n    }\n    return expires_in <= 0;\n  }\n  /** Array representing the parsed values from the `scope`. */\n  get scopes() {\n    var _a, _b;\n    return (_b = (_a = this.scope) == null ? void 0 : _a.split(\" \")) != null ? _b : [];\n  }\n  toStorageString() {\n    new Logger(\"User\").create(\"toStorageString\");\n    return JSON.stringify({\n      id_token: this.id_token,\n      session_state: this.session_state,\n      access_token: this.access_token,\n      refresh_token: this.refresh_token,\n      token_type: this.token_type,\n      scope: this.scope,\n      profile: this.profile,\n      expires_at: this.expires_at\n    });\n  }\n  static fromStorageString(storageString) {\n    Logger.createStatic(\"User\", \"fromStorageString\");\n    return new _User(JSON.parse(storageString));\n  }\n};\n\n// src/navigators/AbstractChildWindow.ts\nvar messageSource = \"oidc-client\";\nvar AbstractChildWindow = class {\n  constructor() {\n    this._abort = new Event(\"Window navigation aborted\");\n    this._disposeHandlers = /* @__PURE__ */ new Set();\n    this._window = null;\n  }\n  async navigate(params) {\n    const logger2 = this._logger.create(\"navigate\");\n    if (!this._window) {\n      throw new Error(\"Attempted to navigate on a disposed window\");\n    }\n    logger2.debug(\"setting URL in window\");\n    this._window.location.replace(params.url);\n    const { url, keepOpen } = await new Promise((resolve, reject) => {\n      const listener = (e) => {\n        var _a;\n        const data = e.data;\n        const origin = (_a = params.scriptOrigin) != null ? _a : window.location.origin;\n        if (e.origin !== origin || (data == null ? void 0 : data.source) !== messageSource) {\n          return;\n        }\n        try {\n          const state = UrlUtils.readParams(data.url, params.response_mode).get(\"state\");\n          if (!state) {\n            logger2.warn(\"no state found in response url\");\n          }\n          if (e.source !== this._window && state !== params.state) {\n            return;\n          }\n        } catch {\n          this._dispose();\n          reject(new Error(\"Invalid response from window\"));\n        }\n        resolve(data);\n      };\n      window.addEventListener(\"message\", listener, false);\n      this._disposeHandlers.add(() => window.removeEventListener(\"message\", listener, false));\n      const channel = new BroadcastChannel(`oidc-client-popup-${params.state}`);\n      channel.addEventListener(\"message\", listener, false);\n      this._disposeHandlers.add(() => channel.close());\n      this._disposeHandlers.add(this._abort.addHandler((reason) => {\n        this._dispose();\n        reject(reason);\n      }));\n    });\n    logger2.debug(\"got response from window\");\n    this._dispose();\n    if (!keepOpen) {\n      this.close();\n    }\n    return { url };\n  }\n  _dispose() {\n    this._logger.create(\"_dispose\");\n    for (const dispose of this._disposeHandlers) {\n      dispose();\n    }\n    this._disposeHandlers.clear();\n  }\n  static _notifyParent(parent, url, keepOpen = false, targetOrigin = window.location.origin) {\n    const msgData = {\n      source: messageSource,\n      url,\n      keepOpen\n    };\n    const logger2 = new Logger(\"_notifyParent\");\n    if (parent) {\n      logger2.debug(\"With parent. Using parent.postMessage.\");\n      parent.postMessage(msgData, targetOrigin);\n    } else {\n      logger2.debug(\"No parent. Using BroadcastChannel.\");\n      const state = new URL(url).searchParams.get(\"state\");\n      if (!state) {\n        throw new Error(\"No parent and no state in URL. Can't complete notification.\");\n      }\n      const channel = new BroadcastChannel(`oidc-client-popup-${state}`);\n      channel.postMessage(msgData);\n      channel.close();\n    }\n  }\n};\n\n// src/UserManagerSettings.ts\nvar DefaultPopupWindowFeatures = {\n  location: false,\n  toolbar: false,\n  height: 640,\n  closePopupWindowAfterInSeconds: -1\n};\nvar DefaultPopupTarget = \"_blank\";\nvar DefaultAccessTokenExpiringNotificationTimeInSeconds = 60;\nvar DefaultCheckSessionIntervalInSeconds = 2;\nvar DefaultSilentRequestTimeoutInSeconds = 10;\nvar UserManagerSettingsStore = class extends OidcClientSettingsStore {\n  constructor(args) {\n    const {\n      popup_redirect_uri = args.redirect_uri,\n      popup_post_logout_redirect_uri = args.post_logout_redirect_uri,\n      popupWindowFeatures = DefaultPopupWindowFeatures,\n      popupWindowTarget = DefaultPopupTarget,\n      redirectMethod = \"assign\",\n      redirectTarget = \"self\",\n      iframeNotifyParentOrigin = args.iframeNotifyParentOrigin,\n      iframeScriptOrigin = args.iframeScriptOrigin,\n      requestTimeoutInSeconds,\n      silent_redirect_uri = args.redirect_uri,\n      silentRequestTimeoutInSeconds,\n      automaticSilentRenew = true,\n      validateSubOnSilentRenew = true,\n      includeIdTokenInSilentRenew = false,\n      monitorSession = false,\n      monitorAnonymousSession = false,\n      checkSessionIntervalInSeconds = DefaultCheckSessionIntervalInSeconds,\n      query_status_response_type = \"code\",\n      stopCheckSessionOnError = true,\n      revokeTokenTypes = [\"access_token\", \"refresh_token\"],\n      revokeTokensOnSignout = false,\n      includeIdTokenInSilentSignout = false,\n      accessTokenExpiringNotificationTimeInSeconds = DefaultAccessTokenExpiringNotificationTimeInSeconds,\n      userStore\n    } = args;\n    super(args);\n    this.popup_redirect_uri = popup_redirect_uri;\n    this.popup_post_logout_redirect_uri = popup_post_logout_redirect_uri;\n    this.popupWindowFeatures = popupWindowFeatures;\n    this.popupWindowTarget = popupWindowTarget;\n    this.redirectMethod = redirectMethod;\n    this.redirectTarget = redirectTarget;\n    this.iframeNotifyParentOrigin = iframeNotifyParentOrigin;\n    this.iframeScriptOrigin = iframeScriptOrigin;\n    this.silent_redirect_uri = silent_redirect_uri;\n    this.silentRequestTimeoutInSeconds = silentRequestTimeoutInSeconds || requestTimeoutInSeconds || DefaultSilentRequestTimeoutInSeconds;\n    this.automaticSilentRenew = automaticSilentRenew;\n    this.validateSubOnSilentRenew = validateSubOnSilentRenew;\n    this.includeIdTokenInSilentRenew = includeIdTokenInSilentRenew;\n    this.monitorSession = monitorSession;\n    this.monitorAnonymousSession = monitorAnonymousSession;\n    this.checkSessionIntervalInSeconds = checkSessionIntervalInSeconds;\n    this.stopCheckSessionOnError = stopCheckSessionOnError;\n    this.query_status_response_type = query_status_response_type;\n    this.revokeTokenTypes = revokeTokenTypes;\n    this.revokeTokensOnSignout = revokeTokensOnSignout;\n    this.includeIdTokenInSilentSignout = includeIdTokenInSilentSignout;\n    this.accessTokenExpiringNotificationTimeInSeconds = accessTokenExpiringNotificationTimeInSeconds;\n    if (userStore) {\n      this.userStore = userStore;\n    } else {\n      const store = typeof window !== \"undefined\" ? window.sessionStorage : new InMemoryWebStorage();\n      this.userStore = new WebStorageStateStore({ store });\n    }\n  }\n};\n\n// src/navigators/IFrameWindow.ts\nvar IFrameWindow = class _IFrameWindow extends AbstractChildWindow {\n  constructor({\n    silentRequestTimeoutInSeconds = DefaultSilentRequestTimeoutInSeconds\n  }) {\n    super();\n    this._logger = new Logger(\"IFrameWindow\");\n    this._timeoutInSeconds = silentRequestTimeoutInSeconds;\n    this._frame = _IFrameWindow.createHiddenIframe();\n    this._window = this._frame.contentWindow;\n  }\n  static createHiddenIframe() {\n    const iframe = window.document.createElement(\"iframe\");\n    iframe.style.visibility = \"hidden\";\n    iframe.style.position = \"fixed\";\n    iframe.style.left = \"-1000px\";\n    iframe.style.top = \"0\";\n    iframe.width = \"0\";\n    iframe.height = \"0\";\n    window.document.body.appendChild(iframe);\n    return iframe;\n  }\n  async navigate(params) {\n    this._logger.debug(\"navigate: Using timeout of:\", this._timeoutInSeconds);\n    const timer = setTimeout(() => void this._abort.raise(new ErrorTimeout(\"IFrame timed out without a response\")), this._timeoutInSeconds * 1e3);\n    this._disposeHandlers.add(() => clearTimeout(timer));\n    return await super.navigate(params);\n  }\n  close() {\n    var _a;\n    if (this._frame) {\n      if (this._frame.parentNode) {\n        this._frame.addEventListener(\"load\", (ev) => {\n          var _a2;\n          const frame = ev.target;\n          (_a2 = frame.parentNode) == null ? void 0 : _a2.removeChild(frame);\n          void this._abort.raise(new Error(\"IFrame removed from DOM\"));\n        }, true);\n        (_a = this._frame.contentWindow) == null ? void 0 : _a.location.replace(\"about:blank\");\n      }\n      this._frame = null;\n    }\n    this._window = null;\n  }\n  static notifyParent(url, targetOrigin) {\n    return super._notifyParent(window.parent, url, false, targetOrigin);\n  }\n};\n\n// src/navigators/IFrameNavigator.ts\nvar IFrameNavigator = class {\n  constructor(_settings) {\n    this._settings = _settings;\n    this._logger = new Logger(\"IFrameNavigator\");\n  }\n  async prepare({\n    silentRequestTimeoutInSeconds = this._settings.silentRequestTimeoutInSeconds\n  }) {\n    return new IFrameWindow({ silentRequestTimeoutInSeconds });\n  }\n  async callback(url) {\n    this._logger.create(\"callback\");\n    IFrameWindow.notifyParent(url, this._settings.iframeNotifyParentOrigin);\n  }\n};\n\n// src/navigators/PopupWindow.ts\nvar checkForPopupClosedInterval = 500;\nvar second = 1e3;\nvar PopupWindow = class extends AbstractChildWindow {\n  constructor({\n    popupWindowTarget = DefaultPopupTarget,\n    popupWindowFeatures = {},\n    popupSignal,\n    popupAbortOnClose\n  }) {\n    super();\n    this._logger = new Logger(\"PopupWindow\");\n    const centeredPopup = PopupUtils.center({ ...DefaultPopupWindowFeatures, ...popupWindowFeatures });\n    this._window = window.open(void 0, popupWindowTarget, PopupUtils.serialize(centeredPopup));\n    this.abortOnClose = Boolean(popupAbortOnClose);\n    if (popupSignal) {\n      popupSignal.addEventListener(\"abort\", () => {\n        var _a;\n        void this._abort.raise(new Error((_a = popupSignal.reason) != null ? _a : \"Popup aborted\"));\n      });\n    }\n    if (popupWindowFeatures.closePopupWindowAfterInSeconds && popupWindowFeatures.closePopupWindowAfterInSeconds > 0) {\n      setTimeout(() => {\n        if (!this._window || typeof this._window.closed !== \"boolean\" || this._window.closed) {\n          void this._abort.raise(new Error(\"Popup blocked by user\"));\n          return;\n        }\n        this.close();\n      }, popupWindowFeatures.closePopupWindowAfterInSeconds * second);\n    }\n  }\n  async navigate(params) {\n    var _a;\n    (_a = this._window) == null ? void 0 : _a.focus();\n    const popupClosedInterval = setInterval(() => {\n      if (!this._window || this._window.closed) {\n        this._logger.debug(\"Popup closed by user or isolated by redirect\");\n        clearPopupClosedInterval();\n        this._disposeHandlers.delete(clearPopupClosedInterval);\n        if (this.abortOnClose) {\n          void this._abort.raise(new Error(\"Popup closed by user\"));\n        }\n      }\n    }, checkForPopupClosedInterval);\n    const clearPopupClosedInterval = () => clearInterval(popupClosedInterval);\n    this._disposeHandlers.add(clearPopupClosedInterval);\n    return await super.navigate(params);\n  }\n  close() {\n    if (this._window) {\n      if (!this._window.closed) {\n        this._window.close();\n        void this._abort.raise(new Error(\"Popup closed\"));\n      }\n    }\n    this._window = null;\n  }\n  static notifyOpener(url, keepOpen) {\n    super._notifyParent(window.opener, url, keepOpen);\n    if (!keepOpen && !window.opener) {\n      window.close();\n    }\n  }\n};\n\n// src/navigators/PopupNavigator.ts\nvar PopupNavigator = class {\n  constructor(_settings) {\n    this._settings = _settings;\n    this._logger = new Logger(\"PopupNavigator\");\n  }\n  async prepare({\n    popupWindowFeatures = this._settings.popupWindowFeatures,\n    popupWindowTarget = this._settings.popupWindowTarget,\n    popupSignal,\n    popupAbortOnClose\n  }) {\n    return new PopupWindow({\n      popupWindowFeatures,\n      popupWindowTarget,\n      popupSignal,\n      popupAbortOnClose\n    });\n  }\n  async callback(url, { keepOpen = false }) {\n    this._logger.create(\"callback\");\n    PopupWindow.notifyOpener(url, keepOpen);\n  }\n};\n\n// src/navigators/RedirectNavigator.ts\nvar RedirectNavigator = class {\n  constructor(_settings) {\n    this._settings = _settings;\n    this._logger = new Logger(\"RedirectNavigator\");\n  }\n  async prepare({\n    redirectMethod = this._settings.redirectMethod,\n    redirectTarget = this._settings.redirectTarget\n  }) {\n    var _a;\n    this._logger.create(\"prepare\");\n    let targetWindow = window.self;\n    if (redirectTarget === \"top\") {\n      targetWindow = (_a = window.top) != null ? _a : window.self;\n    }\n    const redirect = targetWindow.location[redirectMethod].bind(targetWindow.location);\n    let abort;\n    return {\n      navigate: async (params) => {\n        this._logger.create(\"navigate\");\n        const promise = new Promise((resolve, reject) => {\n          abort = reject;\n          window.addEventListener(\"pageshow\", () => resolve(window.location.href));\n          redirect(params.url);\n        });\n        return await promise;\n      },\n      close: () => {\n        this._logger.create(\"close\");\n        abort == null ? void 0 : abort(new Error(\"Redirect aborted\"));\n        targetWindow.stop();\n      }\n    };\n  }\n  async callback() {\n    return;\n  }\n};\n\n// src/UserManagerEvents.ts\nvar UserManagerEvents = class extends AccessTokenEvents {\n  constructor(settings) {\n    super({ expiringNotificationTimeInSeconds: settings.accessTokenExpiringNotificationTimeInSeconds });\n    this._logger = new Logger(\"UserManagerEvents\");\n    this._userLoaded = new Event(\"User loaded\");\n    this._userUnloaded = new Event(\"User unloaded\");\n    this._silentRenewError = new Event(\"Silent renew error\");\n    this._userSignedIn = new Event(\"User signed in\");\n    this._userSignedOut = new Event(\"User signed out\");\n    this._userSessionChanged = new Event(\"User session changed\");\n  }\n  async load(user, raiseEvent = true) {\n    await super.load(user);\n    if (raiseEvent) {\n      await this._userLoaded.raise(user);\n    }\n  }\n  async unload() {\n    await super.unload();\n    await this._userUnloaded.raise();\n  }\n  /**\n   * Add callback: Raised when a user session has been established (or re-established).\n   */\n  addUserLoaded(cb) {\n    return this._userLoaded.addHandler(cb);\n  }\n  /**\n   * Remove callback: Raised when a user session has been established (or re-established).\n   */\n  removeUserLoaded(cb) {\n    return this._userLoaded.removeHandler(cb);\n  }\n  /**\n   * Add callback: Raised when a user session has been terminated.\n   */\n  addUserUnloaded(cb) {\n    return this._userUnloaded.addHandler(cb);\n  }\n  /**\n   * Remove callback: Raised when a user session has been terminated.\n   */\n  removeUserUnloaded(cb) {\n    return this._userUnloaded.removeHandler(cb);\n  }\n  /**\n   * Add callback: Raised when the automatic silent renew has failed.\n   */\n  addSilentRenewError(cb) {\n    return this._silentRenewError.addHandler(cb);\n  }\n  /**\n   * Remove callback: Raised when the automatic silent renew has failed.\n   */\n  removeSilentRenewError(cb) {\n    return this._silentRenewError.removeHandler(cb);\n  }\n  /**\n   * @internal\n   */\n  async _raiseSilentRenewError(e) {\n    await this._silentRenewError.raise(e);\n  }\n  /**\n   * Add callback: Raised when the user is signed in (when `monitorSession` is set).\n   * @see {@link UserManagerSettings.monitorSession}\n   */\n  addUserSignedIn(cb) {\n    return this._userSignedIn.addHandler(cb);\n  }\n  /**\n   * Remove callback: Raised when the user is signed in (when `monitorSession` is set).\n   */\n  removeUserSignedIn(cb) {\n    this._userSignedIn.removeHandler(cb);\n  }\n  /**\n   * @internal\n   */\n  async _raiseUserSignedIn() {\n    await this._userSignedIn.raise();\n  }\n  /**\n   * Add callback: Raised when the user's sign-in status at the OP has changed (when `monitorSession` is set).\n   * @see {@link UserManagerSettings.monitorSession}\n   */\n  addUserSignedOut(cb) {\n    return this._userSignedOut.addHandler(cb);\n  }\n  /**\n   * Remove callback: Raised when the user's sign-in status at the OP has changed (when `monitorSession` is set).\n   */\n  removeUserSignedOut(cb) {\n    this._userSignedOut.removeHandler(cb);\n  }\n  /**\n   * @internal\n   */\n  async _raiseUserSignedOut() {\n    await this._userSignedOut.raise();\n  }\n  /**\n   * Add callback: Raised when the user session changed (when `monitorSession` is set).\n   * @see {@link UserManagerSettings.monitorSession}\n   */\n  addUserSessionChanged(cb) {\n    return this._userSessionChanged.addHandler(cb);\n  }\n  /**\n   * Remove callback: Raised when the user session changed (when `monitorSession` is set).\n   */\n  removeUserSessionChanged(cb) {\n    this._userSessionChanged.removeHandler(cb);\n  }\n  /**\n   * @internal\n   */\n  async _raiseUserSessionChanged() {\n    await this._userSessionChanged.raise();\n  }\n};\n\n// src/SilentRenewService.ts\nvar SilentRenewService = class {\n  constructor(_userManager) {\n    this._userManager = _userManager;\n    this._logger = new Logger(\"SilentRenewService\");\n    this._isStarted = false;\n    this._retryTimer = new Timer(\"Retry Silent Renew\");\n    this._tokenExpiring = async () => {\n      const logger2 = this._logger.create(\"_tokenExpiring\");\n      try {\n        await this._userManager.signinSilent();\n        logger2.debug(\"silent token renewal successful\");\n      } catch (err) {\n        if (err instanceof ErrorTimeout) {\n          logger2.warn(\"ErrorTimeout from signinSilent:\", err, \"retry in 5s\");\n          this._retryTimer.init(5);\n          return;\n        }\n        logger2.error(\"Error from signinSilent:\", err);\n        await this._userManager.events._raiseSilentRenewError(err);\n      }\n    };\n  }\n  async start() {\n    const logger2 = this._logger.create(\"start\");\n    if (!this._isStarted) {\n      this._isStarted = true;\n      this._userManager.events.addAccessTokenExpiring(this._tokenExpiring);\n      this._retryTimer.addHandler(this._tokenExpiring);\n      try {\n        await this._userManager.getUser();\n      } catch (err) {\n        logger2.error(\"getUser error\", err);\n      }\n    }\n  }\n  stop() {\n    if (this._isStarted) {\n      this._retryTimer.cancel();\n      this._retryTimer.removeHandler(this._tokenExpiring);\n      this._userManager.events.removeAccessTokenExpiring(this._tokenExpiring);\n      this._isStarted = false;\n    }\n  }\n};\n\n// src/RefreshState.ts\nvar RefreshState = class {\n  constructor(args) {\n    this.refresh_token = args.refresh_token;\n    this.id_token = args.id_token;\n    this.session_state = args.session_state;\n    this.scope = args.scope;\n    this.profile = args.profile;\n    this.data = args.state;\n  }\n};\n\n// src/UserManager.ts\nvar UserManager = class {\n  constructor(settings, redirectNavigator, popupNavigator, iframeNavigator) {\n    this._logger = new Logger(\"UserManager\");\n    this.settings = new UserManagerSettingsStore(settings);\n    this._client = new OidcClient(settings);\n    this._redirectNavigator = redirectNavigator != null ? redirectNavigator : new RedirectNavigator(this.settings);\n    this._popupNavigator = popupNavigator != null ? popupNavigator : new PopupNavigator(this.settings);\n    this._iframeNavigator = iframeNavigator != null ? iframeNavigator : new IFrameNavigator(this.settings);\n    this._events = new UserManagerEvents(this.settings);\n    this._silentRenewService = new SilentRenewService(this);\n    if (this.settings.automaticSilentRenew) {\n      this.startSilentRenew();\n    }\n    this._sessionMonitor = null;\n    if (this.settings.monitorSession) {\n      this._sessionMonitor = new SessionMonitor(this);\n    }\n  }\n  /**\n   * Get object used to register for events raised by the `UserManager`.\n   */\n  get events() {\n    return this._events;\n  }\n  /**\n   * Get object used to access the metadata configuration of the identity provider.\n   */\n  get metadataService() {\n    return this._client.metadataService;\n  }\n  /**\n   * Load the `User` object for the currently authenticated user.\n   *\n   * @param raiseEvent - If `true`, the `UserLoaded` event will be raised. Defaults to false.\n   * @returns A promise\n   */\n  async getUser(raiseEvent = false) {\n    const logger2 = this._logger.create(\"getUser\");\n    const user = await this._loadUser();\n    if (user) {\n      logger2.info(\"user loaded\");\n      await this._events.load(user, raiseEvent);\n      return user;\n    }\n    logger2.info(\"user not found in storage\");\n    return null;\n  }\n  /**\n   * Remove from any storage the currently authenticated user.\n   *\n   * @returns A promise\n   */\n  async removeUser() {\n    const logger2 = this._logger.create(\"removeUser\");\n    await this.storeUser(null);\n    logger2.info(\"user removed from storage\");\n    await this._events.unload();\n  }\n  /**\n   * Trigger a redirect of the current window to the authorization endpoint.\n   *\n   * @returns A promise\n   *\n   * @throws `Error` In cases of wrong authentication.\n   */\n  async signinRedirect(args = {}) {\n    var _a;\n    this._logger.create(\"signinRedirect\");\n    const {\n      redirectMethod,\n      ...requestArgs\n    } = args;\n    let dpopJkt;\n    if ((_a = this.settings.dpop) == null ? void 0 : _a.bind_authorization_code) {\n      dpopJkt = await this.generateDPoPJkt(this.settings.dpop);\n    }\n    const handle = await this._redirectNavigator.prepare({ redirectMethod });\n    await this._signinStart({\n      request_type: \"si:r\",\n      dpopJkt,\n      ...requestArgs\n    }, handle);\n  }\n  /**\n   * Process the response (callback) from the authorization endpoint.\n   * It is recommended to use {@link UserManager.signinCallback} instead.\n   *\n   * @returns A promise containing the authenticated `User`.\n   *\n   * @see {@link UserManager.signinCallback}\n   */\n  async signinRedirectCallback(url = window.location.href) {\n    const logger2 = this._logger.create(\"signinRedirectCallback\");\n    const user = await this._signinEnd(url);\n    if (user.profile && user.profile.sub) {\n      logger2.info(\"success, signed in subject\", user.profile.sub);\n    } else {\n      logger2.info(\"no subject\");\n    }\n    return user;\n  }\n  /**\n   * Trigger the signin with user/password.\n   *\n   * @returns A promise containing the authenticated `User`.\n   * @throws {@link ErrorResponse} In cases of wrong authentication.\n   */\n  async signinResourceOwnerCredentials({\n    username,\n    password,\n    skipUserInfo = false\n  }) {\n    const logger2 = this._logger.create(\"signinResourceOwnerCredential\");\n    const signinResponse = await this._client.processResourceOwnerPasswordCredentials({\n      username,\n      password,\n      skipUserInfo,\n      extraTokenParams: this.settings.extraTokenParams\n    });\n    logger2.debug(\"got signin response\");\n    const user = await this._buildUser(signinResponse);\n    if (user.profile && user.profile.sub) {\n      logger2.info(\"success, signed in subject\", user.profile.sub);\n    } else {\n      logger2.info(\"no subject\");\n    }\n    return user;\n  }\n  /**\n   * Trigger a request (via a popup window) to the authorization endpoint.\n   *\n   * @returns A promise containing the authenticated `User`.\n   * @throws `Error` In cases of wrong authentication.\n   */\n  async signinPopup(args = {}) {\n    var _a;\n    const logger2 = this._logger.create(\"signinPopup\");\n    let dpopJkt;\n    if ((_a = this.settings.dpop) == null ? void 0 : _a.bind_authorization_code) {\n      dpopJkt = await this.generateDPoPJkt(this.settings.dpop);\n    }\n    const {\n      popupWindowFeatures,\n      popupWindowTarget,\n      popupSignal,\n      popupAbortOnClose,\n      ...requestArgs\n    } = args;\n    const url = this.settings.popup_redirect_uri;\n    if (!url) {\n      logger2.throw(new Error(\"No popup_redirect_uri configured\"));\n    }\n    const handle = await this._popupNavigator.prepare({ popupWindowFeatures, popupWindowTarget, popupSignal, popupAbortOnClose });\n    const user = await this._signin({\n      request_type: \"si:p\",\n      redirect_uri: url,\n      display: \"popup\",\n      dpopJkt,\n      ...requestArgs\n    }, handle);\n    if (user) {\n      if (user.profile && user.profile.sub) {\n        logger2.info(\"success, signed in subject\", user.profile.sub);\n      } else {\n        logger2.info(\"no subject\");\n      }\n    }\n    return user;\n  }\n  /**\n   * Notify the opening window of response (callback) from the authorization endpoint.\n   * It is recommended to use {@link UserManager.signinCallback} instead.\n   *\n   * @returns A promise\n   *\n   * @see {@link UserManager.signinCallback}\n   */\n  async signinPopupCallback(url = window.location.href, keepOpen = false) {\n    const logger2 = this._logger.create(\"signinPopupCallback\");\n    await this._popupNavigator.callback(url, { keepOpen });\n    logger2.info(\"success\");\n  }\n  /**\n   * Trigger a silent request (via refresh token or an iframe) to the authorization endpoint.\n   *\n   * @returns A promise that contains the authenticated `User`.\n   */\n  async signinSilent(args = {}) {\n    var _a, _b;\n    const logger2 = this._logger.create(\"signinSilent\");\n    const {\n      silentRequestTimeoutInSeconds,\n      ...requestArgs\n    } = args;\n    let user = await this._loadUser();\n    if (!args.forceIframeAuth && (user == null ? void 0 : user.refresh_token)) {\n      logger2.debug(\"using refresh token\");\n      const state = new RefreshState(user);\n      return await this._useRefreshToken({\n        state,\n        redirect_uri: requestArgs.redirect_uri,\n        resource: requestArgs.resource,\n        extraTokenParams: requestArgs.extraTokenParams,\n        timeoutInSeconds: silentRequestTimeoutInSeconds\n      });\n    }\n    let dpopJkt;\n    if ((_a = this.settings.dpop) == null ? void 0 : _a.bind_authorization_code) {\n      dpopJkt = await this.generateDPoPJkt(this.settings.dpop);\n    }\n    const url = this.settings.silent_redirect_uri;\n    if (!url) {\n      logger2.throw(new Error(\"No silent_redirect_uri configured\"));\n    }\n    let verifySub;\n    if (user && this.settings.validateSubOnSilentRenew) {\n      logger2.debug(\"subject prior to silent renew:\", user.profile.sub);\n      verifySub = user.profile.sub;\n    }\n    const handle = await this._iframeNavigator.prepare({ silentRequestTimeoutInSeconds });\n    user = await this._signin({\n      request_type: \"si:s\",\n      redirect_uri: url,\n      prompt: \"none\",\n      id_token_hint: this.settings.includeIdTokenInSilentRenew ? user == null ? void 0 : user.id_token : void 0,\n      dpopJkt,\n      ...requestArgs\n    }, handle, verifySub);\n    if (user) {\n      if ((_b = user.profile) == null ? void 0 : _b.sub) {\n        logger2.info(\"success, signed in subject\", user.profile.sub);\n      } else {\n        logger2.info(\"no subject\");\n      }\n    }\n    return user;\n  }\n  async _useRefreshToken(args) {\n    const response = await this._client.useRefreshToken({\n      timeoutInSeconds: this.settings.silentRequestTimeoutInSeconds,\n      ...args\n    });\n    const user = new User({ ...args.state, ...response });\n    await this.storeUser(user);\n    await this._events.load(user);\n    return user;\n  }\n  /**\n   *\n   * Notify the parent window of response (callback) from the authorization endpoint.\n   * It is recommended to use {@link UserManager.signinCallback} instead.\n   *\n   * @returns A promise\n   *\n   * @see {@link UserManager.signinCallback}\n   */\n  async signinSilentCallback(url = window.location.href) {\n    const logger2 = this._logger.create(\"signinSilentCallback\");\n    await this._iframeNavigator.callback(url);\n    logger2.info(\"success\");\n  }\n  /**\n   * Process any response (callback) from the authorization endpoint, by dispatching the request_type\n   * and executing one of the following functions:\n   * - {@link UserManager.signinRedirectCallback}\n   * - {@link UserManager.signinPopupCallback}\n   * - {@link UserManager.signinSilentCallback}\n   *\n   * @throws `Error` If request_type is unknown or signin cannot be processed.\n   */\n  async signinCallback(url = window.location.href) {\n    const { state } = await this._client.readSigninResponseState(url);\n    switch (state.request_type) {\n      case \"si:r\":\n        return await this.signinRedirectCallback(url);\n      case \"si:p\":\n        await this.signinPopupCallback(url);\n        break;\n      case \"si:s\":\n        await this.signinSilentCallback(url);\n        break;\n      default:\n        throw new Error(\"invalid response_type in state\");\n    }\n    return void 0;\n  }\n  /**\n   * Process any response (callback) from the end session endpoint, by dispatching the request_type\n   * and executing one of the following functions:\n   * - {@link UserManager.signoutRedirectCallback}\n   * - {@link UserManager.signoutPopupCallback}\n   * - {@link UserManager.signoutSilentCallback}\n   *\n   * @throws `Error` If request_type is unknown or signout cannot be processed.\n   */\n  async signoutCallback(url = window.location.href, keepOpen = false) {\n    const { state } = await this._client.readSignoutResponseState(url);\n    if (!state) {\n      return void 0;\n    }\n    switch (state.request_type) {\n      case \"so:r\":\n        return await this.signoutRedirectCallback(url);\n      case \"so:p\":\n        await this.signoutPopupCallback(url, keepOpen);\n        break;\n      case \"so:s\":\n        await this.signoutSilentCallback(url);\n        break;\n      default:\n        throw new Error(\"invalid response_type in state\");\n    }\n    return void 0;\n  }\n  /**\n   * Query OP for user's current signin status.\n   *\n   * @returns A promise object with session_state and subject identifier.\n   */\n  async querySessionStatus(args = {}) {\n    const logger2 = this._logger.create(\"querySessionStatus\");\n    const {\n      silentRequestTimeoutInSeconds,\n      ...requestArgs\n    } = args;\n    const url = this.settings.silent_redirect_uri;\n    if (!url) {\n      logger2.throw(new Error(\"No silent_redirect_uri configured\"));\n    }\n    const user = await this._loadUser();\n    const handle = await this._iframeNavigator.prepare({ silentRequestTimeoutInSeconds });\n    const navResponse = await this._signinStart({\n      request_type: \"si:s\",\n      // this acts like a signin silent\n      redirect_uri: url,\n      prompt: \"none\",\n      id_token_hint: this.settings.includeIdTokenInSilentRenew ? user == null ? void 0 : user.id_token : void 0,\n      response_type: this.settings.query_status_response_type,\n      scope: \"openid\",\n      skipUserInfo: true,\n      ...requestArgs\n    }, handle);\n    try {\n      const extraHeaders = {};\n      const signinResponse = await this._client.processSigninResponse(navResponse.url, extraHeaders);\n      logger2.debug(\"got signin response\");\n      if (signinResponse.session_state && signinResponse.profile.sub) {\n        logger2.info(\"success for subject\", signinResponse.profile.sub);\n        return {\n          session_state: signinResponse.session_state,\n          sub: signinResponse.profile.sub\n        };\n      }\n      logger2.info(\"success, user not authenticated\");\n      return null;\n    } catch (err) {\n      if (this.settings.monitorAnonymousSession && err instanceof ErrorResponse) {\n        switch (err.error) {\n          case \"login_required\":\n          case \"consent_required\":\n          case \"interaction_required\":\n          case \"account_selection_required\":\n            logger2.info(\"success for anonymous user\");\n            return {\n              session_state: err.session_state\n            };\n        }\n      }\n      throw err;\n    }\n  }\n  async _signin(args, handle, verifySub) {\n    const navResponse = await this._signinStart(args, handle);\n    return await this._signinEnd(navResponse.url, verifySub);\n  }\n  async _signinStart(args, handle) {\n    const logger2 = this._logger.create(\"_signinStart\");\n    try {\n      const signinRequest = await this._client.createSigninRequest(args);\n      logger2.debug(\"got signin request\");\n      return await handle.navigate({\n        url: signinRequest.url,\n        state: signinRequest.state.id,\n        response_mode: signinRequest.state.response_mode,\n        scriptOrigin: this.settings.iframeScriptOrigin\n      });\n    } catch (err) {\n      logger2.debug(\"error after preparing navigator, closing navigator window\");\n      handle.close();\n      throw err;\n    }\n  }\n  async _signinEnd(url, verifySub) {\n    const logger2 = this._logger.create(\"_signinEnd\");\n    const extraHeaders = {};\n    const signinResponse = await this._client.processSigninResponse(url, extraHeaders);\n    logger2.debug(\"got signin response\");\n    const user = await this._buildUser(signinResponse, verifySub);\n    return user;\n  }\n  async _buildUser(signinResponse, verifySub) {\n    const logger2 = this._logger.create(\"_buildUser\");\n    const user = new User(signinResponse);\n    if (verifySub) {\n      if (verifySub !== user.profile.sub) {\n        logger2.debug(\"current user does not match user returned from signin. sub from signin:\", user.profile.sub);\n        throw new ErrorResponse({ ...signinResponse, error: \"login_required\" });\n      }\n      logger2.debug(\"current user matches user returned from signin\");\n    }\n    await this.storeUser(user);\n    logger2.debug(\"user stored\");\n    await this._events.load(user);\n    return user;\n  }\n  /**\n   * Trigger a redirect of the current window to the end session endpoint.\n   *\n   * @returns A promise\n   */\n  async signoutRedirect(args = {}) {\n    const logger2 = this._logger.create(\"signoutRedirect\");\n    const {\n      redirectMethod,\n      ...requestArgs\n    } = args;\n    const handle = await this._redirectNavigator.prepare({ redirectMethod });\n    await this._signoutStart({\n      request_type: \"so:r\",\n      post_logout_redirect_uri: this.settings.post_logout_redirect_uri,\n      ...requestArgs\n    }, handle);\n    logger2.info(\"success\");\n  }\n  /**\n   * Process response (callback) from the end session endpoint.\n   * It is recommended to use {@link UserManager.signoutCallback} instead.\n   *\n   * @returns A promise containing signout response\n   *\n   * @see {@link UserManager.signoutCallback}\n   */\n  async signoutRedirectCallback(url = window.location.href) {\n    const logger2 = this._logger.create(\"signoutRedirectCallback\");\n    const response = await this._signoutEnd(url);\n    logger2.info(\"success\");\n    return response;\n  }\n  /**\n   * Trigger a redirect of a popup window to the end session endpoint.\n   *\n   * @returns A promise\n   */\n  async signoutPopup(args = {}) {\n    const logger2 = this._logger.create(\"signoutPopup\");\n    const {\n      popupWindowFeatures,\n      popupWindowTarget,\n      popupSignal,\n      ...requestArgs\n    } = args;\n    const url = this.settings.popup_post_logout_redirect_uri;\n    const handle = await this._popupNavigator.prepare({ popupWindowFeatures, popupWindowTarget, popupSignal });\n    await this._signout({\n      request_type: \"so:p\",\n      post_logout_redirect_uri: url,\n      // we're putting a dummy entry in here because we\n      // need a unique id from the state for notification\n      // to the parent window, which is necessary if we\n      // plan to return back to the client after signout\n      // and so we can close the popup after signout\n      state: url == null ? void 0 : {},\n      ...requestArgs\n    }, handle);\n    logger2.info(\"success\");\n  }\n  /**\n   * Process response (callback) from the end session endpoint from a popup window.\n   * It is recommended to use {@link UserManager.signoutCallback} instead.\n   *\n   * @returns A promise\n   *\n   * @see {@link UserManager.signoutCallback}\n   */\n  async signoutPopupCallback(url = window.location.href, keepOpen = false) {\n    const logger2 = this._logger.create(\"signoutPopupCallback\");\n    await this._popupNavigator.callback(url, { keepOpen });\n    logger2.info(\"success\");\n  }\n  async _signout(args, handle) {\n    const navResponse = await this._signoutStart(args, handle);\n    return await this._signoutEnd(navResponse.url);\n  }\n  async _signoutStart(args = {}, handle) {\n    var _a;\n    const logger2 = this._logger.create(\"_signoutStart\");\n    try {\n      const user = await this._loadUser();\n      logger2.debug(\"loaded current user from storage\");\n      if (this.settings.revokeTokensOnSignout) {\n        await this._revokeInternal(user);\n      }\n      const id_token = args.id_token_hint || user && user.id_token;\n      if (id_token) {\n        logger2.debug(\"setting id_token_hint in signout request\");\n        args.id_token_hint = id_token;\n      }\n      await this.removeUser();\n      logger2.debug(\"user removed, creating signout request\");\n      const signoutRequest = await this._client.createSignoutRequest(args);\n      logger2.debug(\"got signout request\");\n      return await handle.navigate({\n        url: signoutRequest.url,\n        state: (_a = signoutRequest.state) == null ? void 0 : _a.id,\n        scriptOrigin: this.settings.iframeScriptOrigin\n      });\n    } catch (err) {\n      logger2.debug(\"error after preparing navigator, closing navigator window\");\n      handle.close();\n      throw err;\n    }\n  }\n  async _signoutEnd(url) {\n    const logger2 = this._logger.create(\"_signoutEnd\");\n    const signoutResponse = await this._client.processSignoutResponse(url);\n    logger2.debug(\"got signout response\");\n    return signoutResponse;\n  }\n  /**\n   * Trigger a silent request (via an iframe) to the end session endpoint.\n   *\n   * @returns A promise\n   */\n  async signoutSilent(args = {}) {\n    var _a;\n    const logger2 = this._logger.create(\"signoutSilent\");\n    const {\n      silentRequestTimeoutInSeconds,\n      ...requestArgs\n    } = args;\n    const id_token_hint = this.settings.includeIdTokenInSilentSignout ? (_a = await this._loadUser()) == null ? void 0 : _a.id_token : void 0;\n    const url = this.settings.popup_post_logout_redirect_uri;\n    const handle = await this._iframeNavigator.prepare({ silentRequestTimeoutInSeconds });\n    await this._signout({\n      request_type: \"so:s\",\n      post_logout_redirect_uri: url,\n      id_token_hint,\n      ...requestArgs\n    }, handle);\n    logger2.info(\"success\");\n  }\n  /**\n   * Notify the parent window of response (callback) from the end session endpoint.\n   * It is recommended to use {@link UserManager.signoutCallback} instead.\n   *\n   * @returns A promise\n   *\n   * @see {@link UserManager.signoutCallback}\n   */\n  async signoutSilentCallback(url = window.location.href) {\n    const logger2 = this._logger.create(\"signoutSilentCallback\");\n    await this._iframeNavigator.callback(url);\n    logger2.info(\"success\");\n  }\n  async revokeTokens(types) {\n    const user = await this._loadUser();\n    await this._revokeInternal(user, types);\n  }\n  async _revokeInternal(user, types = this.settings.revokeTokenTypes) {\n    const logger2 = this._logger.create(\"_revokeInternal\");\n    if (!user) return;\n    const typesPresent = types.filter((type) => typeof user[type] === \"string\");\n    if (!typesPresent.length) {\n      logger2.debug(\"no need to revoke due to no token(s)\");\n      return;\n    }\n    for (const type of typesPresent) {\n      await this._client.revokeToken(\n        user[type],\n        type\n      );\n      logger2.info(`${type} revoked successfully`);\n      if (type !== \"access_token\") {\n        user[type] = null;\n      }\n    }\n    await this.storeUser(user);\n    logger2.debug(\"user stored\");\n    await this._events.load(user);\n  }\n  /**\n   * Enables silent renew for the `UserManager`.\n   */\n  startSilentRenew() {\n    this._logger.create(\"startSilentRenew\");\n    void this._silentRenewService.start();\n  }\n  /**\n   * Disables silent renew for the `UserManager`.\n   */\n  stopSilentRenew() {\n    this._silentRenewService.stop();\n  }\n  get _userStoreKey() {\n    return `user:${this.settings.authority}:${this.settings.client_id}`;\n  }\n  async _loadUser() {\n    const logger2 = this._logger.create(\"_loadUser\");\n    const storageString = await this.settings.userStore.get(this._userStoreKey);\n    if (storageString) {\n      logger2.debug(\"user storageString loaded\");\n      return User.fromStorageString(storageString);\n    }\n    logger2.debug(\"no user storageString\");\n    return null;\n  }\n  async storeUser(user) {\n    const logger2 = this._logger.create(\"storeUser\");\n    if (user) {\n      logger2.debug(\"storing user\");\n      const storageString = user.toStorageString();\n      await this.settings.userStore.set(this._userStoreKey, storageString);\n    } else {\n      this._logger.debug(\"removing user\");\n      await this.settings.userStore.remove(this._userStoreKey);\n      if (this.settings.dpop) {\n        await this.settings.dpop.store.remove(this.settings.client_id);\n      }\n    }\n  }\n  /**\n   * Removes stale state entries in storage for incomplete authorize requests.\n   */\n  async clearStaleState() {\n    await this._client.clearStaleState();\n  }\n  /**\n   * Dynamically generates a DPoP proof for a given user, URL and optional Http method.\n   * This method is useful when you need to make a request to a resource server\n   * with fetch or similar, and you need to include a DPoP proof in a DPoP header.\n   * @param url - The URL to generate the DPoP proof for\n   * @param user - The user to generate the DPoP proof for\n   * @param httpMethod - Optional, defaults to \"GET\"\n   * @param nonce - Optional nonce provided by the resource server\n   *\n   * @returns A promise containing the DPoP proof or undefined if DPoP is not enabled/no user is found.\n   */\n  async dpopProof(url, user, httpMethod, nonce) {\n    var _a, _b;\n    const dpopState = await ((_b = (_a = this.settings.dpop) == null ? void 0 : _a.store) == null ? void 0 : _b.get(this.settings.client_id));\n    if (dpopState) {\n      return await CryptoUtils.generateDPoPProof({\n        url,\n        accessToken: user == null ? void 0 : user.access_token,\n        httpMethod,\n        keyPair: dpopState.keys,\n        nonce\n      });\n    }\n    return void 0;\n  }\n  async generateDPoPJkt(dpopSettings) {\n    let dpopState = await dpopSettings.store.get(this.settings.client_id);\n    if (!dpopState) {\n      const dpopKeys = await CryptoUtils.generateDPoPKeys();\n      dpopState = new DPoPState(dpopKeys);\n      await dpopSettings.store.set(this.settings.client_id, dpopState);\n    }\n    return await CryptoUtils.generateDPoPJkt(dpopState.keys);\n  }\n};\n\n// package.json\nvar version = \"3.4.1\";\n\n// src/Version.ts\nvar Version = version;\n\n// src/IndexedDbDPoPStore.ts\nvar IndexedDbDPoPStore = class {\n  constructor() {\n    this._dbName = \"oidc\";\n    this._storeName = \"dpop\";\n  }\n  async set(key, value) {\n    const store = await this.createStore(this._dbName, this._storeName);\n    await store(\"readwrite\", (str) => {\n      str.put(value, key);\n      return this.promisifyRequest(str.transaction);\n    });\n  }\n  async get(key) {\n    const store = await this.createStore(this._dbName, this._storeName);\n    return await store(\"readonly\", (str) => {\n      return this.promisifyRequest(str.get(key));\n    });\n  }\n  async remove(key) {\n    const item = await this.get(key);\n    const store = await this.createStore(this._dbName, this._storeName);\n    await store(\"readwrite\", (str) => {\n      return this.promisifyRequest(str.delete(key));\n    });\n    return item;\n  }\n  async getAllKeys() {\n    const store = await this.createStore(this._dbName, this._storeName);\n    return await store(\"readonly\", (str) => {\n      return this.promisifyRequest(str.getAllKeys());\n    });\n  }\n  promisifyRequest(request) {\n    return new Promise((resolve, reject) => {\n      request.oncomplete = request.onsuccess = () => resolve(request.result);\n      request.onabort = request.onerror = () => reject(request.error);\n    });\n  }\n  async createStore(dbName, storeName) {\n    const request = indexedDB.open(dbName);\n    request.onupgradeneeded = () => request.result.createObjectStore(storeName);\n    const db = await this.promisifyRequest(request);\n    return async (txMode, callback) => {\n      const tx = db.transaction(storeName, txMode);\n      const store = tx.objectStore(storeName);\n      return await callback(store);\n    };\n  }\n};\nexport {\n  AccessTokenEvents,\n  CheckSessionIFrame,\n  DPoPState,\n  ErrorResponse,\n  ErrorTimeout,\n  InMemoryWebStorage,\n  IndexedDbDPoPStore,\n  Log,\n  Logger,\n  MetadataService,\n  OidcClient,\n  OidcClientSettingsStore,\n  SessionMonitor,\n  SigninResponse,\n  SigninState,\n  SignoutResponse,\n  State,\n  User,\n  UserManager,\n  UserManagerSettingsStore,\n  Version,\n  WebStorageStateStore\n};\n//# sourceMappingURL=oidc-client-ts.js.map\n","import BrowserStorage from \"../browser-store\";\nimport Auth from \"./index\";\nimport Utils from \"../utils\";\n\nimport { UserManager } from 'oidc-client-ts';\n\nexport default class OIDC extends Auth {\n\n  constructor(options, changeListener, router) {\n    super(options, changeListener, router);\n\n    const oidcConfig = {\n      authority: options.openIdConnectUrl.replace('/.well-known/openid-configuration', ''),\n      client_id: 'stac-browser',\n      post_logout_redirect_uri: this.getRedirectUri('/auth/logout'),\n      redirect_uri: this.getRedirectUri('/auth'),\n      automaticSilentRenew: true\n    };\n    this.user = null;\n    this.manager = new UserManager(Object.assign(oidcConfig, options.oidcConfig));\n    const callback = this.setUser.bind(this);\n    this.manager.events.addAccessTokenExpired(callback);\n    this.manager.events.addUserLoaded(callback);\n    this.manager.events.addUserUnloaded(callback);\n    this.browserStorage = new BrowserStorage();\n  }\n\n  setOriginalUri() {\n    this.browserStorage.set('oidc-original-uri', this.router?.currentRoute?.fullPath || window.location.href);\n  }\n\n  restoreOriginalUri() {\n    let originalUri = this.browserStorage.get('oidc-original-uri');\n    if (this.router && Utils.hasText(originalUri)) {\n      if (originalUri.startsWith('/auth/logout')) {\n        originalUri = '/';\n      }\n      this.router.replace(originalUri);\n    }\n    this.browserStorage.remove('oidc-original-uri');\n  }\n\n  getRedirectUri(appPath) {\n    const path = this.router.resolve(appPath).href;\n    return window.location.origin + path;\n  }\n\n  async close() {\n    await this.manager.removeUser();\n    await this.manager.clearStaleState();\n  }\n\n  async login() {\n    this.setOriginalUri();\n    await this.manager.signinRedirect();\n    return null;\n  }\n\n  async confirmLogin() {\n    const user = await this.manager.signinRedirectCallback();\n    await this.setUser(user);\n    this.restoreOriginalUri();\n  }\n\n  async logout() {\n    await this.manager.signoutRedirect();\n  }\n\n  async confirmLogout() {\n    await this.manager.signoutRedirectCallback();\n    await this.setUser(null);\n  }\n\n  async setUser(user = null) {\n    this.user = user;\n    if (user) {\n      await this.changeListener(true, user.access_token);\n    }\n    else {\n      await this.changeListener(false);\n    }\n  }\n\n  updateStore(value) {\n    return this._updateStore(value, 'Authorization', 'header', 'Bearer');\n  }\n\n}\n"],"names":["InvalidTokenError","Error","b64DecodeUnicode","str","decodeURIComponent","atob","replace","m","p","code","charCodeAt","toString","toUpperCase","length","base64UrlDecode","output","err","jwtDecode","token","options","pos","header","part","split","decoded","e","message","JSON","parse","prototype","name","level","logger","nopLogger","debug","info","warn","error","Log","Log2","reset","setLevel","value","setLogger","Logger","_Logger","constructor","_name","this","args","_format","_method","create","method","methodLogger","Object","createStatic","staticMethod","staticLogger","prefix","JwtUtils","decode","generateSignedJwt","payload","privateKey","encodedHeader","CryptoUtils","encodeBase64Url","TextEncoder","encode","stringify","encodedPayload","encodedToken","signature","window","crypto","subtle","sign","hash","encodedSignature","Uint8Array","generateSignedJwtWithHmac","secretKey","UUID_V4_TEMPLATE","toBase64","val","btoa","map","chr","String","fromCharCode","join","_CryptoUtils","_randomWord","arr","Uint32Array","getRandomValues","generateUUIDv4","uuid","c","generateCodeVerifier","generateCodeChallenge","code_verifier","encoder","data","hashed","digest","generateBasicAuth","client_id","client_secret","alg","msgUint8","hashBuffer","customCalculateJwkThumbprint","jwk","jsonObject","kty","n","crv","x","y","k","utf8encodedAndHashed","generateDPoPProof","url","accessToken","httpMethod","keyPair","nonce","hashedToken","encodedHash","randomUUID","Math","floor","Date","now","ath","publicJwk","exportKey","publicKey","TypeError","generateDPoPJkt","generateDPoPKeys","generateKey","namedCurve","generateClientAssertionJwt","audience","algorithm","hashMap","hashFunction","importKey","input","Event","_callbacks","_logger","addHandler","cb","push","removeHandler","idx","lastIndexOf","splice","raise","ev","PopupUtils","center","features","_a","width","find","outerWidth","left","max","round","screenX","height","top","screenY","outerHeight","serialize","entries","filter","key","Timer","_Timer","super","arguments","_timerHandle","_expiration","_callback","diff","getEpochTime","cancel","init","durationInSeconds","logger2","expiration","timerDurationInSeconds","min","setInterval","clearInterval","UrlUtils","readParams","responseMode","parsedUrl","URL","params","URLSearchParams","slice","URL_STATE_DELIMITER","ErrorResponse","form","_b","_c","error_description","error_uri","state","userState","session_state","url_state","ErrorTimeout","AccessTokenEvents","_expiringTimer","_expiredTimer","_expiringNotificationTimeInSeconds","expiringNotificationTimeInSeconds","load","container","access_token","expires_in","duration","expiring","expired","unload","addAccessTokenExpiring","removeAccessTokenExpiring","addAccessTokenExpired","removeAccessTokenExpired","CheckSessionIFrame","_client_id","_intervalInSeconds","_stopOnError","_timer","_session_state","_message","origin","_frame_origin","source","_frame","contentWindow","stop","document","createElement","style","visibility","position","src","href","Promise","resolve","onload","body","appendChild","addEventListener","start","send","postMessage","InMemoryWebStorage","_data","clear","getItem","setItem","removeItem","getOwnPropertyNames","index","ErrorDPoPNonce","JsonService","additionalContentTypes","_jwtHandler","_extraHeaders","_contentTypes","fetchWithTimeout","timeoutInSeconds","initFetch","fetch","controller","AbortController","timeoutId","setTimeout","abort","response","signal","DOMException","clearTimeout","getJson","credentials","headers","_appendExtraHeaders","status","contentType","get","item","startsWith","throw","ok","text","json","statusText","postForm","basicAuth","initCredentials","extraHeaders","responseText","has","customKeys","keys","protectedHeaders","preventOverride","forEach","headerName","includes","toLocaleLowerCase","content","MetadataService","_settings","_signingKeys","_metadata","_metadataUrl","metadataUrl","_jsonService","signingKeys","metadata","fetchRequestCredentials","_fetchRequestCredentials","resetSigningKeys","getMetadata","requestTimeoutInSeconds","assign","metadataSeed","getIssuer","_getMetadataProperty","getAuthorizationEndpoint","getUserInfoEndpoint","getTokenEndpoint","optional","getCheckSessionIframe","getEndSessionEndpoint","getRevocationEndpoint","getKeysEndpoint","getSigningKeys","jwks_uri","keySet","Array","isArray","WebStorageStateStore","store","localStorage","_store","_prefix","set","remove","getAllKeys","len","indexOf","substr","DefaultResponseType","DefaultScope","DefaultClientAuthentication","DefaultStaleStateAgeInSeconds","OidcClientSettingsStore","authority","response_type","scope","redirect_uri","post_logout_redirect_uri","client_authentication","token_endpoint_auth_signing_alg","prompt","display","max_age","ui_locales","acr_values","resource","response_mode","filterProtocolClaims","loadUserInfo","staleStateAgeInSeconds","mergeClaimsStrategy","array","disablePKCE","stateStore","revokeTokenAdditionalContentTypes","refreshTokenAllowedScope","extraQueryParams","extraTokenParams","dpop","omitScopeWhenRequesting","endsWith","UserInfoService","_metadataService","_getClaimsFromJwt","async","getClaims","claims","TokenClient","exchangeCode","grant_type","append","clientAssertion","exchangeCredentials","exchangeRefreshToken","refresh_token","param","revoke","token_type_hint","ResponseValidator","_claimsService","_userInfoService","_tokenClient","validateSigninResponse","_processSigninState","_processCode","isOpenId","_validateIdTokenAttributes","_processClaims","skipUserInfo","validateCredentialsResponse","shouldValidateSubClaim","id_token","validateRefreshResponse","profile","hasIdToken","validateSignoutResponse","id","validateSub","sub","mergeClaims","tokenResponse","existingToken","incoming","existing","auth_time","azp","State","_State","created","request_type","toStorageString","fromStorageString","storageString","clearStaleState","storage","age","cutoff","i","SigninState","_SigninState","code_challenge","_SigninRequest","state_data","dpopJkt","optionalParams","searchParams","stateParam","resources","r","SigninRequest","OidcScope","SigninResponse","token_type","splitState","expires_at","Number","SignoutRequest","id_token_hint","SignoutResponse","DefaultProtocolClaims","InternalRequiredProtocolClaims","ClaimsService","result","protocolClaims","claim","claims1","claims2","values","mergedValues","DPoPState","OidcClient","settings","metadataService","_validator","createSigninRequest","request","request_uri","login_hint","signinRequest","signinState","readSigninResponseState","removeState","storedStateString","processSigninResponse","dpopProof","getDpopProof","dpopStore","dpopState","processResourceOwnerPasswordCredentials","username","password","signinResponse","useRefreshToken","allowableScopes","providedScopes","s","createSignoutRequest","signoutState","readSignoutResponseState","processSignoutResponse","revokeToken","type","SessionMonitor","_userManager","_start","user","_sub","_checkSessionIFrame","intervalInSeconds","checkSessionIntervalInSeconds","stopOnError","stopCheckSessionOnError","checkSessionIFrame","_stop","monitorAnonymousSession","timerHandle","session","querySessionStatus","tmpUser","raiseEvent","events","_raiseUserSessionChanged","_raiseUserSignedOut","_raiseUserSignedIn","addUserLoaded","addUserUnloaded","_init","catch","getUser","User","_User","scopes","messageSource","AbstractChildWindow","_abort","_disposeHandlers","Set","_window","navigate","location","keepOpen","reject","listener","scriptOrigin","_dispose","add","removeEventListener","channel","BroadcastChannel","close","reason","dispose","_notifyParent","parent","targetOrigin","msgData","DefaultPopupWindowFeatures","toolbar","closePopupWindowAfterInSeconds","DefaultPopupTarget","DefaultAccessTokenExpiringNotificationTimeInSeconds","DefaultCheckSessionIntervalInSeconds","DefaultSilentRequestTimeoutInSeconds","UserManagerSettingsStore","popup_redirect_uri","popup_post_logout_redirect_uri","popupWindowFeatures","popupWindowTarget","redirectMethod","redirectTarget","iframeNotifyParentOrigin","iframeScriptOrigin","silent_redirect_uri","silentRequestTimeoutInSeconds","automaticSilentRenew","validateSubOnSilentRenew","includeIdTokenInSilentRenew","monitorSession","query_status_response_type","revokeTokenTypes","revokeTokensOnSignout","includeIdTokenInSilentSignout","accessTokenExpiringNotificationTimeInSeconds","userStore","sessionStorage","IFrameWindow","_IFrameWindow","_timeoutInSeconds","createHiddenIframe","iframe","timer","parentNode","_a2","frame","target","removeChild","notifyParent","IFrameNavigator","prepare","callback","checkForPopupClosedInterval","second","PopupWindow","popupSignal","popupAbortOnClose","centeredPopup","open","abortOnClose","Boolean","closed","focus","popupClosedInterval","clearPopupClosedInterval","delete","notifyOpener","opener","PopupNavigator","RedirectNavigator","targetWindow","self","redirect","bind","promise","UserManagerEvents","_userLoaded","_userUnloaded","_silentRenewError","_userSignedIn","_userSignedOut","_userSessionChanged","removeUserLoaded","removeUserUnloaded","addSilentRenewError","removeSilentRenewError","_raiseSilentRenewError","addUserSignedIn","removeUserSignedIn","addUserSignedOut","removeUserSignedOut","addUserSessionChanged","removeUserSessionChanged","SilentRenewService","_isStarted","_retryTimer","_tokenExpiring","signinSilent","RefreshState","UserManager","redirectNavigator","popupNavigator","iframeNavigator","_client","_redirectNavigator","_popupNavigator","_iframeNavigator","_events","_silentRenewService","startSilentRenew","_sessionMonitor","_loadUser","removeUser","storeUser","signinRedirect","requestArgs","bind_authorization_code","handle","_signinStart","signinRedirectCallback","_signinEnd","signinResourceOwnerCredentials","_buildUser","signinPopup","_signin","signinPopupCallback","forceIframeAuth","_useRefreshToken","verifySub","signinSilentCallback","signinCallback","signoutCallback","signoutRedirectCallback","signoutPopupCallback","signoutSilentCallback","navResponse","signoutRedirect","_signoutStart","_signoutEnd","signoutPopup","_signout","_revokeInternal","signoutRequest","signoutResponse","signoutSilent","revokeTokens","types","typesPresent","stopSilentRenew","_userStoreKey","dpopSettings","dpopKeys","OIDC","Auth","changeListener","router","oidcConfig","openIdConnectUrl","getRedirectUri","manager","setUser","browserStorage","BrowserStorage","setOriginalUri","_this$router","_this$router$currentR","currentRoute","fullPath","restoreOriginalUri","originalUri","Utils","hasText","appPath","path","login","confirmLogin","logout","confirmLogout","updateStore","_updateStore"],"ignoreList":[],"sourceRoot":""}