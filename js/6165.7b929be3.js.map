{"version":3,"file":"js/6165.7b929be3.js","mappings":"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","sources":["webpack://@radiantearth/stac-browser/./node_modules/ol/DataTile.js","webpack://@radiantearth/stac-browser/./node_modules/ol/Tile.js","webpack://@radiantearth/stac-browser/./node_modules/ol/source/SentinelHub.js","webpack://@radiantearth/stac-browser/./node_modules/ol/source/Tile.js","webpack://@radiantearth/stac-browser/./node_modules/ol/tilegrid.js","webpack://@radiantearth/stac-browser/./node_modules/ol/vec/mat4.js"],"sourcesContent":["/**\n * @module ol/DataTile\n */\nimport Tile from './Tile.js';\nimport TileState from './TileState.js';\nimport {createCanvasContext2D} from './dom.js';\n\n/**\n * @typedef {HTMLImageElement|HTMLCanvasElement|HTMLVideoElement|ImageBitmap} ImageLike\n */\n\n/**\n * @typedef {Uint8Array|Uint8ClampedArray|Float32Array|DataView} ArrayLike\n */\n\n/**\n * Data that can be used with a DataTile.\n * @typedef {ArrayLike|ImageLike} Data\n */\n\n/**\n * @param {Data} data Tile data.\n * @return {ImageLike|null} The image-like data.\n */\nexport function asImageLike(data) {\n  return data instanceof Image ||\n    data instanceof HTMLCanvasElement ||\n    data instanceof HTMLVideoElement ||\n    data instanceof ImageBitmap\n    ? data\n    : null;\n}\n\n/**\n * @param {Data} data Tile data.\n * @return {ArrayLike|null} The array-like data.\n */\nexport function asArrayLike(data) {\n  return data instanceof Uint8Array ||\n    data instanceof Uint8ClampedArray ||\n    data instanceof Float32Array ||\n    data instanceof DataView\n    ? data\n    : null;\n}\n\n/**\n * This is set as the cancellation reason when a tile is disposed.\n */\nexport const disposedError = new Error('disposed');\n\n/**\n * @type {CanvasRenderingContext2D|null}\n */\nlet sharedContext = null;\n\n/**\n * @param {ImageLike} image The image.\n * @return {Uint8ClampedArray} The data.\n */\nexport function toArray(image) {\n  if (!sharedContext) {\n    sharedContext = createCanvasContext2D(\n      image.width,\n      image.height,\n      undefined,\n      {willReadFrequently: true},\n    );\n  }\n  const canvas = sharedContext.canvas;\n  const width = image.width;\n  if (canvas.width !== width) {\n    canvas.width = width;\n  }\n  const height = image.height;\n  if (canvas.height !== height) {\n    canvas.height = height;\n  }\n  sharedContext.clearRect(0, 0, width, height);\n  sharedContext.drawImage(image, 0, 0);\n  return sharedContext.getImageData(0, 0, width, height).data;\n}\n\n/**\n * @type {import('./size.js').Size}\n */\nconst defaultSize = [256, 256];\n\n/**\n * @typedef {Object} Options\n * @property {import(\"./tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n * @property {function(): Promise<Data>} loader Data loader.  For loaders that generate images,\n * the promise should not resolve until the image is loaded.\n * @property {number} [transition=250] A duration for tile opacity\n * transitions in milliseconds. A duration of 0 disables the opacity transition.\n * @property {boolean} [interpolate=false] Use interpolated values when resampling.  By default,\n * the nearest neighbor is used when resampling.\n * @property {import('./size.js').Size} [size=[256, 256]] Tile size.\n * @property {AbortController} [controller] An abort controller.\n * @api\n */\n\nclass DataTile extends Tile {\n  /**\n   * @param {Options} options Tile options.\n   */\n  constructor(options) {\n    const state = TileState.IDLE;\n\n    super(options.tileCoord, state, {\n      transition: options.transition,\n      interpolate: options.interpolate,\n    });\n\n    /**\n     * @type {function(): Promise<Data>}\n     * @private\n     */\n    this.loader_ = options.loader;\n\n    /**\n     * @type {Data}\n     * @private\n     */\n    this.data_ = null;\n\n    /**\n     * @type {Error}\n     * @private\n     */\n    this.error_ = null;\n\n    /**\n     * @type {import('./size.js').Size|null}\n     * @private\n     */\n    this.size_ = options.size || null;\n\n    /**\n     * @type {AbortController|null}\n     * @private\n     */\n    this.controller_ = options.controller || null;\n  }\n\n  /**\n   * Get the tile size.\n   * @return {import('./size.js').Size} Tile size.\n   */\n  getSize() {\n    if (this.size_) {\n      return this.size_;\n    }\n    const imageData = asImageLike(this.data_);\n    if (imageData) {\n      return [imageData.width, imageData.height];\n    }\n    return defaultSize;\n  }\n\n  /**\n   * Get the data for the tile.\n   * @return {Data} Tile data.\n   * @api\n   */\n  getData() {\n    return this.data_;\n  }\n\n  /**\n   * Get any loading error.\n   * @return {Error} Loading error.\n   * @api\n   */\n  getError() {\n    return this.error_;\n  }\n\n  /**\n   * Load the tile data.\n   * @api\n   * @override\n   */\n  load() {\n    if (this.state !== TileState.IDLE && this.state !== TileState.ERROR) {\n      return;\n    }\n    this.state = TileState.LOADING;\n    this.changed();\n\n    const self = this;\n    this.loader_()\n      .then(function (data) {\n        self.data_ = data;\n        self.state = TileState.LOADED;\n        self.changed();\n      })\n      .catch(function (error) {\n        self.error_ = error;\n        self.state = TileState.ERROR;\n        self.changed();\n      });\n  }\n\n  /**\n   * Clean up.\n   * @override\n   */\n  disposeInternal() {\n    if (this.controller_) {\n      this.controller_.abort(disposedError);\n      this.controller_ = null;\n    }\n    super.disposeInternal();\n  }\n}\n\nexport default DataTile;\n","/**\n * @module ol/Tile\n */\nimport TileState from './TileState.js';\nimport {easeIn} from './easing.js';\nimport EventType from './events/EventType.js';\nimport EventTarget from './events/Target.js';\nimport {abstract} from './util.js';\n\n/**\n * A function that takes a {@link module:ol/Tile~Tile} for the tile and a\n * `{string}` for the url as arguments. The default is\n * ```js\n * source.setTileLoadFunction(function(tile, src) {\n *   tile.getImage().src = src;\n * });\n * ```\n * For more fine grained control, the load function can use fetch or XMLHttpRequest and involve\n * error handling:\n *\n * ```js\n * import TileState from 'ol/TileState.js';\n *\n * source.setTileLoadFunction(function(tile, src) {\n *   const xhr = new XMLHttpRequest();\n *   xhr.responseType = 'blob';\n *   xhr.addEventListener('loadend', function (evt) {\n *     const data = this.response;\n *     if (data !== undefined) {\n *       tile.getImage().src = URL.createObjectURL(data);\n *     } else {\n *       tile.setState(TileState.ERROR);\n *     }\n *   });\n *   xhr.addEventListener('error', function () {\n *     tile.setState(TileState.ERROR);\n *   });\n *   xhr.open('GET', src);\n *   xhr.send();\n * });\n * ```\n *\n * @typedef {function(Tile, string): void} LoadFunction\n * @api\n */\n\n/**\n * {@link module:ol/source/Tile~TileSource} sources use a function of this type to get\n * the url that provides a tile for a given tile coordinate.\n *\n * This function takes a {@link module:ol/tilecoord~TileCoord} for the tile\n * coordinate, a `{number}` representing the pixel ratio and a\n * {@link module:ol/proj/Projection~Projection} for the projection  as arguments\n * and returns a `{string}` representing the tile URL, or undefined if no tile\n * should be requested for the passed tile coordinate.\n *\n * @typedef {function(import(\"./tilecoord.js\").TileCoord, number,\n *           import(\"./proj/Projection.js\").default): (string|undefined)} UrlFunction\n * @api\n */\n\n/**\n * @typedef {Object} Options\n * @property {number} [transition=250] A duration for tile opacity\n * transitions in milliseconds. A duration of 0 disables the opacity transition.\n * @property {boolean} [interpolate=false] Use interpolated values when resampling.  By default,\n * the nearest neighbor is used when resampling.\n * @api\n */\n\n/**\n * @classdesc\n * Base class for tiles.\n *\n * @abstract\n */\nclass Tile extends EventTarget {\n  /**\n   * @param {import(\"./tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n   * @param {import(\"./TileState.js\").default} state State.\n   * @param {Options} [options] Tile options.\n   */\n  constructor(tileCoord, state, options) {\n    super();\n\n    options = options ? options : {};\n\n    /**\n     * @type {import(\"./tilecoord.js\").TileCoord}\n     */\n    this.tileCoord = tileCoord;\n\n    /**\n     * @protected\n     * @type {import(\"./TileState.js\").default}\n     */\n    this.state = state;\n\n    /**\n     * A key assigned to the tile. This is used in conjunction with a source key\n     * to determine if a cached version of this tile may be used by the renderer.\n     * @type {string}\n     */\n    this.key = '';\n\n    /**\n     * The duration for the opacity transition.\n     * @private\n     * @type {number}\n     */\n    this.transition_ =\n      options.transition === undefined ? 250 : options.transition;\n\n    /**\n     * Lookup of start times for rendering transitions.  If the start time is\n     * equal to -1, the transition is complete.\n     * @private\n     * @type {Object<string, number>}\n     */\n    this.transitionStarts_ = {};\n\n    /**\n     * @type {boolean}\n     */\n    this.interpolate = !!options.interpolate;\n  }\n\n  /**\n   * @protected\n   */\n  changed() {\n    this.dispatchEvent(EventType.CHANGE);\n  }\n\n  /**\n   * Called by the tile cache when the tile is removed from the cache due to expiry\n   */\n  release() {\n    // to remove the `change` listener on this tile in `ol/TileQueue#handleTileChange`\n    this.setState(TileState.EMPTY);\n  }\n\n  /**\n   * @return {string} Key.\n   */\n  getKey() {\n    return this.key + '/' + this.tileCoord;\n  }\n\n  /**\n   * Get the tile coordinate for this tile.\n   * @return {import(\"./tilecoord.js\").TileCoord} The tile coordinate.\n   * @api\n   */\n  getTileCoord() {\n    return this.tileCoord;\n  }\n\n  /**\n   * @return {import(\"./TileState.js\").default} State.\n   */\n  getState() {\n    return this.state;\n  }\n\n  /**\n   * Sets the state of this tile. If you write your own {@link module:ol/Tile~LoadFunction tileLoadFunction} ,\n   * it is important to set the state correctly to {@link module:ol/TileState~ERROR}\n   * when the tile cannot be loaded. Otherwise the tile cannot be removed from\n   * the tile queue and will block other requests.\n   * @param {import(\"./TileState.js\").default} state State.\n   * @api\n   */\n  setState(state) {\n    if (this.state === TileState.EMPTY) {\n      // no more state changes\n      return;\n    }\n    if (this.state !== TileState.ERROR && this.state > state) {\n      throw new Error('Tile load sequence violation');\n    }\n    this.state = state;\n    this.changed();\n  }\n\n  /**\n   * Load the image or retry if loading previously failed.\n   * Loading is taken care of by the tile queue, and calling this method is\n   * only needed for preloading or for reloading in case of an error.\n   * @abstract\n   * @api\n   */\n  load() {\n    abstract();\n  }\n\n  /**\n   * Get the alpha value for rendering.\n   * @param {string} id An id for the renderer.\n   * @param {number} time The render frame time.\n   * @return {number} A number between 0 and 1.\n   */\n  getAlpha(id, time) {\n    if (!this.transition_) {\n      return 1;\n    }\n\n    let start = this.transitionStarts_[id];\n    if (!start) {\n      start = time;\n      this.transitionStarts_[id] = start;\n    } else if (start === -1) {\n      return 1;\n    }\n\n    const delta = time - start + 1000 / 60; // avoid rendering at 0\n    if (delta >= this.transition_) {\n      return 1;\n    }\n    return easeIn(delta / this.transition_);\n  }\n\n  /**\n   * Determine if a tile is in an alpha transition.  A tile is considered in\n   * transition if tile.getAlpha() has not yet been called or has been called\n   * and returned 1.\n   * @param {string} id An id for the renderer.\n   * @return {boolean} The tile is in transition.\n   */\n  inTransition(id) {\n    if (!this.transition_) {\n      return false;\n    }\n    return this.transitionStarts_[id] !== -1;\n  }\n\n  /**\n   * Mark a transition as complete.\n   * @param {string} id An id for the renderer.\n   */\n  endTransition(id) {\n    if (this.transition_) {\n      this.transitionStarts_[id] = -1;\n    }\n  }\n\n  /**\n   * @override\n   */\n  disposeInternal() {\n    this.release();\n    super.disposeInternal();\n  }\n}\n\nexport default Tile;\n","/**\n * @module ol/source/SentinelHub\n */\n\nimport {\n  equivalent as equivalentProjections,\n  get as getProjection,\n} from '../proj.js';\nimport DataTileSource from './DataTile.js';\n\nconst defaultProcessUrl = 'https://services.sentinel-hub.com/api/v1/process';\n\nconst defaultTokenUrl =\n  'https://services.sentinel-hub.com/auth/realms/main/protocol/openid-connect/token';\n\nconst defaultEvalscriptVersion = '3';\n\n/**\n * @type {import('../size.js').Size}\n */\nconst defaultTileSize = [512, 512];\n\nconst maxRetries = 10;\nconst baseDelay = 500;\n\n/**\n * @typedef {Object} AuthConfig\n * @property {string} [tokenUrl='https://services.sentinel-hub.com/auth/realms/main/protocol/openid-connect/token'] The URL to get the authentication token.\n * @property {string} clientId The client ID.\n * @property {string} clientSecret The client secret.\n */\n\n/**\n * @typedef {Object} AccessTokenClaims\n * @property {number} exp The expiration time of the token (in seconds).\n */\n\n/**\n * @typedef {Object} Evalscript\n * @property {Setup} setup The setup function.\n * @property {EvaluatePixel} evaluatePixel The function to transform input samples into output values.\n * @property {UpdateOutput} [updateOutput] Optional function to adjust the output bands.\n * @property {UpdateOutputMetadata} [updateOutputMetadata] Optional function to update the output metadata.\n * @property {Collections} [preProcessScenes] Optional function called before processing.\n * @property {string} [version='3'] The Evalscript version.\n */\n\n/**\n * @typedef {function(): SetupResult} Setup\n */\n\n/**\n * @typedef {function(Sample|Array<Sample>, Scenes, InputMetadata, CustomData, OutputMetadata): OutputValues|Array<number>|void} EvaluatePixel\n */\n\n/**\n * @typedef {function(Object<string, UpdatedOutputDescription>): void} UpdateOutput\n */\n\n/**\n * @typedef {function(Scenes, InputMetadata, OutputMetadata): void} UpdateOutputMetadata\n */\n\n/**\n * @typedef {Object} SetupResult\n * @property {Array<string>|Array<InputDescription>} input Description of the input data.\n * @property {OutputDescription|Array<OutputDescription>} output Description of the output data.\n * @property {'SIMPLE'|'ORBIT'|'TILE'} [mosaicking='SIMPLE'] Control how samples from input scenes are composed.\n */\n\n/**\n * @typedef {Object} InputDescription\n * @property {Array<string>} bands Input band identifiers.\n * @property {string|Array<string>} [units] Input band units.\n * @property {Array<string>} [metadata] Properties to include in the input metadata.\n */\n\n/**\n * @typedef {Object} OutputDescription\n * @property {string} [id='default'] Output identifier.\n * @property {number} bands Number of output bands.\n * @property {SampleType} [sampleType='AUTO'] Output sample type.\n * @property {number} [nodataValue] Output nodata value.\n */\n\n/**\n * @typedef {Object} UpdatedOutputDescription\n * @property {number} bands Number of output bands.\n */\n\n/**\n * @typedef {'INT8'|'UINT8'|'INT16'|'UINT16'|'FLOAT32'|'AUTO'} SampleType\n */\n\n/**\n * @typedef {Object<string, number>} Sample\n */\n\n/**\n * @typedef {Object} Collections\n * @property {string} [from] For 'ORBIT' mosaicking, this will be the start of the search interval.\n * @property {string} [to] For 'ORBIT' mosaicking, this will be the end of the search interval.\n * @property {Scenes} scenes The scenes in the collection.\n */\n\n/**\n * @typedef {Object} Scenes\n * @property {Array<Orbit>} [orbit] Information about scenes included in the tile when 'mosaicking' is 'ORBIT'.\n * @property {Array<Tile>} [tiles] Information about scenes included in the tile when 'mosaicking' is 'TILE'.\n */\n\n/**\n * @typedef {Object} Orbit\n * @property {string} dateFrom The earliest date for all scenes included in the tile.\n * @property {string} dateTo The latest date for scenes included in the tile.\n * @property {Array} tiles Metadata for each tile.\n */\n\n/**\n * @typedef {Object} Tile\n * @property {string} date The date of scene used in the tile.\n * @property {number} cloudCoverage The estimated percentage of pixels obscured by clouds in the scene.\n * @property {string} dataPath The path to the data in storage.\n * @property {number} shId The internal identifier for the scene.\n */\n\n/**\n * @typedef {Object} InputMetadata\n * @property {string} serviceVersion The version of the service used for processing.\n * @property {number} normalizationFactor The factor used to convert digital number (DN) values to reflectance.\n */\n\n/**\n * @typedef {Object<string, unknown>} CustomData\n */\n\n/**\n * @typedef {Object} OutputMetadata\n * @property {Object} userData Arbitrary user data.\n */\n\n/**\n * @typedef {Object<string, Array<number>>} OutputValues\n */\n\n/**\n * @typedef {Object} ProcessRequest\n * @property {ProcessRequestInput} input Input data configuration.\n * @property {string} evalscript The Evalscript used for processing.\n * @property {ProcessRequestOutput} [output] The output configuration.\n */\n\n/**\n * @typedef {Object} ProcessRequestInput\n * @property {ProcessRequestInputBounds} bounds The bounding box of the input data.\n * @property {Array<ProcessRequestInputDataItem>} data The intput data.\n */\n\n/**\n * @typedef {Object} ProcessRequestInputDataItem\n * @property {string} [type] The type of the input data.\n * @property {string} [id] The identifier of the input data.\n * @property {DataFilter} [dataFilter] The filter to apply to the input data.\n * @property {Object<string, unknown>} [processing] The processing to apply to the input data.\n */\n\n/**\n * @typedef {Object} DataFilter\n * @property {TimeRange} [timeRange] The data time range.\n * @property {number} [maxCloudCoverage] The maximum cloud coverage (0-100).\n */\n\n/**\n * @typedef {Object} TimeRange\n * @property {string} [from] The start time (inclusive).\n * @property {string} [to] The end time (inclusive).\n */\n\n/**\n * @typedef {Object} ProcessRequestInputBounds\n * @property {Array<number>} [bbox] The bounding box of the input data.\n * @property {ProcessRequestInputBoundsProperties} [properties] The properties of the bounding box.\n * @property {import(\"geojson\").Geometry} [geometry] The geometry of the bounding box.\n */\n\n/**\n * @typedef {Object} ProcessRequestInputBoundsProperties\n * @property {string} crs The coordinate reference system of the bounding box.\n */\n\n/**\n * @typedef {Object} ProcessRequestOutput\n * @property {number} [width] Image width in pixels.\n * @property {number} [height] Image height in pixels.\n * @property {number} [resx] Spatial resolution in the x direction.\n * @property {number} [resy] Spatial resolution in the y direction.\n * @property {Array<ProcessRequestOutputResponse>} [responses] Response configuration.\n */\n\n/**\n * @typedef {Object} ProcessRequestOutputResponse\n * @property {string} [identifier] Identifier used to connect results to outputs from the setup.\n * @property {ProcessRequestOutputFormat} [format] Response format.\n */\n\n/**\n * @typedef {Object} ProcessRequestOutputFormat\n * @property {string} [type] The output format type.\n */\n\n/**\n * @param {Evalscript} evalscript The object to serialize.\n * @return {string} The serialized Evalscript.\n */\nfunction serializeEvalscript(evalscript) {\n  const version = evalscript.version || defaultEvalscriptVersion;\n  return `//VERSION=${version}\n    ${serializeFunction('setup', evalscript.setup)}\n    ${serializeFunction('evaluatePixel', evalscript.evaluatePixel)}\n    ${serializeFunction('updateOutput', evalscript.updateOutput)}\n  `;\n}\n\n/**\n * Get a loaded image given a response.\n *\n * @param {Response} response The response.\n * @return {Promise<HTMLImageElement>} The image.\n */\nasync function imageFromResponse(response) {\n  const blob = await response.blob();\n\n  return new Promise((resolve, reject) => {\n    const image = new Image();\n    const blobUrl = URL.createObjectURL(blob);\n    image.onload = () => {\n      URL.revokeObjectURL(blobUrl);\n      resolve(image);\n    };\n    image.onerror = () => {\n      URL.revokeObjectURL(blobUrl);\n      reject(new Error('Failed to load image'));\n    };\n    image.src = blobUrl;\n  });\n}\n\n/**\n * @param {number} ms Milliseconds.\n * @return {Promise<void>} A promise that resolves after the given time.\n */\nfunction delay(ms) {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\n/**\n * @param {AuthConfig} auth The authentication configuration.\n * @return {Promise<string>} The authentication token.\n */\nasync function getToken(auth) {\n  const url = auth.tokenUrl || defaultTokenUrl;\n  const body = new URLSearchParams();\n  body.append('grant_type', 'client_credentials');\n  body.append('client_id', auth.clientId);\n  body.append('client_secret', auth.clientSecret);\n\n  /**\n   * @type {RequestInit}\n   */\n  const options = {\n    method: 'POST',\n    headers: {'Content-Type': 'application/x-www-form-urlencoded'},\n    body,\n  };\n  const response = await fetch(url, options);\n  if (!response.ok) {\n    if (response.status === 401) {\n      throw new Error('Bad client id or secret');\n    }\n    throw new Error('Failed to get token');\n  }\n  const data = await response.json();\n  return data.access_token;\n}\n\n/**\n * @param {string} token The access token to parse.\n * @return {AccessTokenClaims} The parsed token claims.\n */\nexport function parseTokenClaims(token) {\n  const base64EncodedClaims = token\n    .split('.')[1]\n    .replace(/-/g, '+')\n    .replace(/_/g, '/');\n\n  const chars = atob(base64EncodedClaims).split('');\n  const count = chars.length;\n  const uriEncodedChars = new Array(count);\n  for (let i = 0; i < count; ++i) {\n    const c = chars[i];\n    uriEncodedChars[i] = '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\n  }\n\n  return JSON.parse(decodeURIComponent(uriEncodedChars.join('')));\n}\n\n/**\n * Gets a CRS identifier accepted by Sentinel Hub.\n * See https://docs.sentinel-hub.com/api/latest/api/process/crs/.\n *\n * @param {import(\"../proj/Projection.js\").default} projection The projection.\n * @return {string} The projection identifier accepted by Sentinel Hub.\n */\nexport function getProjectionIdentifier(projection) {\n  const ogcId = 'http://www.opengis.net/def/crs/';\n  const code = projection.getCode();\n  if (code.startsWith(ogcId)) {\n    return code;\n  }\n  if (code.startsWith('EPSG:')) {\n    return `${ogcId}EPSG/0/${code.slice(5)}`;\n  }\n  if (equivalentProjections(projection, getProjection('EPSG:4326'))) {\n    return `${ogcId}EPSG/0/4326`;\n  }\n\n  // hope for the best\n  return code;\n}\n\n/**\n * This is intended to work with named functions, anonymous functions, arrow functions, and object methods.\n * Due to how the Evalscript is executed, these are serialized as function expressions using `var`.\n *\n * @param {string} name The name of the function.\n * @param {Function|undefined} func The function to serialize.\n * @return {string} The serialized function.\n */\nexport function serializeFunction(name, func) {\n  if (!func) {\n    return '';\n  }\n  let expression = func.toString();\n  if (\n    func.name &&\n    func.name !== 'function' &&\n    expression.match(new RegExp('^' + func.name.replace('$', '\\\\$') + '\\\\b'))\n  ) {\n    // assume function came from an object property using method syntax\n    expression = 'function ' + expression;\n  }\n  return `var ${name} = ${expression};`;\n}\n\n/**\n * @typedef {Object} Options\n * @property {AuthConfig|string} [auth] The authentication configuration with `clientId` and `clientSecret` or an access token.\n * See [Sentinel Hub authentication](https://docs.sentinel-hub.com/api/latest/api/overview/authentication/)\n * for details.  If not provided in the constructor, the source will not be rendered until {@link module:ol/source/SentinelHub~SentinelHub#setAuth}\n * is called.\n * @property {Array<ProcessRequestInputDataItem>} [data] The input data configuration.  If not provided in the constructor,\n * the source will not be rendered until {@link module:ol/source/SentinelHub~SentinelHub#setData} is called.\n * @property {Evalscript|string} [evalscript] The process applied to the input data.  If not provided in the constructor,\n * the source will not be rendered until {@link module:ol/source/SentinelHub~SentinelHub#setEvalscript} is called.  See the\n * `setEvalscript` documentation for details on the restrictions when passing process functions.\n * @property {number|import(\"../size.js\").Size} [tileSize=[512, 512]] The pixel width and height of the source tiles.\n * @property {string} [url='https://services.sentinel-hub.com/api/v1/process'] The Sentinel Hub Processing API URL.\n * @property {import(\"../proj.js\").ProjectionLike} [projection] Projection. Default is the view projection.\n * @property {boolean} [attributionsCollapsible=true] Allow the attributions to be collapsed.\n * @property {boolean} [interpolate=true] Use interpolated values when resampling.  By default,\n * linear interpolation is used when resampling.  Set to false to use the nearest neighbor instead.\n * @property {boolean} [wrapX=true] Wrap the world horizontally.\n * @property {number} [transition] Duration of the opacity transition for rendering.\n * To disable the opacity transition, pass `transition: 0`.\n */\n\n/**\n * @classdesc\n * A tile source that generates tiles using the Sentinel Hub [Processing API](https://docs.sentinel-hub.com/api/latest/api/process/).\n * All of the constructor options are optional, however the source will not be ready for rendering until the `auth`, `data`,\n * and `evalscript` properties are provided.  These can be set after construction with the {@link module:ol/source/SentinelHub~SentinelHub#setAuth},\n * {@link module:ol/source/SentinelHub~SentinelHub#setData}, and {@link module:ol/source/SentinelHub~SentinelHub#setEvalscript}\n * methods.\n *\n * If there are errors while configuring the source or fetching an access token, the `change` event will be fired and the\n * source state will be set to `error`.  See the {@link module:ol/source/SentinelHub~SentinelHub#getError} method for\n * details on handling these errors.\n * @api\n */\nclass SentinelHub extends DataTileSource {\n  /**\n   * @param {Options} [options] Sentinel Hub options.\n   */\n  constructor(options) {\n    /**\n     * @type {Options}\n     */\n    const config = options || {};\n\n    super({\n      state: 'loading',\n      projection: config.projection,\n      attributionsCollapsible: config.attributionsCollapsible,\n      interpolate: config.interpolate,\n      tileSize: config.tileSize || defaultTileSize,\n      wrapX: config.wrapX !== undefined ? config.wrapX : true,\n      transition: config.transition,\n    });\n\n    this.setLoader((x, y, z) => this.loadTile_(x, y, z, 1));\n\n    /**\n     * @type {Error|null}\n     */\n    this.error_ = null;\n\n    /**\n     * @type {string}\n     * @private\n     */\n    this.evalscript_ = '';\n\n    /**\n     * @type {Array<ProcessRequestInputDataItem>|null}\n     * @private\n     */\n    this.inputData_ = null;\n\n    /**\n     * @type {string}\n     * @private\n     */\n    this.processUrl_ = config.url || defaultProcessUrl;\n\n    /**\n     * @type {string}\n     * @private\n     */\n    this.token_ = '';\n\n    /**\n     * @type {ReturnType<typeof setTimeout>}\n     * @private\n     */\n    this.tokenRenewalId_;\n\n    if (config.auth) {\n      this.setAuth(config.auth);\n    }\n\n    if (config.data) {\n      this.setData(config.data);\n    }\n\n    if (config.evalscript) {\n      this.setEvalscript(config.evalscript);\n    }\n  }\n\n  /**\n   * Set the authentication configuration for the source (if not provided in the constructor).\n   * If an object with `clientId` and `clientSecret` is provided, an access token will be fetched\n   * and used with processing requests.  Alternatively, an access token can be supplied directly.\n   *\n   * @param {AuthConfig|string} auth The auth config or access token.\n   * @api\n   */\n  async setAuth(auth) {\n    clearTimeout(this.tokenRenewalId_);\n\n    if (typeof auth === 'string') {\n      this.token_ = auth;\n      this.fireWhenReady_();\n      return;\n    }\n\n    /**\n     * @type {string}\n     */\n    let token;\n\n    /**\n     * @type {AccessTokenClaims}\n     */\n    let claims;\n\n    try {\n      token = await getToken(auth);\n      claims = parseTokenClaims(token);\n    } catch (error) {\n      this.error_ = error;\n      this.setState('error');\n      return;\n    }\n    this.token_ = token;\n\n    const expiry = claims.exp * 1000;\n    const timeout = Math.max(expiry - Date.now() - 60 * 1000, 1);\n    this.tokenRenewalId_ = setTimeout(() => this.setAuth(auth), timeout);\n    this.fireWhenReady_();\n  }\n\n  /**\n   * Set or update the input data used.\n   *\n   * @param {Array<ProcessRequestInputDataItem>} data The input data configuration.\n   * @api\n   */\n  setData(data) {\n    this.inputData_ = data;\n    this.fireWhenReady_();\n  }\n\n  /**\n   * Set or update the Evalscript used to process the data.  Either a process object or a string\n   * Evalscript can be provided.  If a process object is provided, it will be serialized to produce the\n   * Evalscript string.  Because these functions will be serialized and executed by the Processing API,\n   * they cannot refer to other variables or functions that are not provided by the Processing API\n   * context.\n   *\n   * @param {Evalscript|string} evalscript The process to apply to the input data.\n   * @api\n   */\n  setEvalscript(evalscript) {\n    let script;\n    if (typeof evalscript === 'string') {\n      script = evalscript;\n    } else {\n      try {\n        script = serializeEvalscript(evalscript);\n      } catch (error) {\n        this.error_ = error;\n        this.setState('error');\n        return;\n      }\n    }\n    this.evalscript_ = script;\n    this.fireWhenReady_();\n  }\n\n  fireWhenReady_() {\n    if (!this.token_ || !this.evalscript_ || !this.inputData_) {\n      return;\n    }\n    const state = this.getState();\n    if (state === 'ready') {\n      this.changed();\n      return;\n    }\n    this.setState('ready');\n  }\n\n  /**\n   * @param {number} z The z tile index.\n   * @param {number} x The x tile index.\n   * @param {number} y The y tile index.\n   * @param {number} attempt The attempt number (starting with 1).  Incremented with retries.\n   * @return {Promise<import('../DataTile.js').Data>} The composed tile data.\n   * @private\n   */\n  async loadTile_(z, x, y, attempt) {\n    const tileGrid = this.getTileGrid();\n    const extent = tileGrid.getTileCoordExtent([z, x, y]);\n    const tileSize = this.getTileSize(z);\n    const projection = this.getProjection();\n\n    /**\n     * @type {ProcessRequest}\n     */\n    const body = {\n      input: {\n        bounds: {\n          bbox: extent,\n          properties: {crs: getProjectionIdentifier(projection)},\n        },\n        data: this.inputData_,\n      },\n      output: {\n        width: tileSize[0],\n        height: tileSize[1],\n      },\n      evalscript: this.evalscript_,\n    };\n\n    /**\n     * @type {RequestInit}\n     */\n    const options = {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `Bearer ${this.token_}`,\n        'Access-Control-Request-Headers': 'Retry-After',\n      },\n      body: JSON.stringify(body),\n      credentials: 'include',\n    };\n\n    const response = await fetch(this.processUrl_, options);\n    if (!response.ok) {\n      if (response.status === 429 && attempt < maxRetries - 1) {\n        // The Retry-After header includes unreasonable wait times, instead use exponential backoff.\n        const retryAfter = baseDelay * 2 ** attempt;\n        await delay(retryAfter);\n        return this.loadTile_(x, y, z, attempt + 1);\n      }\n      throw new Error(`Failed to get tile: ${response.statusText}`);\n    }\n\n    return imageFromResponse(response);\n  }\n\n  /**\n   * When the source state is `error`, use this function to get more information about the error.\n   * To debug a faulty configuration, you may want to use a listener like this:\n   * ```js\n   * source.on('change', () => {\n   *   if (source.getState() === 'error') {\n   *     console.error(source.getError());\n   *   }\n   * });\n   * ```\n   *\n   * @return {Error|null} A source loading error.\n   * @api\n   */\n  getError() {\n    return this.error_;\n  }\n\n  /**\n   * Clean up.\n   * @override\n   */\n  disposeInternal() {\n    clearTimeout(this.tokenRenewalId_);\n    super.disposeInternal();\n  }\n}\n\nexport default SentinelHub;\n","/**\n * @module ol/source/Tile\n */\nimport Event from '../events/Event.js';\nimport {scale as scaleSize, toSize} from '../size.js';\nimport {withinExtentAndZ} from '../tilecoord.js';\nimport {\n  getForProjection as getTileGridForProjection,\n  wrapX,\n} from '../tilegrid.js';\nimport {abstract, getUid} from '../util.js';\nimport Source from './Source.js';\n\n/***\n * @template Return\n * @typedef {import(\"../Observable\").OnSignature<import(\"../Observable\").EventTypes, import(\"../events/Event.js\").default, Return> &\n *   import(\"../Observable\").OnSignature<import(\"../ObjectEventType\").Types, import(\"../Object\").ObjectEvent, Return> &\n *   import(\"../Observable\").OnSignature<import(\"./TileEventType\").TileSourceEventTypes, TileSourceEvent, Return> &\n *   import(\"../Observable\").CombinedOnSignature<import(\"../Observable\").EventTypes|import(\"../ObjectEventType\").Types|\n *     import(\"./TileEventType\").TileSourceEventTypes, Return>} TileSourceOnSignature\n */\n\n/**\n * @typedef {Object} Options\n * @property {import(\"./Source.js\").AttributionLike} [attributions] Attributions.\n * @property {boolean} [attributionsCollapsible=true] Attributions are collapsible.\n * @property {number} [cacheSize] Deprecated.  Use the cacheSize option on the layer instead.\n * @property {number} [tilePixelRatio] TilePixelRatio.\n * @property {import(\"../proj.js\").ProjectionLike} [projection] Projection.\n * @property {import(\"./Source.js\").State} [state] State.\n * @property {import(\"../tilegrid/TileGrid.js\").default} [tileGrid] TileGrid.\n * @property {boolean} [wrapX=false] WrapX.\n * @property {number} [transition] Transition.\n * @property {string} [key] Key.\n * @property {number|import(\"../array.js\").NearestDirectionFunction} [zDirection=0] ZDirection.\n * @property {boolean} [interpolate=false] Use interpolated values when resampling.  By default,\n * the nearest neighbor is used when resampling.\n */\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for sources providing images divided into a tile grid.\n *\n * @template {import(\"../Tile.js\").default} [TileType=import(\"../Tile.js\").default]\n * @abstract\n * @api\n */\nclass TileSource extends Source {\n  /**\n   * @param {Options} options SourceTile source options.\n   */\n  constructor(options) {\n    super({\n      attributions: options.attributions,\n      attributionsCollapsible: options.attributionsCollapsible,\n      projection: options.projection,\n      state: options.state,\n      wrapX: options.wrapX,\n      interpolate: options.interpolate,\n    });\n\n    /***\n     * @type {TileSourceOnSignature<import(\"../events\").EventsKey>}\n     */\n    this.on;\n\n    /***\n     * @type {TileSourceOnSignature<import(\"../events\").EventsKey>}\n     */\n    this.once;\n\n    /***\n     * @type {TileSourceOnSignature<void>}\n     */\n    this.un;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.tilePixelRatio_ =\n      options.tilePixelRatio !== undefined ? options.tilePixelRatio : 1;\n\n    /**\n     * @type {import(\"../tilegrid/TileGrid.js\").default|null}\n     * @protected\n     */\n    this.tileGrid = options.tileGrid !== undefined ? options.tileGrid : null;\n\n    const tileSize = [256, 256];\n    if (this.tileGrid) {\n      toSize(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()), tileSize);\n    }\n\n    /**\n     * @protected\n     * @type {import(\"../size.js\").Size}\n     */\n    this.tmpSize = [0, 0];\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.key_ = options.key || getUid(this);\n\n    /**\n     * @protected\n     * @type {import(\"../Tile.js\").Options}\n     */\n    this.tileOptions = {\n      transition: options.transition,\n      interpolate: options.interpolate,\n    };\n\n    /**\n     * zDirection hint, read by the renderer. Indicates which resolution should be used\n     * by a renderer if the views resolution does not match any resolution of the tile source.\n     * If 0, the nearest resolution will be used. If 1, the nearest lower resolution\n     * will be used. If -1, the nearest higher resolution will be used.\n     * @type {number|import(\"../array.js\").NearestDirectionFunction}\n     */\n    this.zDirection = options.zDirection ? options.zDirection : 0;\n  }\n\n  /**\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @return {number} Gutter.\n   */\n  getGutterForProjection(projection) {\n    return 0;\n  }\n\n  /**\n   * Return the key to be used for all tiles in the source.\n   * @return {string} The key for all tiles.\n   */\n  getKey() {\n    return this.key_;\n  }\n\n  /**\n   * Set the value to be used as the key for all tiles in the source.\n   * @param {string} key The key for tiles.\n   * @protected\n   */\n  setKey(key) {\n    if (this.key_ !== key) {\n      this.key_ = key;\n      this.changed();\n    }\n  }\n\n  /**\n   * @param {import(\"../proj/Projection\").default} [projection] Projection.\n   * @return {Array<number>|null} Resolutions.\n   * @override\n   */\n  getResolutions(projection) {\n    const tileGrid = projection\n      ? this.getTileGridForProjection(projection)\n      : this.tileGrid;\n    if (!tileGrid) {\n      return null;\n    }\n    return tileGrid.getResolutions();\n  }\n\n  /**\n   * @abstract\n   * @param {number} z Tile coordinate z.\n   * @param {number} x Tile coordinate x.\n   * @param {number} y Tile coordinate y.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @return {TileType|null} Tile.\n   */\n  getTile(z, x, y, pixelRatio, projection) {\n    return abstract();\n  }\n\n  /**\n   * Return the tile grid of the tile source.\n   * @return {import(\"../tilegrid/TileGrid.js\").default|null} Tile grid.\n   * @api\n   */\n  getTileGrid() {\n    return this.tileGrid;\n  }\n\n  /**\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @return {!import(\"../tilegrid/TileGrid.js\").default} Tile grid.\n   */\n  getTileGridForProjection(projection) {\n    if (!this.tileGrid) {\n      return getTileGridForProjection(projection);\n    }\n    return this.tileGrid;\n  }\n\n  /**\n   * Get the tile pixel ratio for this source. Subclasses may override this\n   * method, which is meant to return a supported pixel ratio that matches the\n   * provided `pixelRatio` as close as possible.\n   * @param {number} pixelRatio Pixel ratio.\n   * @return {number} Tile pixel ratio.\n   */\n  getTilePixelRatio(pixelRatio) {\n    return this.tilePixelRatio_;\n  }\n\n  /**\n   * @param {number} z Z.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @return {import(\"../size.js\").Size} Tile size.\n   */\n  getTilePixelSize(z, pixelRatio, projection) {\n    const tileGrid = this.getTileGridForProjection(projection);\n    const tilePixelRatio = this.getTilePixelRatio(pixelRatio);\n    const tileSize = toSize(tileGrid.getTileSize(z), this.tmpSize);\n    if (tilePixelRatio == 1) {\n      return tileSize;\n    }\n    return scaleSize(tileSize, tilePixelRatio, this.tmpSize);\n  }\n\n  /**\n   * Returns a tile coordinate wrapped around the x-axis. When the tile coordinate\n   * is outside the resolution and extent range of the tile grid, `null` will be\n   * returned.\n   * @param {import(\"../tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n   * @param {import(\"../proj/Projection.js\").default} [projection] Projection.\n   * @return {import(\"../tilecoord.js\").TileCoord} Tile coordinate to be passed to the tileUrlFunction or\n   *     null if no tile URL should be created for the passed `tileCoord`.\n   */\n  getTileCoordForTileUrlFunction(tileCoord, projection) {\n    const gridProjection =\n      projection !== undefined ? projection : this.getProjection();\n    const tileGrid =\n      projection !== undefined\n        ? this.getTileGridForProjection(gridProjection)\n        : this.tileGrid || this.getTileGridForProjection(gridProjection);\n    if (this.getWrapX() && gridProjection.isGlobal()) {\n      tileCoord = wrapX(tileGrid, tileCoord, gridProjection);\n    }\n    return withinExtentAndZ(tileCoord, tileGrid) ? tileCoord : null;\n  }\n\n  /**\n   * Remove all cached reprojected tiles from the source. The next render cycle will create new tiles.\n   * @api\n   */\n  clear() {}\n\n  /**\n   * @override\n   */\n  refresh() {\n    this.clear();\n    super.refresh();\n  }\n}\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/source/Tile~TileSource} instances are instances of this\n * type.\n */\nexport class TileSourceEvent extends Event {\n  /**\n   * @param {string} type Type.\n   * @param {import(\"../Tile.js\").default} tile The tile.\n   */\n  constructor(type, tile) {\n    super(type);\n\n    /**\n     * The tile related to the event.\n     * @type {import(\"../Tile.js\").default}\n     * @api\n     */\n    this.tile = tile;\n  }\n}\n\nexport default TileSource;\n","/**\n * @module ol/tilegrid\n */\nimport {\n  containsCoordinate,\n  createOrUpdate,\n  getCorner,\n  getHeight,\n  getWidth,\n} from './extent.js';\nimport {METERS_PER_UNIT, get as getProjection} from './proj.js';\nimport {toSize} from './size.js';\nimport TileGrid from './tilegrid/TileGrid.js';\nimport {DEFAULT_MAX_ZOOM, DEFAULT_TILE_SIZE} from './tilegrid/common.js';\n\nexport {TileGrid};\nexport {default as WMTS} from './tilegrid/WMTS.js';\n\n/**\n * @param {import(\"./proj/Projection.js\").default} projection Projection.\n * @return {!TileGrid} Default tile grid for the\n * passed projection.\n */\nexport function getForProjection(projection) {\n  let tileGrid = projection.getDefaultTileGrid();\n  if (!tileGrid) {\n    tileGrid = createForProjection(projection);\n    projection.setDefaultTileGrid(tileGrid);\n  }\n  return tileGrid;\n}\n\n/**\n * @param {TileGrid} tileGrid Tile grid.\n * @param {import(\"./tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n * @param {import(\"./proj/Projection.js\").default} projection Projection.\n * @return {import(\"./tilecoord.js\").TileCoord} Tile coordinate.\n */\nexport function wrapX(tileGrid, tileCoord, projection) {\n  const z = tileCoord[0];\n  const center = tileGrid.getTileCoordCenter(tileCoord);\n  const projectionExtent = extentFromProjection(projection);\n  if (!containsCoordinate(projectionExtent, center)) {\n    const worldWidth = getWidth(projectionExtent);\n    const worldsAway = Math.ceil(\n      (projectionExtent[0] - center[0]) / worldWidth,\n    );\n    center[0] += worldWidth * worldsAway;\n    return tileGrid.getTileCoordForCoordAndZ(center, z);\n  }\n  return tileCoord;\n}\n\n/**\n * @param {import(\"./extent.js\").Extent} extent Extent.\n * @param {number} [maxZoom] Maximum zoom level (default is\n *     DEFAULT_MAX_ZOOM).\n * @param {number|import(\"./size.js\").Size} [tileSize] Tile size (default uses\n *     DEFAULT_TILE_SIZE).\n * @param {import(\"./extent.js\").Corner} [corner] Extent corner (default is `'top-left'`).\n * @return {!TileGrid} TileGrid instance.\n */\nexport function createForExtent(extent, maxZoom, tileSize, corner) {\n  corner = corner !== undefined ? corner : 'top-left';\n\n  const resolutions = resolutionsFromExtent(extent, maxZoom, tileSize);\n\n  return new TileGrid({\n    extent: extent,\n    origin: getCorner(extent, corner),\n    resolutions: resolutions,\n    tileSize: tileSize,\n  });\n}\n\n/**\n * @typedef {Object} XYZOptions\n * @property {import(\"./extent.js\").Extent} [extent] Extent for the tile grid. The origin for an XYZ tile grid is the\n * top-left corner of the extent. If `maxResolution` is not provided the zero level of the grid is defined by the resolution\n * at which one tile fits in the provided extent. If not provided, the extent of the EPSG:3857 projection is used.\n * @property {number} [maxResolution] Resolution at level zero.\n * @property {number} [maxZoom] Maximum zoom. The default is `42`. This determines the number of levels\n * in the grid set. For example, a `maxZoom` of 21 means there are 22 levels in the grid set.\n * @property {number} [minZoom=0] Minimum zoom.\n * @property {number|import(\"./size.js\").Size} [tileSize=[256, 256]] Tile size in pixels.\n */\n\n/**\n * Creates a tile grid with a standard XYZ tiling scheme.\n * @param {XYZOptions} [options] Tile grid options.\n * @return {!TileGrid} Tile grid instance.\n * @api\n */\nexport function createXYZ(options) {\n  const xyzOptions = options || {};\n\n  const extent = xyzOptions.extent || getProjection('EPSG:3857').getExtent();\n\n  const gridOptions = {\n    extent: extent,\n    minZoom: xyzOptions.minZoom,\n    tileSize: xyzOptions.tileSize,\n    resolutions: resolutionsFromExtent(\n      extent,\n      xyzOptions.maxZoom,\n      xyzOptions.tileSize,\n      xyzOptions.maxResolution,\n    ),\n  };\n  return new TileGrid(gridOptions);\n}\n\n/**\n * Create a resolutions array from an extent.  A zoom factor of 2 is assumed.\n * @param {import(\"./extent.js\").Extent} extent Extent.\n * @param {number} [maxZoom] Maximum zoom level (default is\n *     DEFAULT_MAX_ZOOM).\n * @param {number|import(\"./size.js\").Size} [tileSize] Tile size (default uses\n *     DEFAULT_TILE_SIZE).\n * @param {number} [maxResolution] Resolution at level zero.\n * @return {!Array<number>} Resolutions array.\n */\nfunction resolutionsFromExtent(extent, maxZoom, tileSize, maxResolution) {\n  maxZoom = maxZoom !== undefined ? maxZoom : DEFAULT_MAX_ZOOM;\n  tileSize = toSize(tileSize !== undefined ? tileSize : DEFAULT_TILE_SIZE);\n\n  const height = getHeight(extent);\n  const width = getWidth(extent);\n\n  maxResolution =\n    maxResolution > 0\n      ? maxResolution\n      : Math.max(width / tileSize[0], height / tileSize[1]);\n\n  const length = maxZoom + 1;\n  const resolutions = new Array(length);\n  for (let z = 0; z < length; ++z) {\n    resolutions[z] = maxResolution / Math.pow(2, z);\n  }\n  return resolutions;\n}\n\n/**\n * @param {import(\"./proj.js\").ProjectionLike} projection Projection.\n * @param {number} [maxZoom] Maximum zoom level (default is\n *     DEFAULT_MAX_ZOOM).\n * @param {number|import(\"./size.js\").Size} [tileSize] Tile size (default uses\n *     DEFAULT_TILE_SIZE).\n * @param {import(\"./extent.js\").Corner} [corner] Extent corner (default is `'top-left'`).\n * @return {!TileGrid} TileGrid instance.\n */\nexport function createForProjection(projection, maxZoom, tileSize, corner) {\n  const extent = extentFromProjection(projection);\n  return createForExtent(extent, maxZoom, tileSize, corner);\n}\n\n/**\n * Generate a tile grid extent from a projection.  If the projection has an\n * extent, it is used.  If not, a global extent is assumed.\n * @param {import(\"./proj.js\").ProjectionLike} projection Projection.\n * @return {import(\"./extent.js\").Extent} Extent.\n */\nexport function extentFromProjection(projection) {\n  projection = getProjection(projection);\n  let extent = projection.getExtent();\n  if (!extent) {\n    const half =\n      (180 * METERS_PER_UNIT.degrees) / projection.getMetersPerUnit();\n    extent = createOrUpdate(-half, -half, half, half);\n  }\n  return extent;\n}\n","/**\n * @module ol/vec/mat4\n */\n\n/** @typedef {Array<number>} Mat4 */\n\n/**\n * @return {Mat4} \"4x4 matrix representing a 3D identity transform.\"\n */\nexport function create() {\n  return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n}\n\n/**\n * @param {Mat4} mat4 Flattened 4x4 matrix receiving the result.\n * @param {import(\"../transform.js\").Transform} transform Transformation matrix.\n * @return {Mat4} \"2D transformation matrix as flattened 4x4 matrix.\"\n */\nexport function fromTransform(mat4, transform) {\n  mat4[0] = transform[0];\n  mat4[1] = transform[1];\n  mat4[4] = transform[2];\n  mat4[5] = transform[3];\n  mat4[12] = transform[4];\n  mat4[13] = transform[5];\n  return mat4;\n}\n\n/**\n * Generates a orthogonal projection matrix with the given bounds\n *\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @param {Mat4} [out] mat4 frustum matrix will be written into\n * @return {Mat4} out\n */\nexport function orthographic(left, right, bottom, top, near, far, out) {\n  out = out ?? create();\n  const lr = 1 / (left - right),\n    bt = 1 / (bottom - top),\n    nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Scales the mat4 by the dimensions in the given vec3\n *\n * @param {Mat4} m The matrix to scale.\n * @param {number} x How much to scale in the x direction.\n * @param {number} y How much to scale in the y direction.\n * @param {number} z How much to scale in the z direction.\n * @param {Mat4} [out] The matrix to write to.\n * @return {Mat4} out\n */\nexport function scale(m, x, y, z, out) {\n  out = out ?? create();\n  out[0] = m[0] * x;\n  out[1] = m[1] * x;\n  out[2] = m[2] * x;\n  out[3] = m[3] * x;\n  out[4] = m[4] * y;\n  out[5] = m[5] * y;\n  out[6] = m[6] * y;\n  out[7] = m[7] * y;\n  out[8] = m[8] * z;\n  out[9] = m[9] * z;\n  out[10] = m[10] * z;\n  out[11] = m[11] * z;\n  out[12] = m[12];\n  out[13] = m[13];\n  out[14] = m[14];\n  out[15] = m[15];\n  return out;\n}\n\n/**\n * Translate a matrix.\n *\n * @param {Mat4} m the matrix to translate\n * @param {number} x How much to translate in the x direction.\n * @param {number} y How much to translate in the y direction.\n * @param {number} z How much to translate in the z direction.\n * @param {Mat4} [out] the receiving matrix\n * @return {Mat4} out\n */\nexport function translate(m, x, y, z, out) {\n  out = out ?? create();\n  let a00, a01, a02, a03, a10, a11, a12, a13, a20, a21, a22, a23;\n\n  if (m === out) {\n    out[12] = m[0] * x + m[4] * y + m[8] * z + m[12];\n    out[13] = m[1] * x + m[5] * y + m[9] * z + m[13];\n    out[14] = m[2] * x + m[6] * y + m[10] * z + m[14];\n    out[15] = m[3] * x + m[7] * y + m[11] * z + m[15];\n  } else {\n    a00 = m[0];\n    a01 = m[1];\n    a02 = m[2];\n    a03 = m[3];\n    a10 = m[4];\n    a11 = m[5];\n    a12 = m[6];\n    a13 = m[7];\n    a20 = m[8];\n    a21 = m[9];\n    a22 = m[10];\n    a23 = m[11];\n\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n\n    out[12] = a00 * x + a10 * y + a20 * z + m[12];\n    out[13] = a01 * x + a11 * y + a21 * z + m[13];\n    out[14] = a02 * x + a12 * y + a22 * z + m[14];\n    out[15] = a03 * x + a13 * y + a23 * z + m[15];\n  }\n\n  return out;\n}\n\n/**\n * @param {number} x x translation.\n * @param {number} y y translation.\n * @param {number} z z translation.\n * @param {Mat4} [out] optional matrix to store result\n * @return {Mat4} out\n */\nexport function translation(x, y, z, out) {\n  out = out ?? create();\n\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = x;\n  out[13] = y;\n  out[14] = z;\n  out[15] = 1;\n\n  return out;\n}\n"],"names":["asImageLike","data","Image","HTMLCanvasElement","HTMLVideoElement","ImageBitmap","asArrayLike","Uint8Array","Uint8ClampedArray","Float32Array","DataView","disposedError","Error","sharedContext","toArray","image","width","height","undefined","willReadFrequently","canvas","clearRect","drawImage","getImageData","defaultSize","DataTile","constructor","options","state","IDLE","super","tileCoord","transition","interpolate","this","loader_","loader","data_","error_","size_","size","controller_","controller","getSize","imageData","getData","getError","load","ERROR","LOADING","changed","self","then","LOADED","catch","error","disposeInternal","abort","Tile","key","transition_","transitionStarts_","dispatchEvent","CHANGE","release","setState","EMPTY","getKey","getTileCoord","getState","getAlpha","id","time","start","delta","inTransition","endTransition","defaultProcessUrl","defaultTokenUrl","defaultEvalscriptVersion","defaultTileSize","maxRetries","baseDelay","serializeEvalscript","evalscript","version","serializeFunction","setup","evaluatePixel","updateOutput","async","imageFromResponse","response","blob","Promise","resolve","reject","blobUrl","URL","createObjectURL","onload","revokeObjectURL","onerror","src","delay","ms","setTimeout","getToken","auth","url","tokenUrl","body","URLSearchParams","append","clientId","clientSecret","method","headers","fetch","ok","status","json","access_token","parseTokenClaims","token","base64EncodedClaims","split","replace","chars","atob","count","length","uriEncodedChars","Array","i","c","charCodeAt","toString","slice","JSON","parse","decodeURIComponent","join","getProjectionIdentifier","projection","ogcId","code","getCode","startsWith","name","func","expression","match","RegExp","SentinelHub","config","attributionsCollapsible","tileSize","wrapX","setLoader","x","y","z","loadTile_","evalscript_","inputData_","processUrl_","token_","tokenRenewalId_","setAuth","setData","setEvalscript","clearTimeout","fireWhenReady_","claims","expiry","exp","timeout","Math","max","Date","now","script","attempt","tileGrid","getTileGrid","extent","getTileCoordExtent","getTileSize","getProjection","input","bounds","bbox","properties","crs","output","Authorization","stringify","credentials","retryAfter","statusText","TileSource","attributions","on","once","un","tilePixelRatio_","tilePixelRatio","getMinZoom","tmpSize","key_","tileOptions","zDirection","getGutterForProjection","setKey","getResolutions","getTileGridForProjection","getTile","pixelRatio","getTilePixelRatio","getTilePixelSize","getTileCoordForTileUrlFunction","gridProjection","getWrapX","isGlobal","clear","refresh","TileSourceEvent","type","tile","getForProjection","getDefaultTileGrid","createForProjection","setDefaultTileGrid","center","getTileCoordCenter","projectionExtent","extentFromProjection","worldWidth","worldsAway","ceil","getTileCoordForCoordAndZ","createForExtent","maxZoom","corner","resolutions","resolutionsFromExtent","origin","createXYZ","xyzOptions","getExtent","gridOptions","minZoom","maxResolution","pow","half","degrees","getMetersPerUnit","create","fromTransform","mat4","transform","orthographic","left","right","bottom","top","near","far","out","lr","bt","nf","scale","m","translate","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","translation"],"sourceRoot":""}