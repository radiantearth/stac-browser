"use strict";(self["webpackChunk_radiantearth_stac_browser"]=self["webpackChunk_radiantearth_stac_browser"]||[]).push([[817],{18417:function(t,e,n){n.r(e),n.d(e,{default:function(){return we}});var i={};n.r(i),n.d(i,{difference:function(){return ie},intersection:function(){return ee},setPrecision:function(){return re},union:function(){return te},xor:function(){return ne}});n(18111),n(61701);var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"map-container"},[e("div",{ref:"map",staticClass:"map"},[e("TextControl",{attrs:{text:t.help,map:t.map}}),e("UserLocationControl",{attrs:{map:t.map}}),e("LayerControl",{attrs:{map:t.map}})],1)])},s=[],o=n(39665),l=n(79743),u=n(82209),h=function(){var t=this,e=t._self._c;return e("div",{staticClass:"ol-location ol-unselectable ol-control",staticStyle:{"pointer-events":"auto"}},[e("button",{attrs:{title:t.$t("mapping.location.description")},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.request.apply(null,arguments)}}},[e("b-icon-pin-map-fill")],1)])},a=[],c=n(44294),f=n(23634),p=n(38599),g=n(82948),y={name:"UserLocationControl",components:{BIconPinMapFill:g.sye},mixins:[f.A],methods:{request(){"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(t=>{const e=this.map.getView(),n=(0,p.Rb)([t.coords.longitude,t.coords.latitude],e.getProjection()),i=new c.A(n);e.fit(i,{maxZoom:10})},t=>this.$root.$emit("error",t,t.message),{maximumAge:1/0})}}},d=y,m=n(81656),x=(0,m.A)(d,h,a,!1,null,"a2416cf4",null),w=x.exports,b=n(58704),E=n(86717),v=n(73445),S=n(6933),_=n(1685),T=n(70915),R=n(79787),P=n(82986),O=n(37078),I=n(29276),C=n(21409);const A={EXTENTCHANGED:"extentchanged"};class N extends _.Ay{constructor(t){super(A.EXTENTCHANGED),this.extent=t}}class L extends C.A{constructor(t){t=t||{},super(t),this.on,this.once,this.un,this.condition_=t.condition?t.condition:b.Gk,this.extent_=null,this.pointerHandler_=null,this.pixelTolerance_=void 0!==t.pixelTolerance?t.pixelTolerance:10,this.snappedToVertex_=!1,this.extentFeature_=null,this.vertexFeature_=null,t||(t={}),this.extentOverlay_=new P["default"]({source:new O["default"]({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.boxStyle?t.boxStyle:k(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.vertexOverlay_=new P["default"]({source:new O["default"]({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.pointerStyle?t.pointerStyle:G(),updateWhileAnimating:!0,updateWhileInteracting:!0}),t.extent&&this.setExtent(t.extent)}snapToVertex_(t,e){const n=e.getCoordinateFromPixelInternal(t),i=function(t,e){return(0,S.$x)(n,t)-(0,S.$x)(n,e)},r=this.getExtentInternal();if(r){const s=F(r);s.sort(i);const o=s[0];let l=(0,S.sG)(n,o);const u=e.getPixelFromCoordinateInternal(l);if((0,S.Io)(t,u)<=this.pixelTolerance_){const t=e.getPixelFromCoordinateInternal(o[0]),n=e.getPixelFromCoordinateInternal(o[1]),i=(0,S.hG)(u,t),r=(0,S.hG)(u,n),s=Math.sqrt(Math.min(i,r));return this.snappedToVertex_=s<=this.pixelTolerance_,this.snappedToVertex_&&(l=i>r?o[1]:o[0]),l}}return null}handlePointerMove_(t){const e=t.pixel,n=t.map;let i=this.snapToVertex_(e,n);i||(i=n.getCoordinateFromPixelInternal(e)),this.createOrUpdatePointerFeature_(i)}createOrUpdateExtentFeature_(t){let e=this.extentFeature_;return e?t?e.setGeometry((0,R.VY)(t)):e.setGeometry(void 0):(e=t?new E.A((0,R.VY)(t)):new E.A({}),this.extentFeature_=e,this.extentOverlay_.getSource().addFeature(e)),e}createOrUpdatePointerFeature_(t){let e=this.vertexFeature_;if(e){const n=e.getGeometry();n.setCoordinates(t)}else e=new E.A(new c.A(t)),this.vertexFeature_=e,this.vertexOverlay_.getSource().addFeature(e);return e}handleEvent(t){return!t.originalEvent||!this.condition_(t)||(t.type!=v.A.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(t),super.handleEvent(t),!1)}handleDownEvent(t){const e=t.pixel,n=t.map,i=this.getExtentInternal();let r=this.snapToVertex_(e,n);const s=function(t){let e=null,n=null;return t[0]==i[0]?e=i[2]:t[0]==i[2]&&(e=i[0]),t[1]==i[1]?n=i[3]:t[1]==i[3]&&(n=i[1]),null!==e&&null!==n?[e,n]:null};if(r&&i){const t=r[0]==i[0]||r[0]==i[2]?r[0]:null,e=r[1]==i[1]||r[1]==i[3]?r[1]:null;null!==t&&null!==e?this.pointerHandler_=M(s(r)):null!==t?this.pointerHandler_=B(s([t,i[1]]),s([t,i[3]])):null!==e&&(this.pointerHandler_=B(s([i[0],e]),s([i[2],e])))}else r=n.getCoordinateFromPixelInternal(e),this.setExtent([r[0],r[1],r[0],r[1]]),this.pointerHandler_=M(r);return!0}handleDragEvent(t){if(this.pointerHandler_){const e=t.coordinate;this.setExtent(this.pointerHandler_(e)),this.createOrUpdatePointerFeature_(e)}}handleUpEvent(t){this.pointerHandler_=null;const e=this.getExtentInternal();return e&&0!==(0,T.UG)(e)||this.setExtent(null),!1}setMap(t){this.extentOverlay_.setMap(t),this.vertexOverlay_.setMap(t),super.setMap(t)}getExtent(){return(0,p.JR)(this.getExtentInternal(),this.getMap().getView().getProjection())}getExtentInternal(){return this.extent_}setExtent(t){this.extent_=t||null,this.createOrUpdateExtentFeature_(t),this.dispatchEvent(new N(this.extent_))}}function k(){const t=(0,I.mY)();return function(e,n){return t["Polygon"]}}function G(){const t=(0,I.mY)();return function(e,n){return t["Point"]}}function M(t){return function(e){return(0,T.Tr)([t,e])}}function B(t,e){return t[0]==e[0]?function(n){return(0,T.Tr)([t,[n[0],e[1]]])}:t[1]==e[1]?function(n){return(0,T.Tr)([t,[e[0],n[1]]])}:null}function F(t){return[[[t[0],t[1]],[t[0],t[3]]],[[t[0],t[3]],[t[2],t[3]]],[[t[2],t[3]],[t[2],t[1]]],[[t[2],t[1]],[t[0],t[1]]]]}var q=L,D=n(73354),U=n(13628),V=n(34533),j=6371008.8;Math.PI;function $(t,e,n={}){const i={type:"Feature"};return(0===n.id||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=e||{},i.geometry=t,i}function z(t,e,n={}){for(const r of t){if(r.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(r[r.length-1].length!==r[0].length)throw new Error("First and last Position are not equivalent.");for(let t=0;t<r[r.length-1].length;t++)if(r[r.length-1][t]!==r[0][t])throw new Error("First and last Position are not equivalent.")}const i={type:"Polygon",coordinates:t};return $(i,e,n)}function H(t,e,n={}){const i={type:"MultiPolygon",coordinates:t};return $(i,e,n)}var Y=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,K=Math.ceil,X=Math.floor,Z="[BigNumber Error] ",W=Z+"Number primitive has more than 15 significant digits: ",J=1e14,Q=14,tt=9007199254740991,et=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],nt=1e7,it=1e9;function rt(t){var e,n,i,r=x.prototype={constructor:x,toString:null,valueOf:null},s=new x(1),o=20,l=4,u=-7,h=21,a=-1e7,c=1e7,f=!1,p=1,g=0,y={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},d="0123456789abcdefghijklmnopqrstuvwxyz",m=!0;function x(t,e){var r,s,u,h,f,p,g,y,w=this;if(!(w instanceof x))return new x(t,e);if(null==e){if(t&&!0===t._isBigNumber)return w.s=t.s,void(!t.c||t.e>c?w.c=w.e=null:t.e<a?w.c=[w.e=0]:(w.e=t.e,w.c=t.c.slice()));if((p="number"==typeof t)&&0*t==0){if(w.s=1/t<0?(t=-t,-1):1,t===~~t){for(h=0,f=t;f>=10;f/=10,h++);return void(h>c?w.c=w.e=null:(w.e=h,w.c=[t]))}y=String(t)}else{if(!Y.test(y=String(t)))return i(w,y,p);w.s=45==y.charCodeAt(0)?(y=y.slice(1),-1):1}(h=y.indexOf("."))>-1&&(y=y.replace(".","")),(f=y.search(/e/i))>0?(h<0&&(h=f),h+=+y.slice(f+1),y=y.substring(0,f)):h<0&&(h=y.length)}else{if(ut(e,2,d.length,"Base"),10==e&&m)return w=new x(t),v(w,o+w.e+1,l);if(y=String(t),p="number"==typeof t){if(0*t!=0)return i(w,y,p,e);if(w.s=1/t<0?(y=y.slice(1),-1):1,x.DEBUG&&y.replace(/^0\.0*|\./,"").length>15)throw Error(W+t)}else w.s=45===y.charCodeAt(0)?(y=y.slice(1),-1):1;for(r=d.slice(0,e),h=f=0,g=y.length;f<g;f++)if(r.indexOf(s=y.charAt(f))<0){if("."==s){if(f>h){h=g;continue}}else if(!u&&(y==y.toUpperCase()&&(y=y.toLowerCase())||y==y.toLowerCase()&&(y=y.toUpperCase()))){u=!0,f=-1,h=0;continue}return i(w,String(t),p,e)}p=!1,y=n(y,e,10,w.s),(h=y.indexOf("."))>-1?y=y.replace(".",""):h=y.length}for(f=0;48===y.charCodeAt(f);f++);for(g=y.length;48===y.charCodeAt(--g););if(y=y.slice(f,++g)){if(g-=f,p&&x.DEBUG&&g>15&&(t>tt||t!==X(t)))throw Error(W+w.s*t);if((h=h-f-1)>c)w.c=w.e=null;else if(h<a)w.c=[w.e=0];else{if(w.e=h,w.c=[],f=(h+1)%Q,h<0&&(f+=Q),f<g){for(f&&w.c.push(+y.slice(0,f)),g-=Q;f<g;)w.c.push(+y.slice(f,f+=Q));f=Q-(y=y.slice(f)).length}else f-=g;for(;f--;y+="0");w.c.push(+y)}}else w.c=[w.e=0]}function w(t,e,n,i){var r,s,o,a,c;if(null==n?n=l:ut(n,0,8),!t.c)return t.toString();if(r=t.c[0],o=t.e,null==e)c=ot(t.c),c=1==i||2==i&&(o<=u||o>=h)?at(c,o):ct(c,o,"0");else if(t=v(new x(t),e,n),s=t.e,c=ot(t.c),a=c.length,1==i||2==i&&(e<=s||s<=u)){for(;a<e;c+="0",a++);c=at(c,s)}else if(e-=o+(2===i&&s>o),c=ct(c,s,"0"),s+1>a){if(--e>0)for(c+=".";e--;c+="0");}else if(e+=s-a,e>0)for(s+1==a&&(c+=".");e--;c+="0");return t.s<0&&r?"-"+c:c}function b(t,e){for(var n,i,r=1,s=new x(t[0]);r<t.length;r++)i=new x(t[r]),(!i.s||(n=lt(s,i))===e||0===n&&s.s===e)&&(s=i);return s}function E(t,e,n){for(var i=1,r=e.length;!e[--r];e.pop());for(r=e[0];r>=10;r/=10,i++);return(n=i+n*Q-1)>c?t.c=t.e=null:n<a?t.c=[t.e=0]:(t.e=n,t.c=e),t}function v(t,e,n,i){var r,s,o,l,u,h,f,p=t.c,g=et;if(p){t:{for(r=1,l=p[0];l>=10;l/=10,r++);if(s=e-r,s<0)s+=Q,o=e,u=p[h=0],f=X(u/g[r-o-1]%10);else if(h=K((s+1)/Q),h>=p.length){if(!i)break t;for(;p.length<=h;p.push(0));u=f=0,r=1,s%=Q,o=s-Q+1}else{for(u=l=p[h],r=1;l>=10;l/=10,r++);s%=Q,o=s-Q+r,f=o<0?0:X(u/g[r-o-1]%10)}if(i=i||e<0||null!=p[h+1]||(o<0?u:u%g[r-o-1]),i=n<4?(f||i)&&(0==n||n==(t.s<0?3:2)):f>5||5==f&&(4==n||i||6==n&&(s>0?o>0?u/g[r-o]:0:p[h-1])%10&1||n==(t.s<0?8:7)),e<1||!p[0])return p.length=0,i?(e-=t.e+1,p[0]=g[(Q-e%Q)%Q],t.e=-e||0):p[0]=t.e=0,t;if(0==s?(p.length=h,l=1,h--):(p.length=h+1,l=g[Q-s],p[h]=o>0?X(u/g[r-o]%g[o])*l:0),i)for(;;){if(0==h){for(s=1,o=p[0];o>=10;o/=10,s++);for(o=p[0]+=l,l=1;o>=10;o/=10,l++);s!=l&&(t.e++,p[0]==J&&(p[0]=1));break}if(p[h]+=l,p[h]!=J)break;p[h--]=0,l=1}for(s=p.length;0===p[--s];p.pop());}t.e>c?t.c=t.e=null:t.e<a&&(t.c=[t.e=0])}return t}function S(t){var e,n=t.e;return null===n?t.toString():(e=ot(t.c),e=n<=u||n>=h?at(e,n):ct(e,n,"0"),t.s<0?"-"+e:e)}return x.clone=rt,x.ROUND_UP=0,x.ROUND_DOWN=1,x.ROUND_CEIL=2,x.ROUND_FLOOR=3,x.ROUND_HALF_UP=4,x.ROUND_HALF_DOWN=5,x.ROUND_HALF_EVEN=6,x.ROUND_HALF_CEIL=7,x.ROUND_HALF_FLOOR=8,x.EUCLID=9,x.config=x.set=function(t){var e,n;if(null!=t){if("object"!=typeof t)throw Error(Z+"Object expected: "+t);if(t.hasOwnProperty(e="DECIMAL_PLACES")&&(n=t[e],ut(n,0,it,e),o=n),t.hasOwnProperty(e="ROUNDING_MODE")&&(n=t[e],ut(n,0,8,e),l=n),t.hasOwnProperty(e="EXPONENTIAL_AT")&&(n=t[e],n&&n.pop?(ut(n[0],-it,0,e),ut(n[1],0,it,e),u=n[0],h=n[1]):(ut(n,-it,it,e),u=-(h=n<0?-n:n))),t.hasOwnProperty(e="RANGE"))if(n=t[e],n&&n.pop)ut(n[0],-it,-1,e),ut(n[1],1,it,e),a=n[0],c=n[1];else{if(ut(n,-it,it,e),!n)throw Error(Z+e+" cannot be zero: "+n);a=-(c=n<0?-n:n)}if(t.hasOwnProperty(e="CRYPTO")){if(n=t[e],n!==!!n)throw Error(Z+e+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw f=!n,Error(Z+"crypto unavailable");f=n}else f=n}if(t.hasOwnProperty(e="MODULO_MODE")&&(n=t[e],ut(n,0,9,e),p=n),t.hasOwnProperty(e="POW_PRECISION")&&(n=t[e],ut(n,0,it,e),g=n),t.hasOwnProperty(e="FORMAT")){if(n=t[e],"object"!=typeof n)throw Error(Z+e+" not an object: "+n);y=n}if(t.hasOwnProperty(e="ALPHABET")){if(n=t[e],"string"!=typeof n||/^.?$|[+\-.\s]|(.).*\1/.test(n))throw Error(Z+e+" invalid: "+n);m="0123456789"==n.slice(0,10),d=n}}return{DECIMAL_PLACES:o,ROUNDING_MODE:l,EXPONENTIAL_AT:[u,h],RANGE:[a,c],CRYPTO:f,MODULO_MODE:p,POW_PRECISION:g,FORMAT:y,ALPHABET:d}},x.isBigNumber=function(t){if(!t||!0!==t._isBigNumber)return!1;if(!x.DEBUG)return!0;var e,n,i=t.c,r=t.e,s=t.s;t:if("[object Array]"=={}.toString.call(i)){if((1===s||-1===s)&&r>=-it&&r<=it&&r===X(r)){if(0===i[0]){if(0===r&&1===i.length)return!0;break t}if(e=(r+1)%Q,e<1&&(e+=Q),String(i[0]).length==e){for(e=0;e<i.length;e++)if(n=i[e],n<0||n>=J||n!==X(n))break t;if(0!==n)return!0}}}else if(null===i&&null===r&&(null===s||1===s||-1===s))return!0;throw Error(Z+"Invalid BigNumber: "+t)},x.maximum=x.max=function(){return b(arguments,-1)},x.minimum=x.min=function(){return b(arguments,1)},x.random=function(){var t=9007199254740992,e=Math.random()*t&2097151?function(){return X(Math.random()*t)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)};return function(t){var n,i,r,l,u,h=0,a=[],c=new x(s);if(null==t?t=o:ut(t,0,it),l=K(t/Q),f)if(crypto.getRandomValues){for(n=crypto.getRandomValues(new Uint32Array(l*=2));h<l;)u=131072*n[h]+(n[h+1]>>>11),u>=9e15?(i=crypto.getRandomValues(new Uint32Array(2)),n[h]=i[0],n[h+1]=i[1]):(a.push(u%1e14),h+=2);h=l/2}else{if(!crypto.randomBytes)throw f=!1,Error(Z+"crypto unavailable");for(n=crypto.randomBytes(l*=7);h<l;)u=281474976710656*(31&n[h])+1099511627776*n[h+1]+4294967296*n[h+2]+16777216*n[h+3]+(n[h+4]<<16)+(n[h+5]<<8)+n[h+6],u>=9e15?crypto.randomBytes(7).copy(n,h):(a.push(u%1e14),h+=7);h=l/7}if(!f)for(;h<l;)u=e(),u<9e15&&(a[h++]=u%1e14);for(l=a[--h],t%=Q,l&&t&&(u=et[Q-t],a[h]=X(l/u)*u);0===a[h];a.pop(),h--);if(h<0)a=[r=0];else{for(r=-1;0===a[0];a.splice(0,1),r-=Q);for(h=1,u=a[0];u>=10;u/=10,h++);h<Q&&(r-=Q-h)}return c.e=r,c.c=a,c}}(),x.sum=function(){for(var t=1,e=arguments,n=new x(e[0]);t<e.length;)n=n.plus(e[t++]);return n},n=function(){var t="0123456789";function n(t,e,n,i){for(var r,s,o=[0],l=0,u=t.length;l<u;){for(s=o.length;s--;o[s]*=e);for(o[0]+=i.indexOf(t.charAt(l++)),r=0;r<o.length;r++)o[r]>n-1&&(null==o[r+1]&&(o[r+1]=0),o[r+1]+=o[r]/n|0,o[r]%=n)}return o.reverse()}return function(i,r,s,u,h){var a,c,f,p,y,m,w,b,E=i.indexOf("."),v=o,S=l;for(E>=0&&(p=g,g=0,i=i.replace(".",""),b=new x(r),m=b.pow(i.length-E),g=p,b.c=n(ct(ot(m.c),m.e,"0"),10,s,t),b.e=b.c.length),w=n(i,r,s,h?(a=d,t):(a=t,d)),f=p=w.length;0==w[--p];w.pop());if(!w[0])return a.charAt(0);if(E<0?--f:(m.c=w,m.e=f,m.s=u,m=e(m,b,v,S,s),w=m.c,y=m.r,f=m.e),c=f+v+1,E=w[c],p=s/2,y=y||c<0||null!=w[c+1],y=S<4?(null!=E||y)&&(0==S||S==(m.s<0?3:2)):E>p||E==p&&(4==S||y||6==S&&1&w[c-1]||S==(m.s<0?8:7)),c<1||!w[0])i=y?ct(a.charAt(1),-v,a.charAt(0)):a.charAt(0);else{if(w.length=c,y)for(--s;++w[--c]>s;)w[c]=0,c||(++f,w=[1].concat(w));for(p=w.length;!w[--p];);for(E=0,i="";E<=p;i+=a.charAt(w[E++]));i=ct(i,f,a.charAt(0))}return i}}(),e=function(){function t(t,e,n){var i,r,s,o,l=0,u=t.length,h=e%nt,a=e/nt|0;for(t=t.slice();u--;)s=t[u]%nt,o=t[u]/nt|0,i=a*s+o*h,r=h*s+i%nt*nt+l,l=(r/n|0)+(i/nt|0)+a*o,t[u]=r%n;return l&&(t=[l].concat(t)),t}function e(t,e,n,i){var r,s;if(n!=i)s=n>i?1:-1;else for(r=s=0;r<n;r++)if(t[r]!=e[r]){s=t[r]>e[r]?1:-1;break}return s}function n(t,e,n,i){for(var r=0;n--;)t[n]-=r,r=t[n]<e[n]?1:0,t[n]=r*i+t[n]-e[n];for(;!t[0]&&t.length>1;t.splice(0,1));}return function(i,r,s,o,l){var u,h,a,c,f,p,g,y,d,m,w,b,E,S,_,T,R,P=i.s==r.s?1:-1,O=i.c,I=r.c;if(!O||!O[0]||!I||!I[0])return new x(i.s&&r.s&&(O?!I||O[0]!=I[0]:I)?O&&0==O[0]||!I?0*P:P/0:NaN);for(y=new x(P),d=y.c=[],h=i.e-r.e,P=s+h+1,l||(l=J,h=st(i.e/Q)-st(r.e/Q),P=P/Q|0),a=0;I[a]==(O[a]||0);a++);if(I[a]>(O[a]||0)&&h--,P<0)d.push(1),c=!0;else{for(S=O.length,T=I.length,a=0,P+=2,f=X(l/(I[0]+1)),f>1&&(I=t(I,f,l),O=t(O,f,l),T=I.length,S=O.length),E=T,m=O.slice(0,T),w=m.length;w<T;m[w++]=0);R=I.slice(),R=[0].concat(R),_=I[0],I[1]>=l/2&&_++;do{if(f=0,u=e(I,m,T,w),u<0){if(b=m[0],T!=w&&(b=b*l+(m[1]||0)),f=X(b/_),f>1){f>=l&&(f=l-1),p=t(I,f,l),g=p.length,w=m.length;while(1==e(p,m,g,w))f--,n(p,T<g?R:I,g,l),g=p.length,u=1}else 0==f&&(u=f=1),p=I.slice(),g=p.length;if(g<w&&(p=[0].concat(p)),n(m,p,w,l),w=m.length,-1==u)while(e(I,m,T,w)<1)f++,n(m,T<w?R:I,w,l),w=m.length}else 0===u&&(f++,m=[0]);d[a++]=f,m[0]?m[w++]=O[E]||0:(m=[O[E]],w=1)}while((E++<S||null!=m[0])&&P--);c=null!=m[0],d[0]||d.splice(0,1)}if(l==J){for(a=1,P=d[0];P>=10;P/=10,a++);v(y,s+(y.e=a+h*Q-1)+1,o,c)}else y.e=h,y.r=+c;return y}}(),i=function(){var t=/^(-?)0([xbo])(?=\w[\w.]*$)/i,e=/^([^.]+)\.$/,n=/^\.([^.]+)$/,i=/^-?(Infinity|NaN)$/,r=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(s,o,l,u){var h,a=l?o:o.replace(r,"");if(i.test(a))s.s=isNaN(a)?null:a<0?-1:1;else{if(!l&&(a=a.replace(t,function(t,e,n){return h="x"==(n=n.toLowerCase())?16:"b"==n?2:8,u&&u!=h?t:e}),u&&(h=u,a=a.replace(e,"$1").replace(n,"0.$1")),o!=a))return new x(a,h);if(x.DEBUG)throw Error(Z+"Not a"+(u?" base "+u:"")+" number: "+o);s.s=null}s.c=s.e=null}}(),r.absoluteValue=r.abs=function(){var t=new x(this);return t.s<0&&(t.s=1),t},r.comparedTo=function(t,e){return lt(this,new x(t,e))},r.decimalPlaces=r.dp=function(t,e){var n,i,r,s=this;if(null!=t)return ut(t,0,it),null==e?e=l:ut(e,0,8),v(new x(s),t+s.e+1,e);if(!(n=s.c))return null;if(i=((r=n.length-1)-st(this.e/Q))*Q,r=n[r])for(;r%10==0;r/=10,i--);return i<0&&(i=0),i},r.dividedBy=r.div=function(t,n){return e(this,new x(t,n),o,l)},r.dividedToIntegerBy=r.idiv=function(t,n){return e(this,new x(t,n),0,1)},r.exponentiatedBy=r.pow=function(t,e){var n,i,r,o,u,h,a,c,f,p=this;if(t=new x(t),t.c&&!t.isInteger())throw Error(Z+"Exponent not an integer: "+S(t));if(null!=e&&(e=new x(e)),h=t.e>14,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!t.c||!t.c[0])return f=new x(Math.pow(+S(p),h?t.s*(2-ht(t)):+S(t))),e?f.mod(e):f;if(a=t.s<0,e){if(e.c?!e.c[0]:!e.s)return new x(NaN);i=!a&&p.isInteger()&&e.isInteger(),i&&(p=p.mod(e))}else{if(t.e>9&&(p.e>0||p.e<-1||(0==p.e?p.c[0]>1||h&&p.c[1]>=24e7:p.c[0]<8e13||h&&p.c[0]<=9999975e7)))return o=p.s<0&&ht(t)?-0:0,p.e>-1&&(o=1/o),new x(a?1/o:o);g&&(o=K(g/Q+2))}for(h?(n=new x(.5),a&&(t.s=1),c=ht(t)):(r=Math.abs(+S(t)),c=r%2),f=new x(s);;){if(c){if(f=f.times(p),!f.c)break;o?f.c.length>o&&(f.c.length=o):i&&(f=f.mod(e))}if(r){if(r=X(r/2),0===r)break;c=r%2}else if(t=t.times(n),v(t,t.e+1,1),t.e>14)c=ht(t);else{if(r=+S(t),0===r)break;c=r%2}p=p.times(p),o?p.c&&p.c.length>o&&(p.c.length=o):i&&(p=p.mod(e))}return i?f:(a&&(f=s.div(f)),e?f.mod(e):o?v(f,g,l,u):f)},r.integerValue=function(t){var e=new x(this);return null==t?t=l:ut(t,0,8),v(e,e.e+1,t)},r.isEqualTo=r.eq=function(t,e){return 0===lt(this,new x(t,e))},r.isFinite=function(){return!!this.c},r.isGreaterThan=r.gt=function(t,e){return lt(this,new x(t,e))>0},r.isGreaterThanOrEqualTo=r.gte=function(t,e){return 1===(e=lt(this,new x(t,e)))||0===e},r.isInteger=function(){return!!this.c&&st(this.e/Q)>this.c.length-2},r.isLessThan=r.lt=function(t,e){return lt(this,new x(t,e))<0},r.isLessThanOrEqualTo=r.lte=function(t,e){return-1===(e=lt(this,new x(t,e)))||0===e},r.isNaN=function(){return!this.s},r.isNegative=function(){return this.s<0},r.isPositive=function(){return this.s>0},r.isZero=function(){return!!this.c&&0==this.c[0]},r.minus=function(t,e){var n,i,r,s,o=this,u=o.s;if(t=new x(t,e),e=t.s,!u||!e)return new x(NaN);if(u!=e)return t.s=-e,o.plus(t);var h=o.e/Q,a=t.e/Q,c=o.c,f=t.c;if(!h||!a){if(!c||!f)return c?(t.s=-e,t):new x(f?o:NaN);if(!c[0]||!f[0])return f[0]?(t.s=-e,t):new x(c[0]?o:3==l?-0:0)}if(h=st(h),a=st(a),c=c.slice(),u=h-a){for((s=u<0)?(u=-u,r=c):(a=h,r=f),r.reverse(),e=u;e--;r.push(0));r.reverse()}else for(i=(s=(u=c.length)<(e=f.length))?u:e,u=e=0;e<i;e++)if(c[e]!=f[e]){s=c[e]<f[e];break}if(s&&(r=c,c=f,f=r,t.s=-t.s),e=(i=f.length)-(n=c.length),e>0)for(;e--;c[n++]=0);for(e=J-1;i>u;){if(c[--i]<f[i]){for(n=i;n&&!c[--n];c[n]=e);--c[n],c[i]+=J}c[i]-=f[i]}for(;0==c[0];c.splice(0,1),--a);return c[0]?E(t,c,a):(t.s=3==l?-1:1,t.c=[t.e=0],t)},r.modulo=r.mod=function(t,n){var i,r,s=this;return t=new x(t,n),!s.c||!t.s||t.c&&!t.c[0]?new x(NaN):!t.c||s.c&&!s.c[0]?new x(s):(9==p?(r=t.s,t.s=1,i=e(s,t,0,3),t.s=r,i.s*=r):i=e(s,t,0,p),t=s.minus(i.times(t)),t.c[0]||1!=p||(t.s=s.s),t)},r.multipliedBy=r.times=function(t,e){var n,i,r,s,o,l,u,h,a,c,f,p,g,y,d,m=this,w=m.c,b=(t=new x(t,e)).c;if(!w||!b||!w[0]||!b[0])return!m.s||!t.s||w&&!w[0]&&!b||b&&!b[0]&&!w?t.c=t.e=t.s=null:(t.s*=m.s,w&&b?(t.c=[0],t.e=0):t.c=t.e=null),t;for(i=st(m.e/Q)+st(t.e/Q),t.s*=m.s,u=w.length,c=b.length,u<c&&(g=w,w=b,b=g,r=u,u=c,c=r),r=u+c,g=[];r--;g.push(0));for(y=J,d=nt,r=c;--r>=0;){for(n=0,f=b[r]%d,p=b[r]/d|0,o=u,s=r+o;s>r;)h=w[--o]%d,a=w[o]/d|0,l=p*h+a*f,h=f*h+l%d*d+g[s]+n,n=(h/y|0)+(l/d|0)+p*a,g[s--]=h%y;g[s]=n}return n?++i:g.splice(0,1),E(t,g,i)},r.negated=function(){var t=new x(this);return t.s=-t.s||null,t},r.plus=function(t,e){var n,i=this,r=i.s;if(t=new x(t,e),e=t.s,!r||!e)return new x(NaN);if(r!=e)return t.s=-e,i.minus(t);var s=i.e/Q,o=t.e/Q,l=i.c,u=t.c;if(!s||!o){if(!l||!u)return new x(r/0);if(!l[0]||!u[0])return u[0]?t:new x(l[0]?i:0*r)}if(s=st(s),o=st(o),l=l.slice(),r=s-o){for(r>0?(o=s,n=u):(r=-r,n=l),n.reverse();r--;n.push(0));n.reverse()}for(r=l.length,e=u.length,r-e<0&&(n=u,u=l,l=n,e=r),r=0;e;)r=(l[--e]=l[e]+u[e]+r)/J|0,l[e]=J===l[e]?0:l[e]%J;return r&&(l=[r].concat(l),++o),E(t,l,o)},r.precision=r.sd=function(t,e){var n,i,r,s=this;if(null!=t&&t!==!!t)return ut(t,1,it),null==e?e=l:ut(e,0,8),v(new x(s),t,e);if(!(n=s.c))return null;if(r=n.length-1,i=r*Q+1,r=n[r]){for(;r%10==0;r/=10,i--);for(r=n[0];r>=10;r/=10,i++);}return t&&s.e+1>i&&(i=s.e+1),i},r.shiftedBy=function(t){return ut(t,-tt,tt),this.times("1e"+t)},r.squareRoot=r.sqrt=function(){var t,n,i,r,s,u=this,h=u.c,a=u.s,c=u.e,f=o+4,p=new x("0.5");if(1!==a||!h||!h[0])return new x(!a||a<0&&(!h||h[0])?NaN:h?u:1/0);if(a=Math.sqrt(+S(u)),0==a||a==1/0?(n=ot(h),(n.length+c)%2==0&&(n+="0"),a=Math.sqrt(+n),c=st((c+1)/2)-(c<0||c%2),a==1/0?n="5e"+c:(n=a.toExponential(),n=n.slice(0,n.indexOf("e")+1)+c),i=new x(n)):i=new x(a+""),i.c[0])for(c=i.e,a=c+f,a<3&&(a=0);;)if(s=i,i=p.times(s.plus(e(u,s,f,1))),ot(s.c).slice(0,a)===(n=ot(i.c)).slice(0,a)){if(i.e<c&&--a,n=n.slice(a-3,a+1),"9999"!=n&&(r||"4999"!=n)){+n&&(+n.slice(1)||"5"!=n.charAt(0))||(v(i,i.e+o+2,1),t=!i.times(i).eq(u));break}if(!r&&(v(s,s.e+o+2,0),s.times(s).eq(u))){i=s;break}f+=4,a+=4,r=1}return v(i,i.e+o+1,l,t)},r.toExponential=function(t,e){return null!=t&&(ut(t,0,it),t++),w(this,t,e,1)},r.toFixed=function(t,e){return null!=t&&(ut(t,0,it),t=t+this.e+1),w(this,t,e)},r.toFormat=function(t,e,n){var i,r=this;if(null==n)null!=t&&e&&"object"==typeof e?(n=e,e=null):t&&"object"==typeof t?(n=t,t=e=null):n=y;else if("object"!=typeof n)throw Error(Z+"Argument not an object: "+n);if(i=r.toFixed(t,e),r.c){var s,o=i.split("."),l=+n.groupSize,u=+n.secondaryGroupSize,h=n.groupSeparator||"",a=o[0],c=o[1],f=r.s<0,p=f?a.slice(1):a,g=p.length;if(u&&(s=l,l=u,u=s,g-=s),l>0&&g>0){for(s=g%l||l,a=p.substr(0,s);s<g;s+=l)a+=h+p.substr(s,l);u>0&&(a+=h+p.slice(s)),f&&(a="-"+a)}i=c?a+(n.decimalSeparator||"")+((u=+n.fractionGroupSize)?c.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):c):a}return(n.prefix||"")+i+(n.suffix||"")},r.toFraction=function(t){var n,i,r,o,u,h,a,f,p,g,y,d,m=this,w=m.c;if(null!=t&&(a=new x(t),!a.isInteger()&&(a.c||1!==a.s)||a.lt(s)))throw Error(Z+"Argument "+(a.isInteger()?"out of range: ":"not an integer: ")+S(a));if(!w)return new x(m);for(n=new x(s),p=i=new x(s),r=f=new x(s),d=ot(w),u=n.e=d.length-m.e-1,n.c[0]=et[(h=u%Q)<0?Q+h:h],t=!t||a.comparedTo(n)>0?u>0?n:p:a,h=c,c=1/0,a=new x(d),f.c[0]=0;;){if(g=e(a,n,0,1),o=i.plus(g.times(r)),1==o.comparedTo(t))break;i=r,r=o,p=f.plus(g.times(o=p)),f=o,n=a.minus(g.times(o=n)),a=o}return o=e(t.minus(i),r,0,1),f=f.plus(o.times(p)),i=i.plus(o.times(r)),f.s=p.s=m.s,u*=2,y=e(p,r,u,l).minus(m).abs().comparedTo(e(f,i,u,l).minus(m).abs())<1?[p,r]:[f,i],c=h,y},r.toNumber=function(){return+S(this)},r.toPrecision=function(t,e){return null!=t&&ut(t,1,it),w(this,t,e,2)},r.toString=function(t){var e,i=this,r=i.s,s=i.e;return null===s?r?(e="Infinity",r<0&&(e="-"+e)):e="NaN":(null==t?e=s<=u||s>=h?at(ot(i.c),s):ct(ot(i.c),s,"0"):10===t&&m?(i=v(new x(i),o+s+1,l),e=ct(ot(i.c),i.e,"0")):(ut(t,2,d.length,"Base"),e=n(ct(ot(i.c),s,"0"),10,t,r,!0)),r<0&&i.c[0]&&(e="-"+e)),e},r.valueOf=r.toJSON=function(){return S(this)},r._isBigNumber=!0,r[Symbol.toStringTag]="BigNumber",r[Symbol.for("nodejs.util.inspect.custom")]=r.valueOf,null!=t&&x.set(t),x}function st(t){var e=0|t;return t>0||t===e?e:e-1}function ot(t){for(var e,n,i=1,r=t.length,s=t[0]+"";i<r;){for(e=t[i++]+"",n=Q-e.length;n--;e="0"+e);s+=e}for(r=s.length;48===s.charCodeAt(--r););return s.slice(0,r+1||1)}function lt(t,e){var n,i,r=t.c,s=e.c,o=t.s,l=e.s,u=t.e,h=e.e;if(!o||!l)return null;if(n=r&&!r[0],i=s&&!s[0],n||i)return n?i?0:-l:o;if(o!=l)return o;if(n=o<0,i=u==h,!r||!s)return i?0:!r^n?1:-1;if(!i)return u>h^n?1:-1;for(l=(u=r.length)<(h=s.length)?u:h,o=0;o<l;o++)if(r[o]!=s[o])return r[o]>s[o]^n?1:-1;return u==h?0:u>h^n?1:-1}function ut(t,e,n,i){if(t<e||t>n||t!==X(t))throw Error(Z+(i||"Argument")+("number"==typeof t?t<e||t>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function ht(t){var e=t.c.length-1;return st(t.e/Q)==e&&t.c[e]%2!=0}function at(t,e){return(t.length>1?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function ct(t,e,n){var i,r;if(e<0){for(r=n+".";++e;r+=n);t=r+t}else if(i=t.length,++e>i){for(r=n,e-=i;--e;r+=n);t+=r}else e<i&&(t=t.slice(0,e)+"."+t.slice(e));return t}var ft=rt(),pt=ft,gt=class{key;left=null;right=null;constructor(t){this.key=t}},yt=class extends gt{constructor(t){super(t)}},dt=class t extends gt{value;constructor(t,e){super(t),this.value=e}replaceValue(e){const n=new t(this.key,e);return n.left=this.left,n.right=this.right,n}},mt=class{size=0;modificationCount=0;splayCount=0;splay(t){const e=this.root;if(null==e)return this.compare(t,t),-1;let n=null,i=null,r=null,s=null,o=e;const l=this.compare;let u;while(1)if(u=l(o.key,t),u>0){let e=o.left;if(null==e)break;if(u=l(e.key,t),u>0&&(o.left=e.right,e.right=o,o=e,e=o.left,null==e))break;null==n?i=o:n.left=o,n=o,o=e}else{if(!(u<0))break;{let e=o.right;if(null==e)break;if(u=l(e.key,t),u<0&&(o.right=e.left,e.left=o,o=e,e=o.right,null==e))break;null==r?s=o:r.right=o,r=o,o=e}}return null!=r&&(r.right=o.left,o.left=s),null!=n&&(n.left=o.right,o.right=i),this.root!==o&&(this.root=o,this.splayCount++),u}splayMin(t){let e=t,n=e.left;while(null!=n){const t=n;e.left=t.right,t.right=e,e=t,n=e.left}return e}splayMax(t){let e=t,n=e.right;while(null!=n){const t=n;e.right=t.left,t.left=e,e=t,n=e.right}return e}_delete(t){if(null==this.root)return null;const e=this.splay(t);if(0!=e)return null;let n=this.root;const i=n,r=n.left;if(this.size--,null==r)this.root=n.right;else{const t=n.right;n=this.splayMax(r),n.right=t,this.root=n}return this.modificationCount++,i}addNewRoot(t,e){this.size++,this.modificationCount++;const n=this.root;null!=n?(e<0?(t.left=n,t.right=n.right,n.right=null):(t.right=n,t.left=n.left,n.left=null),this.root=t):this.root=t}_first(){const t=this.root;return null==t?null:(this.root=this.splayMin(t),this.root)}_last(){const t=this.root;return null==t?null:(this.root=this.splayMax(t),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(t){return this.validKey(t)&&0==this.splay(t)}defaultCompare(){return(t,e)=>t<e?-1:t>e?1:0}wrap(){return{getRoot:()=>this.root,setRoot:t=>{this.root=t},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:t=>{this.splayCount=t},splay:t=>this.splay(t),has:t=>this.has(t)}}},xt=(Symbol.iterator,Symbol.toStringTag,class t extends mt{root=null;compare;validKey;constructor(t,e){super(),this.compare=t??this.defaultCompare(),this.validKey=e??(t=>null!=t&&void 0!=t)}delete(t){return!!this.validKey(t)&&null!=this._delete(t)}deleteAll(t){for(const e of t)this.delete(e)}forEach(t){const e=this[Symbol.iterator]();let n;while(n=e.next(),!n.done)t(n.value,n.value,this)}add(t){const e=this.splay(t);return 0!=e&&this.addNewRoot(new yt(t),e),this}addAndReturn(t){const e=this.splay(t);return 0!=e&&this.addNewRoot(new yt(t),e),this.root.key}addAll(t){for(const e of t)this.add(e)}isEmpty(){return null==this.root}isNotEmpty(){return null!=this.root}single(){if(0==this.size)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(0==this.size)throw"Bad state: No element";return this._first().key}last(){if(0==this.size)throw"Bad state: No element";return this._last().key}lastBefore(t){if(null==t)throw"Invalid arguments(s)";if(null==this.root)return null;const e=this.splay(t);if(e<0)return this.root.key;let n=this.root.left;if(null==n)return null;let i=n.right;while(null!=i)n=i,i=n.right;return n.key}firstAfter(t){if(null==t)throw"Invalid arguments(s)";if(null==this.root)return null;const e=this.splay(t);if(e>0)return this.root.key;let n=this.root.right;if(null==n)return null;let i=n.left;while(null!=i)n=i,i=n.left;return n.key}retainAll(e){const n=new t(this.compare,this.validKey),i=this.modificationCount;for(const t of e){if(i!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(t)&&0==this.splay(t)&&n.add(this.root.key)}n.size!=this.size&&(this.root=n.root,this.size=n.size,this.modificationCount++)}lookup(t){if(!this.validKey(t))return null;const e=this.splay(t);return 0!=e?null:this.root.key}intersection(e){const n=new t(this.compare,this.validKey);for(const t of this)e.has(t)&&n.add(t);return n}difference(e){const n=new t(this.compare,this.validKey);for(const t of this)e.has(t)||n.add(t);return n}union(t){const e=this.clone();return e.addAll(t),e}clone(){const e=new t(this.compare,this.validKey);return e.size=this.size,e.root=this.copyNode(this.root),e}copyNode(t){if(null==t)return null;function e(t,n){let i,r;do{if(i=t.left,r=t.right,null!=i){const t=new yt(i.key);n.left=t,e(i,t)}if(null!=r){const e=new yt(r.key);n.right=e,t=r,n=e}}while(null!=r)}const n=new yt(t.key);return e(t,n),n}toSet(){return this.clone()}entries(){return new Et(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[Symbol.iterator](){return new bt(this.wrap())}[Symbol.toStringTag]="[object Set]"}),wt=class{tree;path=new Array;modificationCount=null;splayCount;constructor(t){this.tree=t,this.splayCount=t.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;const t=this.path[this.path.length-1];return this.getValue(t)}rebuildPath(t){this.path.splice(0,this.path.length),this.tree.splay(t),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(t){while(null!=t)this.path.push(t),t=t.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(null==this.modificationCount){this.modificationCount=this.tree.getModificationCount();let t=this.tree.getRoot();while(null!=t)this.path.push(t),t=t.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let t=this.path[this.path.length-1],e=t.right;if(null!=e){while(null!=e)this.path.push(e),e=e.left;return!0}this.path.pop();while(this.path.length&&this.path[this.path.length-1].right===t)t=this.path.pop();return this.path.length>0}},bt=class extends wt{getValue(t){return t.key}},Et=class extends wt{getValue(t){return[t.key,t.key]}},vt=class extends wt{constructor(t){super(t)}getValue(t){return t.value}},St=class extends wt{constructor(t){super(t)}getValue(t){return[t.key,t.value]}replaceValue(t){if(this.modificationCount!=this.tree.getModificationCount())throw"Concurrent modification during iteration.";this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);const e=this.path.pop(),n=e.replaceValue(t);if(this.path.length){const t=this.path[this.path.length-1];e===t.left?t.left=n:t.right=n}else this.tree.setRoot(n);this.path.push(n);const i=this.tree.getSplayCount()+1;this.tree.setSplayCount(i),this.splayCount=i}},_t=t=>()=>t,Tt=t=>{const e=t?(e,n)=>n.minus(e).abs().isLessThanOrEqualTo(t):_t(!1);return(t,n)=>e(t,n)?0:t.comparedTo(n)};function Rt(t){const e=t?(e,n,i,r,s)=>e.exponentiatedBy(2).isLessThanOrEqualTo(r.minus(n).exponentiatedBy(2).plus(s.minus(i).exponentiatedBy(2)).times(t)):_t(!1);return(t,n,i)=>{const r=t.x,s=t.y,o=i.x,l=i.y,u=s.minus(l).times(n.x.minus(o)).minus(r.minus(o).times(n.y.minus(l)));return e(u,r,s,o,l)?0:u.comparedTo(0)}}var Pt=t=>t,Ot=t=>{if(t){const e=new xt(Tt(t)),n=new xt(Tt(t)),i=(t,e)=>e.addAndReturn(t),r=t=>({x:i(t.x,e),y:i(t.y,n)});return r({x:new pt(0),y:new pt(0)}),r}return Pt},It=t=>({set:t=>{Ct=It(t)},reset:()=>It(t),compare:Tt(t),snap:Ot(t),orient:Rt(t)}),Ct=It(),At=(t,e)=>t.ll.x.isLessThanOrEqualTo(e.x)&&e.x.isLessThanOrEqualTo(t.ur.x)&&t.ll.y.isLessThanOrEqualTo(e.y)&&e.y.isLessThanOrEqualTo(t.ur.y),Nt=(t,e)=>{if(e.ur.x.isLessThan(t.ll.x)||t.ur.x.isLessThan(e.ll.x)||e.ur.y.isLessThan(t.ll.y)||t.ur.y.isLessThan(e.ll.y))return null;const n=t.ll.x.isLessThan(e.ll.x)?e.ll.x:t.ll.x,i=t.ur.x.isLessThan(e.ur.x)?t.ur.x:e.ur.x,r=t.ll.y.isLessThan(e.ll.y)?e.ll.y:t.ll.y,s=t.ur.y.isLessThan(e.ur.y)?t.ur.y:e.ur.y;return{ll:{x:n,y:r},ur:{x:i,y:s}}},Lt=(t,e)=>t.x.times(e.y).minus(t.y.times(e.x)),kt=(t,e)=>t.x.times(e.x).plus(t.y.times(e.y)),Gt=t=>kt(t,t).sqrt(),Mt=(t,e,n)=>{const i={x:e.x.minus(t.x),y:e.y.minus(t.y)},r={x:n.x.minus(t.x),y:n.y.minus(t.y)};return Lt(r,i).div(Gt(r)).div(Gt(i))},Bt=(t,e,n)=>{const i={x:e.x.minus(t.x),y:e.y.minus(t.y)},r={x:n.x.minus(t.x),y:n.y.minus(t.y)};return kt(r,i).div(Gt(r)).div(Gt(i))},Ft=(t,e,n)=>e.y.isZero()?null:{x:t.x.plus(e.x.div(e.y).times(n.minus(t.y))),y:n},qt=(t,e,n)=>e.x.isZero()?null:{x:n,y:t.y.plus(e.y.div(e.x).times(n.minus(t.x)))},Dt=(t,e,n,i)=>{if(e.x.isZero())return qt(n,i,t.x);if(i.x.isZero())return qt(t,e,n.x);if(e.y.isZero())return Ft(n,i,t.y);if(i.y.isZero())return Ft(t,e,n.y);const r=Lt(e,i);if(r.isZero())return null;const s={x:n.x.minus(t.x),y:n.y.minus(t.y)},o=Lt(s,e).div(r),l=Lt(s,i).div(r),u=t.x.plus(l.times(e.x)),h=n.x.plus(o.times(i.x)),a=t.y.plus(l.times(e.y)),c=n.y.plus(o.times(i.y)),f=u.plus(h).div(2),p=a.plus(c).div(2);return{x:f,y:p}},Ut=class t{point;isLeft;segment;otherSE;consumedBy;static compare(e,n){const i=t.comparePoints(e.point,n.point);return 0!==i?i:(e.point!==n.point&&e.link(n),e.isLeft!==n.isLeft?e.isLeft?1:-1:Zt.compare(e.segment,n.segment))}static comparePoints(t,e){return t.x.isLessThan(e.x)?-1:t.x.isGreaterThan(e.x)?1:t.y.isLessThan(e.y)?-1:t.y.isGreaterThan(e.y)?1:0}constructor(t,e){void 0===t.events?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=e}link(t){if(t.point===this.point)throw new Error("Tried to link already linked events");const e=t.point.events;for(let n=0,i=e.length;n<i;n++){const t=e[n];this.point.events.push(t),t.point=this.point}this.checkForConsuming()}checkForConsuming(){const t=this.point.events.length;for(let e=0;e<t;e++){const n=this.point.events[e];if(void 0===n.segment.consumedBy)for(let i=e+1;i<t;i++){const t=this.point.events[i];void 0===t.consumedBy&&(n.otherSE.point.events===t.otherSE.point.events&&n.segment.consume(t.segment))}}}getAvailableLinkedEvents(){const t=[];for(let e=0,n=this.point.events.length;e<n;e++){const n=this.point.events[e];n!==this&&!n.segment.ringOut&&n.segment.isInResult()&&t.push(n)}return t}getLeftmostComparator(t){const e=new Map,n=n=>{const i=n.otherSE;e.set(n,{sine:Mt(this.point,t.point,i.point),cosine:Bt(this.point,t.point,i.point)})};return(t,i)=>{e.has(t)||n(t),e.has(i)||n(i);const{sine:r,cosine:s}=e.get(t),{sine:o,cosine:l}=e.get(i);return r.isGreaterThanOrEqualTo(0)&&o.isGreaterThanOrEqualTo(0)?s.isLessThan(l)?1:s.isGreaterThan(l)?-1:0:r.isLessThan(0)&&o.isLessThan(0)?s.isLessThan(l)?-1:s.isGreaterThan(l)?1:0:o.isLessThan(r)?-1:o.isGreaterThan(r)?1:0}}},Vt=class t{events;poly;_isExteriorRing;_enclosingRing;static factory(e){const n=[];for(let i=0,r=e.length;i<r;i++){const r=e[i];if(!r.isInResult()||r.ringOut)continue;let s=null,o=r.leftSE,l=r.rightSE;const u=[o],h=o.point,a=[];while(1){if(s=o,o=l,u.push(o),o.point===h)break;while(1){const e=o.getAvailableLinkedEvents();if(0===e.length){const t=u[0].point,e=u[u.length-1].point;throw new Error(`Unable to complete output ring starting at [${t.x}, ${t.y}]. Last matching segment found ends at [${e.x}, ${e.y}].`)}if(1===e.length){l=e[0].otherSE;break}let i=null;for(let t=0,n=a.length;t<n;t++)if(a[t].point===o.point){i=t;break}if(null!==i){const e=a.splice(i)[0],r=u.splice(e.index);r.unshift(r[0].otherSE),n.push(new t(r.reverse()));continue}a.push({index:u.length,point:o.point});const r=o.getLeftmostComparator(s);l=e.sort(r)[0].otherSE;break}}n.push(new t(u))}return n}constructor(t){this.events=t;for(let e=0,n=t.length;e<n;e++)t[e].segment.ringOut=this;this.poly=null}getGeom(){let t=this.events[0].point;const e=[t];for(let u=1,h=this.events.length-1;u<h;u++){const n=this.events[u].point,i=this.events[u+1].point;0!==Ct.orient(n,t,i)&&(e.push(n),t=n)}if(1===e.length)return null;const n=e[0],i=e[1];0===Ct.orient(n,t,i)&&e.shift(),e.push(e[0]);const r=this.isExteriorRing()?1:-1,s=this.isExteriorRing()?0:e.length-1,o=this.isExteriorRing()?e.length:-1,l=[];for(let u=s;u!=o;u+=r)l.push([e[u].x.toNumber(),e[u].y.toNumber()]);return l}isExteriorRing(){if(void 0===this._isExteriorRing){const t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}enclosingRing(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let t=this.events[0];for(let i=1,r=this.events.length;i<r;i++){const e=this.events[i];Ut.compare(t,e)>0&&(t=e)}let e=t.segment.prevInResult(),n=e?e.prevInResult():null;while(1){if(!e)return null;if(!n)return e.ringOut;if(n.ringOut!==e.ringOut)return n.ringOut?.enclosingRing()!==e.ringOut?e.ringOut:e.ringOut?.enclosingRing();e=n.prevInResult(),n=e?e.prevInResult():null}}},jt=class{exteriorRing;interiorRings;constructor(t){this.exteriorRing=t,t.poly=this,this.interiorRings=[]}addInterior(t){this.interiorRings.push(t),t.poly=this}getGeom(){const t=this.exteriorRing.getGeom();if(null===t)return null;const e=[t];for(let n=0,i=this.interiorRings.length;n<i;n++){const t=this.interiorRings[n].getGeom();null!==t&&e.push(t)}return e}},$t=class{rings;polys;constructor(t){this.rings=t,this.polys=this._composePolys(t)}getGeom(){const t=[];for(let e=0,n=this.polys.length;e<n;e++){const n=this.polys[e].getGeom();null!==n&&t.push(n)}return t}_composePolys(t){const e=[];for(let n=0,i=t.length;n<i;n++){const i=t[n];if(!i.poly)if(i.isExteriorRing())e.push(new jt(i));else{const t=i.enclosingRing();t?.poly||e.push(new jt(t)),t?.poly?.addInterior(i)}}return e}},zt=class{queue;tree;segments;constructor(t,e=Zt.compare){this.queue=t,this.tree=new xt(e),this.segments=[]}process(t){const e=t.segment,n=[];if(t.consumedBy)return t.isLeft?this.queue.delete(t.otherSE):this.tree.delete(e),n;t.isLeft&&this.tree.add(e);let i=e,r=e;do{i=this.tree.lastBefore(i)}while(null!=i&&void 0!=i.consumedBy);do{r=this.tree.firstAfter(r)}while(null!=r&&void 0!=r.consumedBy);if(t.isLeft){let s=null;if(i){const t=i.getIntersection(e);if(null!==t&&(e.isAnEndpoint(t)||(s=t),!i.isAnEndpoint(t))){const e=this._splitSafely(i,t);for(let t=0,i=e.length;t<i;t++)n.push(e[t])}}let o=null;if(r){const t=r.getIntersection(e);if(null!==t&&(e.isAnEndpoint(t)||(o=t),!r.isAnEndpoint(t))){const e=this._splitSafely(r,t);for(let t=0,i=e.length;t<i;t++)n.push(e[t])}}if(null!==s||null!==o){let t=null;if(null===s)t=o;else if(null===o)t=s;else{const e=Ut.comparePoints(s,o);t=e<=0?s:o}this.queue.delete(e.rightSE),n.push(e.rightSE);const i=e.split(t);for(let e=0,r=i.length;e<r;e++)n.push(i[e])}n.length>0?(this.tree.delete(e),n.push(t)):(this.segments.push(e),e.prev=i)}else{if(i&&r){const t=i.getIntersection(r);if(null!==t){if(!i.isAnEndpoint(t)){const e=this._splitSafely(i,t);for(let t=0,i=e.length;t<i;t++)n.push(e[t])}if(!r.isAnEndpoint(t)){const e=this._splitSafely(r,t);for(let t=0,i=e.length;t<i;t++)n.push(e[t])}}}this.tree.delete(e)}return n}_splitSafely(t,e){this.tree.delete(t);const n=t.rightSE;this.queue.delete(n);const i=t.split(e);return i.push(n),void 0===t.consumedBy&&this.tree.add(t),i}},Ht=class{type;numMultiPolys;run(t,e,n){Yt.type=t;const i=[new Qt(e,!0)];for(let h=0,a=n.length;h<a;h++)i.push(new Qt(n[h],!1));if(Yt.numMultiPolys=i.length,"difference"===Yt.type){const t=i[0];let e=1;while(e<i.length)null!==Nt(i[e].bbox,t.bbox)?e++:i.splice(e,1)}if("intersection"===Yt.type)for(let h=0,a=i.length;h<a;h++){const t=i[h];for(let e=h+1,n=i.length;e<n;e++)if(null===Nt(t.bbox,i[e].bbox))return[]}const r=new xt(Ut.compare);for(let h=0,a=i.length;h<a;h++){const t=i[h].getSweepEvents();for(let e=0,n=t.length;e<n;e++)r.add(t[e])}const s=new zt(r);let o=null;0!=r.size&&(o=r.first(),r.delete(o));while(o){const t=s.process(o);for(let e=0,n=t.length;e<n;e++){const n=t[e];void 0===n.consumedBy&&r.add(n)}0!=r.size?(o=r.first(),r.delete(o)):o=null}Ct.reset();const l=Vt.factory(s.segments),u=new $t(l);return u.getGeom()}},Yt=new Ht,Kt=Yt,Xt=0,Zt=class t{id;leftSE;rightSE;rings;windings;ringOut;consumedBy;prev;_prevInResult;_beforeState;_afterState;_isInResult;static compare(t,e){const n=t.leftSE.point.x,i=e.leftSE.point.x,r=t.rightSE.point.x,s=e.rightSE.point.x;if(s.isLessThan(n))return 1;if(r.isLessThan(i))return-1;const o=t.leftSE.point.y,l=e.leftSE.point.y,u=t.rightSE.point.y,h=e.rightSE.point.y;if(n.isLessThan(i)){if(l.isLessThan(o)&&l.isLessThan(u))return 1;if(l.isGreaterThan(o)&&l.isGreaterThan(u))return-1;const n=t.comparePoint(e.leftSE.point);if(n<0)return 1;if(n>0)return-1;const i=e.comparePoint(t.rightSE.point);return 0!==i?i:-1}if(n.isGreaterThan(i)){if(o.isLessThan(l)&&o.isLessThan(h))return-1;if(o.isGreaterThan(l)&&o.isGreaterThan(h))return 1;const n=e.comparePoint(t.leftSE.point);if(0!==n)return n;const i=t.comparePoint(e.rightSE.point);return i<0?1:i>0?-1:1}if(o.isLessThan(l))return-1;if(o.isGreaterThan(l))return 1;if(r.isLessThan(s)){const n=e.comparePoint(t.rightSE.point);if(0!==n)return n}if(r.isGreaterThan(s)){const n=t.comparePoint(e.rightSE.point);if(n<0)return 1;if(n>0)return-1}if(!r.eq(s)){const t=u.minus(o),e=r.minus(n),a=h.minus(l),c=s.minus(i);if(t.isGreaterThan(e)&&a.isLessThan(c))return 1;if(t.isLessThan(e)&&a.isGreaterThan(c))return-1}return r.isGreaterThan(s)?1:r.isLessThan(s)||u.isLessThan(h)?-1:u.isGreaterThan(h)?1:t.id<e.id?-1:t.id>e.id?1:0}constructor(t,e,n,i){this.id=++Xt,this.leftSE=t,t.segment=this,t.otherSE=e,this.rightSE=e,e.segment=this,e.otherSE=t,this.rings=n,this.windings=i}static fromRing(e,n,i){let r,s,o;const l=Ut.comparePoints(e,n);if(l<0)r=e,s=n,o=1;else{if(!(l>0))throw new Error(`Tried to create degenerate segment at [${e.x}, ${e.y}]`);r=n,s=e,o=-1}const u=new Ut(r,!0),h=new Ut(s,!1);return new t(u,h,[i],[o])}replaceRightSE(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t.isLessThan(e)?t:e},ur:{x:this.rightSE.point.x,y:t.isGreaterThan(e)?t:e}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(t){return t.x.eq(this.leftSE.point.x)&&t.y.eq(this.leftSE.point.y)||t.x.eq(this.rightSE.point.x)&&t.y.eq(this.rightSE.point.y)}comparePoint(t){return Ct.orient(this.leftSE.point,t,this.rightSE.point)}getIntersection(t){const e=this.bbox(),n=t.bbox(),i=Nt(e,n);if(null===i)return null;const r=this.leftSE.point,s=this.rightSE.point,o=t.leftSE.point,l=t.rightSE.point,u=At(e,o)&&0===this.comparePoint(o),h=At(n,r)&&0===t.comparePoint(r),a=At(e,l)&&0===this.comparePoint(l),c=At(n,s)&&0===t.comparePoint(s);if(h&&u)return c&&!a?s:!c&&a?l:null;if(h)return a&&r.x.eq(l.x)&&r.y.eq(l.y)?null:r;if(u)return c&&s.x.eq(o.x)&&s.y.eq(o.y)?null:o;if(c&&a)return null;if(c)return s;if(a)return l;const f=Dt(r,this.vector(),o,t.vector());return null===f?null:At(i,f)?Ct.snap(f):null}split(e){const n=[],i=void 0!==e.events,r=new Ut(e,!0),s=new Ut(e,!1),o=this.rightSE;this.replaceRightSE(s),n.push(s),n.push(r);const l=new t(r,o,this.rings.slice(),this.windings.slice());return Ut.comparePoints(l.leftSE.point,l.rightSE.point)>0&&l.swapEvents(),Ut.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),i&&(r.checkForConsuming(),s.checkForConsuming()),n}swapEvents(){const t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let e=0,n=this.windings.length;e<n;e++)this.windings[e]*=-1}consume(e){let n=this,i=e;while(n.consumedBy)n=n.consumedBy;while(i.consumedBy)i=i.consumedBy;const r=t.compare(n,i);if(0!==r){if(r>0){const t=n;n=i,i=t}if(n.prev===i){const t=n;n=i,i=t}for(let t=0,e=i.rings.length;t<e;t++){const e=i.rings[t],r=i.windings[t],s=n.rings.indexOf(e);-1===s?(n.rings.push(e),n.windings.push(r)):n.windings[s]+=r}i.rings=null,i.windings=null,i.consumedBy=n,i.leftSE.consumedBy=n.leftSE,i.rightSE.consumedBy=n.rightSE}}prevInResult(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}beforeState(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){const t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}afterState(){if(void 0!==this._afterState)return this._afterState;const t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};const e=this._afterState.rings,n=this._afterState.windings,i=this._afterState.multiPolys;for(let o=0,l=this.rings.length;o<l;o++){const t=this.rings[o],i=this.windings[o],r=e.indexOf(t);-1===r?(e.push(t),n.push(i)):n[r]+=i}const r=[],s=[];for(let o=0,l=e.length;o<l;o++){if(0===n[o])continue;const t=e[o],i=t.poly;if(-1===s.indexOf(i))if(t.isExterior)r.push(i);else{-1===s.indexOf(i)&&s.push(i);const e=r.indexOf(t.poly);-1!==e&&r.splice(e,1)}}for(let o=0,l=r.length;o<l;o++){const t=r[o].multiPoly;-1===i.indexOf(t)&&i.push(t)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;const t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(Kt.type){case"union":{const n=0===t.length,i=0===e.length;this._isInResult=n!==i;break}case"intersection":{let n,i;t.length<e.length?(n=t.length,i=e.length):(n=e.length,i=t.length),this._isInResult=i===Kt.numMultiPolys&&n<i;break}case"xor":{const n=Math.abs(t.length-e.length);this._isInResult=n%2===1;break}case"difference":{const n=t=>1===t.length&&t[0].isSubject;this._isInResult=n(t)!==n(e);break}}return this._isInResult}},Wt=class{poly;isExterior;segments;bbox;constructor(t,e,n){if(!Array.isArray(t)||0===t.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=e,this.isExterior=n,this.segments=[],"number"!==typeof t[0][0]||"number"!==typeof t[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const i=Ct.snap({x:new pt(t[0][0]),y:new pt(t[0][1])});this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};let r=i;for(let s=1,o=t.length;s<o;s++){if("number"!==typeof t[s][0]||"number"!==typeof t[s][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const e=Ct.snap({x:new pt(t[s][0]),y:new pt(t[s][1])});e.x.eq(r.x)&&e.y.eq(r.y)||(this.segments.push(Zt.fromRing(r,e,this)),e.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=e.x),e.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=e.y),e.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=e.x),e.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=e.y),r=e)}i.x.eq(r.x)&&i.y.eq(r.y)||this.segments.push(Zt.fromRing(r,i,this))}getSweepEvents(){const t=[];for(let e=0,n=this.segments.length;e<n;e++){const n=this.segments[e];t.push(n.leftSE),t.push(n.rightSE)}return t}},Jt=class{multiPoly;exteriorRing;interiorRings;bbox;constructor(t,e){if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Wt(t[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let n=1,i=t.length;n<i;n++){const e=new Wt(t[n],this,!1);e.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=e.bbox.ll.x),e.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=e.bbox.ll.y),e.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=e.bbox.ur.x),e.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=e.bbox.ur.y),this.interiorRings.push(e)}this.multiPoly=e}getSweepEvents(){const t=this.exteriorRing.getSweepEvents();for(let e=0,n=this.interiorRings.length;e<n;e++){const n=this.interiorRings[e].getSweepEvents();for(let e=0,i=n.length;e<i;e++)t.push(n[e])}return t}},Qt=class{isSubject;polys;bbox;constructor(t,e){if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"===typeof t[0][0][0]&&(t=[t])}catch(n){}this.polys=[],this.bbox={ll:{x:new pt(Number.POSITIVE_INFINITY),y:new pt(Number.POSITIVE_INFINITY)},ur:{x:new pt(Number.NEGATIVE_INFINITY),y:new pt(Number.NEGATIVE_INFINITY)}};for(let i=0,r=t.length;i<r;i++){const e=new Jt(t[i],this);e.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=e.bbox.ll.x),e.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=e.bbox.ll.y),e.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=e.bbox.ur.x),e.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=e.bbox.ur.y),this.polys.push(e)}this.isSubject=e}getSweepEvents(){const t=[];for(let e=0,n=this.polys.length;e<n;e++){const n=this.polys[e].getSweepEvents();for(let e=0,i=n.length;e<i;e++)t.push(n[e])}return t}},te=(t,...e)=>Kt.run("union",t,e),ee=(t,...e)=>Kt.run("intersection",t,e),ne=(t,...e)=>Kt.run("xor",t,e),ie=(t,...e)=>Kt.run("difference",t,e),re=Ct.set;function se(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return oe(t);case"FeatureCollection":return ue(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return he(t);default:throw new Error("unknown GeoJSON type")}}function oe(t){const e={type:"Feature"};return Object.keys(t).forEach(n=>{switch(n){case"type":case"properties":case"geometry":return;default:e[n]=t[n]}}),e.properties=le(t.properties),null==t.geometry?e.geometry=null:e.geometry=he(t.geometry),e}function le(t){const e={};return t?(Object.keys(t).forEach(n=>{const i=t[n];"object"===typeof i?null===i?e[n]=null:Array.isArray(i)?e[n]=i.map(t=>t):e[n]=le(i):e[n]=i}),e):e}function ue(t){const e={type:"FeatureCollection"};return Object.keys(t).forEach(n=>{switch(n){case"type":case"features":return;default:e[n]=t[n]}}),e.features=t.features.map(t=>oe(t)),e}function he(t){const e={type:t.type};return t.bbox&&(e.bbox=t.bbox),"GeometryCollection"===t.type?(e.geometries=t.geometries.map(t=>he(t)),e):(e.coordinates=ae(t.coordinates),e)}function ae(t){const e=t;return"object"!==typeof e[0]?e.slice():e.map(t=>ae(t))}function ce(t,e,n){var i;const r=null!=(i=null==n?void 0:n.mutate)&&i;let s=e;e&&!1===r&&(s=se(e));const o=ge(s);let l=null;return l="FeatureCollection"===t.type?fe(t):"Feature"===t.type?pe(te(t.geometry.coordinates)):pe(te(t.coordinates)),l.geometry.coordinates.forEach(function(t){o.geometry.coordinates.push(t[0])}),o}function fe(t){const e=2===t.features.length?te(t.features[0].geometry.coordinates,t.features[1].geometry.coordinates):te.apply(i,t.features.map(function(t){return t.geometry.coordinates}));return pe(e)}function pe(t){return H(t)}function ge(t){const e=[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]];let n=e;return t&&(n="Feature"===t.type?t.geometry.coordinates:t.coordinates),z(n)}var ye=ce,de={name:"MapSelect",components:{LayerControl:l.A,TextControl:u.A,UserLocationControl:w},mixins:[o.A],props:{stac:{type:Object,default:null},value:{type:Array,default:null}},data(){return{crs:"EPSG:4326",extent:this.value,dragging:!1}},computed:{projectedExtent(){return this.extent?(0,p.DI)(this.extent,this.crs,this.map.getView().getProjection()):null},help(){return this.extent?this.$t("mapping.bboxSelect.remove"):this.$t("mapping.bboxSelect.add")}},watch:{async stac(){await this.initMap()}},created(){this.$root.$on("uiLanguageChanged",()=>{})},async mounted(){await this.initMap()},methods:{async initMap(){this.map=null,await this.createMap(this.$refs.map,this.stac,!0);const t=t=>{if("singleclick"===t.type){if(!this.extent){let e=this.map.getSize().map(t=>.2*t),n=this.map.getView().calculateExtent(e),i=[n[2]-n[0],n[3]-n[1]],r=[t.coordinate[0]-i[0],t.coordinate[1]-i[1],t.coordinate[0]+i[0],t.coordinate[1]+i[1]];return this.interaction.setExtent(r),!1}(0,T.Rj)(this.projectedExtent,...t.coordinate)&&(this.interaction.setExtent(null),this.interaction.vertexOverlay_.getSource().clear(),this.interaction.vertexFeature_=null)}else if(this.interaction.handlingDownUpSequence||this.interaction.snapToVertex_(t.pixel,t.map))return!0;return(0,b.Kg)(t)};let e;if(this.interaction=new q({extent:this.projectedExtent,condition:t,boxStyle:(0,I.d1)()}),this.interaction.on("extentchanged",this.update),this.map.addInteraction(this.interaction),this.stac&&this.addMask(this.stac),this.projectedExtent)e=this.projectedExtent;else if(this.stac){const t=this.stac.getBoundingBox();t&&(e=(0,p.DI)(t,this.crs,this.map.getView().getProjection()))}e&&this.map.getView().fit(e,{padding:[50,50,50,50]})},addMask(t){if(!t||"function"!==typeof t.toGeoJSON)return;const e=t.toGeoJSON();if(!e)return;const n=(0,V.Jx)([-180,-90,180,90]),i=ye(e,n),r=(new D.A).readFeatures(i,{featureProjection:this.map.getView().getProjection()}),s=new P["default"]({source:new O["default"]({features:r}),style:new I.Ay({fill:new U.A({color:"rgba(0, 0, 0, 0.5)"})})});this.map.addLayer(s)},fixX(t){return(t+180)%360-180},fixY(t){return Math.max(-90,Math.min(90,t))},update(t){if(t.extent){this.extent=(0,p.DI)(t.extent,this.map.getView().getProjection(),this.crs);const e=[this.fixX(this.extent[0]),this.fixY(this.extent[1]),this.fixX(this.extent[2]),this.fixY(this.extent[3])];this.$emit("input",e)}else this.extent=null,this.$emit("input",null)}}},me=de,xe=(0,m.A)(me,r,s,!1,null,null,null),we=xe.exports}}]);
//# sourceMappingURL=817.936ab74f.js.map