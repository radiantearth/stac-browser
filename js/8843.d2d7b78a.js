"use strict";(self["webpackChunk_radiantearth_stac_browser"]=self["webpackChunk_radiantearth_stac_browser"]||[]).push([[8843],{8143:function(t,e,s){var i=s(11078),n=s(93474),r=s(6837),a=s(79332),h=s(4087);class o extends a.A{constructor(t,e,s){super(),s=s||{},this.tileCoord=t,this.state=e,this.key="",this.transition_=void 0===s.transition?250:s.transition,this.transitionStarts_={},this.interpolate=!!s.interpolate}changed(){this.dispatchEvent(r.A.CHANGE)}release(){this.setState(i.A.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(this.state!==i.A.EMPTY){if(this.state!==i.A.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}}load(){(0,h.b0)()}getAlpha(t,e){if(!this.transition_)return 1;let s=this.transitionStarts_[t];if(s){if(-1===s)return 1}else s=e,this.transitionStarts_[t]=s;const i=e-s+1e3/60;return i>=this.transition_?1:(0,n.a6)(i/this.transition_)}inTransition(t){return!!this.transition_&&-1!==this.transitionStarts_[t]}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}e.A=o},40190:function(t,e,s){var i=s(43938),n=s(8143),r=s(11078),a=s(68711);class h extends n.A{constructor(t,e,s,i,n,r){super(t,e,r),this.crossOrigin_=i,this.src_=s,this.key=s,this.image_=new Image,null!==i&&(this.image_.crossOrigin=i),this.unlisten_=null,this.tileLoadFunction_=n}getImage(){return this.image_}setImage(t){this.image_=t,this.state=r.A.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=r.A.ERROR,this.unlistenImage_(),this.image_=o(),this.changed()}handleImageLoad_(){const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=r.A.LOADED:this.state=r.A.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==r.A.ERROR&&(this.state=r.A.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==r.A.IDLE&&(this.state=r.A.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=(0,i.f6)(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function o(){const t=(0,a.Y)(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}e.A=h},97404:function(t,e,s){var i=s(8143),n=s(11078),r=s(68711),a=s(6837),h=s(9438),o=s(70915),l=s(61597),c=s(33513),_=s(52913),u=s(93101);class g extends i.A{constructor(t,e,s,i,r,a,h,g,d,E,A,p){super(r,n.A.IDLE,p),this.renderEdges_=void 0!==A&&A,this.pixelRatio_=h,this.gutter_=g,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=i,this.wrappedTileCoord_=a||r,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=t.canWrapX()?t.getExtent():void 0;const f=i.getTileCoordExtent(this.wrappedTileCoord_),T=this.targetTileGrid_.getExtent();let m=this.sourceTileGrid_.getExtent();const I=T?(0,o._N)(f,T):f;if(0===(0,o.UG)(I))return void(this.state=n.A.EMPTY);const R=t.getExtent();R&&(m=m?(0,o._N)(m,R):R);const L=i.getResolution(this.wrappedTileCoord_[0]),x=(0,c.aY)(t,s,I,L);if(!isFinite(x)||x<=0)return void(this.state=n.A.EMPTY);const v=void 0!==E?E:u.l;if(this.triangulation_=new _.A(t,s,I,m,x*v,L),0===this.triangulation_.getTriangles().length)return void(this.state=n.A.EMPTY);this.sourceZ_=e.getZForResolution(x);let D=this.triangulation_.calculateSourceExtent();if(m&&(t.canWrapX()?(D[1]=(0,l.qE)(D[1],m[1],m[3]),D[3]=(0,l.qE)(D[3],m[1],m[3])):D=(0,o._N)(D,m)),(0,o.UG)(D)){let s=0,i=0;t.canWrapX()&&(s=(0,o.RG)(R),i=Math.floor((D[0]-R[0])/s));const r=(0,o.QJ)(D.slice(),t,!0);r.forEach(t=>{const n=e.getTileRangeForExtentAndZ(t,this.sourceZ_);for(let e=n.minX;e<=n.maxX;e++)for(let t=n.minY;t<=n.maxY;t++){const n=d(this.sourceZ_,e,t,h);if(n){const t=i*s;this.sourceTiles_.push({tile:n,offset:t})}}++i}),0===this.sourceTiles_.length&&(this.state=n.A.EMPTY)}else this.state=n.A.EMPTY}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach(e=>{const s=e.tile;if(s&&s.getState()==n.A.LOADED){const i=this.sourceTileGrid_.getTileCoordExtent(s.tileCoord);i[0]+=e.offset,i[2]+=e.offset;const n=this.clipExtent_?.slice();n&&(n[0]+=e.offset,n[2]+=e.offset),t.push({extent:i,clipExtent:n,image:s.getImage()})}}),this.sourceTiles_.length=0,0===t.length)this.state=n.A.ERROR;else{const e=this.wrappedTileCoord_[0],s=this.targetTileGrid_.getTileSize(e),i="number"===typeof s?s:s[0],r="number"===typeof s?s:s[1],a=this.targetTileGrid_.getResolution(e),h=this.sourceTileGrid_.getResolution(this.sourceZ_),o=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=(0,c.XX)(i,r,this.pixelRatio_,h,this.sourceTileGrid_.getExtent(),a,o,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=n.A.LOADED}this.changed()}load(){if(this.state==n.A.IDLE){this.state=n.A.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:e})=>{const s=e.getState();if(s==n.A.IDLE||s==n.A.LOADING){t++;const s=(0,h.KT)(e,a.A.CHANGE,i=>{const r=e.getState();r!=n.A.LOADED&&r!=n.A.ERROR&&r!=n.A.EMPTY||((0,h.JH)(s),t--,0===t&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(s)}}),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},e,s){const i=t.getState();i==n.A.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(h.JH),this.sourcesListenerKeys_=null}release(){this.canvas_&&((0,r.Yg)(this.canvas_.getContext("2d")),c.BV.push(this.canvas_),this.canvas_=null),super.release()}}e.A=g}}]);
//# sourceMappingURL=8843.d2d7b78a.js.map