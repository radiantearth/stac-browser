"use strict";(self["webpackChunk_radiantearth_stac_browser"]=self["webpackChunk_radiantearth_stac_browser"]||[]).push([[2192,3440],{34889:function(t,e,s){function i(t){return Array.isArray(t)?Math.min(...t):t}s.d(e,{m:function(){return i}})},42192:function(t,e,s){s.r(e),s.d(e,{DECIMALS:function(){return n},DEFAULT_WMS_VERSION:function(){return i}});const i="1.3.0",n=4},83440:function(t,e,s){s.r(e),s.d(e,{ImageSourceEvent:function(){return f},ImageSourceEventType:function(){return p},default:function(){return x},defaultImageLoadFunction:function(){return D},getRequestExtent:function(){return j}});var i=s(43938),n=s(6141),r=s(66514),o=s(1685),a=s(6837),h=s(70915),u=s(61597),c=s(38599),g=s(9438),l=s(33513),_=s(34889),d=s(52913),m=s(93101);class I extends i.Ay{constructor(t,e,s,i,r,o,a){let u=t.getExtent();u&&t.canWrapX()&&(u=u.slice(),u[0]=-1/0,u[2]=1/0);let c=e.getExtent();c&&e.canWrapX()&&(c=c.slice(),c[0]=-1/0,c[2]=1/0);const g=c?(0,h._N)(s,c):s,_=(0,h.q1)(g),I=(0,l.KQ)(t,e,_,i),A=m.l,E=new d.A(t,e,g,u,I*A,i),R=E.calculateSourceExtent(),p=(0,h.Im)(R)?null:o(R,I,r),f=p?n.A.IDLE:n.A.EMPTY,L=p?p.getPixelRatio():1;super(s,i,L,f),this.targetProj_=e,this.maxSourceExtent_=u,this.triangulation_=E,this.targetResolution_=i,this.targetExtent_=s,this.sourceImage_=p,this.sourcePixelRatio_=L,this.interpolate_=a,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==n.A.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const t=this.sourceImage_.getState();if(t==n.A.LOADED){const t=(0,h.RG)(this.targetExtent_)/this.targetResolution_,e=(0,h.Oq)(this.targetExtent_)/this.targetResolution_;this.canvas_=(0,l.XX)(t,e,this.sourcePixelRatio_,(0,_.m)(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=t,this.changed()}load(){if(this.state==n.A.IDLE){this.state=n.A.LOADING,this.changed();const t=this.sourceImage_.getState();t==n.A.LOADED||t==n.A.ERROR?this.reproject_():(this.sourceListenerKey_=(0,g.KT)(this.sourceImage_,a.A.CHANGE,t=>{const e=this.sourceImage_.getState();e!=n.A.LOADED&&e!=n.A.ERROR||(this.unlistenSource_(),this.reproject_())}),this.sourceImage_.load())}}unlistenSource_(){(0,g.JH)(this.sourceListenerKey_),this.sourceListenerKey_=null}}var A=I,E=s(16444),R=s(42192);const p={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class f extends o.Ay{constructor(t,e){super(t),this.image=e}}class L extends E["default"]{constructor(t){super({attributions:t.attributions,projection:t.projection,state:t.state,interpolate:void 0===t.interpolate||t.interpolate}),this.on,this.once,this.un,this.loader=t.loader||null,this.resolutions_=void 0!==t.resolutions?t.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=!!t.loader&&0===t.loader.length,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(t){this.resolutions_=t}findNearestResolution(t){const e=this.getResolutions();if(e){const s=(0,r.FT)(e,t,0);t=e[s]}return t}getImage(t,e,s,i){const n=this.getProjection();if(!n||!i||(0,c.tI)(n,i))return n&&(i=n),this.getImageInternal(t,e,s,i);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&(0,c.tI)(this.reprojectedImage_.getProjection(),i)&&this.reprojectedImage_.getResolution()==e&&(0,h.aI)(this.reprojectedImage_.getExtent(),t))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new A(n,i,t,e,s,(t,e,s)=>this.getImageInternal(t,e,s,n),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(t,e,s,n){if(this.loader){const r=j(t,e,s,1),o=this.findNearestResolution(e);if(this.image&&(this.static_||this.wantedProjection_===n&&(this.wantedExtent_&&(0,h.ms)(this.wantedExtent_,r)||(0,h.ms)(this.image.getExtent(),r))&&(this.wantedResolution_&&(0,_.m)(this.wantedResolution_)===o||(0,_.m)(this.image.getResolution())===o)))return this.image;this.wantedProjection_=n,this.wantedExtent_=r,this.wantedResolution_=o,this.image=new i.Ay(r,o,s,this.loader),this.image.addEventListener(a.A.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(t){const e=t.target;let s;switch(e.getState()){case n.A.LOADING:this.loading=!0,s=p.IMAGELOADSTART;break;case n.A.LOADED:this.loading=!1,s=p.IMAGELOADEND;break;case n.A.ERROR:this.loading=!1,s=p.IMAGELOADERROR;break;default:return}this.hasListener(s)&&this.dispatchEvent(new f(s,e))}}function D(t,e){t.getImage().src=e}function j(t,e,s,i){const n=e/s,r=(0,h.q1)(t),o=(0,u.mk)((0,h.RG)(t)/n,R.DECIMALS),a=(0,u.mk)((0,h.Oq)(t)/n,R.DECIMALS),c=(0,u.mk)((i-1)*o/2,R.DECIMALS),g=o+2*c,l=(0,u.mk)((i-1)*a/2,R.DECIMALS),_=a+2*l;return(0,h.Bg)(r,n,0,[g,_])}var x=L}}]);
//# sourceMappingURL=3440.61042afc.js.map