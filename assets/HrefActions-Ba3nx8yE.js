const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AuthSchemeItem-k4JQIpFg.js","assets/BListGroupItem.vue_vue_type_script_setup_true_lang-J0Ydbiva-BRPL-cPu.js","assets/index-C2OSS7vO.js","assets/utils-UTZ1_q7B.js","assets/_commonjsHelpers-CE1G-McA.js","assets/I18N-DlIXJTel.js","assets/index-tJa7Rfc7.css","assets/BBadge.vue_vue_type_script_setup_true_lang-D9DEOOtU-BqHbjPbK.js","assets/ConditionalWrapper.vue_vue_type_script_lang-IX_NpHH--CnflwMIL.js","assets/AuthSchemeItem-CinCcr9j.css","assets/bootstrap-vue-next-wyh_H0ie.js","assets/BOffcanvas.vue_vue_type_script_setup_true_lang-BbXmU_5z-DTLrr-xq.js","assets/BAccordion.vue_vue_type_script_setup_true_lang-Ccx3zW5a-DVwXFho3.js","assets/BTabs.vue_vue_type_script_setup_true_lang-CU4B0ph2-BVjdhC_6.js","assets/BCollapse.vue_vue_type_script_setup_true_lang-BUisG8-R-Cy7Eq-78.js","assets/BTable.vue_vue_type_script_setup_true_lang-D6ymr5i1-CFVFhPGu.js","assets/debounce-BHqBzJ1a-DFHHvn_e.js","assets/BCard.vue_vue_type_script_setup_true_lang-9RhyvL8I-CweaJu3U.js","assets/BCardText.vue_vue_type_script_setup_true_lang-SRGbviaO-D669fZXZ.js","assets/BDropdownText.vue_vue_type_script_setup_true_lang-Cm6QYE9x-BjJRUWRv.js","assets/BForm.vue_vue_type_script_setup_true_lang-u44ElAm9-DojAJPWB.js","assets/BFormSelect.vue_vue_type_script_setup_true_lang-djrVhugk-Dm4MgIjS.js","assets/useStateClass-BGbSLWFN-B4NMF7T0.js","assets/BFormGroup.vue_vue_type_script_setup_true_lang-RIWLdYTY-BFR4EtPG.js","assets/BFormCheckboxGroup.vue_vue_type_script_setup_true_lang-Dx_mpGFE-Bts64D_K.js","assets/BFormRadioGroup.vue_vue_type_script_setup_true_lang-DaMHx4U3-CeRnVsH2.js","assets/BFormInput.vue_vue_type_script_setup_true_lang-DRDhfD8d-DdNiux5T.js","assets/BInputGroupText.vue_vue_type_script_setup_true_lang-BBN5F0A4-DedQgdco.js","assets/CopyButton-CNl1qWI4.js","assets/StreamSaver-CKXy_aoG.js"])))=>i.map(i=>d[i]);
import{a4 as S,n as o,B as m,y as h,cB as d,bk as j,cX as q,cL as N,bu as P,cY as G,br as E,bs as Q,bt as C,bl as k,p as u,q as f,_ as Y,L as x,cZ as J,G as l,H as y,K as b,v as B,c_ as W,aY as X,I as T,ax as D,F as K,b6 as Z}from"./index-C2OSS7vO.js";import{a as tt}from"./BListGroupItem.vue_vue_type_script_setup_true_lang-J0Ydbiva-BRPL-cPu.js";import et from"./Description-Dg4lhaQI.js";import{U as n,k as st,j as A,r as rt,v as ot,w as it}from"./utils-UTZ1_q7B.js";const nt={viewBox:"0 0 16 16",width:"1.2em",height:"1.2em"};function at(e,t){return o(),m("svg",nt,[...t[0]||(t[0]=[h("g",{fill:"currentColor"},[h("path",{d:"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"}),h("path",{d:"M8 5.5a2.5 2.5 0 1 0 0 5a2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0a3.5 3.5 0 0 1-7 0"})],-1)])])}const lt=S({name:"bi-eye",render:at}),ut={viewBox:"0 0 16 16",width:"1.2em",height:"1.2em"};function ct(e,t){return o(),m("svg",ut,[...t[0]||(t[0]=[h("g",{fill:"currentColor"},[h("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"}),h("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"})],-1)])])}const ht=S({name:"bi-download",render:ct}),dt={viewBox:"0 0 16 16",width:"1.2em",height:"1.2em"};function pt(e,t){return o(),m("svg",dt,[...t[0]||(t[0]=[h("g",{fill:"currentColor","fill-rule":"evenodd"},[h("path",{d:"M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5"}),h("path",{d:"M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0z"})],-1)])])}const $=S({name:"bi-box-arrow-up-right",render:pt});class I{constructor(t,s){this.id=t,this.component=s}get btnOptions(){let t;return this.uri instanceof n?t=this.uri.toString():typeof this.uri=="string"&&(t=this.uri),t?{href:t,target:"_blank"}:{}}get onClick(){return()=>{}}get uri(){return null}get show(){return!1}get icon(){return $}get text(){return d.global.t("open")}}class v extends I{constructor(t,s,i){super(i,s),this.asset=t}}const ft=["application/3dtiles+json"];let mt=class extends v{get show(){return this.component.isBrowserProtocol&&ft.includes(this.asset.type)}get uri(){let t=new n("https://sandcastle.cesium.com/standalone.html");const i={html:`
        <style> @import url(../templates/bucket.css); </style>
        <div id="cesiumContainer" class="fullSize"></div> 
      `,code:`
        const viewer = new Cesium.Viewer("cesiumContainer", {
          terrain: Cesium.Terrain.fromWorldTerrain(),
        });

        try {
          const tileset = await Cesium.Cesium3DTileset.fromUrl('${this.component.href}');
          viewer.scene.primitives.add(tileset);
          viewer.zoomTo(tileset);
        } catch (error) {
          console.log('Error loading tileset');
        } 
      `.replaceAll("        ","")},c=btoa(JSON.stringify(i));return t.addQuery("code",c),t}get text(){return d.global.t("actions.openIn",{service:"Cesium Sandcastle"})}};class gt extends v{get show(){return this.component.isBrowserProtocol&&(this.asset.type==="application/vnd.laszip+copc"||n(this.asset.href).filename()=="ept.json")}get uri(){let t=new n("https://viewer.copc.io");return t.addQuery("copc",this.component.href),t}get text(){return d.global.t("actions.openIn",{service:"copc.io"})}}const wt=["model/gltf-binary","model/gltf+json","application/fbx"],_t=["obj","ply","fbx","glb","gltf"];class yt extends v{get show(){const t=n(this.asset.href).suffix();return this.component.isBrowserProtocol&&(wt.includes(this.asset.type)||_t.some(s=>t===s))}get uri(){let t=new n("https://f3d.app/viewer");return t.addQuery("model",this.component.href),t=t.toString().replace("?","#"),t}get text(){return d.global.t("actions.openIn",{service:"f3d.app"})}}const bt=["model/gltf-binary","model/gltf+json","application/fbx"],vt=["obj","ply","fbx","glb","gltf","stl","usdz"];class Pt extends v{get show(){const t=n(this.asset.href).suffix();return this.component.isBrowserProtocol&&(bt.includes(this.asset.type)||vt.some(s=>t===s))}get uri(){let t=new n("https://threepipe.org/examples/tweakpane-editor");return t.addQuery("model",this.component.href),t}get text(){return d.global.t("actions.openIn",{service:"ThreePipe"})}}class xt extends v{get show(){return this.component.isBrowserProtocol&&st==this.asset.type}get uri(){const t=new n("https://geojson.io"),s=encodeURIComponent(this.component.href);return t.fragment(`data=data:text/x-url,${s}`),t}get text(){return d.global.t("actions.openIn",{service:"geojson.io"})}}const Tt=["application/vnd.pmtiles"];let Ct=class extends v{get show(){return this.component.isBrowserProtocol&&(Tt.includes(this.asset.type)||n(this.asset.href).suffix()=="pmtiles")}get uri(){let t=new n("https://pmtiles.io/");return t.addQuery("url",this.component.href),t}get text(){return d.global.t("actions.openIn",{service:"Protomaps"})}};const kt={Cesium:mt,CopcViewer:gt,F3D:yt,ThreePipe:Pt,GeoJsonIo:xt,Protomaps:Ct};class O extends I{constructor(t,s,i){super(i,s),this.link=t}get btnOptions(){let t=super.btnOptions;return t.rel=this.link.rel,t}}class At extends O{get show(){return this.link.rel==="3d-tiles"}get uri(){let t=new n("https://sandcastle.cesium.com/standalone.html");const i={html:`
        <style> @import url(../templates/bucket.css); </style>
        <div id="cesiumContainer" class="fullSize"></div> 
      `,code:`
        const viewer = new Cesium.Viewer("cesiumContainer", {
          terrain: Cesium.Terrain.fromWorldTerrain(),
        });

        try {
          const tileset = await Cesium.Cesium3DTileset.fromUrl('${this.link.href}');
          viewer.scene.primitives.add(tileset);
          viewer.zoomTo(tileset);
        } catch (error) {
          console.log('Error loading tileset');
        } 
      `.replaceAll("        ","")},c=btoa(JSON.stringify(i));return t.addQuery("code",c),t}get text(){return d.global.t("actions.openIn",{service:"Cesium Sandcastle"})}}class St extends O{get show(){return this.link.rel==="pmtiles"}get uri(){let t=new n("https://pmtiles.io/");return t.addQuery("url",this.link.href),t}get text(){return d.global.t("actions.openIn",{service:"Protomaps"})}}const Et={Cesium:At,Protomaps:St};let Bt=0;const Dt={name:"HrefActions",components:{AuthSchemeItem:C(()=>P(()=>import("./AuthSchemeItem-k4JQIpFg.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))),BPopover:C(()=>P(()=>import("./bootstrap-vue-next-wyh_H0ie.js"),__vite__mapDeps([10,2,3,4,5,6,11,12,13,14,7,8,15,16,17,18,19,20,21,22,23,24,25,26,27,1])).then(e=>e.BPopover)),CopyButton:C(()=>P(()=>import("./CopyButton-CNl1qWI4.js"),__vite__mapDeps([28,2,3,4,5,6]))),Description:et},props:{data:{type:Object,required:!0},isAsset:{type:Boolean,default:!1},vertical:{type:Boolean,default:!1},size:{type:String,default:"md"},shown:{type:Boolean,default:!1},auth:{type:Array,default:()=>[]}},emits:["show"],data(){return{id:Bt++,loading:!1}},computed:{...Q(["pathPrefix","requestHeaders","buildTileUrlTemplate","useTileLayerAsFallback"]),...E(["getRequestUrl"]),...E("auth",["isLoggedIn"]),requiresAuth(){return!this.isLoggedIn&&this.auth.length>0},tileRendererType(){return this.buildTileUrlTemplate&&!this.useTileLayerAsFallback?"server":"client"},actions(){return Object.entries(this.isAsset?kt:Et).map(([e,t])=>new t(this.data,this,e)).filter(e=>e.show)},canShow(){if(typeof this.data?.type!="string")return!1;if(this.tileRendererType==="server"&&ot.includes(this.data?.type))return!0;if(this.isBrowserProtocol){if(it.includes(this.data?.type))return!0}else return!1;return!1},hasShowButton(){return this.isAsset&&this.canShow&&!this.shown},hasDownloadButton(){return this.isAsset&&this.isBrowserProtocol},downloadEvents(){return this.hasDownloadButton&&this.useAltDownloadMethod?{click:async e=>{e.preventDefault(),this.altDownload()}}:{}},localFilename(){return typeof this.data["file:local_path"]=="string"?n(this.data["file:local_path"]).filename():null},downloadProps(){if(this.hasDownloadButton&&!this.useAltDownloadMethod){const e={href:this.href,target:"_blank"};return this.browserCanOpenFile||(e.download=this.localFilename||this.parsedHref.filename()),e}return{}},useAltDownloadMethod(){return!this.isBrowserProtocol||!window.isSecureContext?!1:typeof this.data.method=="string"&&this.data.method.toUpperCase()!=="GET"?!0:A.size(this.data.headers)>0||A.size(this.requestHeaders)>0},protocol(){if(typeof this.href=="string"&&this.href){let e=this.href.match(/^(\w+):\/\//);if(e)return e[1].toLowerCase()}return null},isBrowserProtocol(){return!this.protocol||rt.includes(this.protocol)},isThumbnail(){return this.isAsset?this.data.isPreview()&&this.data.canBrowserDisplayImage():this.data.rel==="preview"&&this.data.canBrowserDisplayImage()},href(){return typeof this.data.href!="string"?null:this.getRequestUrl(this.data.getAbsoluteUrl())},parsedHref(){return n(this.href)},from(){return this.protocolName(this.protocol)},browserCanOpenFile(){if(this.useAltDownloadMethod)return!1;if(this.data.canBrowserDisplayImage())return!0;if(typeof this.data?.type=="string")switch(this.data.type.toLowerCase()){case"text/html":case"application/xhtml+xml":case"text/plain":case"application/pdf":return!0}return!1},buttonText(){if(this.browserCanOpenFile&&this.isBrowserProtocol)return this.$t("open");let e=!this.isBrowserProtocol&&this.from?"withSource":"generic";return this.$t(`assets.download.${e}`,{source:this.from})},copyButtonText(){let e=!this.isBrowserProtocol&&this.from?"withSource":"generic";return this.$t(`assets.copyUrl.${e}`,{source:this.from})}},methods:{async altDownload(){window.isSecureContext||(window.location.href=this.href);try{this.loading=!0;const e=(await P(async()=>{const{default:a}=await import("./StreamSaver-CKXy_aoG.js").then(_=>_.S);return{default:a}},__vite__mapDeps([29,4]))).default,t=n(window.origin.toString());t.path(A.removeTrailingSlash(this.pathPrefix)+"/mitm.html"),e.mitm=t.toString();const s=Object.assign({},this.data,{href:this.href}),i=G(this.$store,s),c=i.url;delete i.url,typeof i.data<"u"&&(i.body=i.data,delete i.data);const r=await fetch(c,i);if(r.status>=400){let a;switch(r.status){case 401:a=this.$t("errors.unauthorized");break;case 403:a=this.$t("errors.authFailed");break;case 404:a=this.$t("errors.notFound");break;case 500:a=this.$t("errors.serverError");break;default:a=this.$t("errors.networkError");break}throw new Error(a)}let w=this.localFilename;if(!this.localFilename){const a=r.headers.get("content-disposition");if(typeof a=="string"){const _=a.match(/filename=(?:"|)([^"]+)(?:"|)(?:;|$)/);_&&(w=_[1])}}w||(w=this.parsedHref.filename());const g=e.createWriteStream(w);window.addEventListener("unload",()=>{this.loading&&g.abort()}),window.addEventListener("beforeunload",a=>{this.loading&&a.preventDefault()}),await r.body.pipeTo(g)}catch(e){if(e instanceof DOMException&&e.name==="AbortError")return;this.$store.commit("showGlobalError",{error:e})}finally{this.loading=!1}},protocolName(e){if(typeof e!="string")return"";switch(e.toLowerCase()){case"s3":try{const t=`protocol.s3.${this.parsedHref.domain()}`;if(this.$te(t))return this.$t(t)}catch{}return this.$t("protocol.s3.default");case"abfs":case"abfss":return this.$t("protocol.azure");case"gcs":return this.$t("protocol.gcs");case"ftp":return this.$t("protocol.ftp");case"oss":return this.$t("protocol.oss");case"file":return this.$t("protocol.file")}return""},show(){const e=new N(this.data,this.data.getKey(),this.data.getContext());e.href=this.href,this.$emit("show",e)},handleAuthButton(){this.auth.length===1&&this.startAuth(this.auth[0])},async startAuth(e){if(q.isSupported(e,this.$store.state))await this.$store.dispatch("config",{authConfig:e}),await this.$store.dispatch("auth/requestLogin");else{const t=this.$t(`authentication.schemeTypes.${e.type}`,e),s=this.$t("authentication.unsupportedLong",{method:t});this.$store.commit("showGlobalError",{error:new Error(s),message:this.$t("authentication.unsupported")})}}}};function $t(e,t,s,i,c,r){const w=J,g=Y,a=X,_=$,L=ht,R=k("CopyButton"),U=lt,F=Z,M=k("AuthSchemeItem"),z=tt,H=k("b-popover");return o(),m("div",null,[r.href?(o(),u(F,{key:0,class:"actions",vertical:s.vertical,size:s.size},{default:f(()=>[r.requiresAuth?(o(),u(g,{key:0,variant:"danger",tag:"a",tabindex:"0",id:`popover-href-${c.id}-btn`,onClick:r.handleAuthButton},{default:f(()=>[x(w),l(" "+y(e.$t("authentication.required")),1)]),_:1},8,["id","onClick"])):b("",!0),t[1]||(t[1]=l()),r.hasDownloadButton?(o(),u(g,B({key:1,disabled:r.requiresAuth,variant:"primary"},r.downloadProps,W(r.downloadEvents)),{default:f(()=>[c.loading?(o(),u(a,{key:0,small:"",variant:"light"})):r.browserCanOpenFile?(o(),u(_,{key:1})):(o(),u(L,{key:2})),l(" "+y(r.buttonText),1)]),_:1},16,["disabled"])):b("",!0),t[2]||(t[2]=l()),x(R,{variant:"primary",copyText:r.href,title:r.href},{default:f(()=>[l(y(r.copyButtonText),1)]),_:1},8,["copyText","title"]),t[3]||(t[3]=l()),r.hasShowButton?(o(),u(g,{key:2,onClick:r.show,variant:"primary"},{default:f(()=>[x(U,{class:"me-1"}),t[0]||(t[0]=l()),r.isThumbnail?(o(),m(T,{key:0},[l(y(e.$t("assets.showThumbnail")),1)],64)):(o(),m(T,{key:1},[l(y(e.$t("assets.showOnMap")),1)],64))]),_:1},8,["onClick"])):b("",!0),t[4]||(t[4]=l()),(o(!0),m(T,null,D(r.actions,p=>(o(),u(g,B({key:p.id,variant:"primary"},{ref_for:!0},p.btnOptions,{onClick:p.onClick}),{default:f(()=>[p.icon?(o(),u(K(p.icon),{key:0,class:"me-1"})):b("",!0),l(" "+y(p.text),1)]),_:2},1040,["onClick"]))),128))]),_:1},8,["vertical","size"])):b("",!0),t[5]||(t[5]=l()),s.auth.length>1?(o(),u(H,{key:1,click:"",focus:"",id:`popover-href-${c.id}`,class:"href-auth-methods",target:`popover-href-${c.id}-btn`,title:e.$t("authentication.chooseMethod"),"teleport-to":"#stac-browser","boundary-padding":10},{default:f(()=>[x(z,null,{default:f(()=>[(o(!0),m(T,null,D(s.auth,(p,V)=>(o(),u(M,{key:V,method:p,onAuthenticate:r.startAuth},null,8,["method","onAuthenticate"]))),128))]),_:1})]),_:1},8,["id","target","title"])):b("",!0)])}const Mt=j(Dt,[["render",$t]]);export{Mt as H};
//# sourceMappingURL=HrefActions-Ba3nx8yE.js.map
