{"version":3,"file":"webimage-DBgUwIbt.js","sources":["../../node_modules/geotiff/dist-module/compression/webimage.js"],"sourcesContent":["import BaseDecoder from './basedecoder.js';\n\n/**\n * class WebImageDecoder\n *\n * This decoder uses the browsers image decoding facilities to read image\n * formats like WebP when supported.\n */\nexport default class WebImageDecoder extends BaseDecoder {\n  constructor() {\n    super();\n    if (typeof createImageBitmap === 'undefined') {\n      throw new Error('Cannot decode WebImage as `createImageBitmap` is not available');\n    } else if (typeof document === 'undefined' && typeof OffscreenCanvas === 'undefined') {\n      throw new Error('Cannot decode WebImage as neither `document` nor `OffscreenCanvas` is not available');\n    }\n  }\n\n  async decode(fileDirectory, buffer) {\n    const blob = new Blob([buffer]);\n    const imageBitmap = await createImageBitmap(blob);\n\n    let canvas;\n    if (typeof document !== 'undefined') {\n      canvas = document.createElement('canvas');\n      canvas.width = imageBitmap.width;\n      canvas.height = imageBitmap.height;\n    } else {\n      canvas = new OffscreenCanvas(imageBitmap.width, imageBitmap.height);\n    }\n\n    const ctx = canvas.getContext('2d');\n    ctx.drawImage(imageBitmap, 0, 0);\n\n    // TODO: check how many samples per pixel we have, and return RGB/RGBA accordingly\n    // it seems like GDAL always encodes via RGBA which does not require a translation\n\n    return ctx.getImageData(0, 0, imageBitmap.width, imageBitmap.height).data.buffer;\n  }\n}\n"],"names":["WebImageDecoder","BaseDecoder","fileDirectory","buffer","blob","imageBitmap","canvas","ctx"],"mappings":"8CAQe,MAAMA,UAAwBC,CAAY,CACvD,aAAc,CAEZ,GADA,MAAK,EACD,OAAO,kBAAsB,IAC/B,MAAM,IAAI,MAAM,gEAAgE,EAC3E,GAAI,OAAO,SAAa,KAAe,OAAO,gBAAoB,IACvE,MAAM,IAAI,MAAM,qFAAqF,CAEzG,CAEA,MAAM,OAAOC,EAAeC,EAAQ,CAClC,MAAMC,EAAO,IAAI,KAAK,CAACD,CAAM,CAAC,EACxBE,EAAc,MAAM,kBAAkBD,CAAI,EAEhD,IAAIE,EACA,OAAO,SAAa,KACtBA,EAAS,SAAS,cAAc,QAAQ,EACxCA,EAAO,MAAQD,EAAY,MAC3BC,EAAO,OAASD,EAAY,QAE5BC,EAAS,IAAI,gBAAgBD,EAAY,MAAOA,EAAY,MAAM,EAGpE,MAAME,EAAMD,EAAO,WAAW,IAAI,EAClC,OAAAC,EAAI,UAAUF,EAAa,EAAG,CAAC,EAKxBE,EAAI,aAAa,EAAG,EAAGF,EAAY,MAAOA,EAAY,MAAM,EAAE,KAAK,MAC5E,CACF","x_google_ignoreList":[0]}