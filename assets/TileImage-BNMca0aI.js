import{I as G,R as y}from"./Tile-Bg7ozswn.js";import{W as h,g,f,E as p,y as C,b8 as I}from"./GeoJSON-BoRJWQIG.js";import{g as R}from"./tilecoord-DBpIeO-O.js";import{g as w}from"./Tile-BqAKaOfQ.js";import b from"./UrlTile-CjdLFnBY.js";import"./Tile-Dd8tR1PC.js";import"./common-CLWpeXJR.js";import"./index-B3F0456b.js";import"./utils-BXWzvTjY.js";import"./_commonjsHelpers-CE1G-McA.js";import"./I18N-DlIXJTel.js";import"./BFormRadioGroup.vue_vue_type_script_setup_true_lang-DaMHx4U3-DO3czC2y.js";import"./useStateClass-BGbSLWFN-eI-Q6wqs.js";import"./ConditionalWrapper.vue_vue_type_script_lang-IX_NpHH--5aly-L7g.js";import"./TileGrid-r8UQ2tK6.js";import"./TileRange-2Tc-Ry00.js";import"./tileurlfunction-naLPssJX.js";import"./uri-CWE-Y_zl.js";import"./TileEventType-CTN_nmJ7.js";class $ extends b{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:v,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate!==void 0?t.interpolate:!0,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=t.crossOrigin!==void 0?t.crossOrigin:null,this.tileClass=t.tileClass!==void 0?t.tileClass:G,this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(t){return this.getProjection()&&t&&!h(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getTileGridForProjection(t){const r=this.getProjection();if(this.tileGrid&&(!r||h(r,t)))return this.tileGrid;const i=g(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=w(t)),this.tileGridForProjection[i]}createTile_(t,r,i,n,e,o){const s=[t,r,i],l=this.getTileCoordForTileUrlFunction(s,e),c=l?this.tileUrlFunction(l,n,e):void 0,a=new this.tileClass(s,c!==void 0?f.IDLE:f.EMPTY,c!==void 0?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return a.key=o,a.addEventListener(p.CHANGE,this.handleTileChange.bind(this)),a}getTile(t,r,i,n,e,o){const s=this.getProjection();if(!s||!e||h(s,e))return this.getTileInternal(t,r,i,n,s||e);const l=[t,r,i],c=this.getKey(),a=this.getTileGridForProjection(s),T=this.getTileGridForProjection(e),m=this.getTileCoordForTileUrlFunction(l,e),u=new y(s,a,e,T,l,m,this.getTilePixelRatio(n),this.getGutter(),(F,j,P,E)=>this.getTileInternal(F,j,P,E,s,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return u.key=c,u}getTileInternal(t,r,i,n,e,o){const s=this.getKey(),l=R(this,s,t,r,i);if(o&&o.containsKey(l))return o.get(l);const c=this.createTile_(t,r,i,n,e,s);return o?.set(l,c),c}setRenderReprojectionEdges(t){this.renderReprojectionEdges_!=t&&(this.renderReprojectionEdges_=t,this.changed())}setTileGridForProjection(t,r){const i=C(t);if(i){const n=g(i);n in this.tileGridForProjection||(this.tileGridForProjection[n]=r)}}}function v(d,t){if(I){const r=d.getCrossOrigin();let i="same-origin",n="same-origin";r==="anonymous"||r===""?(i="cors",n="omit"):r==="use-credentials"&&(i="cors",n="include"),fetch(t,{mode:i,credentials:n}).then(e=>{if(!e.ok)throw new Error(`HTTP ${e.status}`);return e.blob()}).then(e=>createImageBitmap(e)).then(e=>{const o=d.getImage();o.width=e.width,o.height=e.height,o.getContext("2d").drawImage(e,0,0),e.close?.(),o.dispatchEvent(new Event("load"))}).catch(()=>{d.getImage().dispatchEvent(new Event("error"))});return}d.getImage().src=t}export{$ as default,v as defaultTileLoadFunction};
//# sourceMappingURL=TileImage-BNMca0aI.js.map
