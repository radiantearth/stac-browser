{"version":3,"file":"uri-BxyrIhx_.js","sources":["../../node_modules/ol/uri.js"],"sourcesContent":["/**\n * @module ol/uri\n */\n\nimport {modulo} from './math.js';\nimport {hashZXY} from './tilecoord.js';\n\n/**\n * Appends query parameters to a URI.\n *\n * @param {string} uri The original URI, which may already have query data.\n * @param {!Object} params An object where keys are URI-encoded parameter keys,\n *     and the values are arbitrary types or arrays.\n * @return {string} The new URI.\n */\nexport function appendParams(uri, params) {\n  /** @type {Array<string>} */\n  const keyParams = [];\n  // Skip any null or undefined parameter values\n  Object.keys(params).forEach(function (k) {\n    if (params[k] !== null && params[k] !== undefined) {\n      keyParams.push(k + '=' + encodeURIComponent(params[k]));\n    }\n  });\n  const qs = keyParams.join('&');\n  // remove any trailing ? or &\n  uri = uri.replace(/[?&]$/, '');\n  // append ? or & depending on whether uri has existing parameters\n  uri += uri.includes('?') ? '&' : '?';\n  return uri + qs;\n}\n\nconst zRegEx = /\\{z\\}/g;\nconst xRegEx = /\\{x\\}/g;\nconst yRegEx = /\\{y\\}/g;\nconst dashYRegEx = /\\{-y\\}/g;\n\n/**\n * @param {string} template The URL template.  Should have `{x}`, `{y}`, and `{z}` placeholders.  If\n * the template has a `{-y}` placeholder, the `maxY` parameter must be supplied.\n * @param {number} z The tile z coordinate.\n * @param {number} x The tile x coordinate.\n * @param {number} y The tile y coordinate.\n * @param {number} [maxY] The maximum y coordinate at the given z level.\n * @return {string} The URL.\n */\nexport function renderXYZTemplate(template, z, x, y, maxY) {\n  return template\n    .replace(zRegEx, z.toString())\n    .replace(xRegEx, x.toString())\n    .replace(yRegEx, y.toString())\n    .replace(dashYRegEx, function () {\n      if (maxY === undefined) {\n        throw new Error(\n          'If the URL template has a {-y} placeholder, the grid extent must be known',\n        );\n      }\n      return (maxY - y).toString();\n    });\n}\n\n/**\n * @param {Array<string>} urls List of URLs.\n * @param {number} z The tile z coordinate.\n * @param {number} x The tile x coordinate.\n * @param {number} y The tile y coordinate.\n * @return {string} The chosen URL.\n */\nexport function pickUrl(urls, z, x, y) {\n  const hash = hashZXY(z, x, y);\n  const index = modulo(hash, urls.length);\n  return urls[index];\n}\n\n/**\n * @param {string} url URL.\n * @return {Array<string>} Array of urls.\n */\nexport function expandUrl(url) {\n  const urls = [];\n  let match = /\\{([a-z])-([a-z])\\}/.exec(url);\n  if (match) {\n    // char range\n    const startCharCode = match[1].charCodeAt(0);\n    const stopCharCode = match[2].charCodeAt(0);\n    let charCode;\n    for (charCode = startCharCode; charCode <= stopCharCode; ++charCode) {\n      urls.push(url.replace(match[0], String.fromCharCode(charCode)));\n    }\n    return urls;\n  }\n  match = /\\{(\\d+)-(\\d+)\\}/.exec(url);\n  if (match) {\n    // number range\n    const stop = parseInt(match[2], 10);\n    for (let i = parseInt(match[1], 10); i <= stop; i++) {\n      urls.push(url.replace(match[0], i.toString()));\n    }\n    return urls;\n  }\n  urls.push(url);\n  return urls;\n}\n"],"names":["appendParams","uri","params","keyParams","k","qs","zRegEx","xRegEx","yRegEx","dashYRegEx","renderXYZTemplate","template","z","x","y","maxY","pickUrl","urls","hash","hashZXY","index","modulo","expandUrl","url","match","startCharCode","stopCharCode","charCode","stop","i"],"mappings":"uFAeO,SAASA,EAAaC,EAAKC,EAAQ,CAExC,MAAMC,EAAY,CAAA,EAElB,OAAO,KAAKD,CAAM,EAAE,QAAQ,SAAUE,EAAG,CACnCF,EAAOE,CAAC,IAAM,MAAQF,EAAOE,CAAC,IAAM,QACtCD,EAAU,KAAKC,EAAI,IAAM,mBAAmBF,EAAOE,CAAC,CAAC,CAAC,CAE1D,CAAC,EACD,MAAMC,EAAKF,EAAU,KAAK,GAAG,EAE7B,OAAAF,EAAMA,EAAI,QAAQ,QAAS,EAAE,EAE7BA,GAAOA,EAAI,SAAS,GAAG,EAAI,IAAM,IAC1BA,EAAMI,CACf,CAEA,MAAMC,EAAS,SACTC,EAAS,SACTC,EAAS,SACTC,EAAa,UAWZ,SAASC,EAAkBC,EAAUC,EAAGC,EAAGC,EAAGC,EAAM,CACzD,OAAOJ,EACJ,QAAQL,EAAQM,EAAE,SAAQ,CAAE,EAC5B,QAAQL,EAAQM,EAAE,SAAQ,CAAE,EAC5B,QAAQL,EAAQM,EAAE,SAAQ,CAAE,EAC5B,QAAQL,EAAY,UAAY,CAC/B,GAAIM,IAAS,OACX,MAAM,IAAI,MACR,2EACV,EAEM,OAAQA,EAAOD,GAAG,SAAQ,CAC5B,CAAC,CACL,CASO,SAASE,EAAQC,EAAML,EAAGC,EAAGC,EAAG,CACrC,MAAMI,EAAOC,EAAQP,EAAGC,EAAGC,CAAC,EACtBM,EAAQC,EAAOH,EAAMD,EAAK,MAAM,EACtC,OAAOA,EAAKG,CAAK,CACnB,CAMO,SAASE,EAAUC,EAAK,CAC7B,MAAMN,EAAO,CAAA,EACb,IAAIO,EAAQ,sBAAsB,KAAKD,CAAG,EAC1C,GAAIC,EAAO,CAET,MAAMC,EAAgBD,EAAM,CAAC,EAAE,WAAW,CAAC,EACrCE,EAAeF,EAAM,CAAC,EAAE,WAAW,CAAC,EAC1C,IAAIG,EACJ,IAAKA,EAAWF,EAAeE,GAAYD,EAAc,EAAEC,EACzDV,EAAK,KAAKM,EAAI,QAAQC,EAAM,CAAC,EAAG,OAAO,aAAaG,CAAQ,CAAC,CAAC,EAEhE,OAAOV,CACT,CAEA,GADAO,EAAQ,kBAAkB,KAAKD,CAAG,EAC9BC,EAAO,CAET,MAAMI,EAAO,SAASJ,EAAM,CAAC,EAAG,EAAE,EAClC,QAASK,EAAI,SAASL,EAAM,CAAC,EAAG,EAAE,EAAGK,GAAKD,EAAMC,IAC9CZ,EAAK,KAAKM,EAAI,QAAQC,EAAM,CAAC,EAAGK,EAAE,SAAQ,CAAE,CAAC,EAE/C,OAAOZ,CACT,CACA,OAAAA,EAAK,KAAKM,CAAG,EACNN,CACT","x_google_ignoreList":[0]}