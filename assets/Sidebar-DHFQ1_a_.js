import{a4 as m,n as a,B as n,y as s,bk as V,bp as _,bv as H,bw as $,br as B,bs as M,bl as c,bx as q,x,p as r,q as l,L as h,_ as z,G as u,H as f,A as D,I as y,aY as j,ax as N,K as w,aj as O}from"./index-B3F0456b.js";import{L as G}from"./Loading-By1YVxZb.js";import{d as L}from"./utils-BXWzvTjY.js";import{_ as I}from"./BOffcanvas.vue_vue_type_script_setup_true_lang-BbXmU_5z-Dk7fMMoe.js";import"./I18N-DlIXJTel.js";import"./_commonjsHelpers-CE1G-McA.js";const E={viewBox:"0 0 16 16",width:"1.2em",height:"1.2em"};function F(e,t){return a(),n("svg",E,[...t[0]||(t[0]=[s("path",{fill:"currentColor","fill-rule":"evenodd",d:"M1 11.5a.5.5 0 0 0 .5.5h11.793l-3.147 3.146a.5.5 0 0 0 .708.708l4-4a.5.5 0 0 0 0-.708l-4-4a.5.5 0 0 0-.708.708L13.293 11H1.5a.5.5 0 0 0-.5.5m14-7a.5.5 0 0 1-.5.5H2.707l3.147 3.146a.5.5 0 1 1-.708.708l-4-4a.5.5 0 0 1 0-.708l4-4a.5.5 0 1 1 .708.708L2.707 4H14.5a.5.5 0 0 1 .5.5"},null,-1)])])}const K=m({name:"bi-arrow-left-right",render:F}),R={viewBox:"0 0 16 16",width:"1.2em",height:"1.2em"};function Y(e,t){return a(),n("svg",R,[...t[0]||(t[0]=[s("g",{fill:"currentColor"},[s("path",{d:"M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5zm-3 0A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5z"}),s("path",{d:"M4.5 12.5A.5.5 0 0 1 5 12h3a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5m0-2A.5.5 0 0 1 5 10h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5m1.639-3.708l1.33.886l1.854-1.855a.25.25 0 0 1 .289-.047l1.888.974V8.5a.5.5 0 0 1-.5.5H5a.5.5 0 0 1-.5-.5V8s1.54-1.274 1.639-1.208M6.25 6a.75.75 0 1 0 0-1.5a.75.75 0 0 0 0 1.5"})],-1)])])}const J=m({name:"bi-file-earmark-richtext",render:Y}),Q={viewBox:"0 0 16 16",width:"1.2em",height:"1.2em"};function W(e,t){return a(),n("svg",Q,[...t[0]||(t[0]=[s("g",{fill:"currentColor"},[s("path",{d:"m.5 3l.04.87a2 2 0 0 0-.342 1.311l.637 7A2 2 0 0 0 2.826 14H9v-1H2.826a1 1 0 0 1-.995-.91l-.637-7A1 1 0 0 1 2.19 4h11.62a1 1 0 0 1 .996 1.09L14.54 8h1.005l.256-2.819A2 2 0 0 0 13.81 3H9.828a2 2 0 0 1-1.414-.586l-.828-.828A2 2 0 0 0 6.172 1H2.5a2 2 0 0 0-2 2m5.672-1a1 1 0 0 1 .707.293L7.586 3H2.19q-.362.002-.683.12L1.5 2.98a1 1 0 0 1 1-.98z"}),s("path",{d:"M13.5 9a.5.5 0 0 1 .5.5V11h1.5a.5.5 0 1 1 0 1H14v1.5a.5.5 0 1 1-1 0V12h-1.5a.5.5 0 0 1 0-1H13V9.5a.5.5 0 0 1 .5-.5"})],-1)])])}const X=m({name:"bi-folder-plus",render:W}),Z={viewBox:"0 0 16 16",width:"1.2em",height:"1.2em"};function ee(e,t){return a(),n("svg",Z,[...t[0]||(t[0]=[s("g",{fill:"currentColor"},[s("path",{d:"m.5 3l.04.87a2 2 0 0 0-.342 1.311l.637 7A2 2 0 0 0 2.826 14H9v-1H2.826a1 1 0 0 1-.995-.91l-.637-7A1 1 0 0 1 2.19 4h11.62a1 1 0 0 1 .996 1.09L14.54 8h1.005l.256-2.819A2 2 0 0 0 13.81 3H9.828a2 2 0 0 1-1.414-.586l-.828-.828A2 2 0 0 0 6.172 1H2.5a2 2 0 0 0-2 2m5.672-1a1 1 0 0 1 .707.293L7.586 3H2.19q-.362.002-.683.12L1.5 2.98a1 1 0 0 1 1-.98z"}),s("path",{d:"M11 11.5a.5.5 0 0 1 .5-.5h4a.5.5 0 1 1 0 1h-4a.5.5 0 0 1-.5-.5"})],-1)])])}const te=m({name:"bi-folder-minus",render:ee}),ae={viewBox:"0 0 16 16",width:"1.2em",height:"1.2em"};function ie(e,t){return a(),n("svg",ae,[...t[0]||(t[0]=[s("path",{fill:"currentColor",d:"M3 9.5a1.5 1.5 0 1 1 0-3a1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3a1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3a1.5 1.5 0 0 1 0 3"},null,-1)])])}const se=m({name:"bi-three-dots",render:ie}),ne={name:"Tree",props:{item:{type:Object,required:!0},parent:{type:Object,default:null},path:{type:Array,default:()=>[]}},data(){return{expanded:!1,loading:!1,chunk:1,childs:[]}},computed:{...M(["data","apiCatalogPriority"]),...B(["getStac"]),onClick(){return!this.to&&this.mayHaveChildren?this.toggle:null},stac(){if(this.pagination)return null;if(this.item instanceof _){let e=this.getStac(this.item.getAbsoluteUrl());return!this.loading&&e?e:this.item}else return this.getStac(this.link)},link(){return this.pagination?this.parent?this.parent.getAbsoluteUrl():null:L.isObject(this.item)&&typeof this.item.href=="string"?this.parent?L.toAbsolute(this.item.href,this.parent.getAbsoluteUrl()):this.item.href:null},mayHaveChildren(){return this.item instanceof _?this.item.isCatalogLike():this.link?this.item.rel!=="item":!1},to(){return this.active?null:this.pagination?this.parent&&(!this.data||this.parent.getAbsoluteUrl()!==this.data.getAbsoluteUrl())?this.parent.getBrowserPath():null:this.stac instanceof _?this.stac.getBrowserPath():null},title(){return this.pagination?this.$t("tree.moreCollectionPagesAvailable"):$([this.item,this.stac])},hasMore(){return this.childs.length>this.shownChilds.length},shownChilds(){return this.childs.slice(0,this.chunk*50)},onPath(){return!Array.isArray(this.path)||!this.stac?!1:this.path.includes(this.stac)},active(){return this.stac&&this.stac===this.data},pagination(){return["next","prev","previous"].includes(this.item.rel)}},watch:{onPath:{immediate:!0,handler(){this.onPath&&(this.expanded=!0)}},stac:{immediate:!0,handler(e,t){e instanceof H&&e.setApiDataListener("tree",()=>this.updateChilds()),t instanceof H&&t.setApiDataListener("tree"),this.updateChilds()}}},created(){this.parent||(this.expanded=!0)},methods:{updateChilds(){this.stac&&this.stac.isCatalogLike()?this.childs=this.stac.getChildren(this.apiCatalogPriority):this.childs=[]},showMore(){this.chunk++},load(e){!this.stac&&this.link&&!this.pagination&&this.$store.commit(e?"queue":"unqueue",this.link)},async toggle(){if(this.expanded=!this.expanded,this.expanded&&!this.pagination){this.loading=!0;let e=this.item instanceof _?this.item.getAbsoluteUrl():this.item.href;await this.$store.dispatch("load",{url:e}),this.loading=!1}}}},re={class:"tree"},le={key:0,class:"tree"},oe={key:1,class:"tree"};function he(e,t,p,P,d,i){const g=se,o=z,b=te,v=X,k=J,C=j,S=c("Tree",!0),A=q("visible");return x((a(),n("ul",re,[s("li",null,[i.pagination?(a(),r(o,{key:0,size:"sm",variant:"light",disabled:""},{default:l(()=>[h(g)]),_:1})):i.mayHaveChildren?(a(),r(o,{key:1,size:"sm",variant:"light",onClick:i.toggle},{default:l(()=>[d.expanded?(a(),r(b,{key:0})):(a(),r(v,{key:1}))]),_:1},8,["onClick"])):(a(),r(o,{key:2,size:"sm",variant:"light",to:i.to},{default:l(()=>[h(k)]),_:1},8,["to"])),h(o,{size:"sm",variant:"light",class:D({path:i.onPath||i.active}),disabled:!i.to&&!i.active,to:i.to,onClick:i.onClick},{default:l(()=>[u(f(i.title),1)]),_:1},8,["class","disabled","to","onClick"]),t[1]||(t[1]=u()),d.expanded&&i.mayHaveChildren?(a(),n(y,{key:3},[d.loading?(a(),n("ul",le,[s("li",null,[h(C,{label:e.$t("loading"),small:""},null,8,["label"])])])):d.childs.length===0?(a(),n("ul",oe,[s("li",null,[h(o,{size:"sm",variant:"light",disabled:""},{default:l(()=>[u(f(e.$t("tree.noChildren")),1)]),_:1})])])):(a(),n(y,{key:2},[(a(!0),n(y,null,N(i.shownChilds,(T,U)=>(a(),r(S,{key:U,item:T,parent:i.stac,path:p.path},null,8,["item","parent","path"]))),128)),t[0]||(t[0]=u()),i.hasMore?x((a(),r(o,{key:0,class:"show-more",variant:"light",onClick:i.showMore},{default:l(()=>[u(f(e.$t("showMore")),1)]),_:1},8,["onClick"])),[[A,i.showMore,void 0,{300:!0}]]):w("",!0)],64))],64)):w("",!0)])])),[[A,i.load]])}const de=V(ne,[["render",he],["__scopeId","data-v-146f4930"]]),ue={name:"Sidebar",components:{Loading:G,Tree:de,BOffcanvas:I},props:{modelValue:{type:Boolean,required:!0}},emits:["update:modelValue"],data(){return{loading:!0}},computed:{...M(["allowSelectCatalog","parents"]),...B(["root"])},watch:{modelValue:{immediate:!0,async handler(e){if(e)try{this.loading=!0,await this.$store.dispatch("loadParents")}finally{this.loading=!1}e?document.body.classList.add("sidebar"):document.body.classList.remove("sidebar")}},$route(){this.emit(!1)}},methods:{emit(e){this.$emit("update:modelValue",e)}}};function ce(e,t,p,P,d,i){const g=c("Loading"),o=c("Tree"),b=K,v=c("router-link"),k=z,C=c("b-offcanvas");return a(),r(C,{"initial-animation":"",id:"sidebar","model-value":p.modelValue,"onUpdate:modelValue":i.emit,title:e.$t("browse"),"teleport-to":"#stac-browser","footer-class":"offcanvas-footer"},O({default:l(()=>[d.loading?(a(),r(g,{key:0})):e.root?(a(),r(o,{key:1,item:e.root,path:e.parents},null,8,["item","path"])):w("",!0)]),_:2},[e.allowSelectCatalog?{name:"footer",fn:l(()=>[h(k,{class:"switch-catalog",variant:"light"},{default:l(()=>[h(v,{to:"/"},{default:l(()=>[h(b),u(" "+f(e.$t("sidebar.switchCatalog")),1)]),_:1})]),_:1})]),key:"0"}:void 0]),1032,["model-value","onUpdate:modelValue","title"])}const ve=V(ue,[["render",ce]]);export{ve as default};
//# sourceMappingURL=Sidebar-DHFQ1_a_.js.map
