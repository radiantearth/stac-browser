{"version":3,"mappings":"4rCAsBKA,EAAU,CACb,KAAM,oBACN,WAAY,CACV,kBAAmBC,EAAqB,IAAIC,EAAA,IAAE,2BAAAC,CAAA,EAAgC,OAAC,GAEjF,OAAQ,CACNC,GAEF,MAAO,CACL,IAAK,CACH,KAAM,OACN,SAAU,IAEZ,MAAO,CACL,KAAM,OACN,SAAU,IAEZ,QAAS,CACP,KAAM,OACN,QAAS,MACX,GAEF,SAAU,CACR,QAAS,CACP,MAAMC,EAAY,KAAK,MAAM,UAAS,EAAG,SAAQ,EAC3CC,EAAS,GACf,UAAWC,KAASF,EAAW,CAC7B,GAAIE,EAAM,IAAI,MAAM,EAElB,SAGF,MAAMC,EAAO,CACX,MAFYD,aAAiBE,EAAaF,EAAM,UAAS,EAAG,UAAS,EAAK,EAG1E,MAAAA,EACA,GAAIA,EAAM,OACV,QAASA,EAAM,WAAU,EACzB,MAAO,KAAK,SAASA,CAAK,GAE5BD,EAAO,KAAKE,CAAI,CAClB,CACA,OAAOF,CACT,EACA,cAAe,CACb,KAAM,CACJ,OAAO,KAAK,OACT,OAAOE,GAAQA,EAAK,MAAM,WAAU,CAAE,EACtC,IAAIA,GAAQA,EAAK,EAAE,CACxB,EACA,IAAIE,EAAe,CACjB,UAAWF,KAAQ,KAAK,OAAQ,CAC9B,MAAMG,EAAWD,EAAc,SAASF,EAAK,EAAE,EACzCI,EAAUJ,EAAK,MAAM,WAAU,EACjCG,IAAaC,GACfJ,EAAK,MAAM,WAAWG,CAAQ,CAElC,CACF,CACF,GAEF,QAAS,CACP,cAAcH,EAAMK,EAAS,CAC3BL,EAAK,MAAM,WAAWK,CAAO,EAC7BL,EAAK,QAAUK,CACjB,EACA,YAAYL,EAAM,CACXA,EAAK,SACR,KAAK,cAAcA,EAAM,EAAI,EAE/B,IAAIM,EAASN,EAAK,MAAM,UAAS,EAC7BO,EAAOP,EAAK,MAAM,IAAI,MAAM,EAChC,GAAIO,EAAM,CACR,IAAIC,EAAOD,EAAK,eAAc,EACzBC,IACHD,EAAOA,EAAK,WAAU,EAClBA,IACFC,EAAOD,EAAK,eAAc,IAG1BC,IACFF,EAASG,EAAgBD,EAAM,YAAa,KAAK,IAAI,UAAU,eAAe,EAElF,CACIF,GACF,KAAK,IAAI,QAAO,EAAG,IAAIA,EAAQ,CAAE,QAAS,CAAC,GAAG,GAAG,GAAG,EAAE,EAAG,QAAS,KAAK,QAAS,CAEpF,CACF,CACF,EA3GWI,EAAA,OAAM,gCAAgC,EAEjCC,EAAA,OAAM,OAAO,mFAJ3BC,EAYK,kBAXHA,EAUKC,EAAA,KAAAC,EAVWC,EAAA,OAALC,QAAXJ,EAUK,MAVoB,IAAKI,EAAE,KAC9BC,EAOM,MAPNP,EAOM,CANJQ,EAEkBC,EAAA,CAFD,UAAQ,KAAMH,EAAE,GAAK,cAAaA,EAAE,QAAU,sBAAkBI,GAAEL,EAAA,cAAcC,EAAGI,CAAM,cACxG,IAAwC,CAAxCH,EAAwC,OAAxCN,EAAwCU,EAAjBL,EAAE,KAAK,gFAEhCE,EAEWI,EAAA,CAFD,QAAQ,QAAQ,KAAK,KAAM,MAAOC,EAAA,GAAE,eAAkB,QAAKC,EAAAJ,GAAeL,EAAA,YAAYC,CAAC,kCAC/F,IAAkB,CAAlBE,EAAkBO,CAAA,mDAGGT,EAAE,MAAK,OAAhCU,EAAuFC,EAAA,OAAhD,IAAKC,EAAA,IAAM,MAAOZ,EAAE,MAAQ,QAASY,EAAA","names":["_sfc_main","defineAsyncComponent","__vitePreload","LayerControlGroup$1","LayerControlMixin","allLayers","layers","layer","data","LayerGroup","visibleLayers","expected","current","visible","extent","stac","bbox","transformExtent","_hoisted_1","_hoisted_2","_createElementBlock","_Fragment","_renderList","$options","l","_createElementVNode","_createVNode","_component_b_form_checkbox","$event","_toDisplayString","_component_b_button","_ctx","_withModifiers","_component_b_icon_zoom_in","_createBlock","_component_LayerControlGroup","$props"],"ignoreList":[],"sources":["../../src/components/maps/LayerControlGroup.vue"],"sourcesContent":["<template>\n  <ul>\n    <li v-for=\"l in layers\" :key=\"l.id\">\n      <div class=\"d-flex justify-content-between\">\n        <b-form-checkbox inline :name=\"l.id\" :model-value=\"l.visible\" @update:model-value=\"setVisibility(l, $event)\">\n          <span class=\"title\">{{ l.title }}</span>\n        </b-form-checkbox>\n        <b-button variant=\"light\" size=\"sm\" :title=\"$t('mapping.fit')\" @click.prevent.stop=\"fitToExtent(l)\">\n          <b-icon-zoom-in />\n        </b-button>\n      </div>\n      <LayerControlGroup v-if=\"l.group > 1\" :map=\"map\" :group=\"l.layer\" :maxZoom=\"maxZoom\" />\n    </li>\n  </ul>\n</template>\n\n<script>\nimport { defineAsyncComponent } from 'vue';\nimport LayerControlMixin from './LayerControlMixin';\nimport LayerGroup from 'ol/layer/Group';\nimport { transformExtent } from 'ol/proj';\n\nexport default {\n  name: 'LayerControlGroup',\n  components: {\n    LayerControlGroup: defineAsyncComponent(() => import('./LayerControlGroup.vue')),\n  },\n  mixins: [\n    LayerControlMixin\n  ],\n  props: {\n    map: {\n      type: Object,\n      required: true\n    },\n    group: {\n      type: Object,\n      required: true\n    },\n    maxZoom: {\n      type: Number,\n      default: undefined\n    }\n  },\n  computed: {\n    layers() {\n      const allLayers = this.group.getLayers().getArray();\n      const layers = [];\n      for (const layer of allLayers) {\n        if (layer.get('base')) {\n          // Skip base layers from top-level layer group\n          continue;\n        }\n        const group = layer instanceof LayerGroup ? layer.getLayers().getLength() : 0;\n        const data = {\n          group,\n          layer,\n          id: layer.ol_uid,\n          visible: layer.getVisible(),\n          title: this.getTitle(layer)\n        };\n        layers.push(data);\n      }\n      return layers;\n    },\n    visibleLayers: {\n      get() {\n        return this.layers\n          .filter(data => data.layer.getVisible())\n          .map(data => data.id);\n      },\n      set(visibleLayers) {\n        for (const data of this.layers) {\n          const expected = visibleLayers.includes(data.id);\n          const current = data.layer.getVisible();\n          if (expected !== current) {\n            data.layer.setVisible(expected);\n          }\n        }\n      }\n    }\n  },\n  methods: {\n    setVisibility(data, visible) {\n      data.layer.setVisible(visible);\n      data.visible = visible;\n    },\n    fitToExtent(data) {\n      if (!data.visible) {\n        this.setVisibility(data, true);\n      }\n      let extent = data.layer.getExtent();\n      let stac = data.layer.get('stac');\n      if (stac) {\n        let bbox = stac.getBoundingBox();\n        if (!bbox) {\n          stac = stac.getContext();\n          if (stac) {\n            bbox = stac.getBoundingBox();\n          }\n        }\n        if (bbox) {\n          extent = transformExtent(bbox, 'EPSG:4326', this.map.getView().getProjection());\n        }\n      }\n      if (extent) {\n        this.map.getView().fit(extent, { padding: [10,10,10,10], maxZoom: this.maxZoom });\n      }\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.ol-layercontrol {\n  z-index: 1;\n  left: 0.5em;\n  bottom: 0.5em;\n}\n.layercontrol {\n  max-width: 300px;\n  max-height: 500px;\n  overflow: auto;\n  margin-top: -0.5rem;\n  margin-left: -0.75rem;\n  margin-right: -0.75rem;\n  padding: 0.5rem 0.75rem 0  0.75rem;\n\n  .title {\n    line-break: anywhere;\n  }\n\n  ul {\n    list-style: none;\n    padding: 0.1rem 0;\n    margin: 0;\n\n    .btn-sm {\n      padding: 0.1rem 0.5rem;\n    }\n\n    li {\n      padding-top: 0.1rem;\n      padding-bottom: 0.1rem;\n    }\n\n    li li {\n      padding-left: 0.75rem;\n    }\n  }\n}\nh5 {\n  font-weight: bold;\n  font-size: 1em;\n}\n</style>\n"],"file":"LayerControlGroup-BTEOAjbH.js"}