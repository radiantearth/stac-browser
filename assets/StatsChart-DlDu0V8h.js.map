{"version":3,"file":"StatsChart-DlDu0V8h.js","sources":["../../src/components/metadata/StatsChart.vue"],"sourcesContent":["<template>\n  <div class=\"chart mb-4\">\n    <component :is=\"component\" :data=\"chartData\" :options=\"allOptions\" />\n  </div>\n</template>\n\n<script>\nimport { formatKey } from \"@radiantearth/stac-fields/helper\";\nimport { extension } from \"@radiantearth/stac-fields/interface\";\nimport { formatMediaType } from \"@radiantearth/stac-fields/formatters\";\nimport StacFieldsMixin from \"../StacFieldsMixin\";\nimport Utils from \"../../utils\";\n\nimport { Bar, Pie } from 'vue-chartjs';\nimport {\n  Chart as ChartJS,\n  Colors,\n  Title,\n  Tooltip,\n  BarElement,\n  ArcElement,\n  CategoryScale,\n  LinearScale\n} from 'chart.js';\n\nChartJS.register(Title, Tooltip, Colors, ArcElement, BarElement, CategoryScale, LinearScale);\n\nexport default {\n  name: \"StatsChart\",\n  components: {\n    Bar,\n    Pie\n  },\n  mixins: [\n    StacFieldsMixin({ formatMediaType })\n  ],\n  props: {\n    data: {\n      type: Object,\n      required: true\n    },\n    type: {\n      type: String,\n      required: true\n    },\n    count: {\n      type: Number,\n      required: true\n    },\n    options: {\n      type: Object,\n      default: () => ({})\n    }\n  },\n  computed: {\n    component() {\n      switch(this.type) {\n        case 'versions':\n          return 'Pie';\n        default:\n          return 'Bar';\n      }\n    },\n    title() {\n      switch(this.type) {\n        case 'versions':\n          return this.$t('source.stacVersion');\n        case 'extensions':\n          return this.$t('source.stacExtension');\n        case 'assets':\n          return this.$t('source.fileFormat');\n        default:\n          return '';\n      }\n    },\n    allOptions() {\n      let options = {\n        responsive: true,\n        plugins: {\n          title: {\n            display: true,\n            text: this.title\n          },\n        },\n        scales: {\n          y: {\n            min: 0,\n            max: this.count,\n            title: {\n              display: false\n            }\n          }\n        }\n      };\n      return Object.assign(options, this.options);\n    },\n    chartData() {\n      let labels = [];\n      let values = [];\n      for (let id in this.data) {\n        let count = this.data[id];\n        values.push(count);\n\n        let label;\n        switch(this.type) {\n          case 'extensions': {\n            let ext = this.parseExtension(id);\n            label = `${ext.title}`;\n            if (ext.version) {\n              label += ` (${ext.version})`;\n            }\n            break;\n          }\n          case 'assets':\n            label = this.formatMediaType(id);\n            break;\n          default:\n            label = id;\n        }\n        labels.push(label);\n      }\n      return {\n        labels,\n        datasets: [\n          {\n            data: values\n          }\n        ]\n      };\n    }\n  },\n  methods: {\n    parseExtension(uri) {\n      let version = null;\n      let title = uri;\n      let match = uri.match(/^https?:\\/\\/stac-extensions\\.github\\.io\\/([^/]+)\\/v?([^/]+)(?:\\/([^/.]+))?\\/schema/);\n      if (match) {\n        version = match[2];\n        title = extension(match[1]);\n        if (match[3]) {\n          title += ' - ' + formatKey(match[3]);\n        }\n      }\n      else {\n        title = uri.replace(/^https?:\\/\\/(www.)?/, '').replace(/\\/schema(\\.json)?$/, '');\n        title = Utils.shortenTitle(title, 30);\n      }\n      return { title, version };\n    }\n  }\n};\n</script>\n"],"names":["ChartJS","Title","Tooltip","Colors","ArcElement","BarElement","CategoryScale","LinearScale","_sfc_main","Bar","Pie","StacFieldsMixin","formatMediaType","options","labels","values","id","count","label","ext","uri","version","title","match","extension","formatKey","Utils","_hoisted_1","_openBlock","_createElementBlock","_createBlock","_resolveDynamicComponent","$options"],"mappings":"ieAyBAA,EAAQ,SAASC,EAAOC,EAASC,EAAQC,EAAYC,EAAYC,EAAeC,CAAW,EAE3F,MAAKC,EAAU,CACb,KAAM,aACN,WAAY,CACV,IAAAC,EACA,IAAAC,GAEF,OAAQ,CACNC,EAAgB,CAAA,gBAAEC,EAAAA,gBAAiB,GAErC,MAAO,CACL,KAAM,CACJ,KAAM,OACN,SAAU,IAEZ,KAAM,CACJ,KAAM,OACN,SAAU,IAEZ,MAAO,CACL,KAAM,OACN,SAAU,IAEZ,QAAS,CACP,KAAM,OACN,QAAS,KAAO,CAAA,EAClB,GAEF,SAAU,CACR,WAAY,CACV,OAAO,KAAK,OACL,WACI,MAEA,KAEb,EACA,OAAQ,CACN,OAAO,KAAK,KAAI,CACd,IAAK,WACH,OAAO,KAAK,GAAG,oBAAoB,EACrC,IAAK,aACH,OAAO,KAAK,GAAG,sBAAsB,EACvC,IAAK,SACH,OAAO,KAAK,GAAG,mBAAmB,EACpC,QACE,MAAO,EACX,CACF,EACA,YAAa,CACX,IAAIC,EAAU,CACZ,WAAY,GACZ,QAAS,CACP,MAAO,CACL,QAAS,GACT,KAAM,KAAK,QAGf,OAAQ,CACN,EAAG,CACD,IAAK,EACL,IAAK,KAAK,MACV,MAAO,CACL,QAAS,EACX,CACF,CACF,GAEF,OAAO,OAAO,OAAOA,EAAS,KAAK,OAAO,CAC5C,EACA,WAAY,CACV,IAAIC,EAAS,CAAA,EACTC,EAAS,CAAA,EACb,QAASC,KAAM,KAAK,KAAM,CACxB,IAAIC,EAAQ,KAAK,KAAKD,CAAE,EACxBD,EAAO,KAAKE,CAAK,EAEjB,IAAIC,EACJ,OAAO,KAAK,KAAI,CACd,IAAK,aAAc,CACjB,IAAIC,EAAM,KAAK,eAAeH,CAAE,EAChCE,EAAQ,GAAGC,EAAI,KAAK,GAChBA,EAAI,UACND,GAAS,KAAKC,EAAI,OAAO,KAE3B,KACF,CACA,IAAK,SACHD,EAAQ,KAAK,gBAAgBF,CAAE,EAC/B,MACF,QACEE,EAAQF,CACZ,CACAF,EAAO,KAAKI,CAAK,CACnB,CACA,MAAO,CACL,OAAAJ,EACA,SAAU,CACR,CACE,KAAMC,CACR,CACF,EAEJ,GAEF,QAAS,CACP,eAAeK,EAAK,CAClB,IAAIC,EAAU,KACVC,EAAQF,EACRG,EAAQH,EAAI,MAAM,oFAAoF,EAC1G,OAAIG,GACFF,EAAUE,EAAM,CAAC,EACjBD,EAAQE,EAAAA,UAAUD,EAAM,CAAC,CAAC,EACtBA,EAAM,CAAC,IACTD,GAAS,MAAQG,EAAAA,UAAUF,EAAM,CAAC,CAAC,KAIrCD,EAAQF,EAAI,QAAQ,sBAAuB,EAAE,EAAE,QAAQ,qBAAsB,EAAE,EAC/EE,EAAQI,EAAM,aAAaJ,EAAO,EAAE,GAE/B,CAAE,MAAAA,EAAO,QAAAD,EAClB,CACF,CACF,EArJOM,EAAA,CAAA,MAAM,YAAY,0BAAvB,OAAAC,EAAA,EAAAC,EAEM,MAFNF,EAEM,EADJC,EAAA,EAAAE,EAAqEC,EAArDC,EAAA,SAAS,EAAA,CAAG,KAAMA,EAAA,UAAY,QAASA,EAAA"}