{"version":3,"file":"mapserver-ByvrS29I.js","sources":["../../node_modules/ol/source/mapserver.js"],"sourcesContent":["/**\n * @module ol/source/mapserver\n */\n\nimport {decode} from '../Image.js';\nimport {getHeight, getWidth} from '../extent.js';\nimport {appendParams} from '../uri.js';\nimport {getRequestExtent} from './Image.js';\n\n/**\n * @typedef {Object} LoaderOptions\n * @property {string} url The MapServer url.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you want to access pixel data with the Canvas renderer.\n * See https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image for more detail.\n * the image from the remote server.\n * @property {number} [ratio=1] Ratio. `1` means image requests are the size of the map viewport, `2` means\n * twice the width and height of the map viewport, and so on. Must be `1` or higher.\n * @property {Object} [params] Additional query parameters.\n * @property {function(HTMLImageElement, string): Promise<import('../DataTile.js').ImageLike>} [load] Function\n * to perform loading of the image. Receives the created `HTMLImageElement` and the desired `src` as argument and\n * returns a promise resolving to the loaded or decoded image. Default is {@link module:ol/Image.decode}.\n */\n\n/**\n * @param {string} baseUrl The MapServer url.\n * @param {Object<string, string|number>} params Request parameters.\n * @param {import(\"../extent.js\").Extent} extent Extent.\n * @param {import(\"../size.js\").Size} size Size.\n * @return {string} The MapServer map image request URL.\n */\nfunction getUrl(baseUrl, params, extent, size) {\n  const width = Math.round(size[0]);\n  const height = Math.round(size[1]);\n  const mapSize = `${width} ${height}`;\n  const mapExt = `${extent[0]} ${extent[1]} ${extent[2]} ${extent[3]}`;\n\n  const baseParams = {\n    mode: 'map',\n    map_imagetype: 'png',\n    mapext: mapExt,\n    imgext: mapExt,\n    map_size: mapSize,\n    imgx: width / 2,\n    imgy: height / 2,\n    imgxy: mapSize,\n  };\n  Object.assign(baseParams, params);\n  return appendParams(baseUrl, baseParams);\n}\n\n/**\n * Creates a loader for MapServer images generated using the CGI interface,\n * which predates OGC services. It is **strongly** recommended to configure\n * MapServer to use WMS, and use the WMS createLoader.\n * @param {LoaderOptions} options LoaderOptions Options.\n * @return {import('../Image.js').ImageObjectPromiseLoader} MapServer image.\n * @api\n */\nexport function createLoader(options) {\n  const load = options.load || decode;\n  const ratio = options.ratio ?? 1;\n  const crossOrigin = options.crossOrigin ?? null;\n\n  /** @type {import('../Image.js').ImageObjectPromiseLoader} */\n  return function (extent, resolution, pixelRatio) {\n    const image = new Image();\n    image.crossOrigin = crossOrigin;\n    extent = getRequestExtent(extent, resolution, pixelRatio, ratio);\n    const width = getWidth(extent) / resolution;\n    const height = getHeight(extent) / resolution;\n    const size = [width * pixelRatio, height * pixelRatio];\n    const src = getUrl(options.url, options.params, extent, size);\n    return load(image, src).then((image) => ({image, extent, pixelRatio}));\n  };\n}\n"],"names":["getUrl","baseUrl","params","extent","size","width","height","mapSize","mapExt","baseParams","appendParams","createLoader","options","load","decode","ratio","crossOrigin","resolution","pixelRatio","image","getRequestExtent","getWidth","getHeight","src"],"mappings":"wlBA+BA,SAASA,EAAOC,EAASC,EAAQC,EAAQC,EAAM,CAC7C,MAAMC,EAAQ,KAAK,MAAMD,EAAK,CAAC,CAAC,EAC1BE,EAAS,KAAK,MAAMF,EAAK,CAAC,CAAC,EAC3BG,EAAU,GAAGF,CAAK,IAAIC,CAAM,GAC5BE,EAAS,GAAGL,EAAO,CAAC,CAAC,IAAIA,EAAO,CAAC,CAAC,IAAIA,EAAO,CAAC,CAAC,IAAIA,EAAO,CAAC,CAAC,GAE5DM,EAAa,CACjB,KAAM,MACN,cAAe,MACf,OAAQD,EACR,OAAQA,EACR,SAAUD,EACV,KAAMF,EAAQ,EACd,KAAMC,EAAS,EACf,MAAOC,CACX,EACE,cAAO,OAAOE,EAAYP,CAAM,EACzBQ,EAAaT,EAASQ,CAAU,CACzC,CAUO,SAASE,EAAaC,EAAS,CACpC,MAAMC,EAAOD,EAAQ,MAAQE,EACvBC,EAAQH,EAAQ,OAAS,EACzBI,EAAcJ,EAAQ,aAAe,KAG3C,OAAO,SAAUT,EAAQc,EAAYC,EAAY,CAC/C,MAAMC,EAAQ,IAAI,MAClBA,EAAM,YAAcH,EACpBb,EAASiB,EAAiBjB,EAAQc,EAAYC,EAAYH,CAAK,EAC/D,MAAMV,EAAQgB,EAASlB,CAAM,EAAIc,EAC3BX,EAASgB,EAAUnB,CAAM,EAAIc,EAC7Bb,EAAO,CAACC,EAAQa,EAAYZ,EAASY,CAAU,EAC/CK,EAAMvB,EAAOY,EAAQ,IAAKA,EAAQ,OAAQT,EAAQC,CAAI,EAC5D,OAAOS,EAAKM,EAAOI,CAAG,EAAE,KAAMJ,IAAW,CAAC,MAAAA,EAAO,OAAAhB,EAAQ,WAAAe,CAAU,EAAE,CACvE,CACF","x_google_ignoreList":[0]}