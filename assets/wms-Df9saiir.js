import{y as g,am as L,b2 as M,bi as o,ar as m,bj as f,aB as P,aC as F}from"./GeoJSON-BoRJWQIG.js";import{a as R}from"./uri-CWE-Y_zl.js";import{getRequestExtent as N}from"./Image-ByRyF10d.js";import{DECIMALS as d}from"./common-9rOs42pz.js";import"./index-B3F0456b.js";import"./utils-BXWzvTjY.js";import"./_commonjsHelpers-CE1G-McA.js";import"./I18N-DlIXJTel.js";import"./BFormRadioGroup.vue_vue_type_script_setup_true_lang-DaMHx4U3-DO3czC2y.js";import"./useStateClass-BGbSLWFN-eI-Q6wqs.js";import"./ConditionalWrapper.vue_vue_type_script_lang-IX_NpHH--5aly-L7g.js";import"./tilecoord-DBpIeO-O.js";import"./common-CLWpeXJR.js";import"./resolution-CU8ppKQ3.js";const T="1.3.0",O=[101,101];function I(e,n,r,c,s){s.WIDTH=r[0],s.HEIGHT=r[1];const t=c.getAxisOrientation(),i=m(s.VERSION,"1.3")>=0;s[i?"CRS":"SRS"]=c.getCode();const u=i&&t.startsWith("ne")?[n[1],n[0],n[3],n[2]]:n;return s.BBOX=u.join(","),R(e,s)}function U(e,n,r,c,s,t,i){t=Object.assign({REQUEST:"GetMap"},t);const u=n/r,a=[f(P(e)/u,d),f(F(e)/u,d)];if(r!=1)switch(i){case"geoserver":const E=90*r+.5|0;"FORMAT_OPTIONS"in t?t.FORMAT_OPTIONS+=";dpi:"+E:t.FORMAT_OPTIONS="dpi:"+E;break;case"mapserver":t.MAP_RESOLUTION=90*r;break;case"carmentaserver":case"qgis":t.DPI=90*r;break;default:throw new Error("Unknown `serverType` configured")}return I(s,e,a,c,t)}function A(e,n){return Object.assign({REQUEST:n,SERVICE:"WMS",VERSION:T,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},e)}function q(e){const n=e.hidpi===void 0?!0:e.hidpi,r=g(e.projection||"EPSG:3857"),c=e.ratio||1.5,s=e.load||L,t=e.crossOrigin??null;return(i,u,a)=>{i=N(i,u,a,c),a!=1&&(!n||e.serverType===void 0)&&(a=1);const S=U(i,u,a,r,e.url,A(e.params,"GetMap"),e.serverType),E=new Image;return E.crossOrigin=t,s(E,S).then(b=>({image:b,extent:i,pixelRatio:a}))}}function D(e,n,r){if(e.url===void 0)return;const c=g(e.projection||"EPSG:3857"),s=M(n,r,0,O),t={QUERY_LAYERS:e.params.LAYERS,INFO_FORMAT:"application/json"};Object.assign(t,A(e.params,"GetFeatureInfo"),e.params);const i=o((n[0]-s[0])/r,d),u=o((s[3]-n[1])/r,d),a=m(t.VERSION,"1.3")>=0;return t[a?"I":"X"]=i,t[a?"J":"Y"]=u,I(e.url,s,O,c,t)}function H(e,n){if(e.url===void 0)return;const r={SERVICE:"WMS",VERSION:T,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(n!==void 0){const c=g(e.projection||"EPSG:3857").getMetersPerUnit()||1,s=28e-5;r.SCALE=n*c/s}if(Object.assign(r,e.params),e.params!==void 0&&r.LAYER===void 0){const c=r.LAYERS;if(!(!Array.isArray(c)||c.length!==1))return;r.LAYER=c}return R(e.url,r)}export{T as DEFAULT_VERSION,q as createLoader,D as getFeatureInfoUrl,U as getImageSrc,H as getLegendUrl,A as getRequestParams,I as getRequestUrl};
//# sourceMappingURL=wms-Df9saiir.js.map
