import{bo as B,P as D,bp as y,bq as E,y as T,br as M,bs as _,bt as C,bu as I,bv as L,bw as N,bx as R}from"./GeoJSON-BoRJWQIG.js";const P=65536*65536,S=1/P,U=12,m=typeof TextDecoder>"u"?null:new TextDecoder("utf-8"),V=0,F=1,w=2,g=5;class G{constructor(e=new Uint8Array(16)){this.buf=ArrayBuffer.isView(e)?e:new Uint8Array(e),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(e,t,r=this.length){for(;this.pos<r;){const s=this.readVarint(),n=s>>3,a=this.pos;this.type=s&7,e(n,t,this),this.pos===a&&this.skip(s)}return t}readMessage(e,t){return this.readFields(e,t,this.readVarint()+this.pos)}readFixed32(){const e=this.dataView.getUint32(this.pos,!0);return this.pos+=4,e}readSFixed32(){const e=this.dataView.getInt32(this.pos,!0);return this.pos+=4,e}readFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*P;return this.pos+=8,e}readSFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*P;return this.pos+=8,e}readFloat(){const e=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,e}readDouble(){const e=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,e}readVarint(e){const t=this.buf;let r,s;return s=t[this.pos++],r=s&127,s<128||(s=t[this.pos++],r|=(s&127)<<7,s<128)||(s=t[this.pos++],r|=(s&127)<<14,s<128)||(s=t[this.pos++],r|=(s&127)<<21,s<128)?r:(s=t[this.pos],r|=(s&15)<<28,X(r,e,this))}readVarint64(){return this.readVarint(!0)}readSVarint(){const e=this.readVarint();return e%2===1?(e+1)/-2:e/2}readBoolean(){return!!this.readVarint()}readString(){const e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=U&&m?m.decode(this.buf.subarray(t,e)):Z(this.buf,t,e)}readBytes(){const e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t}readPackedVarint(e=[],t){const r=this.readPackedEnd();for(;this.pos<r;)e.push(this.readVarint(t));return e}readPackedSVarint(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSVarint());return e}readPackedBoolean(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readBoolean());return e}readPackedFloat(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFloat());return e}readPackedDouble(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readDouble());return e}readPackedFixed32(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFixed32());return e}readPackedSFixed32(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSFixed32());return e}readPackedFixed64(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFixed64());return e}readPackedSFixed64(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSFixed64());return e}readPackedEnd(){return this.type===w?this.readVarint()+this.pos:this.pos+1}skip(e){const t=e&7;if(t===V)for(;this.buf[this.pos++]>127;);else if(t===w)this.pos=this.readVarint()+this.pos;else if(t===g)this.pos+=4;else if(t===F)this.pos+=8;else throw new Error(`Unimplemented type: ${t}`)}writeTag(e,t){this.writeVarint(e<<3|t)}realloc(e){let t=this.length||16;for(;t<this.pos+e;)t*=2;if(t!==this.length){const r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.dataView=new DataView(r.buffer),this.length=t}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeSFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,e&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*S),!0),this.pos+=8}writeSFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,e&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*S),!0),this.pos+=8}writeVarint(e){if(e=+e||0,e>268435455||e<0){j(e,this);return}this.realloc(4),this.buf[this.pos++]=e&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=e>>>7&127)))}writeSVarint(e){this.writeVarint(e<0?-e*2-1:e*2)}writeBoolean(e){this.writeVarint(+e)}writeString(e){e=String(e),this.realloc(e.length*4),this.pos++;const t=this.pos;this.pos=v(this.buf,e,this.pos);const r=this.pos-t;r>=128&&k(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r}writeFloat(e){this.realloc(4),this.dataView.setFloat32(this.pos,e,!0),this.pos+=4}writeDouble(e){this.realloc(8),this.dataView.setFloat64(this.pos,e,!0),this.pos+=8}writeBytes(e){const t=e.length;this.writeVarint(t),this.realloc(t);for(let r=0;r<t;r++)this.buf[this.pos++]=e[r]}writeRawMessage(e,t){this.pos++;const r=this.pos;e(t,this);const s=this.pos-r;s>=128&&k(r,s,this),this.pos=r-1,this.writeVarint(s),this.pos+=s}writeMessage(e,t,r){this.writeTag(e,w),this.writeRawMessage(t,r)}writePackedVarint(e,t){t.length&&this.writeMessage(e,H,t)}writePackedSVarint(e,t){t.length&&this.writeMessage(e,O,t)}writePackedBoolean(e,t){t.length&&this.writeMessage(e,$,t)}writePackedFloat(e,t){t.length&&this.writeMessage(e,q,t)}writePackedDouble(e,t){t.length&&this.writeMessage(e,W,t)}writePackedFixed32(e,t){t.length&&this.writeMessage(e,z,t)}writePackedSFixed32(e,t){t.length&&this.writeMessage(e,J,t)}writePackedFixed64(e,t){t.length&&this.writeMessage(e,K,t)}writePackedSFixed64(e,t){t.length&&this.writeMessage(e,Q,t)}writeBytesField(e,t){this.writeTag(e,w),this.writeBytes(t)}writeFixed32Field(e,t){this.writeTag(e,g),this.writeFixed32(t)}writeSFixed32Field(e,t){this.writeTag(e,g),this.writeSFixed32(t)}writeFixed64Field(e,t){this.writeTag(e,F),this.writeFixed64(t)}writeSFixed64Field(e,t){this.writeTag(e,F),this.writeSFixed64(t)}writeVarintField(e,t){this.writeTag(e,V),this.writeVarint(t)}writeSVarintField(e,t){this.writeTag(e,V),this.writeSVarint(t)}writeStringField(e,t){this.writeTag(e,w),this.writeString(t)}writeFloatField(e,t){this.writeTag(e,g),this.writeFloat(t)}writeDoubleField(e,t){this.writeTag(e,F),this.writeDouble(t)}writeBooleanField(e,t){this.writeVarintField(e,+t)}}function X(i,e,t){const r=t.buf;let s,n;if(n=r[t.pos++],s=(n&112)>>4,n<128||(n=r[t.pos++],s|=(n&127)<<3,n<128)||(n=r[t.pos++],s|=(n&127)<<10,n<128)||(n=r[t.pos++],s|=(n&127)<<17,n<128)||(n=r[t.pos++],s|=(n&127)<<24,n<128)||(n=r[t.pos++],s|=(n&1)<<31,n<128))return f(i,s,e);throw new Error("Expected varint not more than 10 bytes")}function f(i,e,t){return t?e*4294967296+(i>>>0):(e>>>0)*4294967296+(i>>>0)}function j(i,e){let t,r;if(i>=0?(t=i%4294967296|0,r=i/4294967296|0):(t=~(-i%4294967296),r=~(-i/4294967296),t^4294967295?t=t+1|0:(t=0,r=r+1|0)),i>=18446744073709552e3||i<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),Y(t,r,e),A(r,e)}function Y(i,e,t){t.buf[t.pos++]=i&127|128,i>>>=7,t.buf[t.pos++]=i&127|128,i>>>=7,t.buf[t.pos++]=i&127|128,i>>>=7,t.buf[t.pos++]=i&127|128,i>>>=7,t.buf[t.pos]=i&127}function A(i,e){const t=(i&7)<<4;e.buf[e.pos++]|=t|((i>>>=3)?128:0),i&&(e.buf[e.pos++]=i&127|((i>>>=7)?128:0),i&&(e.buf[e.pos++]=i&127|((i>>>=7)?128:0),i&&(e.buf[e.pos++]=i&127|((i>>>=7)?128:0),i&&(e.buf[e.pos++]=i&127|((i>>>=7)?128:0),i&&(e.buf[e.pos++]=i&127)))))}function k(i,e,t){const r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(Math.LN2*7));t.realloc(r);for(let s=t.pos-1;s>=i;s--)t.buf[s+r]=t.buf[s]}function H(i,e){for(let t=0;t<i.length;t++)e.writeVarint(i[t])}function O(i,e){for(let t=0;t<i.length;t++)e.writeSVarint(i[t])}function q(i,e){for(let t=0;t<i.length;t++)e.writeFloat(i[t])}function W(i,e){for(let t=0;t<i.length;t++)e.writeDouble(i[t])}function $(i,e){for(let t=0;t<i.length;t++)e.writeBoolean(i[t])}function z(i,e){for(let t=0;t<i.length;t++)e.writeFixed32(i[t])}function J(i,e){for(let t=0;t<i.length;t++)e.writeSFixed32(i[t])}function K(i,e){for(let t=0;t<i.length;t++)e.writeFixed64(i[t])}function Q(i,e){for(let t=0;t<i.length;t++)e.writeSFixed64(i[t])}function Z(i,e,t){let r="",s=e;for(;s<t;){const n=i[s];let a=null,l=n>239?4:n>223?3:n>191?2:1;if(s+l>t)break;let o,h,d;l===1?n<128&&(a=n):l===2?(o=i[s+1],(o&192)===128&&(a=(n&31)<<6|o&63,a<=127&&(a=null))):l===3?(o=i[s+1],h=i[s+2],(o&192)===128&&(h&192)===128&&(a=(n&15)<<12|(o&63)<<6|h&63,(a<=2047||a>=55296&&a<=57343)&&(a=null))):l===4&&(o=i[s+1],h=i[s+2],d=i[s+3],(o&192)===128&&(h&192)===128&&(d&192)===128&&(a=(n&15)<<18|(o&63)<<12|(h&63)<<6|d&63,(a<=65535||a>=1114112)&&(a=null))),a===null?(a=65533,l=1):a>65535&&(a-=65536,r+=String.fromCharCode(a>>>10&1023|55296),a=56320|a&1023),r+=String.fromCharCode(a),s+=l}return r}function v(i,e,t){for(let r=0,s,n;r<e.length;r++){if(s=e.charCodeAt(r),s>55295&&s<57344)if(n)if(s<56320){i[t++]=239,i[t++]=191,i[t++]=189,n=s;continue}else s=n-55296<<10|s-56320|65536,n=null;else{s>56319||r+1===e.length?(i[t++]=239,i[t++]=191,i[t++]=189):n=s;continue}else n&&(i[t++]=239,i[t++]=191,i[t++]=189,n=null);s<128?i[t++]=s:(s<2048?i[t++]=s>>6|192:(s<65536?i[t++]=s>>12|224:(i[t++]=s>>18|240,i[t++]=s>>12&63|128),i[t++]=s>>6&63|128),i[t++]=s&63|128)}return t}class ne extends B{constructor(e){super(),e=e||{},this.dataProjection=new D({code:"",units:"tile-pixels"}),this.featureClass=e.featureClass?e.featureClass:y,this.geometryName_=e.geometryName,this.layerName_=e.layerName?e.layerName:"layer",this.layers_=e.layers?e.layers:null,this.idProperty_=e.idProperty,this.supportedMediaTypes=["application/vnd.mapbox-vector-tile","application/x-protobuf"]}readRawGeometry_(e,t,r,s){e.pos=t.geometry;const n=e.readVarint()+e.pos;let a=1,l=0,o=0,h=0,d=0,x=0;for(;e.pos<n;){if(!l){const u=e.readVarint();a=u&7,l=u>>3}if(l--,a===1||a===2)o+=e.readSVarint(),h+=e.readSVarint(),a===1&&d>x&&(s.push(d),x=d),r.push(o,h),d+=2;else if(a===7)d>x&&(r.push(r[x],r[x+1]),d+=2);else throw new Error("Invalid command found in the PBF")}d>x&&(s.push(d),x=d)}createFeature_(e,t,r){const s=t.type;if(s===0)return null;let n;const a=t.properties;let l;this.idProperty_?(l=a[this.idProperty_],delete a[this.idProperty_]):l=t.id,a[this.layerName_]=t.layer.name;const o=[],h=[];this.readRawGeometry_(e,t,o,h);const d=se(s,h.length);if(this.featureClass===y)n=new this.featureClass(d,o,h,2,a,l),n.transform(r.dataProjection);else{let x;if(d=="Polygon"){const c=M(o,h);x=c.length>1?new _(o,"XY",c):new C(o,"XY",h)}else x=d==="Point"?new I(o,"XY"):d==="LineString"?new L(o,"XY"):d==="MultiPoint"?new N(o,"XY"):d==="MultiLineString"?new R(o,"XY",h):null;const u=this.featureClass;n=new u,this.geometryName_&&n.setGeometryName(this.geometryName_);const p=E(x,!1,r);n.setGeometry(p),l!==void 0&&n.setId(l),n.setProperties(a,!0)}return n}getType(){return"arraybuffer"}readFeatures(e,t){const r=this.layers_;t=this.adaptOptions(t);const s=T(t.dataProjection);s.setWorldExtent(t.extent),t.dataProjection=s;const n=new G(e),a=n.readFields(b,{}),l=[];for(const o in a){if(r&&!r.includes(o))continue;const h=a[o],d=h?[0,0,h.extent,h.extent]:null;s.setExtent(d);for(let x=0,u=h.length;x<u;++x){const p=ie(n,h,x),c=this.createFeature_(n,p,t);c!==null&&l.push(c)}}return l}readProjection(e){return this.dataProjection}setLayers(e){this.layers_=e}}function b(i,e,t){if(i===3){const r={keys:[],values:[],features:[]},s=t.readVarint()+t.pos;t.readFields(ee,r,s),r.length=r.features.length,r.length&&(e[r.name]=r)}}function ee(i,e,t){if(i===15)e.version=t.readVarint();else if(i===1)e.name=t.readString();else if(i===5)e.extent=t.readVarint();else if(i===2)e.features.push(t.pos);else if(i===3)e.keys.push(t.readString());else if(i===4){let r=null;const s=t.readVarint()+t.pos;for(;t.pos<s;)i=t.readVarint()>>3,r=i===1?t.readString():i===2?t.readFloat():i===3?t.readDouble():i===4?t.readVarint64():i===5?t.readVarint():i===6?t.readSVarint():i===7?t.readBoolean():null;e.values.push(r)}}function te(i,e,t){if(i==1)e.id=t.readVarint();else if(i==2){const r=t.readVarint()+t.pos;for(;t.pos<r;){const s=e.layer.keys[t.readVarint()],n=e.layer.values[t.readVarint()];e.properties[s]=n}}else i==3?e.type=t.readVarint():i==4&&(e.geometry=t.pos)}function ie(i,e,t){i.pos=e.features[t];const r=i.readVarint()+i.pos,s={layer:e,type:0,properties:{}};return i.readFields(te,s,r),s}function se(i,e){let t;return i===1?t=e===1?"Point":"MultiPoint":i===2?t=e===1?"LineString":"MultiLineString":i===3&&(t="Polygon"),t}export{ne as M};
//# sourceMappingURL=MVT-QIduTz50.js.map
