import{D as st,b as Rt,t as mt,a as At}from"./DataTile-uej8eNh4.js";import{b8 as pt,ba as Ft,aB as H,aC as Z,a3 as tt,ao as Lt,v as W,bg as et,f as F,as as St,aZ as Dt,a_ as rt,E as ct,w as it,bm as bt,a4 as V,W as k,g as q,y as Pt,bn as vt}from"./GeoJSON-BlyzYhKz.js";import{a as Ut,E as Mt,T as Gt}from"./common-0gNrjJbx.js";import{o as Q,t as yt,s as ot,a as Ct}from"./mat4-CeypvY8Z.js";import{g as wt}from"./tilecoord-DYaQ6NdW.js";import{T as It,c as Xt,e as Bt,a as Ot,g as gt}from"./Tile-8IayXPne.js";import J from"./TileEventType-CTN_nmJ7.js";import"./Tile-lMrQctYw.js";import"./index-4V-ffF_e.js";import"./utils-BXWzvTjY.js";import"./_commonjsHelpers-CE1G-McA.js";import"./I18N-DlIXJTel.js";import"./BFormRadioGroup.vue_vue_type_script_setup_true_lang-DaMHx4U3-CVtNDUBO.js";import"./useStateClass-BGbSLWFN-lMazZNQ7.js";import"./ConditionalWrapper.vue_vue_type_script_lang-IX_NpHH--B1-KiooU.js";import"./TileGrid-D2Qra4XP.js";import"./TileRange-2Tc-Ry00.js";const jt=`
  attribute vec4 a_position;
  attribute vec4 a_texcoord;

  uniform mat4 u_matrix;
  uniform mat4 u_textureMatrix;

  varying vec2 v_texcoord;

  void main() {
    gl_Position = u_matrix * a_position;
    vec2 texcoord = (u_textureMatrix * a_texcoord).xy;
    v_texcoord = texcoord;
  }
`,Nt=`
  precision mediump float;

  varying vec2 v_texcoord;

  uniform sampler2D u_texture;

  void main() {
    if (
      v_texcoord.x < 0.0 ||
      v_texcoord.y < 0.0 ||
      v_texcoord.x > 1.0 ||
      v_texcoord.y > 1.0
    ) {
      discard;
    }
    gl_FragColor = texture2D(u_texture, v_texcoord);
  }
`;class zt{constructor(e){this.gl_=e,this.program_=$(e,Nt,jt),this.positionLocation=e.getAttribLocation(this.program_,"a_position"),this.texcoordLocation=e.getAttribLocation(this.program_,"a_texcoord"),this.matrixLocation=e.getUniformLocation(this.program_,"u_matrix"),this.textureMatrixLocation=e.getUniformLocation(this.program_,"u_textureMatrix"),this.textureLocation=e.getUniformLocation(this.program_,"u_texture"),this.positionBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.positionBuffer),this.positions=[0,0,0,1,1,0,1,0,0,1,1,1],e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.positions),e.STATIC_DRAW),this.texcoordBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.texcoordBuffer),this.texcoords=[0,0,0,1,1,0,1,0,0,1,1,1],e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.texcoords),e.STATIC_DRAW)}drawImage(e,o,i,n,a,R,s,L,U,M,S,f,T){const r=this.gl_;L===void 0&&(L=n),U===void 0&&(U=a),R===void 0&&(R=o),s===void 0&&(s=i),M===void 0&&(M=R),S===void 0&&(S=s),f===void 0&&(f=r.canvas.width),T===void 0&&(T=r.canvas.height),r.bindTexture(r.TEXTURE_2D,e),r.useProgram(this.program_),r.bindBuffer(r.ARRAY_BUFFER,this.positionBuffer),r.enableVertexAttribArray(this.positionLocation),r.vertexAttribPointer(this.positionLocation,2,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,this.texcoordBuffer),r.enableVertexAttribArray(this.texcoordLocation),r.vertexAttribPointer(this.texcoordLocation,2,r.FLOAT,!1,0,0);let u=Q(0,f,0,T,-1,1);u=yt(u,L,U,0),u=ot(u,M,S,1),r.uniformMatrix4fv(this.matrixLocation,!1,u);let p=Ct(n/o,a/i,0);p=ot(p,R/o,s/i,1),r.uniformMatrix4fv(this.textureMatrixLocation,!1,p),r.uniform1i(this.textureLocation,0),r.drawArrays(r.TRIANGLES,0,this.positions.length/2)}}function nt(t,e,o){const i=t.createShader(e);if(i===null)throw new Error("Shader compilation failed");if(t.shaderSource(i,o),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS)){const n=t.getShaderInfoLog(i);throw n===null?new Error("Shader info log creation failed"):new Error(n)}return i}function $(t,e,o){const i=t.createProgram(),n=nt(t,t.VERTEX_SHADER,o),a=nt(t,t.FRAGMENT_SHADER,e);if(i===null)throw new Error("Program creation failed");if(t.attachShader(i,n),t.attachShader(i,a),t.linkProgram(i),!t.getProgramParameter(i,t.LINK_STATUS))throw t.getProgramInfoLog(i)===null?new Error("Program info log creation failed"):new Error;return i}const Yt=`
  attribute vec4 a_position;

  uniform mat4 u_matrix;

  void main() {
     gl_Position = u_matrix * a_position;
  }
`,Kt=`
  precision mediump float;

  uniform vec4 u_val;
  void main() {
     gl_FragColor = u_val;
  }
`,Wt=`
  attribute vec4 a_position;
  attribute vec2 a_texcoord;

  varying vec2 v_texcoord;

  uniform mat4 u_matrix;

  void main() {
     gl_Position = u_matrix * a_position;
     v_texcoord = a_texcoord;
  }
`,Ht=`
  precision mediump float;

  varying vec2 v_texcoord;

  uniform sampler2D u_texture;

  void main() {
    if (v_texcoord.x < 0.0 || v_texcoord.x > 1.0 || v_texcoord.y < 0.0 || v_texcoord.y > 1.0) {
      discard;
    }
    gl_FragColor = texture2D(u_texture, v_texcoord);
  }
`;function Zt(t,e,o,i){let n;return o&&o.length?n=o.shift():pt?n=new OffscreenCanvas(t||300,e||300):n=document.createElement("canvas"),t&&(n.width=t),e&&(n.height=e),n.getContext("webgl",i)}function Vt(t){const e=t.canvas;e.width=1,e.height=1,t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT)}const at=[];function kt(t,e,o,i,n,a,R,s,L,U,M,S,f,T){const r=Math.round(i*e),u=Math.round(i*o);t.canvas.width=r,t.canvas.height=u;let p,m;if(m=t.createTexture(),t.bindTexture(t.TEXTURE_2D,m),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),f?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST)),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,r,u,0,t.RGBA,M,null),p=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,p),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,m,0),p===null)throw new Error("Could not create framebuffer");if(m===null)throw new Error("Could not create texture");if(L.length===0)return{width:r,height:u,framebuffer:p,texture:m};const x=Lt();L.forEach(function(c,D,E){Ft(x,c.extent)});let g,h,_;const v=1/n;{if(g=t.createTexture(),m===null)throw new Error("Could not create texture");h=Math.round(H(x)*v),_=Math.round(Z(x)*v);const c=t.getParameter(t.MAX_TEXTURE_SIZE),D=Math.max(h,_),E=D>c?c/D:1,A=Math.round(h*E),G=Math.round(_*E);t.bindTexture(t.TEXTURE_2D,g),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),f?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST)),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,A,G,0,t.RGBA,M,null);const l=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,l),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,g,0);const X=new zt(t);L.forEach(function(d,B,y){const b=(d.extent[0]-x[0])*v*E,I=-(d.extent[3]-x[3])*v*E,j=H(d.extent)*v*E,P=Z(d.extent)*v*E;if(t.bindFramebuffer(t.FRAMEBUFFER,l),t.viewport(0,0,A,G),d.clipExtent){const O=(d.clipExtent[0]-x[0])*v*E,N=-(d.clipExtent[3]-x[3])*v*E,Y=H(d.clipExtent)*v*E,K=Z(d.clipExtent)*v*E;t.enable(t.SCISSOR_TEST),t.scissor(f?O:Math.round(O),f?N:Math.round(N),f?Y:Math.round(O+Y)-Math.round(O),f?K:Math.round(N+K)-Math.round(N))}X.drawImage(d.texture,d.width,d.height,U,U,d.width-2*U,d.height-2*U,f?b:Math.round(b),f?I:Math.round(I),f?j:Math.round(b+j)-Math.round(b),f?P:Math.round(I+P)-Math.round(I),A,G),t.disable(t.SCISSOR_TEST)}),t.deleteFramebuffer(l)}const C=tt(R),w=tt(x),z=c=>{const D=(c[0][0]-C[0])/a*i,E=-(c[0][1]-C[1])/a*i,A=(c[1][0]-C[0])/a*i,G=-(c[1][1]-C[1])/a*i,l=(c[2][0]-C[0])/a*i,X=-(c[2][1]-C[1])/a*i;return{u1:A,v1:G,u0:D,v0:E,u2:l,v2:X}};t.bindFramebuffer(t.FRAMEBUFFER,p),t.viewport(0,0,r,u);{const c=[],D=[],E=$(t,Ht,Wt);t.useProgram(E);const A=t.getUniformLocation(E,"u_texture");t.bindTexture(t.TEXTURE_2D,g),t.uniform1i(A,0),s.getTriangles().forEach(function(b,I,j){const P=b.source,O=b.target,{u1:N,v1:Y,u0:K,v0:ut,u2:Et,v2:ft}=z(O),_t=(P[0][0]-w[0])/n/h,ht=-(P[0][1]-w[1])/n/_,Tt=(P[1][0]-w[0])/n/h,dt=-(P[1][1]-w[1])/n/_,xt=(P[2][0]-w[0])/n/h,lt=-(P[2][1]-w[1])/n/_;c.push(N,Y,K,ut,Et,ft),D.push(Tt,dt,_t,ht,xt,lt)});const G=Q(0,r,u,0,-1,1),l=t.getUniformLocation(E,"u_matrix");t.uniformMatrix4fv(l,!1,G);const X=t.getAttribLocation(E,"a_position"),d=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,d),t.bufferData(t.ARRAY_BUFFER,new Float32Array(c),t.STATIC_DRAW),t.vertexAttribPointer(X,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(X);const B=t.getAttribLocation(E,"a_texcoord"),y=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,y),t.bufferData(t.ARRAY_BUFFER,new Float32Array(D),t.STATIC_DRAW),t.vertexAttribPointer(B,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(B),t.drawArrays(t.TRIANGLES,0,c.length/2)}if(S){const c=$(t,Kt,Yt);t.useProgram(c);const D=Q(0,r,u,0,-1,1),E=t.getUniformLocation(c,"u_matrix");t.uniformMatrix4fv(E,!1,D);const A=Array.isArray(S)?S:[0,0,0,255],G=t.getUniformLocation(c,"u_val");t.uniform4fv(G,A);const l=t.getAttribLocation(c,"a_position"),X=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,X),t.vertexAttribPointer(l,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(l);const d=s.getTriangles().reduce(function(B,y){const b=y.target,{u1:I,v1:j,u0:P,v0:O,u2:N,v2:Y}=z(b);return B.concat([I,j,P,O,P,O,N,Y,N,Y,I,j])},[]);t.bufferData(t.ARRAY_BUFFER,new Float32Array(d),t.STATIC_DRAW),t.drawArrays(t.LINES,0,d.length/2)}return{width:r,height:u,framebuffer:p,texture:m}}class qt extends st{constructor(e){super({tileCoord:e.tileCoord,loader:()=>Promise.resolve(new Uint8ClampedArray(4)),interpolate:e.interpolate,transition:e.transition}),this.renderEdges_=e.renderEdges!==void 0?e.renderEdges:!1,this.pixelRatio_=e.pixelRatio,this.gutter_=e.gutter,this.reprojData_=null,this.reprojError_=null,this.reprojSize_=void 0,this.sourceTileGrid_=e.sourceTileGrid,this.targetTileGrid_=e.targetTileGrid,this.wrappedTileCoord_=e.wrappedTileCoord||e.tileCoord,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const o=e.sourceProj,i=o.getExtent(),n=e.sourceTileGrid.getExtent();this.clipExtent_=o.canWrapX()?n?W(i,n):i:n;const a=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_),R=this.targetTileGrid_.getExtent();let s=this.sourceTileGrid_.getExtent();const L=R?W(a,R):a;if(et(L)===0){this.state=F.EMPTY;return}i&&(s?s=W(s,i):s=i);const U=this.targetTileGrid_.getResolution(this.wrappedTileCoord_[0]),M=e.targetProj,S=Ut(o,M,L,U);if(!isFinite(S)||S<=0){this.state=F.EMPTY;return}const f=e.errorThreshold!==void 0?e.errorThreshold:Mt;if(this.triangulation_=new Gt(o,M,L,s,S*f,U,e.transformMatrix),this.triangulation_.getTriangles().length===0){this.state=F.EMPTY;return}this.sourceZ_=this.sourceTileGrid_.getZForResolution(S);let T=this.triangulation_.calculateSourceExtent();if(s&&(o.canWrapX()?(T[1]=it(T[1],s[1],s[3]),T[3]=it(T[3],s[1],s[3])):T=W(T,s)),!et(T))this.state=F.EMPTY;else{let r=0,u=0;o.canWrapX()&&(r=H(i),u=Math.floor((T[0]-i[0])/r)),bt(T.slice(),o,!0).forEach(m=>{const x=this.sourceTileGrid_.getTileRangeForExtentAndZ(m,this.sourceZ_),g=e.getTileFunction;for(let h=x.minX;h<=x.maxX;h++)for(let _=x.minY;_<=x.maxY;_++){const v=g(this.sourceZ_,h,_,this.pixelRatio_);if(v){const C=u*r;this.sourceTiles_.push({tile:v,offset:C})}}++u}),this.sourceTiles_.length===0&&(this.state=F.EMPTY)}}getSize(){return this.reprojSize_}getData(){return this.reprojData_}getError(){return this.reprojError_}reproject_(){const e=[];let o=!1;if(this.sourceTiles_.forEach(h=>{const _=h.tile;if(!_||_.getState()!==F.LOADED)return;const v=_.getSize(),C=this.gutter_;let w;const z=Rt(_.getData());z?w=z:(o=!0,w=mt(At(_.getData())));const c=[v[0]+2*C,v[1]+2*C],D=w instanceof Float32Array,E=c[0]*c[1],A=D?Float32Array:Uint8ClampedArray,G=new A(w.buffer),l=A.BYTES_PER_ELEMENT,X=l*G.length/E,d=G.byteLength/c[1],B=Math.floor(d/l/c[0]),y=this.sourceTileGrid_.getTileCoordExtent(_.tileCoord);y[0]+=h.offset,y[2]+=h.offset;const b=this.clipExtent_?.slice();b&&(b[0]+=h.offset,b[2]+=h.offset),e.push({extent:y,clipExtent:b,data:G,dataType:A,bytesPerPixel:X,pixelSize:c,bandCount:B})}),this.sourceTiles_.length=0,e.length===0){this.state=F.ERROR,this.changed();return}const i=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(i),a=typeof n=="number"?n:n[0],R=typeof n=="number"?n:n[1],s=Math.round(a*this.pixelRatio_),L=Math.round(R*this.pixelRatio_),U=this.targetTileGrid_.getResolution(i),M=this.sourceTileGrid_.getResolution(this.sourceZ_),S=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_),f=e[0].bandCount,T=new e[0].dataType(f*s*L),r=Zt(s,L,at,{premultipliedAlpha:!1,antialias:!1});let u;const p=r.RGBA;let m;e[0].dataType==Float32Array?(m=r.FLOAT,r.getExtension("WEBGL_color_buffer_float"),r.getExtension("OES_texture_float"),r.getExtension("EXT_float_blend"),u=r.getExtension("OES_texture_float_linear")!==null&&this.interpolate):(m=r.UNSIGNED_BYTE,u=this.interpolate);const x=4,g=Math.ceil(f/x);for(let h=g-1;h>=0;--h){const _=[];for(let A=0,G=e.length;A<G;++A){const l=e[A],X=l.pixelSize,d=X[0],B=X[1],y=new l.dataType(x*d*B),b=l.data;let I=h*x;for(let P=0,O=y.length;P<O;P+=x)y[P]=b[I],y[P+1]=b[I+1],y[P+2]=b[I+2],y[P+3]=b[I+3],I+=f;const j=r.createTexture();r.bindTexture(r.TEXTURE_2D,j),u?(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR)):(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST)),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texImage2D(r.TEXTURE_2D,0,p,d,B,0,p,m,y),_.push({extent:l.extent,clipExtent:l.clipExtent,texture:j,width:d,height:B})}const{framebuffer:v,width:C,height:w}=kt(r,a,R,this.pixelRatio_,M,U,S,this.triangulation_,_,this.gutter_,m,this.renderEdges_,u),z=C,c=w*x,D=new e[0].dataType(z*c);r.bindFramebuffer(r.FRAMEBUFFER,v),r.readPixels(0,0,C,w,r.RGBA,m,D);let E=h*x;for(let A=0,G=D.length;A<G;A+=x){const l=(z-1-(A/c|0))*c+A%c;T[E]=D[l],T[E+1]=D[l+1],T[E+2]=D[l+2],T[E+3]=D[l+3],E+=f}}if(Vt(r),at.push(r.canvas),o){const h=St(a,R),_=new ImageData(T,a);h.putImageData(_,0,0),this.reprojData_=h.canvas}else this.reprojData_=T;this.reprojSize_=[s,L],this.state=F.LOADED,this.changed()}load(){if(this.state!==F.IDLE&&this.state!==F.ERROR)return;this.state=F.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:o})=>{const i=o.getState();if(i!==F.IDLE&&i!==F.LOADING)return;e++;const n=Dt(o,ct.CHANGE,()=>{const a=o.getState();(a==F.LOADED||a==F.ERROR||a==F.EMPTY)&&(rt(n),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(n)}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:o}){o.getState()==F.IDLE&&o.load()})}unlistenSources_(){this.sourcesListenerKeys_.forEach(rt),this.sourcesListenerKeys_=null}}class Te extends It{constructor(e){const o=e.projection===void 0?"EPSG:3857":e.projection;let i=e.tileGrid;i===void 0&&o&&(i=Xt({extent:Bt(o),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize})),super({cacheSize:.1,attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:o,tileGrid:i,state:e.state,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.tileSize_=e.tileSize?V(e.tileSize):null,this.tileSizes_=null,this.tileLoadingKeys_={},this.loader_=e.loader,this.handleTileChange_=this.handleTileChange_.bind(this),this.bandCount=e.bandCount===void 0?4:e.bandCount,this.tileGridForProjection_={},this.crossOrigin_=e.crossOrigin||"anonymous",this.transformMatrix=null}setTileSizes(e){this.tileSizes_=e}getTileSize(e){if(this.tileSizes_)return this.tileSizes_[e];if(this.tileSize_)return this.tileSize_;const o=this.getTileGrid();return o?V(o.getTileSize(e)):[256,256]}getGutterForProjection(e){const o=this.getProjection();return(!o||k(o,e))&&!this.transformMatrix?this.gutter_:0}setLoader(e){this.loader_=e}getReprojTile_(e,o,i,n,a,R){const s=this.tileGrid||this.getTileGridForProjection(a||n),L=Math.max.apply(null,s.getResolutions().map((r,u)=>{const p=V(s.getTileSize(u)),m=this.getTileSize(u);return Math.max(m[0]/p[0],m[1]/p[1])})),U=this.getTileGridForProjection(n),M=[e,o,i],S=this.getTileCoordForTileUrlFunction(M,n),f=Object.assign({sourceProj:a||n,sourceTileGrid:s,targetProj:n,targetTileGrid:U,tileCoord:M,wrappedTileCoord:S,pixelRatio:L,gutter:this.gutter_,getTileFunction:(r,u,p,m)=>this.getTile(r,u,p,m,void 0,R),transformMatrix:this.transformMatrix},this.tileOptions),T=new qt(f);return T.key=this.getKey(),T}getTile(e,o,i,n,a,R){const s=this.getProjection();if(a&&(s&&!k(s,a)||this.transformMatrix))return this.getReprojTile_(e,o,i,a,s,R);const L=this.getTileSize(e),U=this.loader_,M=new AbortController,S={signal:M.signal,crossOrigin:this.crossOrigin_},f=this.getTileCoordForTileUrlFunction([e,o,i]);if(!f)return null;const T=this.getKey(),r=wt(this,T,e,o,i);if(R&&R.containsKey(r))return R.get(r);const u=f[0],p=f[1],m=f[2],x=this.getTileGrid()?.getFullTileRange(u);x&&(S.maxY=x.getHeight()-1);function g(){return vt(function(){return U(u,p,m,S)})}const h=Object.assign({tileCoord:[e,o,i],loader:g,size:L,controller:M},this.tileOptions),_=new st(h);return _.key=this.getKey(),_.addEventListener(ct.CHANGE,this.handleTileChange_),R?.set(r,_),_}handleTileChange_(e){const o=e.target,i=q(o),n=o.getState();let a;n==F.LOADING?(this.tileLoadingKeys_[i]=!0,a=J.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],a=n==F.ERROR?J.TILELOADERROR:n==F.LOADED?J.TILELOADEND:void 0),a&&this.dispatchEvent(new Ot(a,o))}getTileGridForProjection(e){const o=this.getProjection();if(this.tileGrid&&(!o||k(o,e))&&!this.transformMatrix)return this.tileGrid;const i=q(e);return i in this.tileGridForProjection_||(this.tileGridForProjection_[i]=gt(e)),this.tileGridForProjection_[i]}setTileGridForProjection(e,o){const i=Pt(e);if(i){const n=q(i);n in this.tileGridForProjection_||(this.tileGridForProjection_[n]=o)}}}export{Te as default};
//# sourceMappingURL=DataTile-Dra_RFvC.js.map
