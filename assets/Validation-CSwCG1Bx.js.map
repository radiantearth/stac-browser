{"version":3,"mappings":"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","names":["VERSION_REGEXP","_sfc_main","BCard","BCardHeader","errors","error","i","URI","v","message","Utils","params","key","value","localizedLabel","labelKey","_createBlock","_component_b_card","_createVNode","_component_b_card_header","_openBlock","_resolveDynamicComponent","$options","$props","_component_b_badge","_ctx","_component_b_list_group","_createElementBlock","_Fragment","_renderList","_component_b_list_group_item","_createTextVNode","_toDisplayString","warning","defineComponent","BCardGroup","ValidationResult","BrowseMixin","mapState","locale","i18nFn","__variableDynamicImportRuntimeHelper","STAC","stac","validateSTAC","_hoisted_1","_component_b_alert","_component_ErrorAlert","_component_Loading","_hoisted_2","_createElementVNode","_component_b_row","_component_b_col","_hoisted_3","_hoisted_4","_component_b_card_group","_component_ValidationResult"],"ignoreList":[],"sources":["../../src/components/ValidationResult.vue","../../src/views/Validation.vue"],"sourcesContent":["<template>\n  <b-card no-body>\n    <b-card-header>\n      <component :is=\"titleComponent\" class=\"name me-1\" :title=\"id\">{{ name }}</component>\n      <b-badge v-if=\"version\" variant=\"primary ms-1\">{{ version }}</b-badge>\n      <b-badge v-if=\"!isCore\" variant=\"dark ms-1\">{{ $t('source.extension') }}</b-badge>\n    </b-card-header>\n    <b-list-group flush>\n      <template v-if=\"errors.length > 0\">\n        <b-list-group-item v-for=\"(error, i) in localizedErrors\" :key=\"i\" variant=\"danger\">\n          {{ makeAjvErrorMessage(error) }}\n        </b-list-group-item>\n      </template>\n      <template v-if=\"hasWarnings\">\n        <b-list-group-item v-for=\"(warning, i) in warnings\" :key=\"i\" variant=\"warning\">\n          {{ makeAjvErrorMessage(warning) }}\n        </b-list-group-item>\n      </template>\n      <b-list-group-item v-if=\"errors.length === 0 && !hasWarnings\" variant=\"success\">\n        {{ $t('source.valid') }}\n      </b-list-group-item>\n    </b-list-group>\n  </b-card>\n</template>\n\n<script>\nimport URI from 'urijs';\nimport Utils from '../utils';\nimport { BCard, BCardHeader } from 'bootstrap-vue-next';\n\nconst VERSION_REGEXP = /\\/(v?\\d+\\.\\d+[^/]+)(\\/|$)/;\n\nexport default {\n  name: \"ValidationResult\",\n  components: {\n    BCard,\n    BCardHeader\n  },\n  props: {\n    id: {\n      type: String,\n      required: true\n    },\n    errors: {\n      type: Array,\n      required: true\n    },\n    warnings: {\n      type: Array,\n      default: null\n    },\n    locale: {\n      type: Function,\n      default: null\n    },\n    context: {\n      type: Object,\n      required: true\n    }\n  },\n  computed: {\n    titleComponent() {\n      return this.isCore ? 'span': 'code';\n    },\n    localizedErrors() {\n      if (typeof this.locale !== 'function') {\n        return this.errors;\n      }\n      // Make a copy of the errors as the ajv-i18n package mutates the error objects\n      const errors = this.errors.map(error => Object.assign({}, error));\n      // Translate error messages\n      this.locale(errors);\n      // ajv-i18n overrides error messages from stac-node-validator that do not originate from ajv.\n      // Reset to the original message in those cases.\n      return errors.map((error, i) => {\n        if (typeof error.keyword === 'undefined') {\n          return this.errors[i];\n        }\n        return error;\n      });\n    },\n    hasWarnings() {\n      return Array.isArray(this.warnings) && this.warnings.length > 0;\n    },\n    isCore() {\n      return this.id === 'core';\n    },\n    type() {\n      switch(this.context.type) {\n        case \"Feature\":\n          return this.$t('stacItem', 1);\n        case \"Catalog\":\n          return this.$t(`stacCatalog`, 1);\n        case \"Collection\":\n          return this.$t(`stacCollection`, 1);\n        default:\n          return this.context.type;\n      }\n    },\n    name() {\n      if (this.isCore) {\n        return this.type;\n      }\n      else if (this.id.startsWith('https://stac-extensions.github.io/')) {\n        return URI(this.id)\n          .directory()\n          .replace(VERSION_REGEXP, '/')\n          .replace(/\\//g, ' ')\n          .trim();\n      }\n      return this.id\n        .replace(/^\\w+:\\/\\//, '')\n        .replace(/(\\.github\\.io|raw\\.githubusercontent\\.com)\\/?/, '')\n        .replace(/\\/json-schema/, '')\n        .replace(/\\/[^/]+\\.json$/, '')\n        .replace(VERSION_REGEXP, '');\n    },\n    version() {\n      if (this.isCore) {\n        return this.context.version;\n      }\n      let v = this.id.match(VERSION_REGEXP);\n      if (v) {\n        return v[1];\n      }\n      return null;\n    }\n  },\n  methods: {\n    makeAjvErrorMessage(error) {\n      let message = error.message;\n      if (Utils.isObject(error.params) && Object.keys(error.params).length > 0) {\n        let params = Object.entries(error.params)\n          .map(([key, value]) => {\n            let localizedLabel;\n            const labelKey = `source.validationParams.${key}`;\n            if (this.$te(labelKey)) {\n              localizedLabel = this.$t(labelKey);\n            }\n            else {\n              localizedLabel = key.replace(/([^A-Z]+)([A-Z])/g, \"$1 $2\").toLowerCase();\n            }\n\n            return `${localizedLabel}: ${value}`;\n          })\n          .join(', ');\n        message += ` (${params})`;\n      }\n      if (error.instancePath) {\n        return `${error.instancePath} ${message}`;\n      }\n      else if (error.schemaPath) {\n        return this.$t('messageForSchemaError', {message, schemaPath: error.schemaPath});\n      }\n      else if (message) {\n        return message;\n      }\n      else {\n        return String(error);\n      }\n    }\n  }\n};\n</script>\n","<template>\n  <main class=\"validation d-flex flex-column\">\n    <b-alert v-if=\"!allowExternalAccess && isExternal\" show>{{ $t('errors.noExternalAccess') }}</b-alert>\n    <ErrorAlert v-else-if=\"error\" :url=\"url\" :description=\"errorDescription\" :id=\"errorId\" />\n    <ErrorAlert v-else-if=\"internalError\" :url=\"url\" :description=\"internalError.message\" />\n    <Loading v-else-if=\"loading || working\" stretch />\n    <section v-else-if=\"report\">\n      <h2>{{ $t('source.validationReport.title') }}</h2>\n      <b-alert variant=\"info\" show>{{ $t('source.validationReport.disclaimer') }}</b-alert>\n      <b-row class=\"stac-id\">\n        <b-col cols=\"4\">{{ $t('source.id') }}</b-col>\n        <b-col>\n          <code>{{ report.id }}</code>\n        </b-col>\n      </b-row>\n      <b-row class=\"result\">\n        <b-col cols=\"4\">{{ $t('source.validationReport.result') }}</b-col>\n        <b-col>\n          <span class=\"text-success\" v-if=\"report.valid\">{{ $t('source.valid') }}</span>\n          <span class=\"text-danger\" v-else>{{ $t('source.invalid') }}</span>\n        </b-col>\n      </b-row>\n\n      <hr class=\"my-4\">\n\n      <b-card-group class=\"results\" columns>\n        <ValidationResult\n          id=\"core\" :errors=\"report.results.core\" :warnings=\"report.messages\"\n          :locale=\"locale\" :context=\"report\"\n        />\n        <ValidationResult\n          v-for=\"(errors, key) in report.results.extensions\" :key=\"key\"\n          :id=\"key\" :errors=\"errors\" :locale=\"locale\" :context=\"report\"\n        />\n      </b-card-group>\n    </section>\n    <ErrorAlert v-else :description=\"$t('errors.default')\" />\n  </main>\n</template>\n\n<script>\nimport { mapState } from 'vuex';\nimport { defineComponent } from 'vue';\nimport validateSTAC from 'stac-node-validator';\nimport BrowseMixin from './BrowseMixin.js';\nimport { STAC } from 'stac-js';\nimport { BCardGroup } from 'bootstrap-vue-next';\nimport ValidationResult from '../components/ValidationResult.vue';\n\nexport default defineComponent({\n  name: \"Validation\",\n  components: {\n    BCardGroup,\n    ValidationResult\n  },\n  mixins: [\n    BrowseMixin\n  ],\n  props: {\n    path: {\n      type: String,\n      required: true\n    }\n  },\n  data() {\n    return {\n      working: true,\n      report: null,\n      internalError: null,\n      locale: null\n    };\n  },\n  computed: {\n    ...mapState([\"data\", \"uiLanguage\"]),\n    variant() {\n      return this.report && this.report.valid ? \"success\" : \"danger\";\n    }\n  },\n  watch: {\n    data: {\n      immediate: true,\n      async handler() {\n        await this.validate();\n      }\n    },\n    uiLanguage: {\n      immediate: true,\n      async handler(locale) {\n        if (!locale) {\n          return;\n        }\n        const i18nFn = (await import(`../locales/${locale}/validation.js`)).default;\n        if (i18nFn instanceof Promise) {\n          this.locale = (await i18nFn).default;\n        }\n        else {\n          this.locale = i18nFn;\n        }\n      }\n    }\n  },\n  methods: {\n    async validate() {\n      this.working = true;\n      this.report = null;\n      if (this.data instanceof STAC) {\n        try {\n          const stac = this.data._original || this.data.toJSON();\n          this.report = await validateSTAC(stac, {});\n        } catch (error) {\n          this.internalError = error;\n        } finally {\n          this.working = false;\n        }\n      }\n    }\n  }\n});\n</script>\n\n<style lang=\"scss\" scoped>\n.report {\n  font-weight: bold;\n}\n</style>\n\n<style lang=\"scss\">\n@import 'bootstrap/scss/mixins';\n@import \"../theme/variables.scss\";\n\n#stac-browser .validation .results.card-columns {\n  @include media-breakpoint-up(sm) {\n    column-count: 2;\n  }\n  @include media-breakpoint-up(lg) {\n    column-count: 3;\n  }\n  @include media-breakpoint-up(xxxl) {\n    column-count: 4;\n  }\n}\n</style>\n"],"file":"Validation-CSwCG1Bx.js"}