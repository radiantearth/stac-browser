{"version":3,"file":"TileDebug-DsT8xoOD.js","sources":["../../node_modules/ol/source/TileDebug.js"],"sourcesContent":["/**\n * @module ol/source/TileDebug\n */\n\nimport {createCanvasContext2D} from '../dom.js';\nimport EventType from '../events/EventType.js';\nimport {get as getProjection} from '../proj.js';\nimport {toSize} from '../size.js';\nimport {renderXYZTemplate} from '../uri.js';\nimport DataTile from './DataTile.js';\nimport ImageTile from './ImageTile.js';\n\n/**\n * @typedef {Object} Options\n * @property {import(\"../proj.js\").ProjectionLike} [projection='EPSG:3857'] Optional projection.\n * @property {import(\"../tilegrid/TileGrid.js\").default} [tileGrid] Tile grid.\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n * @property {number|import(\"../array.js\").NearestDirectionFunction} [zDirection=0]\n * Set to `1` when debugging `VectorTile` sources with a default configuration.\n * Choose whether to use tiles with a higher or lower zoom level when between integer\n * zoom levels. See {@link module:ol/tilegrid/TileGrid~TileGrid#getZForResolution}.\n * @property {import(\"./Tile.js\").default} [source] Tile source.\n * This allows `projection`, `tileGrid`, `wrapX` and `zDirection` to be copied from another source.\n * If both `source` and individual options are specified the individual options will have precedence.\n * @property {string} [template='z:{z} x:{x} y:{y}'] Template for labeling the tiles.\n * Should include `{x}`, `{y}` or `{-y}`, and `{z}` placeholders.\n * @property {string} [color='grey'] CSS color to fill text and stroke grid lines of each tile.\n */\n\n/**\n * @classdesc\n * A pseudo tile source, which does not fetch tiles from a server, but renders\n * a grid outline for the tile grid/projection along with the coordinates for\n * each tile. See examples/canvas-tiles for an example.\n * @api\n */\nclass TileDebug extends ImageTile {\n  /**\n   * @param {Options} [options] Debug tile options.\n   */\n  constructor(options) {\n    /**\n     * @type {Options}\n     */\n    options = options || {};\n    const template = options.template || 'z:{z} x:{x} y:{y}';\n    const source = options.source;\n    const color = options.color || 'grey';\n\n    super({\n      transition: 0,\n      wrapX:\n        options.wrapX !== undefined\n          ? options.wrapX\n          : source !== undefined\n            ? source.getWrapX()\n            : undefined,\n    });\n\n    const setReady = () => {\n      this.projection =\n        options.projection !== undefined\n          ? getProjection(options.projection)\n          : source !== undefined\n            ? source.getProjection()\n            : this.projection;\n      this.tileGrid =\n        options.tileGrid !== undefined\n          ? options.tileGrid\n          : source !== undefined\n            ? source.getTileGrid()\n            : this.tileGrid;\n      this.zDirection =\n        options.zDirection !== undefined\n          ? options.zDirection\n          : source !== undefined\n            ? source.zDirection\n            : this.zDirection;\n\n      if (source instanceof DataTile) {\n        this.transformMatrix = source.transformMatrix?.slice() || null;\n      }\n\n      const tileGrid = this.tileGrid;\n      if (tileGrid) {\n        this.setTileSizes(\n          tileGrid\n            .getResolutions()\n            .map((r, i) =>\n              toSize(tileGrid.getTileSize(i)).map((s) =>\n                Math.max(Math.floor(s), 1),\n              ),\n            ),\n        );\n      }\n\n      this.setLoader((z, x, y, loaderOptions) => {\n        const text = renderXYZTemplate(template, z, x, y, loaderOptions.maxY);\n        const [width, height] = this.getTileSize(z);\n        const context = createCanvasContext2D(width, height);\n\n        context.strokeStyle = color;\n        context.strokeRect(0.5, 0.5, width + 0.5, height + 0.5);\n\n        context.fillStyle = color;\n        context.strokeStyle = 'white';\n        context.textAlign = 'center';\n        context.textBaseline = 'middle';\n        context.font = '24px sans-serif';\n        context.lineWidth = 4;\n        context.strokeText(text, width / 2, height / 2, width);\n        context.fillText(text, width / 2, height / 2, width);\n        // make the loader aysnc, so it behaves like other sources that fetch data from a remote server\n        return Promise.resolve(context.canvas);\n      });\n      this.setState('ready');\n    };\n\n    if (source === undefined || source.getState() === 'ready') {\n      setReady();\n    } else {\n      const handler = () => {\n        if (source.getState() === 'ready') {\n          source.removeEventListener(EventType.CHANGE, handler);\n          setReady();\n        }\n      };\n      source.addEventListener(EventType.CHANGE, handler);\n    }\n  }\n}\n\nexport default TileDebug;\n"],"names":["TileDebug","ImageTile","options","template","source","color","setReady","getProjection","DataTile","tileGrid","r","i","toSize","s","z","x","y","loaderOptions","text","renderXYZTemplate","width","height","context","createCanvasContext2D","handler","EventType"],"mappings":"ywBAoCA,MAAMA,UAAkBC,CAAU,CAIhC,YAAYC,EAAS,CAInBA,EAAUA,GAAW,CAAA,EACrB,MAAMC,EAAWD,EAAQ,UAAY,oBAC/BE,EAASF,EAAQ,OACjBG,EAAQH,EAAQ,OAAS,OAE/B,MAAM,CACJ,WAAY,EACZ,MACEA,EAAQ,QAAU,OACdA,EAAQ,MACRE,IAAW,OACTA,EAAO,SAAQ,EACf,MACd,CAAK,EAED,MAAME,EAAW,IAAM,CACrB,KAAK,WACHJ,EAAQ,aAAe,OACnBK,EAAcL,EAAQ,UAAU,EAChCE,IAAW,OACTA,EAAO,cAAa,EACpB,KAAK,WACb,KAAK,SACHF,EAAQ,WAAa,OACjBA,EAAQ,SACRE,IAAW,OACTA,EAAO,YAAW,EAClB,KAAK,SACb,KAAK,WACHF,EAAQ,aAAe,OACnBA,EAAQ,WACRE,IAAW,OACTA,EAAO,WACP,KAAK,WAETA,aAAkBI,IACpB,KAAK,gBAAkBJ,EAAO,iBAAiB,MAAK,GAAM,MAG5D,MAAMK,EAAW,KAAK,SAClBA,GACF,KAAK,aACHA,EACG,eAAc,EACd,IAAI,CAACC,EAAGC,IACPC,EAAOH,EAAS,YAAYE,CAAC,CAAC,EAAE,IAAKE,GACnC,KAAK,IAAI,KAAK,MAAMA,CAAC,EAAG,CAAC,CACzC,CACA,CACA,EAGM,KAAK,UAAU,CAACC,EAAGC,EAAGC,EAAGC,IAAkB,CACzC,MAAMC,EAAOC,EAAkBhB,EAAUW,EAAGC,EAAGC,EAAGC,EAAc,IAAI,EAC9D,CAACG,EAAOC,CAAM,EAAI,KAAK,YAAYP,CAAC,EACpCQ,EAAUC,EAAsBH,EAAOC,CAAM,EAEnD,OAAAC,EAAQ,YAAcjB,EACtBiB,EAAQ,WAAW,GAAK,GAAKF,EAAQ,GAAKC,EAAS,EAAG,EAEtDC,EAAQ,UAAYjB,EACpBiB,EAAQ,YAAc,QACtBA,EAAQ,UAAY,SACpBA,EAAQ,aAAe,SACvBA,EAAQ,KAAO,kBACfA,EAAQ,UAAY,EACpBA,EAAQ,WAAWJ,EAAME,EAAQ,EAAGC,EAAS,EAAGD,CAAK,EACrDE,EAAQ,SAASJ,EAAME,EAAQ,EAAGC,EAAS,EAAGD,CAAK,EAE5C,QAAQ,QAAQE,EAAQ,MAAM,CACvC,CAAC,EACD,KAAK,SAAS,OAAO,CACvB,EAEA,GAAIlB,IAAW,QAAaA,EAAO,SAAQ,IAAO,QAChDE,EAAQ,MACH,CACL,MAAMkB,EAAU,IAAM,CAChBpB,EAAO,SAAQ,IAAO,UACxBA,EAAO,oBAAoBqB,EAAU,OAAQD,CAAO,EACpDlB,EAAQ,EAEZ,EACAF,EAAO,iBAAiBqB,EAAU,OAAQD,CAAO,CACnD,CACF,CACF","x_google_ignoreList":[0]}