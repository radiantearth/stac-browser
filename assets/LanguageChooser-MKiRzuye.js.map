{"version":3,"file":"LanguageChooser-MKiRzuye.js","sources":["../../src/components/LanguageChooser.vue"],"sourcesContent":["<template>\n  <b-dropdown size=\"sm\" variant=\"primary\" right :title=\"$t('source.language.switch')\">\n    <template #button-content>\n      <b-icon-flag /><span class=\"button-label\">{{ $t('source.language.label', {currentLanguage}) }}</span>\n    </template>\n    <b-dropdown-item v-for=\"l of languages\" :key=\"l.code\" class=\"lang-item\" @click=\"setLocale(l.code)\">\n      <b-icon-check :class=\"{hide: currentLocale !== l.code}\" />\n      <span class=\"title\">\n        <span :lang=\"l.code\">{{ l.native }}</span>\n        <template v-if=\"l.global && l.global !== l.native\"> / <span lang=\"en\">{{ l.global }}</span></template>\n      </span>\n      <b-icon-exclamation-triangle v-if=\"supportsLanguageExt && (!l.ui || !l.data)\" :title=\"l.ui ? $t('source.language.onlyUI') : $t('source.language.onlyData')\" class=\"ms-2\" />\n    </b-dropdown-item>\n  </b-dropdown>\n</template>\n\n<script>\n\nimport { STAC } from 'stac-js';\nimport { getBest, prepareSupported } from 'stac-js/src/locales';\n\nimport { BDropdown, BDropdownItem } from 'bootstrap-vue-next';\n\nimport { getDataLanguages, STAC_LANGUAGE_EXT } from '../i18n';\nimport Utils from '../utils';\n\nexport default {\n  name: 'LanguageChooser',\n  components: {\n    BDropdown,\n    BDropdownItem,\n  },\n  props: {\n    data: {\n      type: Object,\n      default: null\n    },\n    locales: {\n      type: Array,\n      default: () => []\n    },\n    currentLocale: {\n      type: String,\n      required: true\n    }\n  },\n  emits: ['setLocale'],\n  computed: {\n    dataLanguages() {\n      let dataLanguages = [];\n      if (this.data instanceof STAC) {\n        const languages = this.data.getMetadata('languages');\n        // Ensure the other languages are always an array\n        if (Array.isArray(languages) && languages.length > 0) {\n          dataLanguages = languages.slice();\n        }\n        // Add the current language of the data to the list of languages\n        // No need to check the language as checks will be done in the filter below\n        dataLanguages.unshift(this.data.getMetadata('language'));\n      }\n      // Filter out invalid languages\n      return dataLanguages.filter(lang => Utils.isObject(lang) && typeof lang.code === 'string');\n    },\n    supportsLanguageExt() {\n      return this.data instanceof STAC && this.data.supportsExtension(STAC_LANGUAGE_EXT);\n    },\n    currentLanguage() {\n      let lang = this.languages.find(l => l.code === this.currentLocale);\n      if (lang) {\n        return lang.native;\n      }\n      else {\n        return '-';\n      }\n    },\n    languages() {\n      let languages = [];\n\n      // Add all UI languages\n      for(let code of this.locales) {\n        const t_key = `languages.${code}.transliteration`;\n        languages.push({\n          code,\n          native: this.$t(`languages.${code}.native`),\n          global: this.$t(`languages.${code}.global`),\n          transliteration: this.$te(t_key) ? this.$t(t_key) : null,\n          ui: true\n        });\n      }\n\n      // Add missing data languages\n      const dataLanguages = getDataLanguages(this.data);\n      for(let lang of dataLanguages) {\n        if (!Utils.isObject(lang) || !lang.code || this.locales.includes(lang.code)) {\n          continue;\n        }\n        let newLang = {\n          code: lang.code\n        };\n        newLang.native = lang.name || lang.alternate || lang.code;\n        newLang.global = lang.alternate || lang.name || lang.code;\n        newLang.data = true;\n        languages.push(newLang);\n      }\n\n      if (this.supportsLanguageExt) {\n        // Determine which languages are complete\n        const uiSupported = prepareSupported(this.locales);\n        const dataSupported = prepareSupported(dataLanguages.map(l => l.code));\n        for(let l of languages) {\n          if (!l.ui) {\n            l.ui = Boolean(getBest(uiSupported, l.code, null));\n          }\n          if (!l.data) {\n            l.data = Boolean(getBest(dataSupported, l.code, null));\n          }\n        }\n      }\n      \n      const collator = new Intl.Collator('en', { sensitivity: 'base' });\n      return languages.sort((a,b) => {\n        return collator.compare(\n          a.transliteration || a.native,\n          b.transliteration || b.native\n        );\n      });\n    },\n  },\n  methods: {\n    setLocale(locale) {\n      this.$emit('setLocale', locale);\n    }\n  }  \n};\n</script>\n\n<style lang=\"scss\" scoped>\n.lang-item > .dropdown-item {\n  display: flex;\n  svg.hide {\n    opacity: 0;\n  }\n  > .title {\n    flex: 1;\n  }\n}\n</style>\n"],"names":["_sfc_main","BDropdown","BDropdownItem","dataLanguages","STAC","languages","lang","Utils","STAC_LANGUAGE_EXT","l","code","t_key","getDataLanguages","newLang","uiSupported","prepareSupported","dataSupported","getBest","collator","a","b","locale","_hoisted_1","_hoisted_2","_hoisted_4","_createBlock","_component_b_dropdown","_ctx","_createVNode","_component_b_icon_flag","_createElementVNode","_toDisplayString","$options","_createElementBlock","_Fragment","_renderList","_component_b_dropdown_item","$event","_component_b_icon_check","_normalizeClass","$props","_hoisted_3","_component_b_icon_exclamation_triangle"],"mappings":"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"}