import{y as a,an as h,q as d,_ as u}from"./GeoJSON-BlyzYhKz.js";import{j as p}from"./net-tq6Ez6OH.js";import{e as S,c as f}from"./Tile-8IayXPne.js";import{c as T}from"./tileurlfunction-CsB_e4FB.js";import E from"./TileImage-BzZFQQFS.js";import"./index-4V-ffF_e.js";import"./utils-BXWzvTjY.js";import"./_commonjsHelpers-CE1G-McA.js";import"./I18N-DlIXJTel.js";import"./BFormRadioGroup.vue_vue_type_script_setup_true_lang-DaMHx4U3-CVtNDUBO.js";import"./useStateClass-BGbSLWFN-lMazZNQ7.js";import"./ConditionalWrapper.vue_vue_type_script_lang-IX_NpHH--B1-KiooU.js";import"./tilecoord-DYaQ6NdW.js";import"./TileGrid-D2Qra4XP.js";import"./TileRange-2Tc-Ry00.js";import"./uri-BxyrIhx_.js";import"./Tile-BrHfHitc.js";import"./Tile-lMrQctYw.js";import"./common-0gNrjJbx.js";import"./UrlTile-CxpuZoX4.js";import"./TileEventType-CTN_nmJ7.js";class D extends E{constructor(t){if(super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:a("EPSG:3857"),reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:"loading",tileLoadFunction:t.tileLoadFunction,wrapX:t.wrapX!==void 0?t.wrapX:!0,transition:t.transition,zDirection:t.zDirection}),this.tileJSON_=null,this.tileSize_=t.tileSize,t.url)if(t.jsonp)p(t.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{const e=new XMLHttpRequest;e.addEventListener("load",this.onXHRLoad_.bind(this)),e.addEventListener("error",this.onXHRError_.bind(this)),e.open("GET",t.url),e.send()}else if(t.tileJSON)this.handleTileJSONResponse(t.tileJSON);else throw new Error("Either `url` or `tileJSON` options must be provided")}onXHRLoad_(t){const e=t.target;if(!e.status||e.status>=200&&e.status<300){let r;try{r=JSON.parse(e.responseText)}catch{this.handleTileJSONError();return}this.handleTileJSONResponse(r)}else this.handleTileJSONError()}onXHRError_(t){this.handleTileJSONError()}getTileJSON(){return this.tileJSON_}handleTileJSONResponse(t){const e=a("EPSG:4326"),r=this.getProjection();let i;if(t.bounds!==void 0){const o=h(e,r);i=d(t.bounds,o)}const n=S(r),l=t.minzoom||0,m=t.maxzoom||22,s=f({extent:n,maxZoom:m,minZoom:l,tileSize:this.tileSize_});if(this.tileGrid=s,this.tileUrlFunction=T(t.tiles,s),t.attribution&&!this.getAttributions()){const o=i!==void 0?i:n;this.setAttributions(function(c){return u(o,c.extent)?[t.attribution]:null})}this.tileJSON_=t,this.setState("ready")}handleTileJSONError(){this.setState("error")}}export{D as default};
//# sourceMappingURL=TileJSON-D4FoPpxN.js.map
